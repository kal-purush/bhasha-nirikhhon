{
    "identifiers": [
        "numpy",
        "np",
        "sklearn",
        "cluster",
        "KMeans",
        "km",
        "sklearn",
        "metrics",
        "met",
        "math",
        "math",
        "np",
        "loadtxt",
        "delimiter",
        "np",
        "loadtxt",
        "delimiter",
        "reshape",
        "np",
        "loadtxt",
        "delimiter",
        "np",
        "loadtxt",
        "delimiter",
        "reshape",
        "syn_input_data",
        "syn_input_data",
        "syn_input_data",
        "syn_output_data",
        "syn_output_data",
        "syn_output_data",
        "letor_input_data",
        "letor_input_data",
        "letor_input_data",
        "letor_output_data",
        "letor_output_data",
        "letor_output_data",
        "len",
        "training_set_ip_syn",
        "X",
        "km",
        "n_clusters",
        "random_state",
        "fit",
        "X",
        "X_kmeans",
        "cluster_centers_",
        "X_centers",
        "X",
        "cluster_size",
        "km",
        "cluster_size",
        "random_state",
        "fit",
        "X",
        "i",
        "X",
        "np",
        "where",
        "X_kmeans",
        "labels_",
        "i",
        "i",
        "cluster_size",
        "np",
        "diag",
        "np",
        "diag",
        "np",
        "cov",
        "X_kmeans_list",
        "i",
        "T",
        "i",
        "cluster_size",
        "X_spread",
        "X",
        "centers",
        "spreads",
        "centers",
        "np",
        "exp",
        "np",
        "sum",
        "np",
        "matmul",
        "X",
        "centers_new",
        "spreads",
        "X",
        "centers_new",
        "axis",
        "T",
        "np",
        "insert",
        "basis_func_output",
        "axis",
        "L2_lambda",
        "design_matrix",
        "output_data",
        "np",
        "linalg",
        "solve",
        "L2_lambda",
        "np",
        "identity",
        "design_matrix",
        "shape",
        "np",
        "matmul",
        "design_matrix",
        "T",
        "design_matrix",
        "np",
        "matmul",
        "design_matrix",
        "T",
        "output_data",
        "flatten",
        "learning_rate",
        "minibatch_size",
        "num_epochs",
        "L2_lambda",
        "design_matrix",
        "output_data",
        "design_matrix",
        "shape",
        "np",
        "zeros",
        "epoch",
        "num_epochs",
        "i",
        "N",
        "minibatch_size",
        "i",
        "minibatch_size",
        "min",
        "i",
        "minibatch_size",
        "N",
        "design_matrix",
        "lower_bound",
        "upper_bound",
        "output_data",
        "lower_bound",
        "upper_bound",
        "np",
        "matmul",
        "np",
        "matmul",
        "Phi",
        "weights",
        "T",
        "t",
        "T",
        "Phi",
        "E_D",
        "L2_lambda",
        "weights",
        "minibatch_size",
        "weights",
        "learning_rate",
        "E",
        "weights",
        "flatten",
        "weight",
        "X",
        "np",
        "matmul",
        "X",
        "weight",
        "reshape",
        "target",
        "predicted",
        "dataset",
        "met",
        "mean_squared_error",
        "target",
        "predicted",
        "math",
        "sqrt",
        "error",
        "len",
        "dataset",
        "choose_center",
        "training_set_ip_syn",
        "find_spread",
        "training_set_ip_syn",
        "cluster_size",
        "compute_design_matrix",
        "training_set_ip_syn",
        "training_set_ip_centers_syn",
        "tranining_set_ip_spread_syn",
        "closed_form_sol",
        "L2_lambda",
        "training_set_ip_design_matrix_syn",
        "training_set_op_syn",
        "find_predicted_value",
        "training_set_ip_closed_syn",
        "training_set_ip_design_matrix_syn",
        "choose_center",
        "validation_set_ip_syn",
        "find_spread",
        "validation_set_ip_syn",
        "cluster_size",
        "compute_design_matrix",
        "validation_set_ip_syn",
        "validation_set_ip_centers_syn",
        "validation_set_ip_spread_syn",
        "closed_form_sol",
        "L2_lambda",
        "validation_set_ip_design_matrix_syn",
        "validation_set_op_syn",
        "find_predicted_value",
        "validation_set_ip_closed_syn",
        "validation_set_ip_design_matrix_syn",
        "choose_center",
        "test_set_ip_syn",
        "find_spread",
        "test_set_ip_syn",
        "cluster_size",
        "compute_design_matrix",
        "test_set_ip_syn",
        "test_set_ip_centers_syn",
        "test_set_ip_spread_syn",
        "test_set_ip_design_matrix_syn",
        "closed_form_sol",
        "L2_lambda",
        "test_set_ip_design_matrix_syn",
        "test_set_op_syn",
        "test_set_ip_closed_syn",
        "find_predicted_value",
        "test_set_ip_closed_syn",
        "test_set_ip_design_matrix_syn",
        "err_func",
        "test_set_op_syn",
        "test_set_ip_predicted_value_syn",
        "test_set_ip_syn",
        "choose_center",
        "training_set_ip_syn",
        "find_spread",
        "training_set_ip_syn",
        "cluster_size",
        "compute_design_matrix",
        "training_set_ip_syn",
        "training_set_ip_centers_sgd",
        "tranining_set_ip_spread_sgd",
        "SGD_sol",
        "learning_rate",
        "minibatch_size",
        "num_epochs",
        "L2_lambda",
        "training_set_ip_design_matrix_sgd",
        "training_set_op_syn",
        "find_predicted_value",
        "training_set_ip_sgd",
        "training_set_ip_design_matrix_sgd",
        "choose_center",
        "validation_set_ip_syn",
        "find_spread",
        "validation_set_ip_syn",
        "cluster_size",
        "compute_design_matrix",
        "validation_set_ip_syn",
        "validation_set_ip_centers_sgd",
        "validation_set_ip_spread_sgd",
        "SGD_sol",
        "learning_rate",
        "minibatch_size",
        "num_epochs",
        "L2_lambda",
        "validation_set_ip_design_matrix_sgd",
        "validation_set_op_syn",
        "find_predicted_value",
        "validation_set_ip_sgd",
        "validation_set_ip_design_matrix_sgd",
        "choose_center",
        "test_set_ip_syn",
        "find_spread",
        "test_set_ip_syn",
        "cluster_size",
        "compute_design_matrix",
        "test_set_ip_syn",
        "test_set_ip_centers_sgd",
        "test_set_ip_spread_sgd",
        "test_set_ip_design_matrix_sgd",
        "closed_form_sol",
        "L2_lambda",
        "test_set_ip_design_matrix_sgd",
        "test_set_op_syn",
        "test_set_ip_closed_sgd",
        "find_predicted_value",
        "test_set_ip_closed_sgd",
        "test_set_ip_design_matrix_sgd",
        "err_func",
        "test_set_op_syn",
        "test_set_ip_predicted_value_sgd",
        "test_set_ip_syn",
        "choose_center",
        "letor_input_data",
        "find_spread",
        "training_set_ip_letor",
        "cluster_size",
        "compute_design_matrix",
        "training_set_ip_letor",
        "training_set_ip_centers_letor",
        "tranining_set_ip_spread_letor",
        "closed_form_sol",
        "L2_lambda",
        "training_set_ip_design_matrix_letor",
        "training_set_op_letor",
        "find_predicted_value",
        "training_set_ip_closed_letor",
        "training_set_ip_design_matrix_letor",
        "choose_center",
        "validation_set_ip_letor",
        "find_spread",
        "validation_set_ip_letor",
        "cluster_size",
        "compute_design_matrix",
        "validation_set_ip_letor",
        "validation_set_ip_centers_letor",
        "validation_set_ip_spread_letor",
        "closed_form_sol",
        "L2_lambda",
        "validation_set_ip_design_matrix_letor",
        "validation_set_op_letor",
        "find_predicted_value",
        "validation_set_ip_closed_letor",
        "validation_set_ip_design_matrix_letor",
        "choose_center",
        "test_set_ip_letor",
        "find_spread",
        "test_set_ip_letor",
        "cluster_size",
        "compute_design_matrix",
        "test_set_ip_letor",
        "test_set_ip_centers_letor",
        "test_set_ip_spread_letor",
        "test_set_ip_design_matrix_sgd",
        "closed_form_sol",
        "L2_lambda",
        "test_set_ip_design_matrix_letor",
        "test_set_op_letor",
        "test_set_ip_closed_letor",
        "find_predicted_value",
        "test_set_ip_closed_letor",
        "test_set_ip_design_matrix_letor",
        "err_func",
        "test_set_op_letor",
        "test_set_ip_predicted_value_letor",
        "test_set_ip_letor",
        "choose_center",
        "training_set_ip_letor",
        "find_spread",
        "training_set_ip_letor",
        "cluster_size",
        "compute_design_matrix",
        "training_set_ip_letor",
        "training_set_ip_centers",
        "tranining_set_ip_spread",
        "SGD_sol",
        "learning_rate",
        "minibatch_size",
        "num_epochs",
        "L2_lambda",
        "training_set_ip_design_matrix",
        "training_set_op_letor",
        "find_predicted_value",
        "training_set_ip_sgd",
        "training_set_ip_design_matrix",
        "choose_center",
        "validation_set_ip_letor",
        "find_spread",
        "validation_set_ip_letor",
        "cluster_size",
        "compute_design_matrix",
        "validation_set_ip_letor",
        "validation_set_ip_centers",
        "validation_set_ip_spread",
        "SGD_sol",
        "learning_rate",
        "minibatch_size",
        "num_epochs",
        "L2_lambda",
        "validation_set_ip_design_matrix",
        "validation_set_op_letor",
        "find_predicted_value",
        "validation_set_ip_sgd",
        "validation_set_ip_design_matrix",
        "choose_center",
        "test_set_ip_letor",
        "find_spread",
        "test_set_ip_letor",
        "cluster_size",
        "compute_design_matrix",
        "test_set_ip_letor",
        "test_set_ip_centers_letor_sgd",
        "test_set_ip_spread_letor_sgd",
        "test_set_ip_design_matrix_letor_sgd",
        "closed_form_sol",
        "L2_lambda",
        "test_set_ip_design_matrix_letor_sgd",
        "test_set_op_letor",
        "test_set_ip_closed_letor_sgd",
        "find_predicted_value",
        "test_set_ip_closed_letor_sgd",
        "test_set_ip_design_matrix_letor_sgd",
        "err_func",
        "test_set_op_letor",
        "test_set_ip_predicted_value_letor_sgd",
        "test_set_ip_letor"
    ],
    "literals": [
        "'input.csv'",
        "','",
        "'output.csv'",
        "','",
        "'Querylevelnorm_X.csv'",
        "','",
        "'Querylevelnorm_t.csv'",
        "','",
        "'Synthetic/Closed: Design matrix for test set:'",
        "'Synthetic/Closed: Closed form solution for test set:'",
        "'Synthetic/Closed: Test set error:'",
        "'Synthetic/SGD: Design matrix for test set:'",
        "'Synthetic/SGD: Closed form solution for test set:'",
        "'Synthetic/SGD: Test set error:'",
        "'Letor/Closed: Design matrix for test set:'",
        "'Letor/Closed: Closed form solution for test set:'",
        "'Letor/Closed: Test set error:'",
        "'Letor/SGD: Design matrix for test set:'",
        "'Letor/SGD: Closed form solution for test set:'",
        "'Letor/SGD: Test set error:'"
    ],
    "variables": [
        "syn_input_data",
        "syn_output_data",
        "letor_input_data",
        "letor_output_data",
        "training_set_ip_syn",
        "validation_set_ip_syn",
        "test_set_ip_syn",
        "training_set_op_syn",
        "validation_set_op_syn",
        "test_set_op_syn",
        "training_set_ip_letor",
        "validation_set_ip_letor",
        "test_set_ip_letor",
        "training_set_op_letor",
        "validation_set_op_letor",
        "test_set_op_letor",
        "cluster_size",
        "learning_rate",
        "minibatch_size",
        "num_epochs",
        "L2_lambda",
        "X_kmeans",
        "X_centers",
        "X_kmeans",
        "X_kmeans_list",
        "X_spread",
        "centers_new",
        "basis_func_output",
        "N",
        "_",
        "weights",
        "lower_bound",
        "upper_bound",
        "Phi",
        "t",
        "E_D",
        "E",
        "weights",
        "error",
        "training_set_ip_centers_syn",
        "tranining_set_ip_spread_syn",
        "training_set_ip_design_matrix_syn",
        "training_set_ip_closed_syn",
        "training_set_ip_predicted_value_syn",
        "validation_set_ip_centers_syn",
        "validation_set_ip_spread_syn",
        "validation_set_ip_design_matrix_syn",
        "validation_set_ip_closed_syn",
        "validation_set_predicted_value_syn",
        "test_set_ip_centers_syn",
        "test_set_ip_spread_syn",
        "test_set_ip_design_matrix_syn",
        "test_set_ip_closed_syn",
        "test_set_ip_predicted_value_syn",
        "training_set_ip_centers_sgd",
        "tranining_set_ip_spread_sgd",
        "training_set_ip_design_matrix_sgd",
        "training_set_ip_sgd",
        "training_set_ip_predicted_value_sgd",
        "validation_set_ip_centers_sgd",
        "validation_set_ip_spread_sgd",
        "validation_set_ip_design_matrix_sgd",
        "validation_set_ip_sgd",
        "validation_set_predicted_value_sgd",
        "test_set_ip_centers_sgd",
        "test_set_ip_spread_sgd",
        "test_set_ip_design_matrix_sgd",
        "test_set_ip_closed_sgd",
        "test_set_ip_predicted_value_sgd",
        "training_set_ip_centers_letor",
        "tranining_set_ip_spread_letor",
        "training_set_ip_design_matrix_letor",
        "training_set_ip_closed_letor",
        "training_set_ip_predicted_value_letor",
        "validation_set_ip_centers_letor",
        "validation_set_ip_spread_letor",
        "validation_set_ip_design_matrix_letor",
        "validation_set_ip_closed_letor",
        "validation_set_predicted_value_letor",
        "test_set_ip_centers_letor",
        "test_set_ip_spread_letor",
        "test_set_ip_design_matrix_letor",
        "test_set_ip_closed_letor",
        "test_set_ip_predicted_value_letor",
        "training_set_ip_centers",
        "tranining_set_ip_spread",
        "training_set_ip_design_matrix",
        "training_set_ip_sgd",
        "training_set_ip_predicted_value",
        "validation_set_ip_centers",
        "validation_set_ip_spread",
        "validation_set_ip_design_matrix",
        "validation_set_ip_sgd",
        "validation_set_predicted_value",
        "test_set_ip_centers_letor_sgd",
        "test_set_ip_spread_letor_sgd",
        "test_set_ip_design_matrix_letor_sgd",
        "test_set_ip_closed_letor_sgd",
        "test_set_ip_predicted_value_letor_sgd"
    ],
    "comments": [
        "print (np.linalg.norm(E))",
        "print('Synthetic/Closed: Training set error:')",
        "err_func(training_set_op_syn, training_set_ip_predicted_value_syn, training_set_ip_letor)",
        "print('Synthetic/Closed: Validation set error:')",
        "err_func(validation_set_op_syn, validation_set_predicted_value_syn, validation_set_ip_syn)",
        "print('Synthetic/SGD: Training set error:')",
        "err_func(training_set_op_syn, training_set_ip_predicted_value_sgd, training_set_ip_syn)",
        "print('Synthetic/SGD: Validation set error:')",
        "err_func(validation_set_op_syn, validation_set_predicted_value_sgd, validation_set_ip_syn)",
        "print('Letor/Closed: Training set error:')",
        "err_func(training_set_op_letor, training_set_ip_predicted_value_letor, training_set_ip_letor)",
        "print('Letor/Closed: Validation set error:')",
        "err_func(validation_set_op_letor, validation_set_predicted_value_letor, validation_set_ip_letor)",
        "print('Letor/SGD: Training set error:')",
        "err_func(training_set_op_letor, training_set_ip_predicted_value, training_set_ip_letor)",
        "print('Letor/SGD: Validation set error:')",
        "err_func(validation_set_op_letor, validation_set_predicted_value, validation_set_ip_letor)"
    ],
    "docstrings": [
        "*****Partitioning into tranong, validation and test*******",
        "*****Synthetic*****",
        "******Letor*******",
        "**************Defining Hyper Parameters**************",
        "****************FUNCTIONS***************",
        "'''\ndef early_stopping(learning_rate, minibatch_size, num_epochs, L2_lambda, design_matrix, output_data):\n    N,_ = design_matrix.shape\n    weights = np.zeros([1,11])\n    previous_error = -500\n    for epoch in range (num_epochs):\n        for i in range (int(N/minibatch_size)):\n            lower_bound = i*minibatch_size\n            upper_bound = min((i+1)*minibatch_size, N)\n            Phi = design_matrix[lower_bound:upper_bound,:]\n            t = output_data[lower_bound:upper_bound,:]\n            E_D = np.matmul((np.matmul(Phi, weights.T)-t).T,Phi)\n            E = (E_D+L2_lambda*weights)/minibatch_size\n            weights = weights-learning_rate*E\n    for data in range (N):\n        predicted = find_predicted_value(weights, design_matrix)\n        error = err_func(output_data, predicted, training_set_ip_syn)\n    return weights.flatten()\n'''",
        "*****************END OF BLOCK************************",
        "****************SYNTHETIC CLOSED FORM*********************",
        "*************END OF BLOCK*****************************",
        "************SYNTHETIC SGD FORM************************",
        "*************END OF BLOCK*****************************",
        "*******************LETOR CLOSED FORM*********************",
        "*****************END OF BLOCK**************************",
        "*****************LETOR SGD FORM************************",
        "*****************END OF BLOCK**************************"
    ],
    "functions": [
        "choose_center",
        "find_spread",
        "compute_design_matrix",
        "closed_form_sol",
        "SGD_sol",
        "find_predicted_value",
        "err_func"
    ],
    "classes": []
}