{
    "identifiers": [
        "os",
        "datetime",
        "socket",
        "websocket",
        "json",
        "ssl",
        "time",
        "base64",
        "hashlib",
        "hmac",
        "requests",
        "azure",
        "functions",
        "func",
        "logging",
        "certifi",
        "os",
        "environ",
        "os",
        "environ",
        "os",
        "environ",
        "os",
        "environ",
        "mytimer",
        "func",
        "TimerRequest",
        "mytimer",
        "past_due",
        "logging",
        "info",
        "logging",
        "info",
        "datetime",
        "datetime",
        "utcnow",
        "minute",
        "time",
        "sleep",
        "Proofpoint_api",
        "evt_type",
        "event_types",
        "api",
        "get_data",
        "event_type",
        "evt_type",
        "cluster_id",
        "_token",
        "time_delay_minutes",
        "gen_timeframe",
        "time_delay_minutes",
        "time_delay_minutes",
        "time_delay_minutes",
        "datetime",
        "datetime",
        "utcnow",
        "datetime",
        "timedelta",
        "minutes",
        "time_delay_minutes",
        "before_time",
        "strftime",
        "before_time",
        "strftime",
        "event_type",
        "cluster_id",
        "event_type",
        "after_time",
        "before_time",
        "logging",
        "info",
        "format",
        "url",
        "_token",
        "ssl",
        "CERT_REQUIRED",
        "certifi",
        "where",
        "websocket",
        "create_connection",
        "url",
        "header",
        "header",
        "sslopt",
        "sslopt",
        "ws",
        "settimeout",
        "time",
        "sleep",
        "logging",
        "info",
        "format",
        "cluster_id",
        "event_type",
        "format",
        "cluster_id",
        "event_type",
        "ws",
        "err",
        "logging",
        "error",
        "format",
        "err",
        "format",
        "err",
        "data",
        "chunksize",
        "index",
        "line",
        "data",
        "index",
        "chunksize",
        "index",
        "chunk",
        "chunk",
        "chunk",
        "append",
        "line",
        "chunk",
        "data",
        "event_type",
        "chunk",
        "gen_chunks_to_object",
        "data",
        "chunksize",
        "len",
        "chunk",
        "row",
        "chunk",
        "row",
        "row",
        "json",
        "loads",
        "row",
        "y",
        "update",
        "event_type",
        "obj_array",
        "append",
        "y",
        "json",
        "dumps",
        "obj_array",
        "post_data",
        "body",
        "len",
        "obj_array",
        "event_type",
        "date",
        "content_length",
        "method",
        "content_type",
        "resource",
        "date",
        "method",
        "content_length",
        "content_type",
        "x_headers",
        "resource",
        "string_to_hash",
        "encoding",
        "base64",
        "b64decode",
        "shared_key",
        "base64",
        "b64encode",
        "hmac",
        "decoded_key",
        "bytes_to_hash",
        "digestmod",
        "hashlib",
        "sha256",
        "digest",
        "decode",
        "format",
        "customer_id",
        "encoded_hash",
        "authorization",
        "body",
        "chunk_count",
        "event_type",
        "datetime",
        "datetime",
        "utcnow",
        "strftime",
        "len",
        "body",
        "build_signature",
        "rfc1123date",
        "content_length",
        "method",
        "content_type",
        "resource",
        "customer_id",
        "resource",
        "content_type",
        "signature",
        "event_type",
        "rfc1123date",
        "requests",
        "post",
        "uri",
        "data",
        "body",
        "headers",
        "headers",
        "response",
        "status_code",
        "response",
        "status_code",
        "logging",
        "info",
        "format",
        "chunk_count",
        "format",
        "chunk_count",
        "format",
        "response",
        "status_code",
        "logging",
        "warn",
        "format",
        "response",
        "status_code",
        "event_type",
        "set_websocket_conn",
        "event_type",
        "time",
        "sleep",
        "ws",
        "ws",
        "recv",
        "events",
        "append",
        "data",
        "sent_events",
        "len",
        "events",
        "gen_chunks",
        "events",
        "event_type",
        "websocket",
        "_exceptions",
        "WebSocketTimeoutException",
        "err",
        "logging",
        "error",
        "format",
        "err",
        "format",
        "err",
        "ws",
        "close",
        "err",
        "logging",
        "error",
        "format",
        "err",
        "format",
        "err",
        "sent_events",
        "gen_chunks",
        "events",
        "event_type",
        "logging",
        "info",
        "format",
        "sent_events",
        "event_type",
        "after_time",
        "before_time",
        "format",
        "sent_events",
        "event_type",
        "after_time",
        "before_time"
    ],
    "literals": [
        "'WorkspaceID'",
        "'WorkspaceKey'",
        "'ProofpointClusterID'",
        "'ProofpointToken'",
        "\"maillog\"",
        "\"message\"",
        "'The timer is past due!'",
        "'Starting program'",
        "\"%Y-%m-%dT%H:59:59.999999\"",
        "\"%Y-%m-%dT%H:00:00.000000\"",
        "f\"wss://logstream.proofpoint.com:443/v1/stream?cid={self.cluster_id}&type={event_type}&sinceTime={self.after_time}&toTime={self.before_time}\"",
        "'Opening Websocket logstream {}'",
        "\"Connection\"",
        "\"Upgrade\"",
        "\"Upgrade\"",
        "\"websocket\"",
        "\"Authorization\"",
        "f\"Bearer {self._token}\"",
        "\"Sec-WebSocket-Key\"",
        "\"SGVsbG8sIHdvcmxkIQ==\"",
        "\"Sec-WebSocket-Version\"",
        "\"13\"",
        "'cert_reqs'",
        "'ca_certs'",
        "'check_hostname'",
        "'Websocket connection established to cluster_id={}, event_type={}'",
        "'Websocket connection established to cluster_id={}, event_type={}'",
        "'Error while connectiong to websocket {}'",
        "'Error while connectiong to websocket {}'",
        "''",
        "'event_type'",
        "'x-ms-date:'",
        "\"\\n\"",
        "\"\\n\"",
        "\"\\n\"",
        "\"\\n\"",
        "\"utf-8\"",
        "\"SharedKey {}:{}\"",
        "'POST'",
        "'application/json'",
        "'/api/logs'",
        "'%a, %d %b %Y %H:%M:%S GMT'",
        "'https://'",
        "'.ods.opinsights.azure.com'",
        "'?api-version=2016-04-01'",
        "'content-type'",
        "'Authorization'",
        "'Log-Type'",
        "'ProofpointPOD_'",
        "'x-ms-date'",
        "\"Chunk was processed({} events)\"",
        "\"Chunk was processed({} events)\"",
        "\"Error during sending events to Azure Sentinel. Response code:{}\"",
        "\"Error during sending events to Azure Sentinel. Response code: {}\"",
        "'Error while receiving data: {}'",
        "'Error while receiving data: {}'",
        "'Error while closing socket: {}'",
        "'Error while closing socket: {}'",
        "'Total events sent: {}. Type: {}. Period(UTC): {} - {}'",
        "'Total events sent: {}. Type: {}. Period(UTC): {} - {}'"
    ],
    "variables": [
        "customer_id",
        "shared_key",
        "cluster_id",
        "_token",
        "time_delay_minutes",
        "event_types",
        "api",
        "cluster_id",
        "_token",
        "time_delay_minutes",
        "before_time",
        "before_time",
        "after_time",
        "url",
        "header",
        "sslopt",
        "ws",
        "chunk",
        "obj_array",
        "y",
        "body",
        "x_headers",
        "string_to_hash",
        "bytes_to_hash",
        "decoded_key",
        "encoded_hash",
        "authorization",
        "method",
        "content_type",
        "resource",
        "rfc1123date",
        "content_length",
        "signature",
        "uri",
        "headers",
        "response",
        "sent_events",
        "ws",
        "events",
        "data",
        "events"
    ],
    "comments": [
        "defining headers for websocket connection (do not change this)"
    ],
    "docstrings": [],
    "functions": [
        "main",
        "gen_timeframe",
        "set_websocket_conn",
        "gen_chunks_to_object",
        "gen_chunks",
        "build_signature",
        "post_data",
        "get_data"
    ],
    "classes": [
        "Proofpoint_api"
    ]
}