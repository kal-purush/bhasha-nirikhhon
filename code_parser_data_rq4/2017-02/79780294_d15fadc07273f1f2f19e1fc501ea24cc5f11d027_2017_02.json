{
    "identifiers": [
        "com",
        "kevin",
        "useranalysedemo",
        "java",
        "io",
        "java",
        "util",
        "org",
        "apache",
        "hadoop",
        "conf",
        "Configuration",
        "org",
        "apache",
        "hadoop",
        "fs",
        "Path",
        "org",
        "apache",
        "hadoop",
        "io",
        "Text",
        "org",
        "apache",
        "hadoop",
        "mapreduce",
        "Job",
        "org",
        "apache",
        "hadoop",
        "mapreduce",
        "lib",
        "input",
        "FileInputFormat",
        "org",
        "apache",
        "hadoop",
        "mapreduce",
        "lib",
        "output",
        "FileOutputFormat",
        "org",
        "apache",
        "log4j",
        "Logger",
        "org",
        "apache",
        "velocity",
        "VelocityContext",
        "org",
        "elasticsearch",
        "hadoop",
        "mr",
        "EsInputFormat",
        "com",
        "kevin",
        "useranalysedemo",
        "mr",
        "mapper",
        "EsCompanyMapper",
        "com",
        "kevin",
        "useranalysedemo",
        "mr",
        "mapper",
        "EsUserEventMapper",
        "com",
        "kevin",
        "useranalysedemo",
        "mr",
        "mapper",
        "EsUserEventReducer",
        "com",
        "kevin",
        "useranalysedemo",
        "mr",
        "mapper",
        "UserIntersectionMapper",
        "com",
        "kevin",
        "useranalysedemo",
        "mr",
        "mapper",
        "UserIntersectionReducer",
        "com",
        "kevin",
        "useranalysedemo",
        "utils",
        "DateUtils",
        "com",
        "kevin",
        "useranalysedemo",
        "utils",
        "PropertyUtil",
        "com",
        "kevin",
        "useranalysedemo",
        "utils",
        "VelocityUtils",
        "logger",
        "Logger",
        "getLogger",
        "args",
        "esQueryStartDate",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esQueryEndDate",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esQueryEventIds",
        "PropertyUtil",
        "getInstance",
        "getString",
        "split",
        "esServerHost",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esServerPort",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esHadoopReadIndex",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esHadoopReadType",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esHadoopWriteIndex",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esHadoopWriteType",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esNetHttpAuthUser",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esNetHttpAuthPass",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esInputJson",
        "PropertyUtil",
        "getInstance",
        "getString",
        "hadoopServerHost",
        "PropertyUtil",
        "getInstance",
        "getString",
        "hadoopDfsPort",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esHadoopQueryResultRootPath",
        "PropertyUtil",
        "getInstance",
        "getString",
        "esQdls",
        "esQueryEventId",
        "esQueryEventIds",
        "velocityContext",
        "velocityContext",
        "put",
        "esQueryStartDate",
        "velocityContext",
        "put",
        "esQueryEndDate",
        "velocityContext",
        "put",
        "esQueryEventId",
        "esQdl",
        "VelocityUtils",
        "getContent",
        "velocityContext",
        "esQdls",
        "add",
        "esQdl",
        "logger",
        "info",
        "esQdl",
        "conf",
        "job",
        "Job",
        "getInstance",
        "conf",
        "job",
        "setMapperClass",
        "job",
        "setReducerClass",
        "job",
        "setOutputKeyClass",
        "job",
        "setOutputValueClass",
        "job",
        "setOutputKeyClass",
        "job",
        "setOutputValueClass",
        "job",
        "setNumReduceTasks",
        "FileInputFormat",
        "setInputPaths",
        "job",
        "FileOutputFormat",
        "setOutputPath",
        "job",
        "ret",
        "job",
        "waitForCompletion",
        "exit",
        "ret"
    ],
    "literals": [
        "\"es.query.start.date\"",
        "\"es.query.end.date\"",
        "\"es.query.event.ids\"",
        "\",\"",
        "\"es.server.host\"",
        "\"es.server.port.http\"",
        "\"es.hadoop.read.index\"",
        "\"es.hadoop.read.type\"",
        "\"es.hadoop.write.index\"",
        "\"es.hadoop.write.type\"",
        "\"es.net.http.auth.user\"",
        "\"es.net.http.auth.pass\"",
        "\"es.input.json\"",
        "\"hadoop.server.host\"",
        "\"hadoop.dfs.port\"",
        "\"es.hadoop.query.result.root.path\"",
        "\"esQueryStartDate\"",
        "\"esQueryEndDate\"",
        "\"esQueryEventId\"",
        "\"velocity_vm/es_user_event_query.vm\"",
        "\" esQdl = \\n\"",
        "\"hadoop intersection\"",
        "\"F:/mr-fs/20170210135217/0/query_result\"",
        "\"F:/mr-fs/temp/out\""
    ],
    "variables": [],
    "comments": [
        "获取配置信息",
        "获取es的查询语句",
        "通过es-hadoop 将es的查询结果导入到hadoop 中",
        "String nowStr = DateUtils.getNowStr(null);",
        "for(int i=0; i<esQdls.size(); i++){",
        "String esQdl = esQdls.get(i);",
        "Configuration conf = new Configuration();",
        "conf.set(\"mapreduce.job.jar\", \"UserEventAnalyzeApp.jar\");",
        "conf.set(\"es.nodes\", esServerHost+\":\"+esServerPort);",
        "conf.set(\"es.resource.read\", esHadoopReadIndex+\"/\"+esHadoopReadType);",
        "conf.set(\"es.resource.write\", esHadoopWriteIndex+\"/\"+esHadoopWriteType);",
        "conf.set(\"es.net.http.auth.user\",esNetHttpAuthUser);",
        "conf.set(\"es.net.http.auth.pass\",esNetHttpAuthPass);",
        "conf.set(\"es.input.json\", esInputJson);",
        "conf.set(\"es.query\",esQdl);",
        "",
        "Job job = Job.getInstance(conf,\"hadoop elasticsearch\");",
        "// 指定自定义的Mapper阶段的任务处理类",
        "job.setMapperClass(EsUserEventMapper.class);",
        "job.setReducerClass(EsUserEventReducer.class);",
        "// 设置map输出格式",
        "job.setOutputKeyClass(Text.class);",
        "job.setOutputValueClass(Text.class);",
        "// 设置输入格式",
        "job.setInputFormatClass(EsInputFormat.class);",
        "//job.setOutputFormatClass(EsOutputFormat.class);",
        "// 设置输出路径",
        "String hadoopPath = \"hdfs://\"+hadoopServerHost+\":\"+hadoopDfsPort+esHadoopQueryResultRootPath+\"/user_event/\"+nowStr+\"/\"+i+\"/query_result\";",
        "//String hadoopPath = \"F:/mr-fs/\"+nowStr+\"/\"+i+\"/query_result\";",
        "FileOutputFormat.setOutputPath(job, new Path(hadoopPath));",
        "",
        "// 运行MR程序",
        "job.waitForCompletion(true);",
        "}",
        "conf.set(\"mapreduce.job.jar\", \"UserEventAnalyzeApp.jar\");",
        "指定自定义的Mapper阶段的任务处理类",
        "设置mr输出格式",
        "指定要处理的原始数据所存放的路径",
        "指定处理之后的结果输出到哪个路径"
    ],
    "docstrings": [],
    "functions": [
        "main"
    ],
    "classes": [
        "UserEventAnalyzeApp"
    ]
}