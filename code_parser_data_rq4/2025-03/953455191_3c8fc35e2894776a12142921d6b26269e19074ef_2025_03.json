{
    "identifiers": [
        "os",
        "io",
        "json",
        "datetime",
        "streamlit",
        "st",
        "typing",
        "Dict",
        "Any",
        "Optional",
        "openai",
        "dotenv",
        "load_dotenv",
        "docx",
        "Document",
        "docx",
        "shared",
        "Pt",
        "Inches",
        "docx",
        "text",
        "WD_ALIGN_PARAGRAPH",
        "base64",
        "load_dotenv",
        "os",
        "getenv",
        "Dict",
        "Any",
        "datetime",
        "date",
        "today",
        "strftime",
        "date_str",
        "get",
        "get",
        "get",
        "get",
        "get",
        "prompt",
        "Dict",
        "Any",
        "_create_system_prompt",
        "_construct_loa_prompt",
        "conversation_history",
        "messages",
        "extend",
        "conversation_history",
        "openai",
        "chat",
        "completions",
        "create",
        "model",
        "model",
        "messages",
        "messages",
        "temperature",
        "max_tokens",
        "response",
        "choices",
        "message",
        "content",
        "_construct_loa_prompt",
        "loa_content",
        "loa_content",
        "loa_content",
        "e",
        "e",
        "edit_request",
        "current_loa",
        "edit_request",
        "conversation_history",
        "append",
        "edit_message",
        "_create_system_prompt",
        "messages",
        "extend",
        "conversation_history",
        "openai",
        "chat",
        "completions",
        "create",
        "model",
        "model",
        "messages",
        "messages",
        "temperature",
        "max_tokens",
        "response",
        "choices",
        "message",
        "content",
        "conversation_history",
        "append",
        "edited_loa",
        "edited_loa",
        "edited_loa",
        "e",
        "e",
        "loa_content",
        "Document",
        "Document",
        "doc",
        "sections",
        "section",
        "sections",
        "Inches",
        "Inches",
        "Inches",
        "Inches",
        "loa_content",
        "strip",
        "split",
        "line",
        "lines",
        "line",
        "strip",
        "line",
        "doc",
        "add_paragraph",
        "line",
        "startswith",
        "line",
        "lower",
        "startswith",
        "line",
        "lower",
        "startswith",
        "doc",
        "add_paragraph",
        "WD_ALIGN_PARAGRAPH",
        "RIGHT",
        "p",
        "add_run",
        "line",
        "line",
        "lower",
        "startswith",
        "salutation",
        "salutation",
        "doc",
        "add_paragraph",
        "p",
        "add_run",
        "line",
        "line",
        "lower",
        "startswith",
        "doc",
        "add_paragraph",
        "p",
        "add_run",
        "line",
        "line",
        "lower",
        "startswith",
        "doc",
        "add_paragraph",
        "p",
        "add_run",
        "line",
        "line",
        "endswith",
        "len",
        "line",
        "doc",
        "add_paragraph",
        "p",
        "add_run",
        "line",
        "doc",
        "add_paragraph",
        "p",
        "add_run",
        "line",
        "doc",
        "doc",
        "filename",
        "io",
        "BytesIO",
        "doc",
        "save",
        "file_stream",
        "file_stream",
        "seek",
        "base64",
        "b64encode",
        "file_stream",
        "read",
        "decode",
        "b64",
        "filename",
        "href",
        "st",
        "set_page_config",
        "page_title",
        "page_icon",
        "layout",
        "st",
        "markdown",
        "unsafe_allow_html",
        "st",
        "title",
        "st",
        "subheader",
        "st",
        "session_state",
        "st",
        "session_state",
        "LOAGenerator",
        "st",
        "session_state",
        "st",
        "session_state",
        "st",
        "session_state",
        "st",
        "session_state",
        "st",
        "columns",
        "col1",
        "st",
        "header",
        "st",
        "subheader",
        "st",
        "text_area",
        "height",
        "placeholder",
        "st",
        "subheader",
        "st",
        "text_input",
        "placeholder",
        "st",
        "subheader",
        "st",
        "text_area",
        "height",
        "placeholder",
        "st",
        "subheader",
        "st",
        "text_area",
        "height",
        "placeholder",
        "st",
        "subheader",
        "st",
        "text_area",
        "height",
        "placeholder",
        "st",
        "button",
        "st",
        "spinner",
        "address",
        "to_whom",
        "scenario",
        "specific_details",
        "yours_sincerely",
        "st",
        "session_state",
        "loa_generator",
        "generate_loa",
        "st",
        "session_state",
        "loa_content",
        "st",
        "session_state",
        "col2",
        "st",
        "header",
        "st",
        "session_state",
        "current_loa",
        "st",
        "markdown",
        "st",
        "session_state",
        "current_loa",
        "replace",
        "unsafe_allow_html",
        "create_word_document",
        "st",
        "session_state",
        "current_loa",
        "st",
        "markdown",
        "get_docx_download_link",
        "doc",
        "unsafe_allow_html",
        "st",
        "session_state",
        "edit_mode",
        "st",
        "button",
        "st",
        "session_state",
        "st",
        "text_area",
        "height",
        "placeholder",
        "st",
        "columns",
        "col1",
        "st",
        "button",
        "st",
        "spinner",
        "st",
        "session_state",
        "loa_generator",
        "edit_loa",
        "edit_request",
        "st",
        "session_state",
        "edited_loa",
        "st",
        "experimental_rerun",
        "col2",
        "st",
        "button",
        "st",
        "session_state",
        "st",
        "experimental_rerun",
        "st",
        "info",
        "main"
    ],
    "literals": [
        "\"OPENAI_API_KEY\"",
        "\"gpt-4\"",
        "\"%d.%m.%Y\"",
        "f\"\"\"\n        Generate a Letter of Authorization (LOA) with the following details:\n        \n        Date: {date_str}\n        \n        Recipient Address:\n        {params.get('address', '')}\n        \n        To: {params.get('to_whom', 'To Whom It May Concern')}\n        \n        Scenario: {params.get('scenario', '')}\n        \n        Specific Details to Include:\n        {params.get('specific_details', '')}\n        \n        Closing:\n        Yours sincerely,\n        {params.get('yours_sincerely', '')}\n        \n        The LOA should follow a formal business letter format with:\n        1. Clear header with date\n        2. Recipient address\n        3. Appropriate salutation\n        4. A clear introduction stating the purpose of the letter\n        5. A main body detailing the specifics of the authorization\n        6. Any necessary terms and conditions\n        7. A formal closing with signatory information\n        \n        Ensure the content specifically addresses the scenario provided and incorporates all the specific details mentioned.\n        \"\"\"",
        "'address'",
        "''",
        "'to_whom'",
        "'To Whom It May Concern'",
        "'scenario'",
        "''",
        "'specific_details'",
        "''",
        "'yours_sincerely'",
        "''",
        "\"role\"",
        "\"system\"",
        "\"content\"",
        "\"role\"",
        "\"user\"",
        "\"content\"",
        "\"role\"",
        "\"user\"",
        "\"content\"",
        "\"role\"",
        "\"assistant\"",
        "\"content\"",
        "f\"Error generating LOA: {str(e)}\"",
        "\"No LOA has been generated yet. Please generate an LOA first.\"",
        "\"role\"",
        "\"user\"",
        "\"content\"",
        "f\"\"\"\n            Edit the LOA according to the following request:\n            \n            {edit_request}\n            \n            Return the complete edited LOA.\n            \"\"\"",
        "\"role\"",
        "\"system\"",
        "\"content\"",
        "\"role\"",
        "\"assistant\"",
        "\"content\"",
        "f\"Error editing LOA: {str(e)}\"",
        "'\\n'",
        "'Date:'",
        "'ref:'",
        "'reference:'",
        "'dear '",
        "'to whom'",
        "'sir'",
        "'madam'",
        "'subject:'",
        "'yours '",
        "'sincerely'",
        "'faithfully'",
        "'regards'",
        "':'",
        "\"letter_of_authorization.docx\"",
        "f'<a href=\"data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,{b64}\" download=\"{filename}\">Download Word Document</a>'",
        "\"LOA Generator\"",
        "\"üìù\"",
        "\"wide\"",
        "\"Letter of Authorization (LOA) Generator\"",
        "\"Generate professional LOAs for outdoor advertising scenarios\"",
        "'loa_generator'",
        "'current_loa'",
        "'edit_mode'",
        "\"LOA Information\"",
        "\"Recipient Address\"",
        "\"Enter the complete address\"",
        "\"Company Name\\nStreet Address\\nCity, State ZIP/Postal Code\"",
        "\"Addressee\"",
        "\"To whom is this addressed?\"",
        "\"To Whom It May Concern / Mr. John Doe / The Manager\"",
        "\"Scenario\"",
        "\"Describe the advertising scenario\"",
        "\"Example: Digital hoarding at a retail outlet for 5 years with quarterly payments\"",
        "\"Specific Details\"",
        "\"Enter specific details to include in the LOA\"",
        "\"Example: Size: 20' X 20' = 400 Sq. Ft.\\nPayment: Rs. 310 per sq ft per year\\nLocation: FC Road, Pune\\nAny other terms or conditions...\"",
        "\"Signature\"",
        "\"Enter the signatory information\"",
        "\"Name\\nPosition\\nCompany Name\"",
        "\"Generate LOA\"",
        "\"Generating LOA...\"",
        "\"address\"",
        "\"to_whom\"",
        "\"scenario\"",
        "\"specific_details\"",
        "\"yours_sincerely\"",
        "\"LOA Preview\"",
        "'<div class=\"loa-preview\">'",
        "'\\n'",
        "'<br>'",
        "'</div>'",
        "\"Edit LOA\"",
        "\"Describe what changes you want to make\"",
        "\"Example: Please change the payment amount to Rs. 350 and add a clause about security deposit.\"",
        "\"Apply Changes\"",
        "\"Editing LOA...\"",
        "\"Cancel\"",
        "\"Fill out the form and click 'Generate LOA' to create a new Letter of Authorization.\"",
        "\"__main__\""
    ],
    "variables": [
        "openai",
        "api_key",
        "model",
        "conversation_history",
        "current_loa",
        "date_str",
        "prompt",
        "messages",
        "response",
        "loa_content",
        "conversation_history",
        "current_loa",
        "edit_message",
        "messages",
        "response",
        "edited_loa",
        "current_loa",
        "doc",
        "sections",
        "section",
        "top_margin",
        "section",
        "bottom_margin",
        "section",
        "left_margin",
        "section",
        "right_margin",
        "lines",
        "line",
        "p",
        "p",
        "alignment",
        "bold",
        "p",
        "p",
        "bold",
        "p",
        "p",
        "bold",
        "p",
        "file_stream",
        "b64",
        "href",
        "loa_generator",
        "current_loa",
        "edit_mode",
        "col1",
        "col2",
        "address",
        "to_whom",
        "scenario",
        "specific_details",
        "yours_sincerely",
        "loa_content",
        "current_loa",
        "edit_mode",
        "doc",
        "edit_mode",
        "edit_request",
        "col1",
        "col2",
        "edited_loa",
        "current_loa",
        "edit_mode"
    ],
    "comments": [
        "Load environment variables",
        "Set OpenAI API key",
        "Can be changed to gpt-3.5-turbo for lower cost",
        "Format date",
        "Construct the prompt",
        "Create messages for the API call",
        "Add conversation history if available",
        "Call the OpenAI API",
        "Lower temperature for more consistent outputs",
        "Get the generated LOA content",
        "Store the conversation",
        "Store the current LOA",
        "Create the edit request message",
        "Add the edit request to the conversation history",
        "Create messages for the API call",
        "Add conversation history",
        "Call the OpenAI API",
        "Get the edited LOA content",
        "Update the conversation history",
        "Update the current LOA",
        "Set margins",
        "Split the content into lines",
        "Process each line",
        "Add empty paragraph for blank lines",
        "Right-aligned date/reference",
        "Salutation",
        "Subject line - bold",
        "Closing",
        "Section headers",
        "Regular paragraph",
        "Save the document to a BytesIO object",
        "Get b64 encoded string",
        "Generate the download link",
        "Add custom CSS",
        "Initialize session state",
        "Create two columns for input form and LOA preview",
        "Recipient Address",
        "To Whom",
        "Scenario",
        "Specific Details",
        "Yours Sincerely",
        "Generate Button",
        "Prepare parameters",
        "Generate LOA",
        "Display LOA in a styled container",
        "Create Word document",
        "Provide download link",
        "Edit option"
    ],
    "docstrings": [
        "\"\"\"\n    A class for generating Letters of Authorization (LOAs) for outdoor advertising\n    based on specific parameters using OpenAI's API.\n    \"\"\"",
        "\"\"\"\n        Creates the system prompt that instructs the model on how to generate LOAs.\n        \n        Returns:\n            str: The system prompt\n        \"\"\"",
        "\"\"\"\n        You are an expert in creating Letters of Authorization (LOAs) for outdoor advertising agencies. \n        Your task is to generate professional, legally-sound LOAs based on the parameters provided.\n        \n        Follow these guidelines:\n        1. Use formal business language appropriate for official documents\n        2. Structure the LOA with proper sections including reference numbers, dates, recipient details, subject line, main body, and signatory information\n        3. Include all necessary legal clauses regarding installation, maintenance, payments, and liability\n        4. Format dates as DD.MM.YYYY\n        5. Make the content specific to the scenario provided\n        6. Ensure payment terms and conditions are clearly stated\n        7. Include appropriate references to any tenders or previous communications when provided\n        \n        Return only the plain text content of the LOA without any explanations or additional formatting.\n        \"\"\"",
        "\"\"\"\n        Constructs a prompt for the model to generate an LOA based on the provided parameters.\n        \n        Args:\n            params: Dictionary of parameters for LOA generation\n            \n        Returns:\n            str: The constructed prompt\n        \"\"\"",
        "\"\"\"\n        Generates an LOA based on the provided parameters.\n        \n        Args:\n            params: Dictionary of parameters for LOA generation\n            \n        Returns:\n            str: The generated LOA text\n        \"\"\"",
        "\"\"\"\n        Edits the previously generated LOA based on the edit request.\n        \n        Args:\n            edit_request: Description of the edits to make\n            \n        Returns:\n            str: The edited LOA text\n        \"\"\"",
        "\"\"\"\n    Create a Word document from the LOA content.\n    \n    Args:\n        loa_content: The text content of the LOA\n        \n    Returns:\n        Document: A python-docx Document object containing the formatted LOA\n    \"\"\"",
        "\"\"\"\n    Generate a download link for a Word document.\n    \n    Args:\n        doc: The python-docx Document object\n        filename: The name for the downloaded file\n        \n    Returns:\n        str: HTML for the download link\n    \"\"\"",
        "\"\"\"\n        <style>\n        .main .block-container {\n            padding-top: 2rem;\n        }\n        .stTextArea textarea {\n            height: 150px;\n        }\n        .loa-preview {\n            border: 1px solid #ddd;\n            border-radius: 5px;\n            padding: 20px;\n            background-color: #f9f9f9;\n            font-family: 'Times New Roman', Times, serif;\n            white-space: pre-line;\n            margin-bottom: 20px;\n        }\n        h1 {\n            color: #2c3e50;\n        }\n        .stButton button {\n            background-color: #2c3e50;\n            color: white;\n        }\n        </style>\n        \"\"\""
    ],
    "functions": [
        "_create_system_prompt",
        "_construct_loa_prompt",
        "generate_loa",
        "edit_loa",
        "create_word_document",
        "get_docx_download_link",
        "main"
    ],
    "classes": [
        "LOAGenerator"
    ]
}