{
    "identifiers": [
        "numpy",
        "np",
        "matplotlib",
        "pylab",
        "pl",
        "sklearn",
        "manifold",
        "MDS",
        "ot",
        "gromov",
        "gromov_wasserstein_linear_unmixing",
        "gromov_wasserstein_dictionary_learning",
        "fused_gromov_wasserstein_linear_unmixing",
        "fused_gromov_wasserstein_dictionary_learning",
        "ot",
        "networkx",
        "networkx",
        "generators",
        "community",
        "stochastic_block_model",
        "sbm",
        "np",
        "random",
        "seed",
        "N",
        "len",
        "clusters",
        "len",
        "clusters",
        "n_cluster",
        "clusters",
        "i",
        "Nc",
        "np",
        "random",
        "uniform",
        "low",
        "high",
        "n_cluster",
        "p_inter",
        "np",
        "ones",
        "n_cluster",
        "n_cluster",
        "np",
        "fill_diagonal",
        "P",
        "p_intra",
        "p_intra",
        "np",
        "eye",
        "np",
        "round",
        "n_nodes",
        "np",
        "ones",
        "n_cluster",
        "n_cluster",
        "astype",
        "np",
        "int32",
        "sbm",
        "sizes",
        "P",
        "seed",
        "i",
        "directed",
        "networkx",
        "to_numpy_array",
        "G",
        "dataset",
        "append",
        "C",
        "labels",
        "append",
        "n_cluster",
        "x",
        "C",
        "binary",
        "color",
        "s",
        "j",
        "C",
        "shape",
        "i",
        "j",
        "binary",
        "C",
        "i",
        "j",
        "pl",
        "plot",
        "x",
        "i",
        "x",
        "j",
        "x",
        "i",
        "x",
        "j",
        "alpha",
        "color",
        "pl",
        "plot",
        "x",
        "i",
        "x",
        "j",
        "x",
        "i",
        "x",
        "j",
        "alpha",
        "C",
        "i",
        "j",
        "color",
        "pl",
        "scatter",
        "x",
        "x",
        "c",
        "color",
        "s",
        "s",
        "zorder",
        "edgecolors",
        "cmap",
        "vmax",
        "pl",
        "figure",
        "pl",
        "clf",
        "idx_c",
        "c",
        "clusters",
        "dataset",
        "c",
        "Nc",
        "MDS",
        "dissimilarity",
        "random_state",
        "fit_transform",
        "C",
        "pl",
        "subplot",
        "nlabels",
        "c",
        "pl",
        "title",
        "c",
        "fontsize",
        "plot_graph",
        "x",
        "C",
        "binary",
        "color",
        "s",
        "pl",
        "axis",
        "pl",
        "subplot",
        "nlabels",
        "nlabels",
        "c",
        "pl",
        "title",
        "c",
        "fontsize",
        "pl",
        "imshow",
        "C",
        "interpolation",
        "pl",
        "axis",
        "pl",
        "tight_layout",
        "pl",
        "show",
        "np",
        "random",
        "seed",
        "ot",
        "unif",
        "C",
        "shape",
        "C",
        "dataset",
        "ot",
        "unif",
        "nt",
        "gromov_wasserstein_dictionary_learning",
        "Cs",
        "dataset",
        "D",
        "D",
        "nt",
        "nt",
        "ps",
        "ps",
        "q",
        "q",
        "epochs",
        "batch_size",
        "learning_rate",
        "reg",
        "reg",
        "projection",
        "tol_outer",
        "tol_inner",
        "max_iter_outer",
        "max_iter_inner",
        "use_log",
        "use_adam_optimizer",
        "verbose",
        "pl",
        "figure",
        "pl",
        "clf",
        "pl",
        "title",
        "fontsize",
        "pl",
        "plot",
        "log",
        "pl",
        "xlabel",
        "fontsize",
        "pl",
        "ylabel",
        "fontsize",
        "pl",
        "tight_layout",
        "pl",
        "show",
        "pl",
        "figure",
        "pl",
        "clf",
        "idx_atom",
        "atom",
        "Cdict_GW",
        "atom",
        "atom",
        "min",
        "atom",
        "max",
        "atom",
        "min",
        "MDS",
        "dissimilarity",
        "random_state",
        "fit_transform",
        "scaled_atom",
        "pl",
        "subplot",
        "D",
        "idx_atom",
        "pl",
        "title",
        "idx_atom",
        "fontsize",
        "plot_graph",
        "x",
        "atom",
        "atom",
        "max",
        "binary",
        "color",
        "s",
        "pl",
        "axis",
        "pl",
        "subplot",
        "D",
        "D",
        "idx_atom",
        "pl",
        "title",
        "idx_atom",
        "fontsize",
        "pl",
        "imshow",
        "scaled_atom",
        "interpolation",
        "pl",
        "colorbar",
        "pl",
        "axis",
        "pl",
        "tight_layout",
        "pl",
        "show",
        "C",
        "dataset",
        "ot",
        "unif",
        "C",
        "shape",
        "gromov_wasserstein_linear_unmixing",
        "C",
        "Cdict_GW",
        "p",
        "p",
        "q",
        "q",
        "reg",
        "reg",
        "tol_outer",
        "tol_inner",
        "max_iter_outer",
        "max_iter_inner",
        "unmixings",
        "append",
        "unmixing",
        "reconstruction_errors",
        "append",
        "reconstruction_error",
        "np",
        "array",
        "unmixings",
        "np",
        "array",
        "reconstruction_errors",
        "sum",
        "np",
        "zeros",
        "shape",
        "N",
        "i",
        "w",
        "unmixings",
        "w",
        "w",
        "np",
        "sqrt",
        "w",
        "np",
        "sqrt",
        "np",
        "stack",
        "x",
        "y",
        "z",
        "pl",
        "figure",
        "pl",
        "clf",
        "pl",
        "title",
        "fontsize",
        "cluster",
        "nlabels",
        "Nc",
        "cluster",
        "Nc",
        "cluster",
        "cluster",
        "pl",
        "scatter",
        "unmixings2D",
        "start",
        "end",
        "unmixings2D",
        "start",
        "end",
        "c",
        "cluster",
        "marker",
        "s",
        "label",
        "pl",
        "scatter",
        "unmixings2D",
        "start",
        "end",
        "unmixings2D",
        "start",
        "end",
        "c",
        "cluster",
        "marker",
        "s",
        "label",
        "cluster",
        "pl",
        "scatter",
        "extremities",
        "extremities",
        "c",
        "marker",
        "s",
        "label",
        "pl",
        "plot",
        "x",
        "y",
        "x",
        "y",
        "color",
        "linewidth",
        "pl",
        "plot",
        "x",
        "z",
        "x",
        "z",
        "color",
        "linewidth",
        "pl",
        "plot",
        "y",
        "z",
        "y",
        "z",
        "color",
        "linewidth",
        "pl",
        "axis",
        "pl",
        "legend",
        "fontsize",
        "pl",
        "tight_layout",
        "pl",
        "show",
        "i",
        "len",
        "dataset",
        "dataset",
        "i",
        "shape",
        "np",
        "zeros",
        "n",
        "i",
        "Nc",
        "i",
        "Nc",
        "dataset_features",
        "append",
        "F",
        "pl",
        "figure",
        "pl",
        "clf",
        "idx_c",
        "c",
        "clusters",
        "dataset",
        "c",
        "Nc",
        "dataset_features",
        "c",
        "Nc",
        "np",
        "argmax",
        "F",
        "i",
        "i",
        "F",
        "shape",
        "MDS",
        "dissimilarity",
        "random_state",
        "fit_transform",
        "C",
        "pl",
        "subplot",
        "nlabels",
        "c",
        "pl",
        "title",
        "c",
        "fontsize",
        "plot_graph",
        "x",
        "C",
        "binary",
        "color",
        "colors",
        "s",
        "pl",
        "axis",
        "pl",
        "subplot",
        "nlabels",
        "nlabels",
        "c",
        "pl",
        "title",
        "c",
        "fontsize",
        "pl",
        "imshow",
        "C",
        "interpolation",
        "pl",
        "axis",
        "pl",
        "tight_layout",
        "pl",
        "show",
        "np",
        "random",
        "seed",
        "ot",
        "unif",
        "C",
        "shape",
        "C",
        "dataset",
        "ot",
        "unif",
        "nt",
        "fused_gromov_wasserstein_dictionary_learning",
        "Cs",
        "dataset",
        "Ys",
        "dataset_features",
        "D",
        "D",
        "nt",
        "nt",
        "ps",
        "ps",
        "q",
        "q",
        "alpha",
        "alpha",
        "epochs",
        "batch_size",
        "learning_rate_C",
        "learning_rate_Y",
        "reg",
        "reg",
        "tol_outer",
        "tol_inner",
        "max_iter_outer",
        "max_iter_inner",
        "projection",
        "use_log",
        "use_adam_optimizer",
        "verbose",
        "pl",
        "figure",
        "pl",
        "clf",
        "pl",
        "title",
        "fontsize",
        "pl",
        "plot",
        "log",
        "pl",
        "xlabel",
        "fontsize",
        "pl",
        "ylabel",
        "fontsize",
        "pl",
        "tight_layout",
        "pl",
        "show",
        "pl",
        "figure",
        "pl",
        "clf",
        "Ydict_FGW",
        "max",
        "Ydict_FGW",
        "min",
        "idx_atom",
        "Catom",
        "Fatom",
        "Cdict_FGW",
        "Ydict_FGW",
        "Catom",
        "Catom",
        "min",
        "Catom",
        "max",
        "Catom",
        "min",
        "np",
        "argmax",
        "Fatom",
        "i",
        "i",
        "Fatom",
        "shape",
        "MDS",
        "dissimilarity",
        "random_state",
        "fit_transform",
        "scaled_atom",
        "pl",
        "subplot",
        "D",
        "idx_atom",
        "pl",
        "title",
        "idx_atom",
        "fontsize",
        "plot_graph",
        "x",
        "Catom",
        "Catom",
        "max",
        "binary",
        "color",
        "colors",
        "s",
        "pl",
        "axis",
        "pl",
        "subplot",
        "D",
        "D",
        "idx_atom",
        "pl",
        "title",
        "idx_atom",
        "fontsize",
        "pl",
        "imshow",
        "scaled_atom",
        "interpolation",
        "pl",
        "colorbar",
        "pl",
        "axis",
        "pl",
        "tight_layout",
        "pl",
        "show",
        "i",
        "len",
        "dataset",
        "dataset",
        "i",
        "dataset_features",
        "i",
        "ot",
        "unif",
        "C",
        "shape",
        "fused_gromov_wasserstein_linear_unmixing",
        "C",
        "Y",
        "Cdict_FGW",
        "Ydict_FGW",
        "p",
        "p",
        "q",
        "q",
        "alpha",
        "alpha",
        "reg",
        "reg",
        "tol_outer",
        "tol_inner",
        "max_iter_outer",
        "max_iter_inner",
        "unmixings",
        "append",
        "unmixing",
        "reconstruction_errors",
        "append",
        "reconstruction_error",
        "np",
        "array",
        "unmixings",
        "np",
        "array",
        "reconstruction_errors",
        "sum",
        "np",
        "zeros",
        "shape",
        "N",
        "i",
        "w",
        "unmixings",
        "w",
        "w",
        "np",
        "sqrt",
        "w",
        "np",
        "sqrt",
        "np",
        "stack",
        "x",
        "y",
        "z",
        "pl",
        "figure",
        "pl",
        "clf",
        "pl",
        "title",
        "fontsize",
        "cluster",
        "nlabels",
        "Nc",
        "cluster",
        "Nc",
        "cluster",
        "cluster",
        "pl",
        "scatter",
        "unmixings2D",
        "start",
        "end",
        "unmixings2D",
        "start",
        "end",
        "c",
        "cluster",
        "marker",
        "s",
        "label",
        "pl",
        "scatter",
        "unmixings2D",
        "start",
        "end",
        "unmixings2D",
        "start",
        "end",
        "c",
        "cluster",
        "marker",
        "s",
        "label",
        "cluster",
        "pl",
        "scatter",
        "extremities",
        "extremities",
        "c",
        "marker",
        "s",
        "label",
        "pl",
        "plot",
        "x",
        "y",
        "x",
        "y",
        "color",
        "linewidth",
        "pl",
        "plot",
        "x",
        "z",
        "x",
        "z",
        "color",
        "linewidth",
        "pl",
        "plot",
        "y",
        "z",
        "y",
        "z",
        "color",
        "linewidth",
        "pl",
        "axis",
        "pl",
        "legend",
        "fontsize",
        "pl",
        "tight_layout",
        "pl",
        "show"
    ],
    "literals": [
        "r\"\"\"\n=================================\n(Fused) Gromov-Wasserstein Linear Dictionary Learning\n=================================\n\nIn this exemple, we illustrate how to learn a Gromov-Wasserstein dictionary on\na dataset of structured data such as graphs, denoted\n:math:`\\{ \\mathbf{C_s} \\}_{s \\in [S]}` where every nodes have uniform weights.\nGiven a dictionary :math:`\\mathbf{C_{dict}}` composed of D structures of a fixed\nsize nt, each graph :math:`(\\mathbf{C_s}, \\mathbf{p_s})`\nis modeled as a convex combination :math:`\\mathbf{w_s} \\in \\Sigma_D` of these\ndictionary atoms as :math:`\\sum_d w_{s,d} \\mathbf{C_{dict}[d]}`.\n\n\nFirst, we consider a dataset composed of graphs generated by Stochastic Block models\nwith variable sizes taken in :math:`\\{30, ... , 50\\}` and quantities of clusters\nvarying in :math:`\\{ 1, 2, 3\\}`. We learn a dictionary of 3 atoms, by minimizing\nthe Gromov-Wasserstein distance from all samples to its model in the dictionary\nwith respect to the dictionary atoms.\n\nSecond, we illustrate the extension of this dictionary learning framework to\nstructured data endowed with node features by using the Fused Gromov-Wasserstein\ndistance. Starting from the aforementioned dataset of unattributed graphs, we\nadd discrete labels uniformly depending on the number of clusters. Then we learn\nand visualize attributed graph atoms where each sample is modeled as a joint convex\ncombination between atom structures and features.\n\n\n[38] C. Vincent-Cuaz, T. Vayer, R. Flamary, M. Corneli, N. Courty, Online Graph\nDictionary Learning, International Conference on Machine Learning (ICML), 2021.\n\n\"\"\"",
        "'C0'",
        "'k'",
        "'k'",
        "'k'",
        "'tab10'",
        "'precomputed'",
        "'(graph) sample from label '",
        "'C0'",
        "\"off\"",
        "'(matrix) sample from label %s \\n'",
        "'nearest'",
        "\"off\"",
        "'nonnegative_symmetric'",
        "'loss evolution by epoch'",
        "'loss_epochs'",
        "'epochs'",
        "'loss'",
        "'precomputed'",
        "'(graph) atom '",
        "'C0'",
        "\"off\"",
        "'(matrix) atom %s \\n'",
        "'nearest'",
        "\"off\"",
        "'cumulated reconstruction error:'",
        "'Embedding space'",
        "'C'",
        "'o'",
        "'1 cluster'",
        "'C'",
        "'o'",
        "'%s clusters'",
        "'black'",
        "'x'",
        "'atoms'",
        "'black'",
        "'black'",
        "'black'",
        "'off'",
        "'C'",
        "'precomputed'",
        "'(graph) sample from label '",
        "\"off\"",
        "'(matrix) sample from label %s \\n'",
        "'nearest'",
        "\"off\"",
        "'nonnegative_symmetric'",
        "'loss evolution by epoch'",
        "'loss_epochs'",
        "'epochs'",
        "'loss'",
        "'C%s'",
        "'precomputed'",
        "'(attributed graph) atom '",
        "\"off\"",
        "'(matrix) atom %s \\n'",
        "'nearest'",
        "\"off\"",
        "'cumulated reconstruction error:'",
        "'Embedding space'",
        "'C'",
        "'o'",
        "'1 cluster'",
        "'C'",
        "'o'",
        "'%s clusters'",
        "'black'",
        "'x'",
        "'atoms'",
        "'black'",
        "'black'",
        "'black'",
        "'off'"
    ],
    "variables": [
        "N",
        "clusters",
        "Nc",
        "nlabels",
        "dataset",
        "labels",
        "p_inter",
        "p_intra",
        "n_nodes",
        "P",
        "P",
        "sizes",
        "G",
        "C",
        "C",
        "x",
        "ps",
        "D",
        "nt",
        "q",
        "reg",
        "Cdict_GW",
        "log",
        "scaled_atom",
        "x",
        "unmixings",
        "reconstruction_errors",
        "p",
        "unmixing",
        "Cembedded",
        "OT",
        "reconstruction_error",
        "unmixings",
        "unmixings2D",
        "unmixings2D",
        "i",
        "unmixings2D",
        "i",
        "x",
        "y",
        "z",
        "extremities",
        "start",
        "end",
        "dataset_features",
        "n",
        "F",
        "F",
        "F",
        "F",
        "C",
        "F",
        "colors",
        "x",
        "ps",
        "D",
        "nt",
        "q",
        "reg",
        "alpha",
        "Cdict_FGW",
        "Ydict_FGW",
        "log",
        "max_features",
        "min_features",
        "scaled_atom",
        "colors",
        "x",
        "unmixings",
        "reconstruction_errors",
        "C",
        "Y",
        "p",
        "unmixing",
        "Cembedded",
        "Yembedded",
        "OT",
        "reconstruction_error",
        "unmixings",
        "unmixings2D",
        "unmixings2D",
        "i",
        "unmixings2D",
        "i",
        "x",
        "y",
        "z",
        "extremities",
        "start",
        "end"
    ],
    "comments": [
        "-*- coding: utf-8 -*-",
        "Author: Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>",
        "",
        "License: MIT License",
        "sphinx_gallery_thumbnail_number = 4",
        "%%",
        "=============================================================================",
        "Generate a dataset composed of graphs following Stochastic Block models of 1, 2 and 3 clusters.",
        "=============================================================================",
        "number of graphs in the dataset",
        "For every number of clusters, we generate SBM with fixed inter/intra-clusters probability.",
        "number of graphs by cluster",
        "Visualize samples",
        "connection intensity proportional to C[i,j]",
        "sample with c clusters",
        "get 2d position for nodes",
        "%%",
        "=============================================================================",
        "Estimate the gromov-wasserstein dictionary from the dataset",
        "=============================================================================",
        "3 atoms in the dictionary",
        "of 6 nodes each",
        "regularization coefficient to promote sparsity of unmixings {w_s}",
        "visualize loss evolution over epochs",
        "%%",
        "=============================================================================",
        "Visualization of the estimated dictionary atoms",
        "=============================================================================",
        "Continuous connections between nodes of the atoms are colored in shades of grey (1: dark / 2: white)",
        "%%",
        "=============================================================================",
        "Visualization of the embedding space",
        "=============================================================================",
        "Compute the 2D representation of the unmixing living in the 2-simplex of probability",
        "%%",
        "=============================================================================",
        "Endow the dataset with node features",
        "=============================================================================",
        "We follow this feature assignment on all nodes of a graph depending on its label/number of clusters",
        "1 cluster --> 0 as nodes feature",
        "2 clusters --> 1 as nodes feature",
        "3 clusters --> 2 as nodes feature",
        "features are one-hot encoded following these assignments",
        "graph with 1 cluster",
        "graph with 2 clusters",
        "graph with 3 clusters",
        "sample with c clusters",
        "get 2d position for nodes",
        "%%",
        "=============================================================================",
        "Estimate a Fused Gromov-Wasserstein dictionary from the dataset of attributed graphs",
        "=============================================================================",
        "6 atoms instead of 3",
        "trade-off parameter between structure and feature information of Fused Gromov-Wasserstein",
        "visualize loss evolution",
        "%%",
        "=============================================================================",
        "Visualization of the estimated dictionary atoms",
        "=============================================================================",
        "scaled_F = 2 * (Fatom - min_features) / (max_features - min_features)",
        "%%",
        "=============================================================================",
        "Visualization of the embedding space",
        "=============================================================================",
        "Visualize unmixings in the 2-simplex of probability"
    ],
    "docstrings": [],
    "functions": [
        "plot_graph"
    ],
    "classes": []
}