{
    "identifiers": [
        "os",
        "arcpy",
        "re",
        "shutil",
        "tempfile",
        "tables",
        "suffix",
        "final_gdb",
        "dataset",
        "tables",
        "tempfile",
        "mkdtemp",
        "prefix",
        "tables",
        "os",
        "path",
        "join",
        "final_gdb",
        "dataset",
        "os",
        "path",
        "join",
        "dataset_path",
        "dataset",
        "suffix",
        "suffix",
        "dataset",
        "first_table",
        "_process_table",
        "first_table",
        "temp_dir",
        "first_table",
        "modified_table",
        "os",
        "path",
        "exists",
        "modified_table",
        "first_table",
        "arcpy",
        "Exists",
        "output_table",
        "arcpy",
        "Delete_management",
        "output_table",
        "os",
        "path",
        "basename",
        "modified_table",
        "arcpy",
        "conversion",
        "TableToGeodatabase",
        "modified_table",
        "dataset_path",
        "os",
        "path",
        "join",
        "dataset_path",
        "os",
        "path",
        "splitext",
        "os",
        "path",
        "basename",
        "modified_table",
        "arcpy",
        "Exists",
        "temp_name",
        "temp_name",
        "output_table",
        "arcpy",
        "Rename_management",
        "temp_name",
        "output_table",
        "arcpy",
        "ExecuteError",
        "e",
        "modified_table",
        "output_table",
        "e",
        "len",
        "tables",
        "table",
        "_",
        "code",
        "tables",
        "_process_table",
        "table",
        "temp_dir",
        "code",
        "processed",
        "os",
        "path",
        "exists",
        "processed",
        "modified_tables",
        "append",
        "processed",
        "modified_tables",
        "arcpy",
        "Append_management",
        "inputs",
        "modified_tables",
        "target",
        "output_table",
        "schema_type",
        "os",
        "path",
        "exists",
        "temp_dir",
        "shutil",
        "rmtree",
        "temp_dir",
        "input_dirs",
        "final_gdb",
        "dataset",
        "input_dir",
        "input_dirs",
        "dataset",
        "suffix",
        "suffix",
        "SUFFIX_MAPPING",
        "dataset",
        "_find_dbf_by_suffix",
        "input_dir",
        "dataset",
        "suffix",
        "SUFFIX_MAPPING",
        "dataset",
        "current_results",
        "suffix",
        "len",
        "current_results",
        "suffix",
        "suffix",
        "_consolidate_tables",
        "current_results",
        "suffix",
        "suffix",
        "final_gdb",
        "dataset",
        "_normalize_fields",
        "final_gdb",
        "e",
        "e",
        "directory",
        "dataset",
        "suffix",
        "suffix",
        "SUFFIX_MAPPING",
        "dataset",
        "os",
        "path",
        "exists",
        "directory",
        "directory",
        "results",
        "dataset",
        "directory",
        "root",
        "dirs",
        "files",
        "os",
        "walk",
        "directory",
        "os",
        "path",
        "basename",
        "root",
        "len",
        "dirs",
        "len",
        "files",
        "file",
        "files",
        "file",
        "lower",
        "endswith",
        "os",
        "path",
        "join",
        "root",
        "file",
        "os",
        "path",
        "splitext",
        "file",
        "_extract_municipal_code",
        "file",
        "municipal_code",
        "file",
        "suffix",
        "SUFFIX_MAPPING",
        "dataset",
        "base_name",
        "lower",
        "endswith",
        "suffix",
        "lower",
        "results",
        "suffix",
        "append",
        "file_path",
        "base_name",
        "municipal_code",
        "file",
        "municipal_code",
        "suffix",
        "sum",
        "len",
        "files",
        "files",
        "results",
        "values",
        "dataset",
        "suffix",
        "files",
        "results",
        "items",
        "files",
        "suffix",
        "len",
        "files",
        "found_files",
        "results",
        "filename",
        "re",
        "compile",
        "pattern",
        "match",
        "filename",
        "match",
        "match",
        "group",
        "ValueError",
        "table_path",
        "temp_dir",
        "municipal_code",
        "os",
        "path",
        "join",
        "temp_dir",
        "os",
        "path",
        "basename",
        "table_path",
        "shutil",
        "copy2",
        "table_path",
        "output_path",
        "f",
        "name",
        "f",
        "arcpy",
        "ListFields",
        "output_path",
        "TEMP_FIELD",
        "field_names",
        "TEMP_FIELD",
        "arcpy",
        "AddField_management",
        "in_table",
        "output_path",
        "field_name",
        "TEMP_FIELD",
        "field_type",
        "field_alias",
        "arcpy",
        "ExecuteError",
        "e",
        "e",
        "municipal_code",
        "arcpy",
        "da",
        "UpdateCursor",
        "output_path",
        "TEMP_FIELD",
        "cursor",
        "row",
        "cursor",
        "municipal_code",
        "cursor",
        "updateRow",
        "row",
        "output_path",
        "e",
        "table_path",
        "e",
        "table",
        "field_name",
        "field_type",
        "overwrite",
        "overwrite",
        "field_name",
        "f",
        "name",
        "f",
        "arcpy",
        "ListFields",
        "table",
        "arcpy",
        "DeleteField_management",
        "table",
        "field_name",
        "arcpy",
        "ListFields",
        "table",
        "field_name",
        "arcpy",
        "AddField_management",
        "in_table",
        "table",
        "field_name",
        "field_name",
        "field_type",
        "field_type",
        "field_alias",
        "field_name",
        "TEMP_FIELD",
        "field_name",
        "table",
        "old_name",
        "new_name",
        "_manage_field",
        "table",
        "new_name",
        "arcpy",
        "CalculateField_management",
        "table",
        "new_name",
        "old_name",
        "arcpy",
        "DeleteField_management",
        "table",
        "old_name",
        "e",
        "old_name",
        "new_name",
        "e",
        "final_gdb",
        "arcpy",
        "env",
        "final_gdb",
        "table",
        "arcpy",
        "ListTables",
        "table",
        "os",
        "path",
        "join",
        "final_gdb",
        "table",
        "f",
        "name",
        "f",
        "arcpy",
        "ListFields",
        "table_path",
        "MUNICIPAL_CODE_FIELD",
        "arcpy",
        "AddField_management",
        "in_table",
        "table_path",
        "field_name",
        "MUNICIPAL_CODE_FIELD",
        "field_type",
        "field_alias",
        "arcpy",
        "CalculateField_management",
        "in_table",
        "table_path",
        "field",
        "MUNICIPAL_CODE_FIELD",
        "expression",
        "expression_type",
        "arcpy",
        "DeleteField_management",
        "in_table",
        "table_path",
        "drop_field",
        "table",
        "e",
        "table",
        "e"
    ],
    "literals": [
        "\"COD_MUNI\"",
        "\"Codigo_Municipal_Catastral\"",
        "\"Rustico\"",
        "\"rA_Carvia\"",
        "\"rA_RUCULTIVO\"",
        "\"rA_RUSUBPARCELA\"",
        "\"Urbano\"",
        "\"uA_Carvia\"",
        "\"dbf_temp_\"",
        "f\"{dataset}_{suffix}\"",
        "f\"\\nProcesando tablas {suffix} en {dataset}:\"",
        "f\"- Tabla inicial: {first_table[0]}\"",
        "f\"Error: No se pudo procesar {first_table[0]}\"",
        "f\"- Convirtiendo a GDB: {os.path.basename(modified_table)}\"",
        "f\"Error en conversión:\"",
        "f\"- Input: {modified_table}\"",
        "f\"- Output: {output_table}\"",
        "f\"- Error: {str(e)}\"",
        "\"TEST\"",
        "\"Rustico\"",
        "\"Urbano\"",
        "f\"\\nProcesando {dataset}:\"",
        "f\"- Encontradas {len(current_results[suffix])} tablas {suffix}\"",
        "f\"Error en proceso principal: {str(e)}\"",
        "f\"Error: Directorio no existe: {directory}\"",
        "f\"\\nBuscando en {dataset}:\"",
        "f\"Directorio raíz: {directory}\"",
        "f\"\\nEscaneando subdirectorio: {os.path.basename(root)}\"",
        "f\"- Subdirectorios encontrados: {len(dirs)}\"",
        "f\"- Archivos encontrados: {len(files)}\"",
        "'.dbf'",
        "f\"- Ignorando {file} (sin código municipal)\"",
        "f\"✓ DBF válido: {file}\"",
        "f\"  Código: {municipal_code}, Sufijo: {suffix}\"",
        "f\"\\nResumen de {dataset}:\"",
        "f\"- {suffix}: {len(files)} archivos\"",
        "f\"Total: {found_files} archivos DBF válidos\"",
        "r\"^(\\d+)\"",
        "f\"- Añadiendo campo temporal {self.TEMP_FIELD}\"",
        "\"LONG\"",
        "\"Código Municipal Catastral\"",
        "f\"Error añadiendo campo: {str(e)}\"",
        "f\"- Actualizando código municipal: {municipal_code}\"",
        "f\"Error procesando tabla {table_path}: {str(e)}\"",
        "\"LONG\"",
        "\"Código Municipal Catastral\"",
        "f\"!{old_name}!\"",
        "\"PYTHON3\"",
        "f\"Error renombrando campo {old_name} a {new_name}: {str(e)}\"",
        "f\"\\nProcesando tabla: {table}\"",
        "\"COD_MUNI\"",
        "f\"1. Creando campo '{self.MUNICIPAL_CODE_FIELD}'...\"",
        "\"LONG\"",
        "\"Código Municipal Catastral\"",
        "f\"2. Copiando valores desde 'COD_MUNI'...\"",
        "\"!COD_MUNI!\"",
        "\"PYTHON3\"",
        "f\"3. Eliminando campo temporal 'COD_MUNI'...\"",
        "\"COD_MUNI\"",
        "f\"✓ Campo normalizado en {table}\"",
        "f\"Error procesando tabla {table}: {str(e)}\""
    ],
    "variables": [
        "TEMP_FIELD",
        "MUNICIPAL_CODE_FIELD",
        "SUFFIX_MAPPING",
        "temp_dir",
        "first_table",
        "dataset_path",
        "output_table",
        "modified_table",
        "temp_name",
        "modified_tables",
        "processed",
        "results",
        "current_results",
        "results",
        "file_path",
        "base_name",
        "municipal_code",
        "found_files",
        "pattern",
        "match",
        "output_path",
        "field_names",
        "row",
        "workspace",
        "table_path"
    ],
    "comments": [
        "-*- coding: utf-8 -*-",
        "Campo temporal de 8 caracteres (cumple límite de 10)",
        "Campo final (se usará solo después de la conversión a GDB)",
        "Procesar primera tabla",
        "Crear tabla en GDB",
        "Renombrar si es necesario",
        "Procesar tablas adicionales",
        "Encontrar archivos",
        "Inicializar resultados con sufijos del dataset específico",
        "Recorrer subdirectorios",
        "Verificar sufijos del dataset actual",
        "Resumen",
        "Verificar campo temporal existente",
        "Using 8-char field name",
        "Actualizar valores",
        "Verificar si existe el campo temporal"
    ],
    "docstrings": [
        "\"\"\"\n    Clase para procesar y consolidar tablas DBF con las siguientes capacidades:\n    - Consolidación de tablas por sufijo\n    - Adición automática de códigos municipales\n    - Manejo seguro de archivos temporales\n    - Normalización de campos\n    \"\"\"",
        "\"\"\"\n        Inicialización con constantes y configuración\n        \n        Atributos:\n            MUNICIPAL_CODE_FIELD (str): Nombre del campo de código municipal\n            SUFFIXES (list): Lista de sufijos a procesar\n        \"\"\"",
        "\"\"\"\n        Consolida tablas DBF en dataset específico.\n        \n        Args:\n            tables (list): Lista de tablas a procesar\n            suffix (str): Sufijo de las tablas\n            final_gdb (str): Ruta de la geodatabase\n            dataset (str): Nombre del dataset (Rustico/Urbano)\n        \"\"\"",
        "\"\"\"\n        Encuentra archivos DBF por sufijo recursivamente en subdirectorios.\n        \n        Args:\n            directory (str): Directorio raíz a examinar\n            dataset (str): Tipo de dataset (Rustico/Urbano)\n        \n        Returns:\n            dict: Diccionario con sufijos como claves y listas de tuplas (ruta, nombre, código)\n        \"\"\"",
        "\"\"\"\n        Extrae el código municipal del nombre del archivo.\n        \n        Args:\n            filename (str): Nombre del archivo\n            \n        Returns:\n            int: Código municipal o None si no se encuentra\n        \"\"\"",
        "\"\"\"Procesa una tabla individual.\"\"\"",
        "\"\"\"Gestiona la creación o modificación de campos.\"\"\"",
        "\"\"\"\n        Renombra un campo en una tabla.\n        \n        Args:\n            table (str): Nombre de la tabla\n            old_name (str): Nombre actual del campo\n            new_name (str): Nuevo nombre del campo\n        \"\"\"",
        "\"\"\"\n        Normaliza los campos en todas las tablas de la geodatabase.\n        \n        Args:\n            final_gdb (str): Ruta de la geodatabase final\n        \"\"\""
    ],
    "functions": [
        "_consolidate_tables",
        "process_directory",
        "_find_dbf_by_suffix",
        "_extract_municipal_code",
        "_process_table",
        "_manage_field",
        "_rename_field",
        "_normalize_fields"
    ],
    "classes": [
        "DBFProcessor"
    ]
}