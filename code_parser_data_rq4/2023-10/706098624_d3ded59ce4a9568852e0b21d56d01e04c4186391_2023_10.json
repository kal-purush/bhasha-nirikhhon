{
    "identifiers": [
        "argparse",
        "logging",
        "numpy",
        "np",
        "os",
        "pandas",
        "pd",
        "sys",
        "yaml",
        "repdf",
        "lowL",
        "highL",
        "scanfreq",
        "nmLabels",
        "pd",
        "IndexSlice",
        "lowL",
        "highL",
        "scanfreq",
        "nmLabels",
        "keys",
        "i",
        "split",
        "i",
        "cols",
        "repdf",
        "loc",
        "cols",
        "droplevel",
        "axis",
        "groupby",
        "highL",
        "split",
        "agg",
        "reset_index",
        "df",
        "loc",
        "df",
        "columns",
        "duplicated",
        "i",
        "df",
        "i",
        "split",
        "to_list",
        "i",
        "nmLabels",
        "keys",
        "i",
        "k",
        "nmLabels",
        "i",
        "k",
        "j",
        "j",
        "tmp",
        "i",
        "i",
        "tmp",
        "np",
        "logical_or",
        "reduce",
        "i",
        "tolist",
        "i",
        "tmp",
        "i",
        "i",
        "tmp",
        "len",
        "i",
        "i",
        "j",
        "i",
        "j",
        "tmp",
        "df",
        "scanfreq",
        "split",
        "to_list",
        "j",
        "j",
        "i",
        "j",
        "i",
        "tmp",
        "i",
        "np",
        "argmax",
        "j",
        "j",
        "i",
        "len",
        "i",
        "i",
        "tmp",
        "j",
        "i",
        "i",
        "i",
        "j",
        "tmp",
        "df",
        "lowL",
        "split",
        "to_list",
        "lowL",
        "split",
        "nm_list",
        "df",
        "loc",
        "highL",
        "split",
        "nmcol",
        "pd",
        "MultiIndex",
        "from_product",
        "tmp",
        "columns",
        "pd",
        "merge",
        "repdf",
        "tmp",
        "left_on",
        "i",
        "j",
        "i",
        "j",
        "repdf",
        "columns",
        "i",
        "highL",
        "split",
        "right_on",
        "highL",
        "split",
        "how",
        "drop",
        "highL",
        "split",
        "axis",
        "repdf",
        "repdf",
        "integration",
        "lowL",
        "pd",
        "IndexSlice",
        "lowL",
        "split",
        "repdf",
        "loc",
        "lowL",
        "split",
        "nmcol",
        "repdf_nm",
        "join",
        "repdf",
        "loc",
        "idx",
        "integration",
        "repdf_nm",
        "drop_duplicates",
        "set_index",
        "lowL",
        "split",
        "lowL",
        "split",
        "repdf_nm",
        "loc",
        "repdf_nm",
        "nmcol",
        "drop_duplicates",
        "repdf_nm",
        "nmcol",
        "drop_duplicates",
        "reset_index",
        "drop",
        "lowL",
        "split",
        "lowL",
        "split",
        "axis",
        "rename",
        "columns",
        "integration",
        "integration",
        "pd",
        "merge",
        "repdf",
        "repdf_nm",
        "on",
        "nmcol",
        "how",
        "repdf",
        "loc",
        "idx",
        "integration",
        "repdf",
        "loc",
        "idx",
        "integration",
        "pd",
        "MultiIndex",
        "from_product",
        "integration",
        "tmp",
        "columns",
        "repdf",
        "join",
        "tmp",
        "repdf",
        "drop",
        "integration",
        "axis",
        "level",
        "repdf",
        "repdf",
        "integration",
        "lowL",
        "lowL",
        "split",
        "integration",
        "pd",
        "IndexSlice",
        "repdf",
        "nmcol",
        "to_list",
        "pd",
        "MultiIndex",
        "from_tuples",
        "i",
        "j",
        "i",
        "j",
        "repdf",
        "columns",
        "i",
        "integration_d",
        "pd",
        "DataFrame",
        "i",
        "k",
        "j",
        "i",
        "j",
        "k",
        "j",
        "i",
        "j",
        "repdf",
        "loc",
        "integration",
        "to_dict",
        "items",
        "j",
        "i",
        "j",
        "repdf",
        "loc",
        "integration_d",
        "to_dict",
        "items",
        "bna",
        "columns",
        "cols",
        "repdf",
        "drop",
        "cols",
        "axis",
        "join",
        "df",
        "integration",
        "i",
        "i",
        "bna",
        "repdf",
        "drop",
        "cols",
        "axis",
        "join",
        "repdf",
        "loc",
        "cols",
        "replace",
        "np",
        "nan",
        "repdf",
        "config",
        "file",
        "logging",
        "info",
        "config",
        "file",
        "pd",
        "read_csv",
        "config",
        "sep",
        "header",
        "low_memory",
        "file",
        "logging",
        "info",
        "nmLabels",
        "update",
        "i",
        "i",
        "config",
        "getNM",
        "repdf",
        "lowL",
        "config",
        "highL",
        "config",
        "scanfreq",
        "config",
        "nmLabels",
        "nmLabels",
        "logging",
        "info",
        "Z_NM",
        "repdf",
        "config",
        "config",
        "logging",
        "info",
        "Z_noNM",
        "repdf",
        "config",
        "config",
        "repdf",
        "replace",
        "config",
        "np",
        "nan",
        "inplace",
        "os",
        "path",
        "join",
        "os",
        "path",
        "dirname",
        "config",
        "os",
        "path",
        "basename",
        "config",
        "logging",
        "info",
        "outpath",
        "repdf",
        "to_csv",
        "outpath",
        "sep",
        "index",
        "repdf",
        "argparse",
        "ArgumentParser",
        "description",
        "epilog",
        "parser",
        "add_argument",
        "os",
        "path",
        "join",
        "os",
        "path",
        "dirname",
        "help",
        "parser",
        "parse_args",
        "open",
        "args",
        "config",
        "file",
        "yaml",
        "load",
        "file",
        "yaml",
        "FullLoader",
        "logging",
        "basicConfig",
        "level",
        "logging",
        "INFO",
        "format",
        "os",
        "getpid",
        "datefmt",
        "handlers",
        "logging",
        "FileHandler",
        "os",
        "path",
        "splitext",
        "config",
        "logging",
        "StreamHandler",
        "logging",
        "info",
        "format",
        "join",
        "x",
        "x",
        "sys",
        "argv",
        "main",
        "config",
        "logging",
        "info"
    ],
    "literals": [
        "'pdm#LEVEL'",
        "'p#LEVEL'",
        "'ScanFreq#REL'",
        "'a#REL'",
        "'U'",
        "'#'",
        "'#'",
        "'#'",
        "'#'",
        "\"\"",
        "'#'",
        "f\"{lowL.split('#')[0]}_NM\"",
        "'#'",
        "'#'",
        "'EXTRA'",
        "'#'",
        "'#'",
        "'EXTRA'",
        "'left'",
        "'#'",
        "'EXTRA'",
        "f\"{lowL.split('#')[0]}_NM\"",
        "'#'",
        "'#'",
        "'EXTRA'",
        "'#'",
        "'#'",
        "'EXTRA'",
        "'EXTRA'",
        "''",
        "'#'",
        "'#'",
        "'_NM'",
        "'EXTRA'",
        "'left'",
        "'_NM'",
        "'_dNM'",
        "'_NM'",
        "f\"{lowL.split('#')[0]}_NM\"",
        "'#'",
        "'_dNM'",
        "'EXTRA'",
        "''",
        "'list'",
        "'list'",
        "'info-'",
        "'_dNM'",
        "'EXTRA'",
        "'psp'",
        "'sp'",
        "f\"Reading report: {config['infile']}\"",
        "'infile'",
        "'infile'",
        "'\\t'",
        "f\"Searching non modified element\"",
        "'NM_columns'",
        "'low_level'",
        "'high_level'",
        "'scanfreq'",
        "f\"Calculating dZ\"",
        "'integration'",
        "'low_level'",
        "f\"Get Z of elements without NM reference\"",
        "'integration'",
        "'low_level'",
        "'integration'",
        "'_dNM'",
        "'infile'",
        "'NM_'",
        "'infile'",
        "f\"Writing output report: {outpath}\"",
        "'\\t'",
        "'__main__'",
        "'NMpyCompare'",
        "'-c'",
        "'--config'",
        "'NMpyCompare.yaml'",
        "'Path to config file'",
        "'NMpyCompare.py - '",
        "' - %(asctime)s - %(levelname)s - %(message)s'",
        "'%m/%d/%Y %I:%M:%S %p'",
        "'infile'",
        "'.log'",
        "'Start script: '",
        "\"{0}\"",
        "\" \"",
        "f'End script'"
    ],
    "variables": [
        "idx",
        "cols",
        "cols",
        "df",
        "df",
        "tmp",
        "tmp",
        "tmp",
        "tmp",
        "tmp",
        "tmp",
        "nm_list",
        "nmcol",
        "df",
        "nmcol",
        "tmp",
        "tmp",
        "columns",
        "repdf",
        "idx",
        "nmcol",
        "repdf_nm",
        "repdf_nm",
        "repdf_nm",
        "repdf_nm",
        "repdf",
        "tmp",
        "tmp",
        "columns",
        "repdf",
        "repdf",
        "nmcol",
        "integration_d",
        "idx",
        "bna",
        "cols",
        "df",
        "repdf",
        "repdf",
        "repdf",
        "repdf",
        "repdf",
        "nmLabels",
        "_",
        "repdf",
        "repdf",
        "repdf",
        "outpath",
        "parser",
        "args",
        "config",
        "repdf"
    ],
    "comments": [
        "-*- coding: utf-8 -*-",
        "",
        "Import Modules",
        "",
        "",
        "Local Functions",
        "",
        "Local functions",
        "working columns",
        "import pdb; pdb.set_trace()",
        "{nmLabel1: [[[label_ijk],...[]n],...,[]m]} where m is the number of clusters, and n is number of pdm in the given cluster",
        "label_ijk is the label of pdm i in cluster j for label k",
        "replace label_ijk for a boolean (True if non-modified)",
        "Collapse boolean of the same pdm --> [[b_1j,... b_ij], ..., []m] where m is the number of clusters, where b_ij is boolean of pdm i in cluster j",
        "Join each pdm with its frequency and index position --> [[(i_1j, b_1j, s_1j), ..., ()n], ..., []m]",
        "Remove pdm with false",
        "Get position of the pdm with biggest frequency",
        "Extract pdm using the position",
        "Add NM to df",
        "Merge report with non modified using cluster as key",
        "Drop column containing Z of non modified (we only maintain Z_difference)",
        "bna = pd.isna(repdf.loc[:, idx[integration_d,:]]).all(axis=1)",
        "Remove 0 of NM",
        "",
        "Main",
        "",
        "read report",
        "get nm",
        "calculate delta Z",
        "if dZ is NaN because of NM absence, get original Z",
        "Replace 0 by nan",
        "repdf.loc[:, config['integration']+'_dNM'].replace(0, np.nan, inplace=True)",
        "write report"
    ],
    "docstrings": [
        "'''\n    Overview: Get the non modified peptidoform used as a reference\n    in each cluster\n\n    Input:\n        - repdf: Pandas dataframe with report format (multiindex)\n        - lowL: String indicating low level\n        - highL: String indicating high level\n        - nmLabels: Dictionary indicating the criteria used to identify the \n        non modified element.\n\n    Output:\n        - repdf: Pandas dataframe with report format.\n            - +=\n            - (NM, REL) column containing non modified element       \n    '''",
        "'''\n    Overview: Add each peptidoform the Z values of the NM used as reference\n    and calculate delta Z.\n\n    Input:\n        - repdf: Pandas dataframe with report format (multiindex)\n        - integration: String indicating integration (Z_pgm2p)\n        - lowL: String indicating low level\n\n    Output:\n        - repdf: Pandas dataframe with report format.\n            - +=\n            - Z_lowL2highL_NM (one per sample)\n            - Z_lowL2highL_dNM (one per sample)\n    '''",
        "'''\n    Parameters\n    ----------\n    repdf : Pandas DataFrame\n        DESCRIPTION.\n    integration : string\n        DESCRIPTION.\n\n    Returns\n    -------\n    Pandas DataFrame.\n\n    '''",
        "'''\n    main\n    '''",
        "'''\n        Example:\n            python NMpyCompare.py\n        '''"
    ],
    "functions": [
        "getNM",
        "Z_NM",
        "Z_noNM",
        "main"
    ],
    "classes": []
}