{
    "identifiers": [
        "configparser",
        "configparser",
        "ConfigParser",
        "config",
        "read",
        "config",
        "get",
        "config",
        "get",
        "config",
        "get",
        "config",
        "get",
        "format",
        "EVENT_DATA",
        "IAM_ROLE_ARN",
        "format",
        "COW_DATA",
        "IAM_ROLE_ARN",
        "format",
        "SENSOR_DATA",
        "IAM_ROLE_ARN",
        "staging_events_table_create",
        "staging_cows_table_create",
        "staging_sensors_table_create",
        "sensorevents_table_create",
        "sensors_table_create",
        "cows_table_create",
        "time_table_create",
        "groups_table_create",
        "staging_events_table_drop",
        "staging_cows_table_drop",
        "staging_sensors_table_drop",
        "sensorevents_table_drop",
        "sensors_table_drop",
        "cows_table_drop",
        "time_table_drop",
        "groups_table_drop",
        "staging_events_delete",
        "staging_cows_delete",
        "staging_sensors_delete",
        "staging_events_copy",
        "staging_cows_copy",
        "staging_sensors_copy",
        "sensorevents_table_insert",
        "sensors_table_insert",
        "cows_table_insert",
        "time_table_insert",
        "groups_table_insert"
    ],
    "literals": [
        "'dwh.cfg'",
        "'IAM_ROLE'",
        "'ARN'",
        "'S3'",
        "'EVENT_DATA'",
        "'S3'",
        "'COW_DATA'",
        "'S3'",
        "'SENSOR_DATA'",
        "\"DROP TABLE IF EXISTS staging_events;\"",
        "\"DROP TABLE IF EXISTS staging_cows;\"",
        "\"DROP TABLE IF EXISTS staging_sensors;\"",
        "\"DROP TABLE IF EXISTS sensorevents;\"",
        "\"DROP TABLE IF EXISTS sensors;\"",
        "\"DROP TABLE IF EXISTS cows;\"",
        "\"DROP TABLE IF EXISTS time;\"",
        "\"DROP TABLE IF EXISTS groups;\""
    ],
    "variables": [
        "config",
        "IAM_ROLE_ARN",
        "EVENT_DATA",
        "COW_DATA",
        "SENSOR_DATA",
        "staging_events_table_drop",
        "staging_cows_table_drop",
        "staging_sensors_table_drop",
        "sensorevents_table_drop",
        "sensors_table_drop",
        "cows_table_drop",
        "time_table_drop",
        "groups_table_drop",
        "staging_events_table_create",
        "staging_cows_table_create",
        "staging_sensors_table_create",
        "sensorevents_table_create",
        "sensors_table_create",
        "cows_table_create",
        "time_table_create",
        "groups_table_create",
        "staging_events_delete",
        "staging_cows_delete",
        "staging_sensors_delete",
        "staging_events_copy",
        "staging_cows_copy",
        "staging_sensors_copy",
        "sensorevents_table_insert",
        "sensors_table_insert",
        "cows_table_insert",
        "time_table_insert",
        "groups_table_insert",
        "create_table_queries",
        "drop_table_queries",
        "delete_table_queries",
        "copy_table_queries",
        "insert_table_queries"
    ],
    "comments": [
        "CONFIG",
        "DROP TABLES",
        "CREATE TABLES",
        "DELETE TABLES",
        "STAGING TABLES",
        "FINAL TABLES",
        "QUERY LISTS"
    ],
    "docstrings": [
        "\"\"\"\n    CREATE TABLE IF NOT EXISTS staging_events(\n        timestamp           integer,\n        body_temperature    float,\n        motion              integer,\n        rumination          float,\n        sensor_id           varchar,\n        event_id            varchar\n    );\n\"\"\"",
        "\"\"\"\n    CREATE TABLE IF NOT EXISTS staging_cows(\n        cow_number      integer,\n        cow_name        varchar,\n        age             integer,\n        color           varchar     \n    );\n\"\"\"",
        "\"\"\"\n    CREATE TABLE IF NOT EXISTS staging_sensors(\n        sensor_id               varchar,\n        sensor_name             varchar,\n        description             varchar,\n        cow_number              integer,\n        group_id                integer,\n        group_name              varchar,\n        location_description    varchar,\n        udder_factor            integer\n    );\n\"\"\"",
        "\"\"\"\n    CREATE TABLE IF NOT EXISTS sensorevents \n    (\n        event_id            varchar NOT NULL PRIMARY KEY DISTKEY,\n        sensor_id           varchar NOT NULL,\n        timestamp           timestamp NOT NULL,\n        cow_number          integer NOT NULL,\n        group_id            integer,\n        body_temperature    float,\n        motion              integer,\n        rumination          float\n    )\n    SORTKEY (timestamp, cow_number);\n\"\"\"",
        "\"\"\"\n    CREATE TABLE IF NOT EXISTS sensors\n    (\n        sensor_id       varchar NOT NULL PRIMARY KEY,\n        sensor_name     varchar,\n        description     varchar,\n        cow_number      integer SORTKEY DISTKEY\n    );\n\"\"\"",
        "\"\"\"\n    CREATE TABLE IF NOT EXISTS cows\n    (\n        cow_number      integer NOT NULL PRIMARY KEY SORTKEY,\n        cow_name        varchar,\n        age             integer,\n        color           varchar\n    );\n\"\"\"",
        "\"\"\"\n    CREATE TABLE IF NOT EXISTS time\n    (\n        timestamp   timestamp NOT NULL PRIMARY KEY SORTKEY DISTKEY,\n        month       integer NOT NULL,\n        date        integer NOT NULL,\n        year        integer NOT NULL,\n        hour        integer NOT NULL,\n        minute      integer NOT NULL,\n        second      integer NOT NULL,\n        weekday     integer NOT NULL\n    );\n\"\"\"",
        "\"\"\"\n    CREATE TABLE IF NOT EXISTS groups\n    (\n        group_id        integer NOT NULL PRIMARY KEY SORTKEY,\n        group_name      varchar,\n        description     varchar,\n        udder_factor    integer   \n    );\n\"\"\"",
        "\"\"\"\n    DELETE FROM staging_events\n\"\"\"",
        "\"\"\"\n    DELETE FROM staging_cows\n\"\"\"",
        "\"\"\"\n    DELETE FROM staging_sensors\n\"\"\"",
        "\"\"\"\n    copy staging_events from {}\n    credentials 'aws_iam_role={}'\n    region 'us-west-2' format as JSON 'auto'\n    timeformat as 'epochsecs'\n    TRUNCATECOLUMNS;\n\"\"\"",
        "\"\"\"\n    copy staging_cows from {}\n    credentials 'aws_iam_role={}'\n    region 'us-west-2'\n    CSV\n    IGNOREHEADER 1;\n\"\"\"",
        "\"\"\"\n    copy staging_sensors from {}\n    credentials 'aws_iam_role={}'\n    region 'us-west-2'\n    CSV\n    IGNOREHEADER 1;\n\"\"\"",
        "\"\"\"\n    INSERT INTO sensorevents (event_id, sensor_id, timestamp, cow_number, group_id, body_temperature, motion, rumination)\n    SELECT e.event_id,\n        e.sensor_id,\n        TIMESTAMP 'epoch' + e.timestamp * INTERVAL '1 Second ' AS timestamp,\n        c.cow_number,\n        s.group_id,\n        e.body_temperature,\n        e.motion,\n        e.rumination       \n    FROM staging_events e INNER JOIN staging_sensors s ON e.sensor_id = s.sensor_id\n        INNER JOIN staging_cows c ON c.cow_number = s.cow_number\n\"\"\"",
        "\"\"\"\n    INSERT INTO sensors (sensor_id, sensor_name, description, cow_number)\n    SELECT ss.sensor_id,\n        ss.sensor_name,\n        ss.description,\n        ss.cow_number\n    FROM staging_sensors ss LEFT JOIN sensors s ON ss.sensor_id = s.sensor_id\n    WHERE s.sensor_id IS NULL\n\"\"\"",
        "\"\"\"\n    INSERT INTO cows (cow_number, cow_name, age, color)\n    SELECT sc.cow_number,\n        sc.cow_name,\n        sc.age,\n        sc.color\n    FROM staging_cows sc LEFT JOIN cows c ON sc.cow_number = c.cow_number\n    WHERE c.cow_number IS NULL\n\"\"\"",
        "\"\"\"\n    INSERT INTO time (timestamp, month, date, year, hour, minute, second, weekday)\n    SELECT DISTINCT(sr.timestamp),\n        EXTRACT(month from sr.timestamp) as month,\n        EXTRACT(day from sr.timestamp) as date,\n        EXTRACT(year from sr.timestamp) as year,\n        EXTRACT(hour from sr.timestamp) as hour,\n        EXTRACT(minute from sr.timestamp) as minute,\n        EXTRACT(second from sr.timestamp) as second,\n        EXTRACT(weekday from sr.timestamp) as weekday\n    FROM sensorevents sr LEFT JOIN time t ON sr.timestamp = t.timestamp\n    WHERE t.timestamp IS NULL\n\"\"\"",
        "\"\"\"\n    INSERT INTO groups (group_id, group_name, description, udder_factor)\n    SELECT DISTINCT ss.group_id,\n        ss.group_name,\n        ss.location_description AS description,\n        ss.udder_factor\n    FROM staging_sensors ss LEFT JOIN groups l ON ss.group_id = l.group_id\n    WHERE l.group_id IS NULL\n\"\"\""
    ],
    "functions": [],
    "classes": []
}