{
    "identifiers": [
        "os",
        "argparse",
        "logging",
        "time",
        "numpy",
        "np",
        "numpy",
        "random",
        "npr",
        "matplotlib",
        "matplotlib",
        "use",
        "matplotlib",
        "pyplot",
        "plt",
        "torch",
        "torch",
        "nn",
        "nn",
        "torch",
        "optim",
        "optim",
        "torch",
        "nn",
        "functional",
        "F",
        "argparse",
        "ArgumentParser",
        "parser",
        "add_argument",
        "eval",
        "parser",
        "add_argument",
        "eval",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "parse_args",
        "args",
        "adjoint",
        "torchdiffeq",
        "odeint_adjoint",
        "odeint",
        "torchdiffeq",
        "odeint",
        "nspiral",
        "ntotal",
        "nsample",
        "start",
        "stop",
        "noise_std",
        "a",
        "b",
        "savefig",
        "np",
        "linspace",
        "start",
        "stop",
        "num",
        "ntotal",
        "orig_ts",
        "nsample",
        "stop",
        "orig_ts",
        "a",
        "b",
        "zs_cw",
        "rs_cw",
        "np",
        "cos",
        "zs_cw",
        "rs_cw",
        "np",
        "sin",
        "zs_cw",
        "np",
        "stack",
        "xs",
        "ys",
        "axis",
        "orig_ts",
        "a",
        "b",
        "zs_cc",
        "rw_cc",
        "np",
        "cos",
        "zs_cc",
        "rw_cc",
        "np",
        "sin",
        "zs_cc",
        "np",
        "stack",
        "xs",
        "ys",
        "axis",
        "savefig",
        "plt",
        "figure",
        "plt",
        "plot",
        "orig_traj_cw",
        "orig_traj_cw",
        "label",
        "plt",
        "plot",
        "orig_traj_cc",
        "orig_traj_cc",
        "label",
        "plt",
        "legend",
        "plt",
        "savefig",
        "dpi",
        "format",
        "_",
        "nspiral",
        "npr",
        "multinomial",
        "ntotal",
        "nsample",
        "ntotal",
        "nsample",
        "np",
        "argmax",
        "t0_idx",
        "nsample",
        "npr",
        "rand",
        "orig_traj_cc",
        "cc",
        "orig_traj_cw",
        "orig_trajs",
        "append",
        "orig_traj",
        "orig_traj",
        "t0_idx",
        "t0_idx",
        "nsample",
        "copy",
        "samp_traj",
        "npr",
        "randn",
        "samp_traj",
        "shape",
        "noise_std",
        "samp_trajs",
        "append",
        "samp_traj",
        "np",
        "stack",
        "orig_trajs",
        "axis",
        "np",
        "stack",
        "samp_trajs",
        "axis",
        "orig_trajs",
        "samp_trajs",
        "orig_ts",
        "samp_ts",
        "nn",
        "Module",
        "latent_dim",
        "nhidden",
        "LatentODEfunc",
        "nn",
        "ELU",
        "inplace",
        "nn",
        "Linear",
        "latent_dim",
        "nhidden",
        "nn",
        "Linear",
        "nhidden",
        "nhidden",
        "nn",
        "Linear",
        "nhidden",
        "latent_dim",
        "t",
        "x",
        "nfe",
        "fc1",
        "x",
        "elu",
        "fc2",
        "elu",
        "fc3",
        "nn",
        "Module",
        "latent_dim",
        "obs_dim",
        "nhidden",
        "nbatch",
        "RecognitionRNN",
        "nhidden",
        "nbatch",
        "nn",
        "Linear",
        "obs_dim",
        "nhidden",
        "nhidden",
        "nn",
        "Linear",
        "nhidden",
        "latent_dim",
        "x",
        "h",
        "torch",
        "cat",
        "x",
        "h",
        "dim",
        "torch",
        "tanh",
        "i2h",
        "combined",
        "h2o",
        "h",
        "h",
        "torch",
        "zeros",
        "nbatch",
        "nhidden",
        "nn",
        "Module",
        "latent_dim",
        "obs_dim",
        "nhidden",
        "Decoder",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "Linear",
        "latent_dim",
        "nhidden",
        "nn",
        "Linear",
        "nhidden",
        "obs_dim",
        "z",
        "fc1",
        "z",
        "relu",
        "fc2",
        "momentum",
        "momentum",
        "reset",
        "val",
        "val",
        "val",
        "avg",
        "momentum",
        "val",
        "momentum",
        "val",
        "x",
        "mean",
        "logvar",
        "torch",
        "from_numpy",
        "np",
        "array",
        "np",
        "pi",
        "to",
        "x",
        "device",
        "torch",
        "log",
        "logvar",
        "x",
        "mean",
        "torch",
        "exp",
        "logvar",
        "mu1",
        "lv1",
        "mu2",
        "lv2",
        "torch",
        "exp",
        "lv1",
        "torch",
        "exp",
        "lv2",
        "lv1",
        "lv2",
        "lstd2",
        "lstd1",
        "v1",
        "mu1",
        "mu2",
        "v2",
        "kl",
        "np",
        "pi",
        "torch",
        "device",
        "args",
        "gpu",
        "torch",
        "cuda",
        "is_available",
        "generate_spiral2d",
        "nspiral",
        "nspiral",
        "start",
        "start",
        "stop",
        "stop",
        "noise_std",
        "noise_std",
        "a",
        "a",
        "b",
        "b",
        "torch",
        "from_numpy",
        "orig_trajs",
        "to",
        "device",
        "torch",
        "from_numpy",
        "samp_trajs",
        "to",
        "device",
        "torch",
        "from_numpy",
        "samp_ts",
        "to",
        "device",
        "LatentODEfunc",
        "latent_dim",
        "nhidden",
        "to",
        "device",
        "RecognitionRNN",
        "latent_dim",
        "obs_dim",
        "rnn_nhidden",
        "nspiral",
        "to",
        "device",
        "Decoder",
        "latent_dim",
        "obs_dim",
        "nhidden",
        "to",
        "device",
        "func",
        "parameters",
        "dec",
        "parameters",
        "rec",
        "parameters",
        "optim",
        "Adam",
        "lr",
        "args",
        "lr",
        "RunningAverageMeter",
        "args",
        "train_dir",
        "os",
        "path",
        "exists",
        "args",
        "train_dir",
        "os",
        "makedirs",
        "args",
        "train_dir",
        "os",
        "path",
        "join",
        "args",
        "train_dir",
        "os",
        "path",
        "exists",
        "ckpt_path",
        "torch",
        "load",
        "ckpt_path",
        "func",
        "load_state_dict",
        "checkpoint",
        "rec",
        "load_state_dict",
        "checkpoint",
        "dec",
        "load_state_dict",
        "checkpoint",
        "optimizer",
        "load_state_dict",
        "checkpoint",
        "checkpoint",
        "checkpoint",
        "checkpoint",
        "checkpoint",
        "format",
        "ckpt_path",
        "itr",
        "args",
        "niters",
        "optimizer",
        "zero_grad",
        "rec",
        "initHidden",
        "to",
        "device",
        "t",
        "reversed",
        "samp_trajs",
        "size",
        "samp_trajs",
        "t",
        "rec",
        "forward",
        "obs",
        "h",
        "latent_dim",
        "latent_dim",
        "torch",
        "randn",
        "qz0_mean",
        "size",
        "to",
        "device",
        "epsilon",
        "torch",
        "exp",
        "qz0_logvar",
        "qz0_mean",
        "odeint",
        "func",
        "z0",
        "samp_ts",
        "permute",
        "dec",
        "pred_z",
        "torch",
        "zeros",
        "pred_x",
        "size",
        "to",
        "device",
        "noise_std",
        "torch",
        "log",
        "noise_std_",
        "to",
        "device",
        "log_normal_pdf",
        "samp_trajs",
        "pred_x",
        "noise_logvar",
        "sum",
        "sum",
        "torch",
        "zeros",
        "z0",
        "size",
        "to",
        "device",
        "normal_kl",
        "qz0_mean",
        "qz0_logvar",
        "pz0_mean",
        "pz0_logvar",
        "sum",
        "torch",
        "mean",
        "logpx",
        "analytic_kl",
        "dim",
        "loss",
        "backward",
        "optimizer",
        "step",
        "loss_meter",
        "update",
        "loss",
        "item",
        "format",
        "itr",
        "loss_meter",
        "avg",
        "KeyboardInterrupt",
        "args",
        "train_dir",
        "os",
        "path",
        "join",
        "args",
        "train_dir",
        "torch",
        "save",
        "func",
        "state_dict",
        "rec",
        "state_dict",
        "dec",
        "state_dict",
        "optimizer",
        "state_dict",
        "orig_trajs",
        "samp_trajs",
        "orig_ts",
        "samp_ts",
        "ckpt_path",
        "format",
        "ckpt_path",
        "format",
        "itr",
        "args",
        "visualize",
        "torch",
        "no_grad",
        "rec",
        "initHidden",
        "to",
        "device",
        "t",
        "reversed",
        "samp_trajs",
        "size",
        "samp_trajs",
        "t",
        "rec",
        "forward",
        "obs",
        "h",
        "latent_dim",
        "latent_dim",
        "torch",
        "randn",
        "qz0_mean",
        "size",
        "to",
        "device",
        "epsilon",
        "torch",
        "exp",
        "qz0_logvar",
        "qz0_mean",
        "torch",
        "from_numpy",
        "orig_ts",
        "to",
        "device",
        "z0",
        "np",
        "linspace",
        "np",
        "pi",
        "num",
        "np",
        "linspace",
        "np",
        "pi",
        "num",
        "copy",
        "torch",
        "from_numpy",
        "ts_pos",
        "to",
        "device",
        "torch",
        "from_numpy",
        "ts_neg",
        "to",
        "device",
        "odeint",
        "func",
        "z0",
        "ts_pos",
        "odeint",
        "func",
        "z0",
        "ts_neg",
        "dec",
        "zs_pos",
        "torch",
        "flip",
        "dec",
        "zs_neg",
        "dims",
        "xs_pos",
        "cpu",
        "numpy",
        "xs_neg",
        "cpu",
        "numpy",
        "orig_trajs",
        "cpu",
        "numpy",
        "samp_trajs",
        "cpu",
        "numpy",
        "plt",
        "figure",
        "plt",
        "plot",
        "orig_traj",
        "orig_traj",
        "label",
        "plt",
        "plot",
        "xs_pos",
        "xs_pos",
        "label",
        "plt",
        "plot",
        "xs_neg",
        "xs_neg",
        "label",
        "plt",
        "scatter",
        "samp_traj",
        "samp_traj",
        "label",
        "s",
        "plt",
        "legend",
        "plt",
        "savefig",
        "dpi",
        "format"
    ],
    "literals": [
        "'agg'",
        "'--adjoint'",
        "'--visualize'",
        "'--niters'",
        "'--lr'",
        "'--gpu'",
        "'--train_dir'",
        "'clock'",
        "'counter clock'",
        "'./ground_truth.png'",
        "'Saved ground truth spiral at {}'",
        "'./ground_truth.png'",
        "'__main__'",
        "'cuda:'",
        "'cpu'",
        "'ckpt.pth'",
        "'func_state_dict'",
        "'rec_state_dict'",
        "'dec_state_dict'",
        "'optimizer_state_dict'",
        "'orig_trajs'",
        "'samp_trajs'",
        "'orig_ts'",
        "'samp_ts'",
        "'Loaded ckpt from {}'",
        "'Iter: {}, running avg elbo: {:.4f}'",
        "'ckpt.pth'",
        "'func_state_dict'",
        "'rec_state_dict'",
        "'dec_state_dict'",
        "'optimizer_state_dict'",
        "'orig_trajs'",
        "'samp_trajs'",
        "'orig_ts'",
        "'samp_ts'",
        "'Stored ckpt at {}'",
        "'Training complete after {} iters.'",
        "'g'",
        "'true trajectory'",
        "'r'",
        "'learned trajectory (t>0)'",
        "'c'",
        "'learned trajectory (t<0)'",
        "'sampled data'",
        "'./vis.png'",
        "'Saved visualization figure at {}'",
        "'./vis.png'"
    ],
    "variables": [
        "parser",
        "args",
        "orig_ts",
        "samp_ts",
        "zs_cw",
        "rs_cw",
        "xs",
        "ys",
        "orig_traj_cw",
        "zs_cc",
        "rw_cc",
        "xs",
        "ys",
        "orig_traj_cc",
        "orig_trajs",
        "samp_trajs",
        "t0_idx",
        "t0_idx",
        "cc",
        "orig_traj",
        "samp_traj",
        "orig_trajs",
        "samp_trajs",
        "elu",
        "fc1",
        "fc2",
        "fc3",
        "nfe",
        "nhidden",
        "nbatch",
        "i2h",
        "h2o",
        "combined",
        "h",
        "relu",
        "fc1",
        "fc2",
        "momentum",
        "val",
        "avg",
        "avg",
        "avg",
        "val",
        "v1",
        "v2",
        "lstd1",
        "lstd2",
        "kl",
        "latent_dim",
        "nhidden",
        "rnn_nhidden",
        "obs_dim",
        "nspiral",
        "start",
        "stop",
        "noise_std",
        "a",
        "b",
        "ntotal",
        "nsample",
        "device",
        "orig_trajs",
        "samp_trajs",
        "orig_ts",
        "samp_ts",
        "orig_trajs",
        "samp_trajs",
        "samp_ts",
        "func",
        "rec",
        "dec",
        "optimizer",
        "loss_meter",
        "ckpt_path",
        "checkpoint",
        "orig_trajs",
        "samp_trajs",
        "orig_ts",
        "samp_ts",
        "h",
        "obs",
        "h",
        "qz0_mean",
        "qz0_logvar",
        "epsilon",
        "z0",
        "pred_z",
        "pred_x",
        "noise_std_",
        "noise_logvar",
        "logpx",
        "pz0_mean",
        "pz0_logvar",
        "analytic_kl",
        "loss",
        "ckpt_path",
        "h",
        "obs",
        "h",
        "qz0_mean",
        "qz0_logvar",
        "epsilon",
        "z0",
        "orig_ts",
        "z0",
        "ts_pos",
        "ts_neg",
        "ts_pos",
        "ts_neg",
        "zs_pos",
        "zs_neg",
        "xs_pos",
        "xs_neg",
        "xs_pos",
        "xs_neg",
        "orig_traj",
        "samp_traj"
    ],
    "comments": [
        "approximately equal to 6pi",
        "add 1 all timestamps to avoid division by 0",
        "generate clock-wise and counter clock-wise spirals in observation space",
        "with two sets of time-invariant latent dynamics",
        "sample starting timestamps",
        "don't sample t0 very near the start or the end",
        "uniformly select rotation",
        "batching for sample trajectories is good for RNN; batching for original",
        "trajectories only for ease of indexing",
        "generate toy spiral data",
        "model",
        "backward in time to infer q(z_0)",
        "forward in time and solve ode for reconstructions",
        "compute loss",
        "sample from trajectorys' approx. posterior",
        "take first trajectory for visualization"
    ],
    "docstrings": [
        "\"\"\"Parametric formula for 2d spiral is `r = a + b * theta`.\n\n    Args:\n      nspiral: number of spirals, i.e. batch dimension\n      ntotal: total number of datapoints per spiral\n      nsample: number of sampled datapoints for model fitting per spiral\n      start: spiral starting theta value\n      stop: spiral ending theta value\n      noise_std: observation noise standard deviation\n      a, b: parameters of the Archimedean spiral\n      savefig: plot the ground truth for sanity check\n\n    Returns: \n      Tuple where first element is true trajectory of size (nspiral, ntotal, 2),\n      second element is noisy observations of size (nspiral, nsample, 2),\n      third element is timestamps of size (ntotal,),\n      and fourth element is timestamps of size (nsample,)\n    \"\"\"",
        "\"\"\"Computes and stores the average and current value\"\"\""
    ],
    "functions": [
        "generate_spiral2d",
        "forward",
        "forward",
        "initHidden",
        "forward",
        "reset",
        "update",
        "log_normal_pdf",
        "normal_kl"
    ],
    "classes": [
        "LatentODEfunc",
        "RecognitionRNN",
        "Decoder",
        "RunningAverageMeter"
    ]
}