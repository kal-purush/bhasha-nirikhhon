{
    "identifiers": [
        "torch",
        "torch",
        "nn",
        "nn",
        "typing",
        "Union",
        "torch",
        "utils",
        "data",
        "DataLoader",
        "torch",
        "nn",
        "functional",
        "F",
        "copy",
        "utils",
        "get_device",
        "torchviz",
        "make_dot",
        "nn",
        "Module",
        "in_features",
        "out_features",
        "dropout",
        "is_output_layer",
        "nn",
        "Linear",
        "in_features",
        "in_features",
        "out_features",
        "out_features",
        "fc",
        "append",
        "layer",
        "is_output_layer",
        "fc",
        "extend",
        "nn",
        "BatchNorm1d",
        "num_features",
        "out_features",
        "nn",
        "ReLU",
        "nn",
        "Dropout",
        "dropout",
        "nn",
        "ModuleList",
        "fc",
        "x",
        "torch",
        "Tensor",
        "torch",
        "Tensor",
        "layer",
        "fc",
        "layer",
        "x",
        "x",
        "nn",
        "Module",
        "channels",
        "nn",
        "Conv2d",
        "channels",
        "channels",
        "kernel_size",
        "padding",
        "bias",
        "torch",
        "eye",
        "channels",
        "view",
        "channels",
        "channels",
        "identity_matrix",
        "torch",
        "no_grad",
        "conv",
        "weight",
        "copy_",
        "identity_matrix",
        "nn",
        "Sequential",
        "conv",
        "nn",
        "BatchNorm2d",
        "channels",
        "nn",
        "ReLU",
        "x",
        "torch",
        "tensor",
        "torch",
        "tensor",
        "conv",
        "x",
        "nn",
        "Module",
        "in_channels",
        "out_channels",
        "kernel_size",
        "out_channels",
        "kernel_size",
        "convs",
        "extend",
        "nn",
        "Conv2d",
        "in_channels",
        "in_channels",
        "out_channels",
        "out_channels",
        "kernel_size",
        "kernel_size",
        "padding",
        "nn",
        "BatchNorm2d",
        "num_features",
        "out_channels",
        "nn",
        "ReLU",
        "nn",
        "ModuleList",
        "convs",
        "get_device",
        "x",
        "layer",
        "convs",
        "layer",
        "x",
        "x",
        "count",
        "IdentityConvLayer",
        "channels",
        "out_channels",
        "to",
        "device",
        "convs",
        "append",
        "new_layer",
        "count",
        "nn",
        "Module",
        "channels_list",
        "n_classes",
        "dropout",
        "channels_list",
        "ValueError",
        "n_classes",
        "dropout",
        "get_device",
        "i",
        "len",
        "channels_list",
        "blocks",
        "extend",
        "ConvBlock",
        "in_channels",
        "channels_list",
        "i",
        "kernel_size",
        "out_channels",
        "channels_list",
        "i",
        "nn",
        "MaxPool2d",
        "nn",
        "ModuleList",
        "blocks",
        "nn",
        "Sequential",
        "MLP",
        "dropout",
        "dropout",
        "nn",
        "BatchNorm1d",
        "MLP",
        "out_features",
        "n_classes",
        "dropout",
        "dropout",
        "is_output_layer",
        "nn",
        "Sequential",
        "nn",
        "Conv2d",
        "in_channels",
        "channels_list",
        "out_channels",
        "kernel_size",
        "nn",
        "ReLU",
        "nn",
        "Flatten",
        "x",
        "torch",
        "Tensor",
        "torch",
        "Tensor",
        "layer",
        "convs",
        "layer",
        "x",
        "one_by_one_conv",
        "x",
        "flatten",
        "x",
        "fc",
        "x",
        "x",
        "dataloader",
        "DataLoader",
        "criterion",
        "nn",
        "CrossEntropyLoss",
        "name",
        "param",
        "named_parameters",
        "torch",
        "zeros_like",
        "param",
        "eval",
        "inputs",
        "labels",
        "dataloader",
        "inputs",
        "to",
        "device",
        "labels",
        "to",
        "device",
        "inputs",
        "criterion",
        "outputs",
        "labels",
        "zero_grad",
        "loss",
        "backward",
        "name",
        "param",
        "named_parameters",
        "param",
        "grad",
        "fisher_information",
        "name",
        "param",
        "grad",
        "pow",
        "len",
        "dataloader",
        "train",
        "fisher_information",
        "dataloader",
        "DataLoader",
        "criterion",
        "nn",
        "CrossEntropyLoss",
        "compute_fisher_information",
        "dataloader",
        "criterion",
        "eval",
        "inputs",
        "labels",
        "dataloader",
        "inputs",
        "to",
        "device",
        "labels",
        "to",
        "device",
        "inputs",
        "criterion",
        "outputs",
        "labels",
        "zero_grad",
        "loss",
        "backward",
        "name",
        "param",
        "named_parameters",
        "param",
        "grad",
        "name",
        "fisher_information",
        "fisher_information",
        "name",
        "natural_expansion_score",
        "torch",
        "sum",
        "param",
        "grad",
        "fisher_inv",
        "sum",
        "p",
        "numel",
        "p",
        "parameters",
        "p",
        "requires_grad",
        "num_params",
        "natural_expansion_score",
        "natural_expansion_score",
        "len",
        "dataloader",
        "num_params",
        "natural_expansion_score",
        "train",
        "natural_expansion_score",
        "item",
        "dataloader",
        "DataLoader",
        "threshold",
        "criterion",
        "nn",
        "CrossEntropyLoss",
        "nn",
        "CrossEntropyLoss",
        "find_optimal_location",
        "dataloader",
        "dataloader",
        "threshold",
        "threshold",
        "criterion",
        "criterion",
        "optimal_index",
        "expand",
        "optimal_index",
        "optimal_index",
        "convs",
        "optimal_index",
        "add_layer",
        "dataloader",
        "DataLoader",
        "threshold",
        "criterion",
        "nn",
        "CrossEntropyLoss",
        "compute_natural_expansion_score",
        "dataloader",
        "dataloader",
        "criterion",
        "criterion",
        "score",
        "threshold",
        "dataloader",
        "DataLoader",
        "threshold",
        "criterion",
        "nn",
        "CrossEntropyLoss",
        "compute_natural_expansion_score",
        "dataloader",
        "dataloader",
        "criterion",
        "criterion",
        "index",
        "convs",
        "isinstance",
        "ConvBlock",
        "conv_block_indices",
        "append",
        "index",
        "index",
        "conv_block_indices",
        "copy",
        "deepcopy",
        "temp_model",
        "convs",
        "index",
        "temp_model",
        "convs",
        "index",
        "add_layer",
        "temp_model",
        "compute_natural_expansion_score",
        "dataloader",
        "criterion",
        "index",
        "new_score",
        "new_score",
        "current_score",
        "threshold",
        "scores",
        "append",
        "index",
        "new_score",
        "temp_model",
        "scores",
        "scores",
        "max",
        "scores",
        "key",
        "d",
        "sum",
        "d",
        "values",
        "max_dict",
        "optimal_index",
        "optimal_index"
    ],
    "literals": [
        "\"same\"",
        "\"Identity matrix type: \"",
        "\"same\"",
        "\"Channels list should not be empty\"",
        "f\"num params: {num_params}\"",
        "f\"np before div{natural_expansion_score}\"",
        "f\"Natural expansion score: {natural_expansion_score}\"",
        "\"adding layer\"",
        "\"added layer\"",
        "f\"CONVS: {temp_model.convs[index]}\"",
        "f\"score at index {index}: {new_score}\"",
        "f\"Scores: {scores}\"",
        "f\"optimal_index: {optimal_index}\""
    ],
    "variables": [
        "fc",
        "layer",
        "fc",
        "x",
        "conv",
        "identity_matrix",
        "conv",
        "convs",
        "count",
        "out_channels",
        "kernel_size",
        "convs",
        "device",
        "x",
        "new_layer",
        "blocks",
        "n_classes",
        "dropout",
        "device",
        "convs",
        "fc",
        "one_by_one_conv",
        "flatten",
        "x",
        "x",
        "x",
        "x",
        "fisher_information",
        "fisher_information",
        "name",
        "inputs",
        "labels",
        "outputs",
        "loss",
        "fisher_information",
        "natural_expansion_score",
        "inputs",
        "labels",
        "outputs",
        "loss",
        "fisher_inv",
        "num_params",
        "optimal_index",
        "score",
        "scores",
        "current_score",
        "conv_block_indices",
        "temp_model",
        "new_score",
        "max_dict",
        "optimal_index",
        "optimal_index"
    ],
    "comments": [
        "self.convs.insert(len(self.convs)-1, new_layer)",
        "Setting to eval mode",
        "Accumulate the natural expansion score",
        "Fisher inverse component for this parameter",
        "Updating the natural expansion scrore",
        "score = g^T * F^(-1) * g = g**2 *F^(-1)",
        "Setting back to train mode",
        "breakpoint()",
        "if self.needs_expansion(dataloader, threshold, criterion):",
        "range(num_convs-1):"
    ],
    "docstrings": [],
    "functions": [
        "forward",
        "forward",
        "forward",
        "add_layer",
        "forward",
        "compute_fisher_information",
        "compute_natural_expansion_score",
        "expand_if_necessary",
        "expand",
        "needs_expansion",
        "find_optimal_location"
    ],
    "classes": [
        "MLP",
        "IdentityConvLayer",
        "ConvBlock",
        "DynamicCNN"
    ]
}