{
    "identifiers": [
        "os",
        "sys",
        "glob",
        "pandas",
        "pd",
        "matplotlib",
        "pyplot",
        "pl",
        "numpy",
        "np",
        "getpass",
        "tqdm",
        "tqdm",
        "pytransit",
        "MandelAgol",
        "scipy",
        "optimize",
        "op",
        "limbdark",
        "lb",
        "scipy",
        "stats",
        "emcee",
        "MHSampler",
        "EnsembleSampler",
        "emcee",
        "utils",
        "sample_ball",
        "tqdm",
        "tqdm",
        "gzip",
        "pl",
        "style",
        "use",
        "matplotlib",
        "matplotlib",
        "rcParams",
        "update",
        "pl",
        "rcParams",
        "pl",
        "rcParams",
        "os",
        "environ",
        "environ",
        "format",
        "environ",
        "sys",
        "exit",
        "glob",
        "glob",
        "data_dir",
        "file_list",
        "sort",
        "len",
        "file_list",
        "split",
        "i",
        "f",
        "b",
        "file_list",
        "bands",
        "pd",
        "read_csv",
        "os",
        "path",
        "join",
        "data_dir",
        "f",
        "delimiter",
        "parse_dates",
        "df",
        "set_index",
        "df",
        "np",
        "sqrt",
        "np",
        "deg2rad",
        "p",
        "t14",
        "k",
        "i",
        "np",
        "pi",
        "impact_param",
        "np",
        "sqrt",
        "k",
        "impact_param",
        "np",
        "sin",
        "i",
        "np",
        "sin",
        "t14",
        "np",
        "pi",
        "p",
        "numer",
        "denom",
        "scaled_a",
        "_P",
        "_t14",
        "_k",
        "i",
        "_inc",
        "impact_param",
        "_b",
        "MandelAgol",
        "q1",
        "q2",
        "np",
        "sqrt",
        "q1",
        "q2",
        "np",
        "sqrt",
        "q1",
        "q2",
        "u1",
        "u2",
        "theta",
        "t",
        "p",
        "MandelAgol",
        "theta",
        "np",
        "arccos",
        "b",
        "a",
        "q_to_u",
        "q1",
        "q2",
        "MA",
        "evaluate",
        "t",
        "k",
        "u1",
        "u2",
        "tc",
        "p",
        "a",
        "inc",
        "model",
        "data",
        "b",
        "index",
        "b",
        "sorted",
        "bands",
        "data",
        "b",
        "b",
        "bands",
        "split",
        "pl",
        "subplots",
        "figsize",
        "i",
        "b",
        "c",
        "sorted",
        "bands",
        "colors",
        "data",
        "b",
        "df",
        "flux",
        "apply",
        "x",
        "x",
        "i",
        "plot",
        "label",
        "b",
        "marker",
        "color",
        "c",
        "alpha",
        "ax",
        "ax",
        "_k",
        "i",
        "scaled_a",
        "_P",
        "_t14",
        "k_0",
        "i",
        "_inc",
        "impact_param",
        "_b",
        "k_0",
        "tc_0",
        "a_s_",
        "_b",
        "q1_0",
        "q2_0",
        "df",
        "index",
        "model_q",
        "theta",
        "t",
        "_P",
        "ax",
        "plot",
        "t",
        "m",
        "i",
        "color",
        "c",
        "ax",
        "set_ylabel",
        "theta_vec",
        "append",
        "theta",
        "pl",
        "legend",
        "theta",
        "t",
        "f",
        "p",
        "model_q",
        "theta",
        "t",
        "p",
        "np",
        "sum",
        "m",
        "f",
        "split",
        "pl",
        "subplots",
        "figsize",
        "sharey",
        "i",
        "b",
        "sorted",
        "bands",
        "data",
        "b",
        "d",
        "f",
        "index",
        "ts",
        "append",
        "t",
        "fluxes",
        "append",
        "f",
        "axs",
        "plot",
        "t",
        "f",
        "i",
        "drawstyle",
        "c",
        "colors",
        "i",
        "op",
        "minimize",
        "obj",
        "theta_vec",
        "i",
        "args",
        "t",
        "f",
        "_P",
        "method",
        "model_q",
        "res",
        "x",
        "t",
        "_P",
        "axs",
        "plot",
        "t",
        "model",
        "i",
        "fig",
        "tight_layout",
        "airmasses",
        "append",
        "d",
        "uncs",
        "append",
        "d",
        "values",
        "dxs",
        "append",
        "d",
        "values",
        "dys",
        "append",
        "d",
        "values",
        "axs",
        "set_title",
        "fontsize",
        "fontsize",
        "axs",
        "set_ylabel",
        "fontsize",
        "fontsize",
        "axs",
        "set_xlabel",
        "fontsize",
        "fontsize",
        "theta",
        "aux_vec",
        "t",
        "aux_vec",
        "np",
        "ones",
        "len",
        "t",
        "np",
        "array",
        "theta",
        "np",
        "c_",
        "airmass",
        "xcenter",
        "ycenter",
        "offset",
        "t",
        "sum",
        "axis",
        "s",
        "theta",
        "t",
        "f",
        "p",
        "aux_vec",
        "ret_mod",
        "ret_sys",
        "ret_full",
        "theta",
        "model_q",
        "theta",
        "t",
        "p",
        "model_s",
        "theta",
        "aux_vec",
        "t",
        "ret_mod",
        "m",
        "ret_sys",
        "s",
        "ret_full",
        "m",
        "s",
        "f",
        "m",
        "s",
        "np",
        "exp",
        "ls",
        "np",
        "sum",
        "resid",
        "inv_sig2",
        "ls",
        "x",
        "loglike",
        "x",
        "k0",
        "k1",
        "k2",
        "k3",
        "k4",
        "k5",
        "k6",
        "k7",
        "k8",
        "k9",
        "pl",
        "figure",
        "figsize",
        "n",
        "b",
        "sorted",
        "bands",
        "data",
        "b",
        "d",
        "f",
        "index",
        "d",
        "values",
        "d",
        "values",
        "d",
        "values",
        "d",
        "values",
        "format",
        "b",
        "np",
        "log",
        "np",
        "nanstd",
        "f",
        "_k",
        "i",
        "scaled_a",
        "_P",
        "_t14",
        "k_0",
        "i",
        "_inc",
        "impact_param",
        "_b",
        "k_0",
        "tc_0",
        "a_s_",
        "_b",
        "q1_0",
        "q2_0",
        "np",
        "concatenate",
        "theta",
        "ls",
        "k_list",
        "nparams",
        "airmass",
        "dx",
        "dy",
        "format",
        "nll",
        "theta_sys",
        "t",
        "f",
        "_P",
        "aux_vec",
        "op",
        "minimize",
        "nll",
        "theta_sys",
        "args",
        "t",
        "f",
        "_P",
        "aux_vec",
        "method",
        "format",
        "nll",
        "result",
        "x",
        "t",
        "f",
        "_P",
        "aux_vec",
        "loglike",
        "result",
        "x",
        "t",
        "f",
        "_P",
        "aux_vec",
        "ret_full",
        "loglike",
        "result",
        "x",
        "t",
        "f",
        "_P",
        "aux_vec",
        "ret_mod",
        "loglike",
        "result",
        "x",
        "t",
        "f",
        "_P",
        "aux_vec",
        "ret_sys",
        "f",
        "f_pred",
        "np",
        "std",
        "resid",
        "np",
        "sqrt",
        "np",
        "mean",
        "resid",
        "format",
        "sigma",
        "rms",
        "pl",
        "subplot",
        "n",
        "ax",
        "plot",
        "t",
        "f",
        "t",
        "f_pred",
        "i",
        "split",
        "ldp",
        "append",
        "lb",
        "claret",
        "i",
        "teff",
        "uteff",
        "logg",
        "ulogg",
        "feh",
        "ufeh",
        "n",
        "theta",
        "up",
        "theta",
        "np",
        "arccos",
        "impact_param",
        "a",
        "q1",
        "q1",
        "q2",
        "q2",
        "k",
        "k",
        "impact_param",
        "impact_param",
        "inc",
        "np",
        "pi",
        "a",
        "a",
        "tc",
        "t",
        "tc",
        "t",
        "np",
        "inf",
        "q_to_u",
        "q1",
        "q2",
        "up",
        "lp",
        "np",
        "log",
        "stats",
        "norm",
        "pdf",
        "u1",
        "loc",
        "up",
        "scale",
        "up",
        "lp",
        "np",
        "log",
        "stats",
        "norm",
        "pdf",
        "u2",
        "loc",
        "up",
        "scale",
        "up",
        "lp",
        "theta_sys",
        "ts",
        "fluxes",
        "p",
        "airmasses",
        "dxs",
        "dys",
        "up",
        "ts",
        "fluxes",
        "airmasses",
        "dxs",
        "dys",
        "theta_sys",
        "k1",
        "tc",
        "a1",
        "impact_param",
        "q11",
        "q21",
        "ls1",
        "k01",
        "k11",
        "k21",
        "k31",
        "k41",
        "k2",
        "tc",
        "a2",
        "impact_param",
        "q12",
        "q22",
        "ls2",
        "k02",
        "k12",
        "k22",
        "k32",
        "k42",
        "k3",
        "tc",
        "a3",
        "impact_param",
        "q13",
        "q23",
        "ls3",
        "k03",
        "k13",
        "k23",
        "k33",
        "k43",
        "airmass1",
        "xcen1",
        "ycen1",
        "airmass2",
        "xcen2",
        "ycen2",
        "airmass3",
        "xcen3",
        "ycen3",
        "loglike",
        "theta1",
        "t1",
        "f1",
        "p",
        "aux_vec1",
        "ll",
        "loglike",
        "theta2",
        "t2",
        "f2",
        "p",
        "aux_vec2",
        "ll",
        "loglike",
        "theta3",
        "t3",
        "f3",
        "p",
        "aux_vec3",
        "up",
        "logprior",
        "theta1",
        "up",
        "up",
        "lp",
        "logprior",
        "theta2",
        "up",
        "up",
        "lp",
        "logprior",
        "theta3",
        "up",
        "up",
        "logprior",
        "theta1",
        "lp",
        "logprior",
        "theta2",
        "lp",
        "logprior",
        "theta3",
        "np",
        "isnan",
        "ll",
        "np",
        "inf",
        "lp",
        "ll",
        "x",
        "logprob",
        "x",
        "i",
        "j",
        "bands",
        "_k",
        "i",
        "scaled_a",
        "_P",
        "_t14",
        "k_0",
        "i",
        "_inc",
        "impact_param",
        "_b",
        "k_0",
        "tc_0",
        "a_s_",
        "_b",
        "q1_0",
        "q2_0",
        "theta",
        "append",
        "theta_vec",
        "_k",
        "_k",
        "_k",
        "a_s_",
        "np",
        "log",
        "np",
        "nanstd",
        "f",
        "f",
        "fluxes",
        "ts",
        "fluxes",
        "dxs",
        "dys",
        "airmasses",
        "k1",
        "k2",
        "k3",
        "tc_0",
        "a1",
        "a2",
        "a3",
        "_b",
        "q11",
        "q12",
        "q13",
        "q21",
        "q22",
        "q23",
        "ls1",
        "ls2",
        "ls3",
        "k01",
        "k02",
        "k03",
        "k11",
        "k12",
        "k13",
        "k21",
        "k22",
        "k23",
        "k31",
        "k32",
        "k33",
        "k41",
        "k42",
        "k43",
        "ts",
        "fluxes",
        "_P",
        "airmasses",
        "dxs",
        "dys",
        "logprob",
        "theta_sys",
        "args",
        "logprob",
        "theta_sys",
        "args",
        "up",
        "ldp",
        "len",
        "theta_sys",
        "ndim",
        "ndim",
        "ndim",
        "EnsembleSampler",
        "nwalkers",
        "ndim",
        "logprob",
        "args",
        "args",
        "threads",
        "np",
        "load",
        "np",
        "array",
        "theta_sys0",
        "np",
        "random",
        "randn",
        "ndim",
        "i",
        "nwalkers",
        "pos",
        "lnp",
        "rstate",
        "tqdm",
        "sampler",
        "sample",
        "pos0",
        "iterations",
        "nsteps1",
        "split",
        "sampler",
        "chain",
        "chain",
        "shape",
        "pl",
        "subplots",
        "ndim",
        "figsize",
        "ndim",
        "sharex",
        "axs",
        "flat",
        "i",
        "plot",
        "c",
        "drawstyle",
        "color",
        "alpha",
        "nwalkers",
        "i",
        "c",
        "chain",
        "T",
        "axs",
        "flat",
        "i",
        "set_ylabel",
        "l",
        "i",
        "l",
        "param_names",
        "pl",
        "xlabel",
        "pl",
        "savefig",
        "sampler",
        "chain",
        "burn",
        "gzip",
        "GzipFile",
        "os",
        "path",
        "join",
        "loc",
        "g1",
        "np",
        "save",
        "g1",
        "chain",
        "gzip",
        "GzipFile",
        "os",
        "path",
        "join",
        "loc",
        "g2",
        "np",
        "save",
        "g2",
        "chain",
        "sampler",
        "reset",
        "pos2",
        "lnp2",
        "rstate",
        "tqdm",
        "sampler",
        "sample",
        "pos",
        "iterations",
        "nsteps2",
        "sampler",
        "chain",
        "gzip",
        "GzipFile",
        "os",
        "path",
        "join",
        "loc",
        "fname",
        "g1",
        "np",
        "save",
        "g1",
        "chain",
        "os",
        "system",
        "transfer_data",
        "gzip",
        "GzipFile",
        "os",
        "path",
        "join",
        "loc",
        "g2",
        "np",
        "save",
        "g2",
        "lnp2",
        "chain",
        "shape",
        "pl",
        "subplots",
        "ndim",
        "figsize",
        "ndim",
        "sharex",
        "axs",
        "flat",
        "i",
        "plot",
        "c",
        "drawstyle",
        "color",
        "alpha",
        "nwalkers",
        "i",
        "c",
        "chain",
        "T",
        "axs",
        "flat",
        "i",
        "set_ylabel",
        "l",
        "i",
        "l",
        "param_names",
        "pl",
        "xlabel",
        "pl",
        "savefig"
    ],
    "literals": [
        "'CoRoT-5b'",
        "'seaborn-white'",
        "'font.size'",
        "'ytick.labelsize'",
        "'large'",
        "'xtick.labelsize'",
        "'large'",
        "'astroconda35'",
        "'CONDA_DEFAULT_ENV'",
        "'{} not found'",
        "'.'",
        "'/*.csv'",
        "'g,r,z'",
        "','",
        "','",
        "'GJD'",
        "'flux'",
        "'b,g,r'",
        "','",
        "'.'",
        "'Normalized flux'",
        "'---computing MLE---'",
        "'b,g,r'",
        "','",
        "'flux'",
        "'steps-mid'",
        "'nelder-mead'",
        "'k-'",
        "'airmass'",
        "'err'",
        "'dx'",
        "'dy'",
        "'WASP-21 b raw light curve'",
        "'Relative Flux + Offset'",
        "'Phase (days)'",
        "'flux'",
        "'airmass'",
        "'err'",
        "'dx'",
        "'dy'",
        "'--{}--'",
        "\"NLL before: {}\"",
        "'nelder-mead'",
        "\"NLL after: {}\"",
        "'residual: std={0:.4f}, rms={1:.4f}'",
        "'ko'",
        "'r-'",
        "'---sampling limb dark priors---'",
        "'g*,r*,z*'",
        "','",
        "'---computing logprob---'",
        "'---setting up MCMC---'",
        "'theta_post.csv'",
        "'k1,k2,k3,tc,a1,a2,a3,inc,u11,u12,u13,u21,u22,u23,ls1,ls2,ls3,k01,k02,k03,k11,k12,k13,k21,k22,k23,k31,k32,k33,k41,k42,k43'",
        "','",
        "'steps'",
        "'k'",
        "'nsteps'",
        "'chain1.png'",
        "'.'",
        "'chain1.npy.gz'",
        "\"w\"",
        "'lnp1.npy.gz'",
        "\"w\"",
        "'.'",
        "'chain2.npy.gz'",
        "\"w\"",
        "'lnp2.npy.gz'",
        "\"w\"",
        "'steps'",
        "'k'",
        "'nsteps'",
        "'chain2.png'"
    ],
    "variables": [
        "dirname",
        "fontsize",
        "environ",
        "data_dir",
        "file_list",
        "data",
        "bands",
        "df",
        "df",
        "data",
        "b",
        "_P",
        "_t14",
        "_b",
        "_a_s",
        "_k",
        "_inc",
        "tc_0",
        "q1_0",
        "q2_0",
        "numer",
        "denom",
        "a_s_",
        "MA",
        "u1",
        "u2",
        "MA",
        "k",
        "tc",
        "a",
        "b",
        "q1",
        "q2",
        "inc",
        "u1",
        "u2",
        "model",
        "ts",
        "fluxes",
        "theta_vec",
        "colors",
        "fig",
        "ax",
        "df",
        "k_0",
        "a_s_",
        "theta",
        "t",
        "m",
        "m",
        "ts",
        "fluxes",
        "airmasses",
        "uncs",
        "dxs",
        "dys",
        "colors",
        "fig",
        "axs",
        "d",
        "f",
        "t",
        "res",
        "model",
        "airmass",
        "xcenter",
        "ycenter",
        "offset",
        "s",
        "ls",
        "m",
        "s",
        "resid",
        "inv_sig2",
        "nll",
        "k0",
        "k1",
        "k2",
        "k3",
        "k4",
        "k5",
        "k6",
        "k7",
        "k8",
        "k9",
        "k_list",
        "nparams",
        "ip",
        "fig",
        "d",
        "f",
        "t",
        "airmass",
        "err",
        "dx",
        "dy",
        "ls",
        "k_0",
        "a_s_",
        "theta",
        "theta_sys",
        "aux_vec",
        "result",
        "f_pred",
        "mod",
        "sys",
        "resid",
        "sigma",
        "rms",
        "ax",
        "teff",
        "uteff",
        "logg",
        "ulogg",
        "feh",
        "ufeh",
        "ldp",
        "k",
        "tc",
        "a",
        "impact_param",
        "q1",
        "q2",
        "inc",
        "lp",
        "u1",
        "u2",
        "t1",
        "t2",
        "t3",
        "f1",
        "f2",
        "f3",
        "airmass1",
        "airmass2",
        "airmass3",
        "xcen1",
        "xcen2",
        "xcen3",
        "ycen1",
        "ycen2",
        "ycen3",
        "k1",
        "k2",
        "k3",
        "tc",
        "a1",
        "a2",
        "a3",
        "impact_param",
        "q11",
        "q12",
        "q13",
        "q21",
        "q22",
        "q23",
        "ls1",
        "ls2",
        "ls3",
        "k01",
        "k02",
        "k03",
        "k11",
        "k12",
        "k13",
        "k21",
        "k22",
        "k23",
        "k31",
        "k32",
        "k33",
        "k41",
        "k42",
        "k43",
        "theta1",
        "theta2",
        "theta3",
        "aux_vec1",
        "aux_vec2",
        "aux_vec3",
        "ll",
        "lp",
        "lp",
        "nlp",
        "theta_vec",
        "k_0",
        "a_s_",
        "theta",
        "k1",
        "k2",
        "k3",
        "q11",
        "q12",
        "q13",
        "q21",
        "q22",
        "q23",
        "a1",
        "a2",
        "a3",
        "k01",
        "k11",
        "k21",
        "k31",
        "k41",
        "k02",
        "k12",
        "k22",
        "k32",
        "k42",
        "k03",
        "k13",
        "k23",
        "k33",
        "k43",
        "ls1",
        "ls2",
        "ls3",
        "t1",
        "t2",
        "t3",
        "f1",
        "f2",
        "f3",
        "xcen1",
        "xcen2",
        "xcen3",
        "ycen1",
        "ycen2",
        "ycen3",
        "airmass1",
        "airmass2",
        "airmass3",
        "theta_sys",
        "args",
        "ndim",
        "nwalkers",
        "nsteps1",
        "sampler",
        "theta_sys0",
        "pos0",
        "param_names",
        "chain",
        "nwalkers",
        "nsteps",
        "ndim",
        "fig",
        "axs",
        "burn",
        "chain",
        "loc",
        "nsteps2",
        "chain",
        "loc",
        "fname",
        "nwalkers",
        "nsteps",
        "ndim",
        "fig",
        "axs"
    ],
    "comments": [
        "!home/usr/miniconda3/envs/astroconda3/python #laptop",
        "!home/usr/miniconda2/envs/astroconda/python #Tamura server",
        "styling",
        "_tc  = 245778e6+8.01",
        "compute model",
        "--------------MLE--------------#",
        "dropna",
        "d=d.dropna(axis=0)",
        "sys mod params",
        "peak_fluxes.append(d['peak'].values)",
        "fwhms.append(d['fwhm'].values)",
        "systematics model (time-dependent)",
        "functional form of systematics model",
        "s = [np.sum(c[k] * x**k) for k in np.arange(N)]",
        "unpack 6 free params",
        "a,b,c,d,e = theta",
        "s = a + b*t + c*fwhm + d*xcenter + e*ycenter",
        "airmass, xcenter, ycenter = aux_vec",
        "#add sys model",
        "negative log-likelihood",
        "systematics parameters",
        "log flux uncertainty",
        "impact param, b",
        "parameters vector: 6 free, 7 input",
        "dropna",
        "d=d.dropna(axis=0)",
        "remove outliers",
        "d=d[np.abs(d-d.mean())<=(3*d.std())]",
        "sys mod params",
        "peak_flux=d['peak(ADU)'].values",
        "fwhm = d['fwhm(pix)'].values",
        "parameters vector: 6 free, 3 input",
        "-------------Limb-darkening priors---------------#",
        "limbdark priors",
        "-----------------logprob--------------------------#",
        "or k from 0 up to order of max_k (Seager paper)?",
        "print('off limits encountered in logprior')",
        "u prior",
        "sum loglike for each band",
        "print('NaN encountered in loglike')",
        "total: sum of prior and likelihood",
        "negative log prob",
        "---------------multi-band, simultaneous-----------#",
        "a.append(scaled_a(p_, t14_, k_, inc=np.pi/2))",
        "systematics parameters",
        "log flux uncertainty",
        "fwhm1,fwhm2,fwhm3= fwhms",
        "unc1,unc2,unc3   = uncs",
        "without ldp",
        "with ldp",
        "------------------MCMC---------------------#",
        "set-up",
        "random initial condition",
        "pos0 = sample_ball(theta_sys, [1e-4]*ndim, nwalkers)",
        "load results of previous mcmc runs",
        "begin mcmc: 1st stage",
        "visualize 1st stage",
        "ls, lc = ['-','--','--'], ['k', '0.5', '0.5']",
        "percs = [np.percentile(sampler.chain2[:,:,i], [50,16,84], 0) for i in range(ndim)]",
        "[[axs.flat[i].plot(percs[i][j], c=lc[j], ls=ls[j]) for j in range(3)] for i in range(ndim)]",
        "check and discard burn-in stage",
        "import pdb",
        "pdb.set_trace()",
        "set burn: burn = 1000, say then press c",
        "save chain",
        "np.allclose(sample_chain.shape,chain.shape)",
        "restart mcmc: 1st stage",
        "save chain",
        "np.allclose(sample_chain.shape,chain.shape)",
        "visualize 2nd stage",
        "ls, lc = ['-','--','--'], ['k', '0.5', '0.5']",
        "percs = [np.percentile(sampler.chain2[:,:,i], [50,16,84], 0) for i in range(ndim)]",
        "[[axs.flat[i].plot(percs[i][j], c=lc[j], ls=ls[j]) for j in range(3)] for i in range(ndim)]"
    ],
    "docstrings": [
        "'''\n1. cd corot5b\n2. ssh_todai\n3. tmux new -s corot5b\n4. source activate astroconda/3\n5. cd corot5b\n6. python mcmc_sript_corot5b.py\n\nUses theta_post.csv as input to new mcmc run.\n'''",
        "\"\"\"\n    Winn 2014 (\"Transits and Occultations\"), eq. 14\n    \"\"\"",
        "'''\n    p is an argument because it is well known from previous observation\n    '''",
        "'''\n    objective function is ordinary least squares\n    c.f. chi-quared which includes point-wise sigma\n    '''"
    ],
    "functions": [
        "scaled_a",
        "q_to_u",
        "model_q",
        "obj",
        "model_s",
        "loglike",
        "logprior",
        "logprob"
    ],
    "classes": []
}