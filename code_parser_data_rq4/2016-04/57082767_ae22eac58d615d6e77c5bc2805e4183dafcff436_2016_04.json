{
    "identifiers": [
        "Collections",
        "Generic",
        "Linq",
        "KSP",
        "UI",
        "Screens",
        "KSP",
        "UI",
        "Screens",
        "Flight",
        "UnityEngine",
        "JSIAdvTransparentPods",
        "PartModule",
        "KSPField",
        "Empty",
        "KSPField",
        "KSPField",
        "Empty",
        "KSPField",
        "KSPField",
        "KSPField",
        "KSPField",
        "isPersistant",
        "guiActive",
        "guiActiveEditor",
        "guiName",
        "KSPEvent",
        "active",
        "guiActive",
        "guiActiveUnfocused",
        "guiActiveEditor",
        "unfocusedRange",
        "name",
        "guiName",
        "transparentPodSetting",
        "transparentPodSetting",
        "transparentPodSetting",
        "transparentPodSetting",
        "Transform",
        "Shader",
        "Transform",
        "Shader",
        "Quaternion",
        "StartState",
        "state",
        "JSIAdvPodsUtil",
        "Log_Debug",
        "part",
        "craftID",
        "part",
        "name",
        "state",
        "state",
        "StartState",
        "Editor",
        "disableLoadingInEditor",
        "DepthMaskShader",
        "Shader",
        "Find",
        "DepthMaskShaderName",
        "distanceToCameraThreshold",
        "distanceToCameraThreshold",
        "IsNullOrEmpty",
        "opaqueShaderName",
        "opaqueShader",
        "Shader",
        "Find",
        "opaqueShaderName",
        "transparentShader",
        "JSIAdvPodsUtil",
        "Log",
        "opaqueShaderName",
        "hasOpaqueShader",
        "state",
        "StartState",
        "Editor",
        "JSIAdvPodsUtil",
        "SetCameraCullingMaskForIVA",
        "GameEvents",
        "onVesselChange",
        "Add",
        "CheckStowaways",
        "part",
        "internalModel",
        "part",
        "CreateInternalModel",
        "e",
        "JSIAdvPodsUtil",
        "Log",
        "Debug",
        "LogException",
        "e",
        "part",
        "internalModel",
        "part",
        "partInfo",
        "JSIAdvPodsUtil",
        "Log_Debug",
        "cfg",
        "GameDatabase",
        "Instance",
        "GetConfigs",
        "cfg",
        "url",
        "part",
        "partInfo",
        "partUrl",
        "cfg",
        "config",
        "GetNode",
        "FirstOrDefault",
        "ipNameNode",
        "part",
        "internalModel",
        "part",
        "AddInternalPart",
        "ipNameNode",
        "IsNullOrEmpty",
        "transparentTransforms",
        "transparentShader",
        "Shader",
        "Find",
        "transparentShaderName",
        "ex",
        "JSIAdvPodsUtil",
        "Log",
        "transparentShaderName",
        "ex",
        "transparentShader",
        "JSIAdvPodsUtil",
        "Log",
        "transparentShaderName",
        "transformName",
        "transparentTransforms",
        "Split",
        "part",
        "FindModelTransform",
        "transformName",
        "Trim",
        "tr",
        "tr",
        "GetComponent",
        "Renderer",
        "material",
        "shader",
        "tr",
        "GetComponent",
        "Renderer",
        "material",
        "shader",
        "transparentShader",
        "shadersBackup",
        "Add",
        "tr",
        "backupShader",
        "part",
        "internalModel",
        "part",
        "internalModel",
        "FindModelTransform",
        "transformName",
        "Trim",
        "itr",
        "itr",
        "GetComponent",
        "Renderer",
        "material",
        "shader",
        "itr",
        "GetComponent",
        "Renderer",
        "material",
        "shader",
        "transparentShader",
        "shadersBackup",
        "Add",
        "itr",
        "backupShader",
        "e",
        "Debug",
        "LogException",
        "e",
        "part",
        "internalModel",
        "state",
        "StartState",
        "Editor",
        "part",
        "internalModel",
        "transform",
        "localRotation",
        "MagicalVoodooRotation",
        "EditorSetDepthMaskOff",
        "ResetIVA",
        "JSIAdvPodsUtil",
        "Log",
        "GameEvents",
        "onVesselChange",
        "Remove",
        "CheckStowaways",
        "state",
        "restoreShadersOnIVA",
        "state",
        "KeyValuePair",
        "Transform",
        "Shader",
        "backup",
        "shadersBackup",
        "backup",
        "Key",
        "backup",
        "Key",
        "GetComponent",
        "Renderer",
        "material",
        "shader",
        "transparentShader",
        "KeyValuePair",
        "Transform",
        "Shader",
        "backup",
        "shadersBackup",
        "backup",
        "Key",
        "backup",
        "Key",
        "GetComponent",
        "Renderer",
        "material",
        "shader",
        "hasOpaqueShader",
        "opaqueShader",
        "backup",
        "Value",
        "part",
        "internalModel",
        "MeshRenderer",
        "GetComponentsInChildren",
        "MeshRenderer",
        "i",
        "meshRenderers",
        "Length",
        "i",
        "meshRenderers",
        "i",
        "meshRenderer",
        "material",
        "shader",
        "DepthMaskShader",
        "meshRenderer",
        "enabled",
        "SkinnedMeshRenderer",
        "GetComponentsInChildren",
        "SkinnedMeshRenderer",
        "j",
        "skinnedMeshRenderers",
        "Length",
        "j",
        "skinnedMeshRenderers",
        "j",
        "skinnedMeshRenderer",
        "material",
        "shader",
        "DepthMaskShader",
        "skinnedMeshRenderer",
        "enabled",
        "Time",
        "timeSinceLevelLoad",
        "mouseOver",
        "HighLogic",
        "LoadedSceneIsFlight",
        "JSIAdvPodsUtil",
        "Log_Debug",
        "part",
        "name",
        "part",
        "craftID",
        "vessel",
        "rootPart",
        "knownRootPart",
        "JSIAdvPodsUtil",
        "UserIsInPod",
        "part",
        "JSIAdvPodsUtil",
        "Log_Debug",
        "part",
        "partName",
        "CameraManager",
        "Instance",
        "SetCameraFlight",
        "part",
        "internalModel",
        "Destroy",
        "part",
        "internalModel",
        "gameObject",
        "part",
        "internalModel",
        "part",
        "SpawnIVA",
        "part",
        "internalModel",
        "SetVisible",
        "setVisible",
        "knownRootPart",
        "vessel",
        "rootPart",
        "lastActiveVessel",
        "FlightGlobals",
        "ActiveVessel",
        "ex",
        "JSIAdvPodsUtil",
        "Log_Debug",
        "ex",
        "Vessel",
        "vsl",
        "FlightGlobals",
        "ActiveVessel",
        "id",
        "vessel",
        "id",
        "part",
        "internalModel",
        "i",
        "part",
        "internalModel",
        "seats",
        "Count",
        "i",
        "part",
        "internalModel",
        "seats",
        "i",
        "kerbalRef",
        "Portraits",
        "DestroyPortrait",
        "part",
        "internalModel",
        "seats",
        "i",
        "kerbalRef",
        "JSIAdvPodsUtil",
        "Log_Debug",
        "part",
        "internalModel",
        "seats",
        "i",
        "kerbalRef",
        "crewMemberName",
        "Time",
        "timeSinceLevelLoad",
        "HighLogic",
        "LoadedSceneIsEditor",
        "part",
        "internalModel",
        "SetVisible",
        "SetShaders",
        "VoodooRotate",
        "setVisible",
        "transparentPodSetting",
        "transparentPodSetting",
        "mouseOver",
        "SetShaders",
        "part",
        "internalModel",
        "part",
        "internalModel",
        "SetVisible",
        "setVisible",
        "EditorSetDepthMaskOff",
        "vessel",
        "rootPart",
        "knownRootPart",
        "lastActiveVessel",
        "FlightGlobals",
        "ActiveVessel",
        "part",
        "internalModel",
        "ResetIVA",
        "CameraManager",
        "Instance",
        "InternalSpace",
        "Instance",
        "vessel",
        "isActiveVessel",
        "JSIAdvTransparentPods",
        "Instance",
        "StockOverlayCamIsOn",
        "LoadGlobals",
        "settings",
        "LoadedInactive",
        "part",
        "internalModel",
        "part",
        "internalModel",
        "SetVisible",
        "setVisible",
        "SetShaders",
        "JSIAdvPodsUtil",
        "Log_Debug",
        "part",
        "craftID",
        "vessel",
        "vesselName",
        "vessel",
        "isActiveVessel",
        "part",
        "internalModel",
        "part",
        "vessel",
        "transform",
        "position",
        "part",
        "vessel",
        "transform",
        "rotation",
        "part",
        "orgPos",
        "part",
        "internalModel",
        "transform",
        "position",
        "InternalSpace",
        "WorldToInternal",
        "VesselPosition",
        "part",
        "vessel",
        "transform",
        "rotation",
        "part",
        "orgRot",
        "part",
        "internalModel",
        "transform",
        "rotation",
        "InternalSpace",
        "WorldToInternal",
        "VesselRotation",
        "MagicalVoodooRotation",
        "transparentPodSetting",
        "transparentPodSetting",
        "mouseOver",
        "SetShaders",
        "JSIAdvTransparentPods",
        "Instance",
        "PartstoFilterfromIVADict",
        "Contains",
        "part",
        "JSIAdvTransparentPods",
        "Instance",
        "PartstoFilterfromIVADict",
        "Add",
        "part",
        "setVisible",
        "part",
        "internalModel",
        "vessel",
        "isActiveVessel",
        "part",
        "transform",
        "FlightCamera",
        "fetch",
        "transform",
        "heading",
        "x",
        "thisPart",
        "position",
        "x",
        "flightCamera",
        "position",
        "x",
        "heading",
        "y",
        "thisPart",
        "position",
        "y",
        "flightCamera",
        "position",
        "y",
        "heading",
        "z",
        "thisPart",
        "position",
        "z",
        "flightCamera",
        "position",
        "z",
        "heading",
        "x",
        "heading",
        "x",
        "heading",
        "y",
        "heading",
        "y",
        "heading",
        "z",
        "heading",
        "z",
        "distanceToCamera",
        "Mathf",
        "Sqrt",
        "distanceSquared",
        "distanceToCamera",
        "distanceToCameraThreshold",
        "SetShaders",
        "JSIAdvTransparentPods",
        "Instance",
        "PartstoFilterfromIVADict",
        "Contains",
        "part",
        "JSIAdvTransparentPods",
        "Instance",
        "PartstoFilterfromIVADict",
        "Add",
        "part",
        "setVisible",
        "LoadGlobals",
        "settings",
        "LoadedInactive",
        "JSIAdvTransparentPods",
        "Instance",
        "setVisible",
        "CameraManager",
        "Instance",
        "currentCameraMode",
        "CameraManager",
        "CameraMode",
        "Flight",
        "JSIAdvTransparentPods",
        "Instance",
        "IVAcameraTransform",
        "GameObject",
        "transform",
        "IVAtoWorld",
        "position",
        "InternalSpace",
        "InternalToWorld",
        "part",
        "internalModel",
        "transform",
        "position",
        "IVAtoWorld",
        "rotation",
        "InternalSpace",
        "InternalToWorld",
        "part",
        "internalModel",
        "transform",
        "rotation",
        "GameObject",
        "transform",
        "IVACameratoWorld",
        "position",
        "InternalSpace",
        "InternalToWorld",
        "JSIAdvTransparentPods",
        "Instance",
        "IVAcameraTransform",
        "position",
        "IVAtoWorld",
        "rotation",
        "InternalSpace",
        "InternalToWorld",
        "JSIAdvTransparentPods",
        "Instance",
        "IVAcameraTransform",
        "rotation",
        "JSIAdvPodsUtil",
        "IsIVAObstructed",
        "IVAtoWorld",
        "JSIAdvTransparentPods",
        "Instance",
        "IVAcameraTransform",
        "JSIAdvTransparentPods",
        "Instance",
        "PartstoFilterfromIVADict",
        "Contains",
        "part",
        "JSIAdvTransparentPods",
        "Instance",
        "PartstoFilterfromIVADict",
        "Add",
        "part",
        "IVAtoWorld",
        "gameObject",
        "DestroyGameObject",
        "IVACameratoWorld",
        "gameObject",
        "DestroyGameObject",
        "SetShaders",
        "JSIAdvTransparentPods",
        "Instance",
        "PartstoFilterfromIVADict",
        "Contains",
        "part",
        "JSIAdvTransparentPods",
        "Instance",
        "PartstoFilterfromIVADict",
        "Remove",
        "part",
        "setVisible",
        "part",
        "internalModel",
        "SetVisible",
        "JSIAdvPodsUtil",
        "Log",
        "part",
        "craftID",
        "part",
        "internalModel",
        "transform",
        "parent",
        "part",
        "transform",
        "part",
        "internalModel",
        "transform",
        "localRotation",
        "MagicalVoodooRotation",
        "part",
        "internalModel",
        "transform",
        "localPosition",
        "Vector3",
        "zero",
        "part",
        "internalModel",
        "transform",
        "localScale",
        "Vector3",
        "one",
        "mouseOver"
    ],
    "literals": [
        "\"Legacy Shaders/Transparent/Specular\"",
        "\"TransparentPod\"",
        "\"ON\"",
        "\"eventToggleTransparency\"",
        "\"TransparentPod\"",
        "\"ON\"",
        "\"OFF\"",
        "\"OFF\"",
        "\"AUTO\"",
        "\"ON\"",
        "\"DepthMask\"",
        "\"The windows of this capsule have had advanced cleaning.\"",
        "\"OnStart {0} {1} in state {2}\"",
        "\"opaqueShader {0} not found.\"",
        "\"Main Camera\"",
        "\"failed to create internal model in Onstart\"",
        "\"Let's see if anyone included parts so I can assemble the interior\"",
        "\"PART\"",
        "\"INTERNAL\"",
        "\"Get transparentShader {0} failed. Error: {1}\"",
        "\"transparentShader {0} not found.\"",
        "\"Wait, where's my internal model?\"",
        "\"Need to reset IVA in part {0}({1})\"",
        "\"The user is in pod {0} and I need to kick them out.\"",
        "\"Reset IVA failed: {0}\"",
        "\"Unregister Portrait on inactive part failed {0}\"",
        "\"OFF\"",
        "\"AUTO\"",
        "\"Internal turned off as vessel is Not Active Vessel and stock overlay is on or LoadedInactive is False: ({0}) {1}\"",
        "\"OFF\"",
        "\"AUTO\"",
        "\"Where is my Internal model for : {0}\""
    ],
    "variables": [
        "transparentTransforms",
        "transparentShaderName",
        "opaqueShaderName",
        "restoreShadersOnIVA",
        "disableLoadingInEditor",
        "distanceToCameraThreshold",
        "transparentPodSetting",
        "Part",
        "knownRootPart",
        "Vessel",
        "lastActiveVessel",
        "Shader",
        "transparentShader",
        "opaqueShader",
        "DepthMaskShader",
        "hasOpaqueShader",
        "DepthMaskShaderName",
        "shadersBackup",
        "mouseOver",
        "setVisible",
        "distanceToCamera",
        "frameCounter",
        "Quaternion",
        "MagicalVoodooRotation",
        "ConfigNode",
        "ipNameNode",
        "Transform",
        "tr",
        "Shader",
        "backupShader",
        "Transform",
        "itr",
        "Shader",
        "backupShader",
        "meshRenderers",
        "i",
        "MeshRenderer",
        "meshRenderer",
        "skinnedMeshRenderers",
        "j",
        "SkinnedMeshRenderer",
        "skinnedMeshRenderer",
        "i",
        "Vector3",
        "VesselPosition",
        "Quaternion",
        "VesselRotation",
        "Vector3",
        "heading",
        "Transform",
        "thisPart",
        "Transform",
        "flightCamera",
        "distanceSquared",
        "Transform",
        "IVAtoWorld",
        "Transform",
        "IVACameratoWorld"
    ],
    "comments": [
        "ON = transparentpod on, OFF = transparentpod off, AUTO = on when focused.",
        "We still need this for Editor Mode?",
        "Early out for people who want to disable transparency in",
        "the editor due to low-spec computers.",
        "In Editor, the camera we want to change is called \"Main Camera\". In flight, the camera to change is",
        "\"Camera 00\", i.e. close range camera.",
        "I'm not sure if this change is actually needed, even. Main Camera's culling mask seems to already include IVA objects,",
        "they just don't normally spawn them.",
        "If the internal model has not yet been created, try creating it and log the exception if we fail.",
        "KSP 1.0.x introduced a new feature where it doesn't appear",
        "to fully load parts if they're not the root.  In particular,",
        "that CreateInternalModel() call above here returns null for",
        "non-root parts until one exits the VAB and returns.",
        "If the internalModel doesn't exist yet, I find the config",
        "for this part, extract the INTERNAL node, and try to create",
        "the model myself. Awfully roundabout.",
        "Apply shaders to transforms on startup.",
        "We both change the shader and backup the original shader so we can undo it later.",
        "We both change the shader and backup the original shader so we can undo it later.",
        "If we ended up with an existing internal model,",
        "Rotate it now, so that it is shown correctly in the editor. - OLD Method.",
        "Just rotating the internal is sufficient in this case.",
        "Find all Renderer's with DepthMask shader assigned to them and make them inactive as they cause Z-Fighting in the Editor and are",
        "not needed in the editor - OLD Method.",
        "Else this is our first startup in flight scene, we reset the IVA.",
        "Some error-proofing. I won't bother doing this every frame, because one error message",
        "should suffice, this module is not supposed to be attached to parts that have no internals in the first place.",
        "For some reason we need to keep turning off the Renderers with the DepthMask Shader..",
        "Reset the mouseOver flag.",
        "Now the cruical bit.",
        "If the root part changed, we actually need to recreate the IVA forcibly even if it still exists.",
        "In this case we also need to kick the user out of IVA if they're currently in our pod,",
        "otherwise lots of things screw up in a bizarre fashion.",
        "But otherwise the existing one will serve.",
        "If the internal model doesn't yet exist, this call will implicitly create it anyway.",
        "It will also initialise it, which in this case implies moving it into the correct location in internal space",
        "and populate it with crew, which is what we want.",
        "And then we remember the root part and the active vessel these coordinates refer to.",
        "Now we need to make sure that the list of portraits in the GUI conforms to what actually is in the active vessel.",
        "This is important because IVA/EVA buttons clicked on kerbals that are not in the active vessel cause problems",
        "that I can't readily debug, and it shouldn't happen anyway.",
        "Only the pods that are not the active vessel should be doing this. So if this part/vessel is not part of the active vessel then:-",
        "Search the seats and where there is a kerbalRef try to Unregister them from the PortraitGallery.",
        "In the editor, none of this logic should matter, even though the IVA probably exists already.",
        "Make the internal model visible...",
        "And for a good measure we make sure the shader change has been applied.",
        "Now we attach the restored IVA directly into the pod at zero local coordinates and rotate it,",
        "so that it shows up on the main outer view camera in the correct location.",
        "If we are in editor mode we need to turn off the internal if the internal is in OFF or AUTO mode and not moused over.",
        "Otherwise we make it visible.",
        "Now FlightScene Processing",
        "If the root part changed, or the IVA is mysteriously missing, we reset it and take note of where it ended up.",
        "If we are in flight and the user has the Stock Overlay on and this part is not part of the active vessel we turn off the internal.",
        "also if the user has set the LoadedInactive to False - we don't show TransparentPods that aren't on the active vessel.",
        "We turn it off rather than registering it for the PreCull list because if Stock Overlay is on the JSI camera is not active.",
        "For some reason (probably performance) Squad do not actively update the position and rotation of InternalModels that are not part of the active vessel.",
        "Calculate the Vessel position and rotation and then apply that to the InternalModel position and rotation with the MagicalVoodooRotation.",
        "If transparentPodSetting = OFF or AUTO and not the focused active part we treat the part like a non-transparent part.",
        "and we turn off the shaders (if set) and the internal to the filter list and exit OnUpdate.",
        "part.internalModel.SetVisible(false);",
        "So we do have an internal model, right?",
        "If the current part is not part of the active vessel, we calculate the distance from the part to the flight camera.",
        "If this distance is > distanceToCameraThreshold metres we turn off transparency for the part.",
        "Uses Maths calcs intead of built in Unity functions as this is up to 5 times faster.",
        "part.internalModel.SetVisible(false);",
        "If inactive vessel IVAs are turned on via the settings then we:",
        "Check for obstructions between this IVA and the Camera that may be on lower layers and turn off the IVA if there is one.",
        "Not a perfect solution..... and bad performance-wise.",
        "Make the internal model visible...",
        "And for a good measure we make sure the shader change has been applied.",
        "Now we attach the restored IVA directly into the pod at zero local coordinates and rotate it,",
        "so that it shows up on the main outer view camera in the correct location.",
        "When mouse is over this part set a flag for the transparentPodSetting = \"AUTO\" setting."
    ],
    "docstrings": [
        "***************************************************************************\n * JSIAdvTransparentPods\n * =====================\n * Plugin for Kerbal Space Program\n *\n * Re-Written by JPLRepo (Jamie Leighton).\n * Based on original JSITransparentPod by Mihara (Eugene Medvedev), \n * MOARdV, and other contributors\n * JSIAdvTransparentPods has been split off from the main RasterPropMonitor\n * project and distrubtion files and will be maintained and distributed \n * separately going foward. But as with all free software the license \n * continues to be the same as the original RasterPropMonitor license:\n * JSIAdvTransparentPods is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, revision\n * date 29 June 2007, or (at your option) any later version.\n * \n * RJSIAdvTransparentPods is distributed in the hope that it will be useful, but\n * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n * for more details.\n * \n * You should have received a copy of the GNU General Public License\n * along with JSIAdvTransparentPods.  If not, see <http://www.gnu.org/licenses/>.\n ***************************************************************************"
    ],
    "functions": [
        "eventToggleTransparency",
        "GetInfo",
        "OnStart",
        "OnDestroy",
        "SetShaders",
        "EditorSetDepthMaskOff",
        "LateUpdate",
        "ResetIVA",
        "CheckStowaways",
        "OnUpdate",
        "VoodooRotate",
        "OnMouseOver"
    ],
    "classes": [
        "JSIAdvTransparentPod"
    ]
}