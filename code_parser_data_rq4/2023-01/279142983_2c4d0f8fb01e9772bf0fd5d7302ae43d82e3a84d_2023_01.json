{
    "identifiers": [
        "datetime",
        "timedelta",
        "discord",
        "ext",
        "vbu",
        "tasks",
        "cogs",
        "utils",
        "vbu",
        "Cog",
        "utils",
        "types",
        "Bot",
        "bot",
        "bot",
        "plant_death_timeout_loop",
        "start",
        "plant_death_timeout_loop",
        "stop",
        "staticmethod",
        "db",
        "vbu",
        "Database",
        "utils",
        "types",
        "PlantLevelsRow",
        "db",
        "call",
        "utils",
        "constants",
        "DEATH_TIMEOUT",
        "utils",
        "types",
        "PlantLevelsRow",
        "staticmethod",
        "db",
        "vbu",
        "Database",
        "row",
        "utils",
        "types",
        "PlantLevelsRow",
        "db",
        "call",
        "row",
        "row",
        "staticmethod",
        "db",
        "vbu",
        "Database",
        "db",
        "call",
        "tasks",
        "loop",
        "minutes",
        "vbu",
        "Database",
        "db",
        "kill_plants",
        "db",
        "row",
        "dead_plants",
        "update_plant_death_count",
        "db",
        "row",
        "update_max_plant_lifetime",
        "db",
        "plant_death_timeout_loop",
        "before_loop",
        "bot",
        "wait_until_ready",
        "bot",
        "utils",
        "types",
        "Bot",
        "PlantDeathTimeout",
        "bot",
        "bot",
        "add_cog",
        "x"
    ],
    "literals": [
        "'user_id'",
        "'plant_type'"
    ],
    "variables": [
        "dead_plants",
        "x"
    ],
    "comments": [
        "Kill any dead plants",
        "Add counter for plant dying",
        "Update max plant lifetime"
    ],
    "docstrings": [
        "\"\"\"\n        Kill any dead plants in the database.\n        \"\"\"",
        "\"\"\"\n            UPDATE\n                plant_levels\n            SET\n                plant_nourishment = -plant_levels.plant_nourishment\n            WHERE\n                plant_nourishment > 0\n            AND\n                last_water_time + $1 < TIMEZONE('UTC', NOW())\n            AND\n                immortal = FALSE\n            RETURNING\n                *\n            \"\"\"",
        "\"\"\"\n        Update the plant's death count.\n        \"\"\"",
        "\"\"\"\n            INSERT INTO\n                plant_achievement_counts\n                (\n                    user_id,\n                    plant_type,\n                    plant_death_count\n                )\n            VALUES\n                (\n                    $1,\n                    $2,\n                    1\n                )\n            ON CONFLICT\n                (user_id, plant_type)\n            DO UPDATE\n            SET\n                plant_death_count = plant_death_count + excluded.plant_death_count\n            \"\"\"",
        "\"\"\"\n        Set the maximum plant lifetime.\n        \"\"\"",
        "\"\"\"\n            INSERT INTO\n                user_achievement_counts\n                (\n                    user_id,\n                    max_plant_lifetime\n                )\n            (\n                SELECT\n                    user_id,\n                    MAX(TIMEZONE('UTC', NOW()) - plant_adoption_time)\n                FROM\n                    plant_levels\n                WHERE\n                    plant_levels.plant_nourishment > 0\n                AND\n                    immortal=FALSE\n                GROUP BY\n                    user_id\n            )\n            ON CONFLICT\n                (user_id)\n            DO UPDATE\n            SET\n                max_plant_lifetime = GREATEST(\n                    user_achievement_counts.max_plant_lifetime,\n                    excluded.max_plant_lifetime\n                )\n            WHERE\n                user_achievement_counts.user_id = excluded.user_id\n            \"\"\"",
        "\"\"\"\n        Loop to see if we should kill off any plants that\n        may have been timed out.\n        \"\"\""
    ],
    "functions": [
        "cog_unload",
        "kill_plants",
        "update_plant_death_count",
        "update_max_plant_lifetime",
        "plant_death_timeout_loop",
        "before_plant_death_timeout_loop",
        "setup"
    ],
    "classes": [
        "PlantDeathTimeout"
    ]
}