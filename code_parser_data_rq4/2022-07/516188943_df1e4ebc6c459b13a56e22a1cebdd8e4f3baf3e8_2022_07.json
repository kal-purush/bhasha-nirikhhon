{
    "identifiers": [
        "unicode_literals",
        "datetime",
        "re",
        "time",
        "unicodedata",
        "urllib",
        "parse",
        "urlparse",
        "urlencode",
        "django",
        "conf",
        "settings",
        "django",
        "utils",
        "translation",
        "ugettext",
        "_",
        "django",
        "contrib",
        "auth",
        "login",
        "auth_login",
        "logout",
        "auth_logout",
        "django",
        "contrib",
        "auth",
        "forms",
        "AuthenticationForm",
        "django",
        "contrib",
        "auth",
        "views",
        "redirect_to_login",
        "django",
        "contrib",
        "sites",
        "shortcuts",
        "get_current_site",
        "django",
        "http",
        "HttpResponseRedirect",
        "HttpResponse",
        "django",
        "shortcuts",
        "resolve_url",
        "django",
        "template",
        "response",
        "TemplateResponse",
        "django",
        "utils",
        "timezone",
        "common",
        "log",
        "logger",
        "blueapps",
        "account",
        "encryption",
        "encrypt",
        "decrypt",
        "salt",
        "blueapps",
        "account",
        "models",
        "Loignlog",
        "BkToken",
        "cls",
        "args",
        "kwargs",
        "isinstance",
        "cls",
        "_instance",
        "cls",
        "__new__",
        "cls",
        "args",
        "kwargs",
        "cls",
        "_instance",
        "AccountSingleton",
        "settings",
        "BK_COOKIE_NAME",
        "settings",
        "BK_COOKIE_AGE",
        "settings",
        "LOGIN_URL",
        "settings",
        "BK_TOKEN_OFFSET_ERROR_TIME",
        "url",
        "host",
        "url",
        "url",
        "strip",
        "url",
        "url",
        "replace",
        "url",
        "startswith",
        "urlparse",
        "url",
        "url_info",
        "netloc",
        "url_info",
        "scheme",
        "unicodedata",
        "category",
        "url",
        "url_info",
        "netloc",
        "split",
        "split",
        "url_info",
        "netloc",
        "host",
        "split",
        "split",
        "host",
        "url_info",
        "netloc",
        "url_domain",
        "host_domain",
        "url_info",
        "scheme",
        "url_info",
        "scheme",
        "username",
        "time",
        "time",
        "bk_token",
        "retry_count",
        "time",
        "time",
        "now_time",
        "BK_COOKIE_AGE",
        "expire_time",
        "username",
        "salt",
        "encrypt",
        "plain_token",
        "BkToken",
        "objects",
        "create",
        "token",
        "bk_token",
        "error",
        "logger",
        "exception",
        "format",
        "error",
        "retry_count",
        "bk_token",
        "retry_count",
        "bk_token",
        "datetime",
        "datetime",
        "fromtimestamp",
        "expire_time",
        "timezone",
        "get_current_timezone",
        "bk_token",
        "decrypt",
        "bk_token",
        "error",
        "logger",
        "exception",
        "format",
        "error",
        "_",
        "plain_bk_token",
        "error_msg",
        "plain_bk_token",
        "split",
        "error",
        "logger",
        "exception",
        "format",
        "error",
        "token_info",
        "bk_token",
        "bk_token",
        "_",
        "error_msg",
        "_decrypt_token",
        "bk_token",
        "ok",
        "error_msg",
        "token_info",
        "len",
        "token_info",
        "error_msg",
        "BkToken",
        "objects",
        "get",
        "token",
        "bk_token",
        "is_logout",
        "BkToken",
        "DoesNotExist",
        "_",
        "error_msg",
        "token_info",
        "time",
        "time",
        "is_logout",
        "_",
        "error_msg",
        "now_time",
        "expire_time",
        "BK_TOKEN_OFFSET_ERROR_TIME",
        "_",
        "error_msg",
        "expire_time",
        "now_time",
        "BK_COOKIE_AGE",
        "BK_TOKEN_OFFSET_ERROR_TIME",
        "_",
        "error_msg",
        "token_info",
        "username",
        "request",
        "request",
        "COOKIES",
        "get",
        "BK_COOKIE_NAME",
        "_is_bk_token_valid",
        "bk_token",
        "request",
        "response",
        "request",
        "COOKIES",
        "get",
        "BK_COOKIE_NAME",
        "bk_token",
        "BkToken",
        "objects",
        "token",
        "bk_token",
        "update",
        "is_logout",
        "response",
        "response",
        "delete_cookie",
        "BK_COOKIE_NAME",
        "domain",
        "settings",
        "BK_COOKIE_DOMAIN",
        "response",
        "request",
        "user",
        "app_id",
        "request",
        "get_host",
        "request",
        "META",
        "get",
        "request",
        "META",
        "get",
        "Loignlog",
        "objects",
        "record_login",
        "user",
        "login_browser",
        "login_ip",
        "host",
        "app_id",
        "request",
        "request",
        "is_ajax",
        "HttpResponse",
        "status",
        "request",
        "build_absolute_uri",
        "resolve_url",
        "BK_LOGIN_URL",
        "urlparse",
        "resolved_login_url",
        "urlparse",
        "path",
        "login_scheme",
        "login_scheme",
        "current_scheme",
        "login_netloc",
        "login_netloc",
        "current_netloc",
        "settings",
        "SITE_URL",
        "request",
        "get_full_path",
        "redirect_to_login",
        "path",
        "resolved_login_url",
        "REDIRECT_FIELD_NAME",
        "request",
        "template_name",
        "authentication_form",
        "AuthenticationForm",
        "current_app",
        "extra_context",
        "re",
        "match",
        "request",
        "path",
        "REDIRECT_FIELD_NAME",
        "request",
        "POST",
        "get",
        "redirect_field_name",
        "request",
        "GET",
        "get",
        "redirect_field_name",
        "request",
        "POST",
        "get",
        "request",
        "GET",
        "get",
        "request",
        "method",
        "authentication_form",
        "request",
        "data",
        "request",
        "POST",
        "form",
        "is_valid",
        "login_success_response",
        "request",
        "form",
        "redirect_to",
        "app_id",
        "authentication_form",
        "request",
        "get_current_site",
        "request",
        "form",
        "redirect_field_name",
        "redirect_to",
        "current_site",
        "current_site",
        "name",
        "extra_context",
        "context",
        "update",
        "extra_context",
        "current_app",
        "current_app",
        "TemplateResponse",
        "request",
        "template_name",
        "context",
        "set_bk_token_invalid",
        "request",
        "response",
        "response",
        "request",
        "next_page",
        "REDIRECT_FIELD_NAME",
        "auth_logout",
        "request",
        "redirect_field_name",
        "request",
        "POST",
        "redirect_field_name",
        "request",
        "GET",
        "request",
        "POST",
        "get",
        "redirect_field_name",
        "request",
        "GET",
        "get",
        "redirect_field_name",
        "is_safe_url",
        "url",
        "next_page",
        "host",
        "request",
        "get_host",
        "request",
        "path",
        "next_page",
        "HttpResponseRedirect",
        "next_page",
        "HttpResponseRedirect",
        "format",
        "BK_LOGIN_URL",
        "set_bk_token_invalid",
        "request",
        "response",
        "response",
        "request",
        "redirect_to",
        "app_id",
        "BK_LOGIN_URL",
        "redirect_to",
        "REDIRECT_FIELD_NAME",
        "redirect_to",
        "app_id",
        "app_id",
        "len",
        "query",
        "format",
        "BK_LOGIN_URL",
        "urlencode",
        "query",
        "HttpResponseRedirect",
        "redirect_url",
        "set_bk_token_invalid",
        "request",
        "response",
        "response",
        "request",
        "user_or_form",
        "redirect_to",
        "app_id",
        "isinstance",
        "user_or_form",
        "AuthenticationForm",
        "user_or_form",
        "get_user",
        "user_or_form",
        "cleaned_data",
        "get",
        "user_or_form",
        "user",
        "username",
        "is_safe_url",
        "url",
        "redirect_to",
        "host",
        "request",
        "get_host",
        "resolve_url",
        "format",
        "settings",
        "SITE_URL",
        "auth_login",
        "request",
        "user",
        "record_login_log",
        "request",
        "user",
        "app_id",
        "get_bk_token",
        "username",
        "HttpResponseRedirect",
        "redirect_to",
        "response",
        "set_cookie",
        "BK_COOKIE_NAME",
        "bk_token",
        "expires",
        "expire_time",
        "domain",
        "settings",
        "BK_COOKIE_DOMAIN",
        "httponly",
        "response",
        "request",
        "redirect_url",
        "is_from_logout",
        "HttpResponseRedirect",
        "redirect_url",
        "is_from_logout",
        "set_bk_token_invalid",
        "request",
        "response",
        "response"
    ],
    "literals": [
        "'c_url'",
        "'\\\\'",
        "'/'",
        "'///'",
        "'C'",
        "':'",
        "'.'",
        "''",
        "':'",
        "'.'",
        "''",
        "'http'",
        "'https'",
        "''",
        "'%s|%s|%s'",
        "'Login ticket failed to be saved during ticket generation, error: {}'",
        "''",
        "''",
        "\"Parameter parse failed, error: {}\"",
        "\"参数bk_token非法\"",
        "'|'",
        "\"token info wrong, error: {}\"",
        "\"缺少参数bk_token\"",
        "\"不存在该bk_token的记录\"",
        "\"登录态已注销\"",
        "\"登录态已过期\"",
        "\"登录态有效期不合法\"",
        "\"\"",
        "'HTTP_USER_AGENT'",
        "'unknown'",
        "'HTTP_X_FORWARDED_FOR'",
        "'REMOTE_ADDR'",
        "'login/login.html'",
        "r\".*/plain/$\"",
        "'login/plain_login.html'",
        "''",
        "'app_id'",
        "'app_id'",
        "''",
        "'POST'",
        "'form'",
        "'site'",
        "'site_name'",
        "\"{}?{}\"",
        "\"is_from_logout=1\"",
        "'app_id'",
        "\"{}?{}\"",
        "'username'",
        "''",
        "'{}accounts/user/list/'"
    ],
    "variables": [
        "_instance",
        "cls",
        "_instance",
        "BK_COOKIE_NAME",
        "BK_COOKIE_AGE",
        "REDIRECT_FIELD_NAME",
        "BK_LOGIN_URL",
        "BK_TOKEN_OFFSET_ERROR_TIME",
        "url",
        "url",
        "url_info",
        "url_domain",
        "host_domain",
        "bk_token",
        "expire_time",
        "retry_count",
        "now_time",
        "expire_time",
        "plain_token",
        "bk_token",
        "bk_token",
        "plain_bk_token",
        "plain_bk_token",
        "error_msg",
        "token_info",
        "token_info",
        "error_msg",
        "ok",
        "error_msg",
        "token_info",
        "is_logout",
        "error_msg",
        "expire_time",
        "now_time",
        "error_msg",
        "error_msg",
        "error_msg",
        "username",
        "bk_token",
        "bk_token",
        "host",
        "login_browser",
        "login_ip",
        "path",
        "resolved_login_url",
        "login_scheme",
        "login_netloc",
        "current_scheme",
        "current_netloc",
        "path",
        "template_name",
        "redirect_field_name",
        "redirect_to",
        "app_id",
        "form",
        "form",
        "current_site",
        "context",
        "request",
        "current_app",
        "response",
        "response",
        "redirect_field_name",
        "next_page",
        "next_page",
        "response",
        "response",
        "response",
        "redirect_url",
        "query",
        "query",
        "query",
        "redirect_url",
        "response",
        "response",
        "user",
        "username",
        "user",
        "username",
        "redirect_to",
        "bk_token",
        "expire_time",
        "response",
        "response",
        "response"
    ],
    "comments": [
        "-*- coding: utf-8 -*-",
        "noqa",
        "Avoid shadowing the login() and logout() views below.",
        "cookie名称",
        "cookie 有效期，默认为1天",
        "登录回调链接",
        "登录连接",
        "允许误差时间，防止多台机器时间误差， 1分钟",
        "Chrome treats \\ completely as /",
        "Chrome considers any URL with more than two slashes to be absolute, but",
        "urlparse is not so flexible. Treat any url with three slashes as unsafe.",
        "Forbid URLs like http:///example.com - with a scheme, but without a hostname.",
        "In that URL, example.com is not the hostname but, a path component. However,",
        "Chrome will still consider example.com to be the hostname, so we must not",
        "allow this syntax.",
        "Forbid URLs that start with control characters. Some browsers (like",
        "Chrome) ignore quite a few control characters at the start of a",
        "URL and might consider the URL as scheme relative.",
        "重试5次",
        "循环结束前将bk_token置空后重新生成",
        "参数bk_token非法",
        "token已注销",
        "token有效期已过",
        "token有效期大于当前时间的有效期",
        "delete cookie",
        "获取用户ip",
        "If the login url is the same scheme and net location then just",
        "use the path as the \"next\" url.",
        "'app_id': app_id,",
        "Security check -- don't allow redirection to a different host.",
        "Redirect to this page until the session has been cleared.",
        "Redirect to login url.",
        "将登录票据设置为不合法",
        "判读是form还是user",
        "检查回调URL是否安全，防钓鱼",
        "设置用户登录",
        "记录登录日志",
        "针对域名设置cookie",
        "NOTE: DO NOT SET THE LANGUAGE COOKIE HERE BEFORE I18N is AVAILABLE",
        "set cookie for app or platform",
        "bk_user_info, is_created = UserInfo.objects.get_or_create(user=user)",
        "response.set_cookie(conf.LANGUAGE_COOKIE_NAME, bk_user_info.language,",
        "# max_age=conf.LANGUAGE_COOKIE_AGE,",
        "expires=expire_time,",
        "path=conf.LANGUAGE_COOKIE_PATH,",
        "domain=conf.LANGUAGE_COOKIE_DOMAIN)",
        "来自注销，则需清除蓝鲸bk_token"
    ],
    "docstrings": [
        "\"\"\"\nTencent is pleased to support the open source community by making 蓝鲸智云PaaS平台社区版 (BlueKing PaaS Community Edition) available.\nCopyright (C) 2017-2018 THL A29 Limited, a Tencent company. All rights reserved.\nLicensed under the MIT License (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at\nhttp://opensource.org/licenses/MIT\nUnless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.\n\"\"\"",
        "\"\"\"\n    单例基类\n    \"\"\"",
        "\"\"\"\n    账号体系相关的基类Account\n\n    提供通用的账号功能\n    \"\"\"",
        "\"\"\"\n        判断url是否与当前host的根域一致\n\n        以下情况返回False：\n            1)根域不一致\n            2)url的scheme不为：https(s)\n            3)url为空\n        \"\"\"",
        "\"\"\"\n        生成用户的登录态\n        \"\"\"",
        "\"\"\"\n        验证用户登录态\n        \"\"\"",
        "\"\"\"\n        将登录票据设置为不合法\n        \"\"\"",
        "\"\"\"\n        记录用户登录日志\n        \"\"\"",
        "\"\"\"\n        重定向到登录页面.\n\n        登录态验证不通过时调用\n        \"\"\"",
        "\"\"\"\n        登录页面和登录动作\n        \"\"\"",
        "\"\"\"\n        登出并重定向到登录页面\n        \"\"\"",
        "\"\"\"\n        登录失败跳转，目前重定向到登录，后续可返还支持自定义的错误页面\n        \"\"\"",
        "\"\"\"\n        用户验证成功后，登录处理\n        \"\"\"",
        "\"\"\"\n        登录重定向\n        \"\"\""
    ],
    "functions": [
        "__new__",
        "is_safe_url",
        "get_bk_token",
        "_decrypt_token",
        "_is_bk_token_valid",
        "is_bk_token_valid",
        "set_bk_token_invalid",
        "record_login_log",
        "redirect_login",
        "login",
        "logout",
        "login_failed_response",
        "login_success_response",
        "login_redirect_response"
    ],
    "classes": [
        "AccountSingleton",
        "Account"
    ]
}