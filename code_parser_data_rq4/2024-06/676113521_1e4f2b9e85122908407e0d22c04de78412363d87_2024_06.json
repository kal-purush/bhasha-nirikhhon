{
    "identifiers": [
        "argparse",
        "cProfile",
        "os",
        "pstats",
        "time",
        "jax",
        "numpy",
        "np",
        "pandas",
        "pd",
        "wandb",
        "yaml",
        "nqs",
        "state",
        "nqs",
        "jax",
        "config",
        "update",
        "jax",
        "devices",
        "config_path",
        "open",
        "config_path",
        "file",
        "yaml",
        "safe_load",
        "file",
        "config",
        "nqs",
        "NQS",
        "nqs_repr",
        "backend",
        "config",
        "logger_level",
        "seed",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "base_layer_sizes",
        "config",
        "get",
        "config",
        "layer_sizes",
        "activations",
        "config",
        "config",
        "system",
        "set_wf",
        "config",
        "config",
        "config",
        "common_kwargs",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "get",
        "config",
        "config",
        "get",
        "config",
        "config",
        "config",
        "common_kwargs",
        "common_kwargs",
        "system",
        "set_wf",
        "config",
        "config",
        "config",
        "common_kwargs",
        "config",
        "system",
        "set_wf",
        "config",
        "config",
        "config",
        "nhidden",
        "config",
        "sigma2",
        "np",
        "sqrt",
        "config",
        "particle",
        "config",
        "correlation",
        "config",
        "system",
        "set_wf",
        "config",
        "config",
        "config",
        "particle",
        "config",
        "correlation",
        "config",
        "system",
        "config",
        "initialize_system",
        "config",
        "config",
        "system",
        "set_sampler",
        "mcmc_alg",
        "mcmc_alg",
        "scale",
        "np",
        "sqrt",
        "config",
        "config",
        "mcmc_alg",
        "np",
        "sqrt",
        "config",
        "system",
        "set_hamiltonian",
        "type_",
        "int_type",
        "config",
        "omega",
        "config",
        "r0_reg",
        "config",
        "training_cycles",
        "config",
        "system",
        "set_optimizer",
        "optimizer",
        "config",
        "eta",
        "config",
        "np",
        "sqrt",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "get",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "get",
        "config",
        "config",
        "get",
        "config",
        "config",
        "config",
        "config",
        "pretrain",
        "system",
        "max_iter",
        "batch_size",
        "args",
        "common_kwargs",
        "time",
        "time",
        "system",
        "train",
        "max_iter",
        "config",
        "batch_size",
        "config",
        "early_stop",
        "history",
        "tune",
        "grad_clip",
        "seed",
        "config",
        "time",
        "time",
        "time_train",
        "pd",
        "DataFrame",
        "history",
        "history",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "time",
        "time",
        "system",
        "sample",
        "config",
        "config",
        "config",
        "save_positions",
        "config",
        "foldername",
        "config",
        "time",
        "time",
        "time_sample",
        "df_all",
        "mean",
        "df_all",
        "df_all",
        "E_std_errors",
        "E_variances",
        "np",
        "sum",
        "E_weights",
        "E_means",
        "np",
        "sum",
        "E_weights",
        "np",
        "sum",
        "E_weights",
        "np",
        "sqrt",
        "E_combined_variance",
        "df_all",
        "df_all",
        "K_std_errors",
        "K_variances",
        "np",
        "sum",
        "K_weights",
        "K_means",
        "np",
        "sum",
        "K_weights",
        "np",
        "sum",
        "K_weights",
        "np",
        "sqrt",
        "K_combined_variance",
        "df_all",
        "df_all",
        "PE_trap_std_errors",
        "PE_trap_variances",
        "np",
        "sum",
        "PE_trap_weights",
        "PE_trap_means",
        "np",
        "sum",
        "PE_trap_weights",
        "np",
        "sum",
        "PE_trap_weights",
        "np",
        "sqrt",
        "PE_trap_combined_variance",
        "df_all",
        "df_all",
        "PE_int_std_errors",
        "PE_int_variances",
        "np",
        "sum",
        "PE_int_weights",
        "PE_int_means",
        "np",
        "sum",
        "PE_int_weights",
        "np",
        "sum",
        "PE_int_weights",
        "np",
        "sqrt",
        "PE_int_combined_variance",
        "E_combined_mean",
        "E_combined_std_error",
        "np",
        "mean",
        "df_all",
        "K_combined_mean",
        "K_combined_std_error",
        "PE_trap_combined_mean",
        "PE_trap_combined_std_error",
        "PE_int_combined_mean",
        "PE_int_combined_std_error",
        "accept_rate_mean",
        "config",
        "config",
        "config",
        "config",
        "config",
        "pd",
        "DataFrame",
        "combined_data",
        "df_mean",
        "values",
        "df_mean",
        "values",
        "df_mean",
        "values",
        "df_mean",
        "values",
        "df_mean",
        "values",
        "df_mean",
        "values",
        "df_mean",
        "values",
        "df_mean",
        "values",
        "np",
        "isnan",
        "final_E_error",
        "final_E_error",
        "np",
        "isnan",
        "final_K_error",
        "final_K_error",
        "np",
        "isnan",
        "final_PE_trap_error",
        "final_PE_trap_error",
        "np",
        "isnan",
        "final_PE_int_error",
        "final_PE_int_error",
        "np",
        "isnan",
        "final_E_energy",
        "final_E_energy",
        "np",
        "isnan",
        "final_K_energy",
        "final_K_energy",
        "np",
        "isnan",
        "final_PE_trap_energy",
        "final_PE_trap_energy",
        "np",
        "isnan",
        "final_PE_int_energy",
        "final_PE_int_energy",
        "final_E_error",
        "final_K_error",
        "final_PE_trap_error",
        "final_PE_int_error",
        "E_error_str",
        "split",
        "K_error_str",
        "split",
        "PE_trap_error_str",
        "split",
        "PE_int_error_str",
        "split",
        "E_error_scale",
        "K_error_scale",
        "PE_trap_error_scale",
        "PE_int_error_scale",
        "E_energy_decimal_places",
        "final_E_energy",
        "E_energy_decimal_places",
        "final_E_energy",
        "K_energy_decimal_places",
        "final_K_energy",
        "K_energy_decimal_places",
        "final_K_energy",
        "PE_trap_energy_decimal_places",
        "final_PE_trap_energy",
        "PE_trap_energy_decimal_places",
        "final_PE_trap_energy",
        "PE_int_energy_decimal_places",
        "final_PE_int_energy",
        "PE_int_energy_decimal_places",
        "final_PE_int_energy",
        "E_error_str",
        "K_error_str",
        "PE_trap_error_str",
        "PE_int_error_str",
        "E_energy_str",
        "E_energy_str",
        "K_energy_str",
        "K_energy_str",
        "PE_trap_energy_str",
        "PE_trap_energy_str",
        "PE_int_energy_str",
        "PE_int_energy_str",
        "E_energy_str",
        "E_error_first_digit",
        "K_energy_str",
        "K_error_first_digit",
        "PE_trap_energy_str",
        "PE_trap_error_first_digit",
        "PE_int_energy_str",
        "PE_int_error_first_digit",
        "formated_E_energy",
        "formated_K_energy",
        "formated_PE_trap_energy",
        "formated_PE_int_energy",
        "config",
        "config",
        "config",
        "config",
        "config",
        "np",
        "sqrt",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "config",
        "time_train",
        "time_sample",
        "os",
        "path",
        "exists",
        "config",
        "config",
        "df_mean",
        "to_csv",
        "config",
        "config",
        "index",
        "df_mean",
        "to_csv",
        "config",
        "config",
        "mode",
        "header",
        "index",
        "df_mean",
        "system",
        "max_iter",
        "batch_size",
        "args",
        "system",
        "nqs_type",
        "system",
        "nqs_type",
        "system",
        "pretrain",
        "model",
        "max_iter",
        "max_iter",
        "batch_size",
        "batch_size",
        "logger_level",
        "args",
        "args",
        "config",
        "lower",
        "system",
        "set_hamiltonian",
        "type_",
        "int_type",
        "omega",
        "config",
        "training_cycles",
        "config",
        "system",
        "train",
        "max_iter",
        "config",
        "batch_size",
        "config",
        "early_stop",
        "history",
        "tune",
        "grad_clip",
        "seed",
        "config",
        "system",
        "set_hamiltonian",
        "type_",
        "int_type",
        "config",
        "omega",
        "config",
        "r0_reg",
        "config",
        "training_cycles",
        "config",
        "system",
        "argparse",
        "ArgumentParser",
        "description",
        "parser",
        "add_argument",
        "required",
        "help",
        "parser",
        "parse_args",
        "os",
        "path",
        "join",
        "os",
        "path",
        "dirname",
        "args",
        "config",
        "load_config",
        "config_path",
        "config",
        "config",
        "run_experiment",
        "config"
    ],
    "literals": [
        "\"jax_platform_name\"",
        "\"cpu\"",
        "\"r\"",
        "\"psi\"",
        "\"backend\"",
        "\"INFO\"",
        "\"seed\"",
        "\"nqs_type\"",
        "\"ffnn\"",
        "\"base_layer_sizes\"",
        "\"nqs_type\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"activations\"",
        "\"nqs_type\"",
        "\"layer_sizes\"",
        "\"activations\"",
        "\"correlation\"",
        "\"correlation\"",
        "\"particle\"",
        "\"particle\"",
        "\"nqs_type\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"nqs_type\"",
        "\"dsffn\"",
        "\"layer_sizes\"",
        "\"S0\"",
        "\"dim\"",
        "\"base_layer_sizes\"",
        "\"nqs_type\"",
        "\"S0\"",
        "\"latent_dim\"",
        "\"S1\"",
        "\"latent_dim\"",
        "\"base_layer_sizes\"",
        "\"nqs_type\"",
        "\"S1\"",
        "\"activations\"",
        "\"S0\"",
        "\"activations\"",
        "\"nqs_type\"",
        "\"S0\"",
        "\"S1\"",
        "\"activations\"",
        "\"nqs_type\"",
        "\"S1\"",
        "\"correlation\"",
        "\"correlation\"",
        "\"particle\"",
        "\"particle\"",
        "\"layer_sizes\"",
        "\"layer_sizes\"",
        "\"activations\"",
        "\"activations\"",
        "\"nqs_type\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"nqs_type\"",
        "\"rbm\"",
        "\"nqs_type\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"nhidden\"",
        "\"omega\"",
        "\"particle\"",
        "\"correlation\"",
        "\"nqs_type\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"particle\"",
        "\"correlation\"",
        "\"mcmc_alg\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"m\"",
        "\"nparticles\"",
        "\"ho\"",
        "\"interaction_type\"",
        "\"omega\"",
        "\"r0_reg\"",
        "\"training_cycles\"",
        "\"optimizer\"",
        "\"eta\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"nqs_type\"",
        "\"ffnn\"",
        "\"layer_sizes\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"base_layer_sizes\"",
        "\"nqs_type\"",
        "\"activations\"",
        "\"activations\"",
        "\"nqs_type\"",
        "\"correlation\"",
        "\"correlation\"",
        "\"particle\"",
        "\"particle\"",
        "\"nqs_type\"",
        "\"dsffn\"",
        "\"layer_sizes\"",
        "\"S0\"",
        "\"dim\"",
        "\"base_layer_sizes\"",
        "\"nqs_type\"",
        "\"S0\"",
        "\"latent_dim\"",
        "\"S1\"",
        "\"latent_dim\"",
        "\"base_layer_sizes\"",
        "\"nqs_type\"",
        "\"S1\"",
        "\"activations\"",
        "\"S0\"",
        "\"activations\"",
        "\"nqs_type\"",
        "\"S0\"",
        "\"S1\"",
        "\"activations\"",
        "\"nqs_type\"",
        "\"S1\"",
        "\"correlation\"",
        "\"correlation\"",
        "\"particle\"",
        "\"particle\"",
        "\"pretrain\"",
        "\"training_cycles\"",
        "\"batch_size\"",
        "\"seed\"",
        "\"energy\"",
        "\"energy\"",
        "\"std_error\"",
        "\"std\"",
        "\"nqs_type\"",
        "\"nqs_type\"",
        "\"n_particles\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"dim\"",
        "\"batch_size\"",
        "\"batch_size\"",
        "\"eta\"",
        "\"eta\"",
        "\"training_cycles\"",
        "\"training_cycles\"",
        "\"nsamples\"",
        "\"nsamples\"",
        "\"Opti\"",
        "\"optimizer\"",
        "\"particle\"",
        "\"particle\"",
        "\"nsamples\"",
        "\"nchains\"",
        "\"seed\"",
        "\"save_positions\"",
        "\"output_filename\"",
        "\"accept_rate\"",
        "\"E_energy\"",
        "\"E_std_error\"",
        "\"K_energy\"",
        "\"K_std_error\"",
        "\"PE_trap_energy\"",
        "\"PE_trap_std_error\"",
        "\"PE_int_energy\"",
        "\"PE_int_std_error\"",
        "\"E_energy\"",
        "\"E_std_error\"",
        "\"E_variance\"",
        "\"E_variance\"",
        "\"K_energy\"",
        "\"K_std_error\"",
        "\"PE_trap_energy\"",
        "\"PE_trap_std_error\"",
        "\"PE_int_energy\"",
        "\"PE_int_std_error\"",
        "\"accept_rate\"",
        "\"omega\"",
        "\"omega\"",
        "\"pretrain\"",
        "\"pretrain\"",
        "\"r0_reg\"",
        "\"r0_reg\"",
        "\"correration\"",
        "\"correlation\"",
        "\"optimizer\"",
        "\"optimizer\"",
        "\"E_energy\"",
        "\"K_energy\"",
        "\"PE_trap_energy\"",
        "\"PE_int_energy\"",
        "\"E_std_error\"",
        "\"K_std_error\"",
        "\"PE_trap_std_error\"",
        "\"PE_int_std_error\"",
        "f\"{final_E_error:.0e}\"",
        "f\"{final_K_error:.0e}\"",
        "f\"{final_PE_trap_error:.0e}\"",
        "f\"{final_PE_int_error:.0e}\"",
        "\"e\"",
        "\"e\"",
        "\"e\"",
        "\"e\"",
        "f\"{final_E_energy:.{E_energy_decimal_places}f}\"",
        "f\"{int(final_E_energy)}\"",
        "f\"{final_K_energy:.{K_energy_decimal_places}f}\"",
        "f\"{int(final_K_energy)}\"",
        "f\"{final_PE_trap_energy:.{PE_trap_energy_decimal_places}f}\"",
        "f\"{int(final_PE_trap_energy)}\"",
        "f\"{final_PE_int_energy:.{PE_int_energy_decimal_places}f}\"",
        "f\"{int(final_PE_int_energy)}\"",
        "\".\"",
        "\".\"",
        "\".\"",
        "\".\"",
        "f\"{E_energy_str}({E_error_first_digit})\"",
        "f\"{K_energy_str}({K_error_first_digit})\"",
        "f\"{PE_trap_energy_str}({PE_trap_error_first_digit})\"",
        "f\"{PE_int_energy_str}({PE_int_error_first_digit})\"",
        "\"E_energy(error)\"",
        "\"K_energy(error)\"",
        "\"PE_trap_energy(error)\"",
        "\"PE_int_energy(error)\"",
        "\"nqs_type\"",
        "\"n_particles\"",
        "\"dim\"",
        "\"batch_size\"",
        "\"eta\"",
        "\"training_cycles\"",
        "\"nsamples\"",
        "\"Opti\"",
        "\"particle\"",
        "\"time_train\"",
        "\"time_sample\"",
        "\"nqs_type\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"batch_size\"",
        "\"eta\"",
        "\"nparticles\"",
        "\"dim\"",
        "\"training_cycles\"",
        "\"nchains\"",
        "\"nsamples\"",
        "\"optimizer\"",
        "\"particle\"",
        "\"output_filename\"",
        "f\"final_results_v0_{config['omega']}.csv\"",
        "'omega'",
        "\"output_filename\"",
        "f\"final_results_v0_{config['omega']}.csv\"",
        "'omega'",
        "\"output_filename\"",
        "f\"final_results_v0_{config['omega']}.csv\"",
        "'omega'",
        "\"a\"",
        "\"Pretraining with GAUSSIAN model first\"",
        "\"ffnn\"",
        "\"dsffn\"",
        "\"Gaussian\"",
        "\"INFO\"",
        "\"interaction_type\"",
        "\"none\"",
        "\"Pretraining with non-interact FIRST\"",
        "\"ho\"",
        "\"none\"",
        "\"omega\"",
        "\"training_cycles\"",
        "\"training_cycles\"",
        "\"batch_size\"",
        "\"seed\"",
        "\"ho\"",
        "\"interaction_type\"",
        "\"omega\"",
        "\"reg_r0\"",
        "\"training_cycles\"",
        "\"__main__\"",
        "\"Run NQS Experiment\"",
        "\"--config\"",
        "\"Path to the configuration file\"",
        "f\"Running experiment with interaction: {config['interaction_type']} and n_particles: {config['nparticles']}\"",
        "'interaction_type'",
        "'nparticles'"
    ],
    "variables": [
        "system",
        "base_layer_sizes",
        "layer_sizes",
        "activations",
        "common_kwargs",
        "common_kwargs",
        "system",
        "mcmc_alg",
        "common_kwargs",
        "common_kwargs",
        "common_kwargs",
        "system",
        "time_train",
        "history",
        "time_train",
        "df_hist",
        "time_sample",
        "df_all",
        "time_sample",
        "accept_rate_mean",
        "E_means",
        "E_std_errors",
        "E_variances",
        "E_weights",
        "E_combined_mean",
        "E_combined_variance",
        "E_combined_std_error",
        "K_means",
        "K_std_errors",
        "K_variances",
        "K_weights",
        "K_combined_mean",
        "K_combined_variance",
        "K_combined_std_error",
        "PE_trap_means",
        "PE_trap_std_errors",
        "PE_trap_variances",
        "PE_trap_weights",
        "PE_trap_combined_mean",
        "PE_trap_combined_variance",
        "PE_trap_combined_std_error",
        "PE_int_means",
        "PE_int_std_errors",
        "PE_int_variances",
        "PE_int_weights",
        "PE_int_combined_mean",
        "PE_int_combined_variance",
        "PE_int_combined_std_error",
        "combined_data",
        "df_mean",
        "final_E_energy",
        "final_K_energy",
        "final_PE_trap_energy",
        "final_PE_int_energy",
        "final_E_error",
        "final_K_error",
        "final_PE_trap_error",
        "final_PE_int_error",
        "final_E_error",
        "final_K_error",
        "final_PE_trap_error",
        "final_PE_int_error",
        "final_E_energy",
        "final_K_energy",
        "final_PE_trap_energy",
        "final_PE_int_energy",
        "E_error_str",
        "K_error_str",
        "PE_trap_error_str",
        "PE_int_error_str",
        "E_error_scale",
        "K_error_scale",
        "PE_trap_error_scale",
        "PE_int_error_scale",
        "E_energy_decimal_places",
        "K_energy_decimal_places",
        "PE_trap_energy_decimal_places",
        "PE_int_energy_decimal_places",
        "E_energy_str",
        "E_energy_str",
        "K_energy_str",
        "K_energy_str",
        "PE_trap_energy_str",
        "PE_trap_energy_str",
        "PE_int_energy_str",
        "PE_int_energy_str",
        "E_error_first_digit",
        "K_error_first_digit",
        "PE_trap_error_first_digit",
        "PE_int_error_first_digit",
        "E_energy_str",
        "K_energy_str",
        "PE_trap_energy_str",
        "PE_int_energy_str",
        "formated_E_energy",
        "formated_K_energy",
        "formated_PE_trap_energy",
        "formated_PE_int_energy",
        "df_mean",
        "df_mean",
        "df_mean",
        "df_mean",
        "df_mean",
        "parser",
        "args",
        "config_path",
        "config"
    ],
    "comments": [
        "noqa",
        "noqa",
        "noqa",
        "Print device",
        "Handle other methods like VMC that don't use layers",
        "needs to be fixed to 1 to compare to drissi et al",
        "noqa",
        "save energies and stds to csv, together",
        "noqa",
        "if not os.path.exists(",
        "config[\"output_filename\"] + f\"energies_and_stds_v0_{config['omega']}.csv\"",
        "):",
        "df_hist.to_csv(",
        "config[\"output_filename\"] + f\"energies_and_stds_v0_{config['omega']}.csv\",",
        "index=False,",
        ")",
        "else:",
        "df_hist.to_csv(",
        "config[\"output_filename\"] + f\"energies_and_stds_v0_{config['omega']}.csv\",",
        "mode=\"a\",",
        "header=False,",
        "index=False,",
        ")",
        "Mean values",
        "Combined standard error of the mean for energy",
        "Combined standard error of the mean for kinetic energy",
        "Combined standard error of the mean for potential energy (trap)",
        "Combined standard error of the mean for potential energy (int)",
        "Construct the combined DataFrame",
        "convert any NaN to 0",
        "Format energy to match the precision required by the error",
        "Get the first digit of the error for the parenthesis notation",
        "Remove trailing decimal point if it exists after formatting",
        "if config[\"save_positions\"]:",
        "chain_id = 0",
        "filename = f\"energies_and_pos_{config['nqs_type'].upper()}_ch{chain_id}.h5\"",
        "plot_3dobd(filename, config[\"nsamples\"], config[\"dim\"])",
        "sns.scatterplot(data=df_all, x=\"chain_id\", y=\"energy\")",
        "plt.xlabel(\"Chain\")",
        "plt.ylabel(\"Energy\")",
        "plt.show()",
        "will be fixed to 1 to compare to drissi et al",
        "noqa",
        "needs to be fixed to 1 to compare to drissi et al",
        "Ensure the config path is relative to the project root",
        "try:",
        "except Exception as e:",
        "print(",
        "f\"Error: {e} for interaction: {config['interaction_type']} and n_particles: {config['nparticles']}\"",
        ")"
    ],
    "docstrings": [],
    "functions": [
        "load_config",
        "initialize_system",
        "run_experiment",
        "pretrain"
    ],
    "classes": []
}