{
    "identifiers": [
        "torch",
        "torch",
        "nn",
        "nn",
        "torch",
        "nn",
        "functional",
        "F",
        "torch",
        "optim",
        "optim",
        "tqdm",
        "tqdm",
        "copy",
        "sys",
        "os",
        "argparse",
        "time",
        "random",
        "math",
        "glob",
        "robustbench",
        "rb",
        "data",
        "autopgd_train",
        "apgd_train",
        "train_clean",
        "apgd_train_kl",
        "pretrain",
        "gp",
        "get_params_no_decay",
        "gp_finetune",
        "utils",
        "model_zoo",
        "fast_models",
        "PreActResNet18",
        "model_zoo",
        "wide_resnet",
        "Wide_ResNet",
        "other_utils",
        "eval",
        "utils_eval",
        "argparse",
        "ArgumentParser",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "action",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "action",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "help",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "action",
        "help",
        "parser",
        "add_argument",
        "action",
        "parser",
        "add_argument",
        "action",
        "parser",
        "parse_args",
        "args",
        "parse_args",
        "args",
        "fname",
        "other_utils",
        "makedir",
        "format",
        "args",
        "save_dir",
        "args",
        "fname",
        "glob",
        "glob",
        "format",
        "args",
        "save_dir",
        "args",
        "fname",
        "f",
        "files",
        "os",
        "remove",
        "f",
        "eps_dict",
        "args",
        "dataset",
        "c",
        "c",
        "args",
        "all_norms",
        "utils",
        "stats_dict",
        "args",
        "other_utils",
        "Logger",
        "format",
        "args",
        "save_dir",
        "args",
        "fname",
        "format",
        "args",
        "save_dir",
        "args",
        "fname",
        "torch",
        "manual_seed",
        "args",
        "seed",
        "torch",
        "cuda",
        "manual_seed",
        "args",
        "seed",
        "random",
        "seed",
        "args",
        "seed",
        "args",
        "dataset",
        "data",
        "load_cifar10_train",
        "args",
        "only_train",
        "data",
        "load_cifar10",
        "args",
        "n_ex_eval",
        "args",
        "data_dir",
        "training_set",
        "device",
        "data",
        "load_cifar10",
        "args",
        "n_ex_eval",
        "args",
        "data_dir",
        "device",
        "args",
        "dataset",
        "data",
        "load_imagenet_train",
        "args",
        "data",
        "load_imagenet",
        "args",
        "n_ex_eval",
        "data",
        "load_imagenet",
        "args",
        "n_ex_eval",
        "format",
        "x_test_eval",
        "device",
        "args",
        "finetune_model",
        "args",
        "dataset",
        "args",
        "wide",
        "Wide_ResNet",
        "depth",
        "cuda",
        "PreActResNet18",
        "activation",
        "args",
        "act",
        "cuda",
        "model",
        "eval",
        "args",
        "model_name",
        "startswith",
        "rb",
        "utils",
        "load_model",
        "join",
        "args",
        "model_name",
        "split",
        "model_dir",
        "args",
        "model_dir",
        "dataset",
        "args",
        "dataset",
        "threat_model",
        "model",
        "cuda",
        "model",
        "eval",
        "format",
        "args",
        "model_name",
        "args",
        "model_name",
        "startswith",
        "utils",
        "load_pretrained_models",
        "args",
        "model_name",
        "model",
        "cuda",
        "model",
        "eval",
        "PreActResNet18",
        "activation",
        "args",
        "act",
        "os",
        "path",
        "isfile",
        "args",
        "model_name",
        "torch",
        "load",
        "args",
        "model_name",
        "model",
        "load_state_dict",
        "ckpt",
        "model",
        "cuda",
        "model",
        "eval",
        "args",
        "loss",
        "nn",
        "CrossEntropyLoss",
        "optim",
        "SGD",
        "get_params_no_decay",
        "args",
        "model",
        "lr",
        "momentum",
        "weight_decay",
        "args",
        "weight_decay",
        "copy",
        "deepcopy",
        "model",
        "optim",
        "SGD",
        "get_params_no_decay",
        "args",
        "model_nat",
        "lr",
        "momentum",
        "weight_decay",
        "args",
        "weight_decay",
        "utils",
        "get_lr_schedule",
        "args",
        "args",
        "l_norms",
        "split",
        "args",
        "l_eps",
        "eps_dict",
        "args",
        "dataset",
        "c",
        "c",
        "args",
        "l_norms",
        "args",
        "l_eps",
        "split",
        "args",
        "l_eps",
        "split",
        "eps_dict",
        "args",
        "dataset",
        "size",
        "eps_dict",
        "args",
        "dataset",
        "c",
        "c",
        "args",
        "l_norms",
        "args",
        "l_iters",
        "c",
        "c",
        "args",
        "l_iters",
        "split",
        "args",
        "at_iter",
        "_",
        "args",
        "l_norms",
        "join",
        "format",
        "args",
        "l_norms",
        "c",
        "args",
        "l_eps",
        "c",
        "args",
        "l_iters",
        "c",
        "c",
        "len",
        "args",
        "l_norms",
        "i",
        "norm",
        "args",
        "l_norms",
        "args",
        "all_norms",
        "index",
        "norm",
        "args",
        "all_epss",
        "args",
        "l_eps",
        "i",
        "join",
        "format",
        "args",
        "all_norms",
        "c",
        "args",
        "all_epss",
        "c",
        "c",
        "len",
        "args",
        "all_norms",
        "args",
        "pretraining",
        "i",
        "train_clean",
        "args",
        "i",
        "model_nat",
        "train_loader",
        "optimizer_nat",
        "lr_schedule",
        "model",
        "load_state_dict",
        "model_nat",
        "state_dict",
        "epoch",
        "args",
        "epochs",
        "time",
        "time",
        "model",
        "train",
        "tqdm",
        "train_loader",
        "unit",
        "tepoch",
        "i",
        "x_loader",
        "y_loader",
        "tepoch",
        "x_loader",
        "cuda",
        "y_loader",
        "cuda",
        "lr_schedule",
        "epoch",
        "i",
        "len",
        "train_loader",
        "optimizer",
        "param_groups",
        "update",
        "lr",
        "lr",
        "model",
        "eval",
        "apgd_train",
        "model",
        "x",
        "y",
        "norm",
        "args",
        "l_norms",
        "eps",
        "args",
        "l_eps",
        "n_iter",
        "args",
        "l_iters",
        "is_train",
        "apgd_train",
        "model",
        "x",
        "y",
        "norm",
        "args",
        "l_norms",
        "eps",
        "args",
        "l_eps",
        "n_iter",
        "args",
        "l_iters",
        "is_train",
        "apgd_train",
        "model",
        "x",
        "y",
        "norm",
        "args",
        "l_norms",
        "eps",
        "args",
        "l_eps",
        "n_iter",
        "args",
        "l_iters",
        "is_train",
        "y",
        "clone",
        "loss_best_inf",
        "loss_best_1",
        "loss_best_2",
        "x_tr_inf",
        "view",
        "len",
        "y",
        "x_tr_1",
        "view",
        "len",
        "y",
        "x_tr_2",
        "view",
        "len",
        "y",
        "torch",
        "stack",
        "tensor_list",
        "torch",
        "stack",
        "delta_list",
        "loss_arr",
        "max",
        "dim",
        "delta_arr",
        "max_loss",
        "torch",
        "arange",
        "len",
        "y",
        "x_tr_best",
        "view",
        "len",
        "y",
        "x_tr_1",
        "shape",
        "x_tr_1",
        "shape",
        "x_tr_1",
        "shape",
        "model",
        "train",
        "optimizer",
        "zero_grad",
        "args",
        "loss",
        "model",
        "x_tr_best",
        "outputs_best",
        "max",
        "dim",
        "y_tr",
        "cpu",
        "sum",
        "item",
        "running_acc_ep_inf",
        "acc_ep_best",
        "criterion",
        "outputs_best",
        "y_tr",
        "loss",
        "backward",
        "optimizer",
        "step",
        "running_loss",
        "loss",
        "item",
        "tepoch",
        "set_postfix",
        "running_loss",
        "i",
        "running_acc_ep_inf",
        "i",
        "args",
        "batch_size",
        "model",
        "eval",
        "stats",
        "running_loss",
        "len",
        "train_loader",
        "format",
        "epoch",
        "time",
        "time",
        "startt",
        "stats",
        "epoch",
        "epoch",
        "args",
        "eval_freq",
        "args",
        "eval_freq",
        "model",
        "eval",
        "utils_eval",
        "eval_norms_fast",
        "model",
        "x_train_eval",
        "y_train_eval",
        "args",
        "all_norms",
        "args",
        "all_epss",
        "n_iter",
        "n_cls",
        "args",
        "n_cls",
        "utils_eval",
        "eval_norms_fast",
        "model",
        "x_test_eval",
        "y_test_eval",
        "args",
        "all_norms",
        "args",
        "all_epss",
        "n_iter",
        "n_cls",
        "args",
        "n_cls",
        "norm",
        "args",
        "all_norms",
        "stats",
        "norm",
        "acc_test",
        "norm",
        "stats",
        "norm",
        "acc_train",
        "norm",
        "str_test",
        "format",
        "norm",
        "acc_test",
        "norm",
        "str_train",
        "format",
        "norm",
        "acc_train",
        "norm",
        "str_to_log",
        "format",
        "str_train",
        "str_test",
        "epoch",
        "args",
        "save_freq",
        "epoch",
        "args",
        "epochs",
        "model",
        "state_dict",
        "args",
        "save_optim",
        "model",
        "state_dict",
        "optimizer",
        "state_dict",
        "torch",
        "save",
        "curr_dict",
        "format",
        "args",
        "save_dir",
        "args",
        "fname",
        "epoch",
        "iteration",
        "torch",
        "save",
        "stats",
        "format",
        "args",
        "save_dir",
        "args",
        "fname",
        "logger",
        "log",
        "str_to_log",
        "args",
        "final_eval",
        "args",
        "dataset",
        "data",
        "load_cifar10",
        "args",
        "n_ex_final",
        "data_dir",
        "args",
        "data_dir",
        "device",
        "stats",
        "utils_eval",
        "eval_norms",
        "model",
        "x",
        "y",
        "l_norms",
        "args",
        "all_norms",
        "l_epss",
        "args",
        "all_epss",
        "bs",
        "args",
        "batch_size_eval",
        "log_path",
        "log_eval_path",
        "data",
        "load_imagenet",
        "args",
        "n_ex_final",
        "device",
        "stats",
        "utils_eval",
        "eval_norms",
        "model",
        "x",
        "y",
        "l_norms",
        "args",
        "all_norms",
        "l_epss",
        "args",
        "all_epss",
        "bs",
        "args",
        "batch_size_eval",
        "log_path",
        "log_eval_path",
        "n_cls",
        "torch",
        "save",
        "stats",
        "format",
        "args",
        "save_dir",
        "args",
        "fname",
        "iteration",
        "norm",
        "eps",
        "v",
        "args",
        "l_norms",
        "args",
        "l_eps",
        "l_x_adv",
        "torch",
        "save",
        "v",
        "format",
        "args",
        "save_dir",
        "args",
        "fname",
        "norm",
        "args",
        "n_ex_final",
        "eps",
        "iteration",
        "main"
    ],
    "literals": [
        "'cifar10'",
        "'Linf'",
        "'L2'",
        "'L1'",
        "'imagenet'",
        "'Linf'",
        "'L2'",
        "'L1'",
        "'--model_name'",
        "'Wong2020Fast'",
        "'--batch_size_eval'",
        "'batch size for evaluation'",
        "'--batch_size'",
        "'batch size for training'",
        "'--data_dir'",
        "'../datasets/cifar10'",
        "'where to store downloaded datasets'",
        "'--model_dir'",
        "'./models'",
        "'where to store downloaded models'",
        "'--save_dir'",
        "'./trained_models'",
        "'--lr-schedule'",
        "'piecewise-ft'",
        "'--lr-max'",
        "'--epochs'",
        "'--save_freq'",
        "'--eval_freq'",
        "'if -1 no evaluation during training'",
        "'--act'",
        "'softplus1'",
        "'--finetune_model'",
        "'store_true'",
        "'--l_norms'",
        "'Linf L1 L2'",
        "'norms to use in adversarial training'",
        "'--attack'",
        "'apgd'",
        "'--weight_decay'",
        "'--l_eps'",
        "'epsilon values for adversarial training wrt each norm'",
        "'--notes_run'",
        "'appends a comment to the run name'",
        "'--loss'",
        "'ce'",
        "'--l_iters'",
        "'iterations for each norms in adversarial training (possibly different)'",
        "'--save_optim'",
        "'store_true'",
        "'--seed'",
        "'--fname'",
        "'store file name'",
        "'--dataset'",
        "'cifar10'",
        "'--at_iter'",
        "'iteration in adversarial training (used for all norms)'",
        "'--n_ex_eval'",
        "'--n_ex_final'",
        "'--final_eval'",
        "'store_true'",
        "'run long evaluation after training'",
        "'--pretraining'",
        "'store_true'",
        "'--wide'",
        "'store_true'",
        "'{}/{}'",
        "'{}/{}/*'",
        "'Linf'",
        "'L2'",
        "'L1'",
        "'{}/{}/log_train.txt'",
        "'{}/{}/log_eval_final.txt'",
        "'cifar10'",
        "'cuda'",
        "'cuda'",
        "'imagenet'",
        "'data loaded on {}'",
        "'cifar10'",
        "'RB'",
        "'_'",
        "'_'",
        "'Linf'",
        "'{} ({}) loaded'",
        "'pretr'",
        "'pretrained model loaded'",
        "'ce'",
        "' '",
        "'_'",
        "'_'",
        "' '",
        "'[train] '",
        "', '",
        "'{} eps={:.5f} iters={}'",
        "'[eval] '",
        "', '",
        "'{} eps={:.5f}'",
        "\"batch\"",
        "'ce'",
        "'loss'",
        "'acc'",
        "'loss_train_dets'",
        "'clean'",
        "'[epoch] {} [time] {:.1f} s [train] loss {:.5f}'",
        "'loss_train_dets'",
        "'clean'",
        "''",
        "''",
        "'clean'",
        "'union'",
        "'rob_acc_test_dets'",
        "'rob_acc_train_dets'",
        "' {} {:.1%}'",
        "' {} {:.1%}'",
        "'[eval train]{} [eval test]{}'",
        "'state_dict'",
        "'optim'",
        "'{}/{}/ep_{}_{}.pth'",
        "'{}/{}/metrics.pth'",
        "'cifar10'",
        "'cpu'",
        "'final_acc_dets'",
        "'cpu'",
        "'final_acc_dets'",
        "'{}/{}/metrics_{}.pth'",
        "'{}/{}/eval_{}_{}_1_{}_eps_{:.5f}_{}.pth'",
        "'final'",
        "'__main__'"
    ],
    "variables": [
        "eps_dict",
        "parser",
        "args",
        "args",
        "files",
        "args",
        "all_norms",
        "args",
        "all_epss",
        "stats",
        "logger",
        "log_eval_path",
        "train_loader",
        "_",
        "x_train_eval",
        "y_train_eval",
        "x_test_eval",
        "y_test_eval",
        "args",
        "n_cls",
        "train_loader",
        "_",
        "x_train_eval",
        "y_train_eval",
        "x_test_eval",
        "y_test_eval",
        "args",
        "n_cls",
        "model",
        "model",
        "model",
        "model",
        "model",
        "ckpt",
        "criterion",
        "optimizer",
        "model_nat",
        "optimizer_nat",
        "lr_schedule",
        "args",
        "l_norms",
        "args",
        "l_eps",
        "norm",
        "size",
        "norm",
        "args",
        "l_eps",
        "args",
        "l_iters",
        "args",
        "l_iters",
        "idx",
        "idx",
        "iteration",
        "model_nat",
        "_",
        "startt",
        "running_loss",
        "running_acc_ep_inf",
        "x",
        "y",
        "lr",
        "x_tr_inf",
        "_",
        "_",
        "loss_best_inf",
        "_",
        "x_tr_1",
        "_",
        "_",
        "loss_best_1",
        "_",
        "x_tr_2",
        "_",
        "_",
        "loss_best_2",
        "_",
        "y_tr",
        "tensor_list",
        "delta_list",
        "loss_arr",
        "delta_arr",
        "max_loss",
        "x_tr_best",
        "x_tr_best",
        "outputs_best",
        "acc_ep_best",
        "loss",
        "epoch",
        "str_to_log",
        "acc_train",
        "acc_test",
        "str_test",
        "str_train",
        "epoch",
        "epoch",
        "curr_dict",
        "curr_dict",
        "x",
        "y",
        "l_x_adv",
        "x",
        "y",
        "l_x_adv"
    ],
    "comments": [
        "from torch.autograd import Variable",
        "from torchvision import datasets, transforms",
        "from datetime import datetime",
        "parser.add_argument('--eps', type=float, default=8/255)",
        "parser.add_argument('--n_ex', type=int, default=100, help='number of examples to evaluate on')",
        "parser.add_argument('--norm', type=str, default='Linf')",
        "parser.add_argument('--save_imgs', action='store_true')",
        "parser.add_argument('--log_freq', type=int, default=20)",
        "parser.add_argument('--pgd_iter', type=int, default=1)",
        "parser.add_argument('--epoch_switch', type=int)",
        "parser.add_argument('--save_min', type=int, default=0)",
        "parser.add_argument('--no_wd_bn', action='store_true')",
        "parser.add_argument('--gp', action='store_true')",
        "logging and saving tools",
        "utils.get_runname(args)",
        "args.save_dir",
        "fix seed",
        "load data",
        "non augmented images for statistics",
        "training_set=True",
        "non augmented images for statistics",
        "training_set=True",
        "load model",
        "from model_zoo.fast_models import PreActResNet18",
        "raise NotImplemented",
        "args.model_name.split('_')[2])",
        ".split('_')[1:]))",
        "clean_acc = rb.utils.clean_accuracy(model, x_test_eval, y_test_eval)",
        "print('initial clean accuracy: {:.2%}'.format(clean_acc))",
        "set loss",
        "set optimizer",
        "initialize models for D_nat and D_inf",
        "get lr scheduler",
        "set norms, eps and iters for training",
        "args.l_eps = [float(c) for c in args.l_eps.split(' ')]",
        "set eps for evaluation",
        "iterative finetuning",
        "pretraining on D_nat",
        "loop over the dataset multiple times",
        "training the target domain",
        "train the Lp domain (target domain)",
        "update lr",
        "compute training points",
        "zero the parameter gradients",
        "forward + backward + optimize",
        "collect stats",
        "training stats",
        "running_loss / len(train_loader)",
        "stats['rob_acc_train_dets']['clean'][epoch]",
        "compute robustness stats (apgd with 100 iterations)",
        "test points",
        "saving",
        "run long eval",
        "model, args=args"
    ],
    "docstrings": [],
    "functions": [
        "parse_args",
        "main"
    ],
    "classes": []
}