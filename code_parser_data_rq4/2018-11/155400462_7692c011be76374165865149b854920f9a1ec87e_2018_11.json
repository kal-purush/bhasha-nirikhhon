{
    "identifiers": [
        "numpy",
        "np",
        "pandas",
        "pd",
        "pydicom",
        "dicom",
        "os",
        "scipy",
        "ndimage",
        "matplotlib",
        "pyplot",
        "plt",
        "skimage",
        "measure",
        "morphology",
        "path",
        "dicom",
        "read_file",
        "path",
        "s",
        "s",
        "os",
        "listdir",
        "path",
        "slices",
        "sort",
        "key",
        "x",
        "x",
        "ImagePositionPatient",
        "slices",
        "ImagePositionPatient",
        "slices",
        "ImagePositionPatient",
        "slices",
        "ImagePositionPatient",
        "slices",
        "sec_num",
        "ImagePositionPatient",
        "sec_num",
        "len",
        "slices",
        "sec_num",
        "slices",
        "sort",
        "key",
        "x",
        "x",
        "InstanceNumber",
        "slices",
        "slice_num",
        "slices",
        "sort",
        "key",
        "x",
        "x",
        "ImagePositionPatient",
        "np",
        "abs",
        "slices",
        "ImagePositionPatient",
        "slices",
        "ImagePositionPatient",
        "np",
        "abs",
        "slices",
        "SliceLocation",
        "slices",
        "SliceLocation",
        "s",
        "slices",
        "slice_thickness",
        "slices",
        "slices",
        "np",
        "stack",
        "s",
        "pixel_array",
        "s",
        "slices",
        "image",
        "astype",
        "np",
        "int16",
        "slice_number",
        "len",
        "slices",
        "slices",
        "slice_number",
        "RescaleIntercept",
        "slices",
        "slice_number",
        "RescaleSlope",
        "slope",
        "slope",
        "image",
        "slice_number",
        "astype",
        "np",
        "float64",
        "image",
        "slice_number",
        "astype",
        "np",
        "int16",
        "image",
        "slice_number",
        "np",
        "int16",
        "intercept",
        "np",
        "array",
        "image",
        "dtype",
        "np",
        "int16",
        "np",
        "array",
        "slices",
        "SliceThickness",
        "slices",
        "PixelSpacing",
        "slices",
        "PixelSpacing",
        "dtype",
        "np",
        "float32",
        "image",
        "spacing",
        "intensity_th",
        "sigma",
        "area_th",
        "eccen_th",
        "bg_patch_size",
        "np",
        "zeros",
        "image",
        "shape",
        "dtype",
        "image",
        "shape",
        "np",
        "linspace",
        "image_size",
        "image_size",
        "image_size",
        "np",
        "meshgrid",
        "grid_axis",
        "grid_axis",
        "x",
        "y",
        "d",
        "image_size",
        "astype",
        "nan_mask",
        "np",
        "nan",
        "i",
        "image",
        "shape",
        "len",
        "np",
        "unique",
        "image",
        "i",
        "bg_patch_size",
        "bg_patch_size",
        "scipy",
        "ndimage",
        "filters",
        "gaussian_filter",
        "np",
        "multiply",
        "image",
        "i",
        "astype",
        "nan_mask",
        "sigma",
        "truncate",
        "intensity_th",
        "scipy",
        "ndimage",
        "filters",
        "gaussian_filter",
        "image",
        "i",
        "astype",
        "sigma",
        "truncate",
        "intensity_th",
        "measure",
        "label",
        "current_bw",
        "measure",
        "regionprops",
        "label",
        "prop",
        "properties",
        "prop",
        "area",
        "spacing",
        "spacing",
        "area_th",
        "prop",
        "eccentricity",
        "eccen_th",
        "valid_label",
        "add",
        "prop",
        "label",
        "np",
        "in1d",
        "label",
        "valid_label",
        "reshape",
        "label",
        "shape",
        "current_bw",
        "bw",
        "bw",
        "spacing",
        "cut_num",
        "vol_limit",
        "area_th",
        "dist_th",
        "cut_num",
        "np",
        "copy",
        "bw",
        "cut_num",
        "measure",
        "label",
        "bw",
        "connectivity",
        "label",
        "shape",
        "label",
        "label",
        "label",
        "label",
        "label",
        "cut_num",
        "label",
        "cut_num",
        "label",
        "cut_num",
        "label",
        "cut_num",
        "label",
        "mid",
        "label",
        "mid",
        "label",
        "cut_num",
        "mid",
        "label",
        "cut_num",
        "mid",
        "l",
        "bg_label",
        "label",
        "l",
        "measure",
        "regionprops",
        "label",
        "prop",
        "properties",
        "prop",
        "area",
        "spacing",
        "prod",
        "vol_limit",
        "prop",
        "area",
        "spacing",
        "prod",
        "vol_limit",
        "label",
        "prop",
        "label",
        "np",
        "linspace",
        "label",
        "shape",
        "label",
        "shape",
        "label",
        "shape",
        "spacing",
        "np",
        "linspace",
        "label",
        "shape",
        "label",
        "shape",
        "label",
        "shape",
        "spacing",
        "np",
        "meshgrid",
        "x_axis",
        "y_axis",
        "x",
        "y",
        "measure",
        "regionprops",
        "label",
        "vol",
        "vols",
        "label",
        "vol",
        "label",
        "np",
        "zeros",
        "label",
        "shape",
        "np",
        "zeros",
        "label",
        "shape",
        "i",
        "label",
        "shape",
        "np",
        "sum",
        "single_vol",
        "i",
        "np",
        "prod",
        "spacing",
        "np",
        "min",
        "single_vol",
        "i",
        "d",
        "single_vol",
        "i",
        "np",
        "max",
        "d",
        "np",
        "average",
        "min_distance",
        "i",
        "i",
        "label",
        "shape",
        "slice_area",
        "i",
        "area_th",
        "dist_th",
        "valid_label",
        "add",
        "vol",
        "label",
        "np",
        "in1d",
        "label",
        "valid_label",
        "reshape",
        "label",
        "shape",
        "cut_num",
        "np",
        "copy",
        "bw",
        "cut_num",
        "bw0",
        "cut_num",
        "np",
        "copy",
        "bw",
        "scipy",
        "ndimage",
        "binary_dilation",
        "bw2",
        "iterations",
        "cut_num",
        "bw1",
        "bw2",
        "measure",
        "label",
        "bw",
        "connectivity",
        "measure",
        "label",
        "bw3",
        "connectivity",
        "np",
        "unique",
        "label",
        "l",
        "l_list",
        "np",
        "nonzero",
        "label",
        "l",
        "label3",
        "indices",
        "indices",
        "indices",
        "l3",
        "valid_l3",
        "add",
        "l3",
        "np",
        "in1d",
        "label3",
        "valid_l3",
        "reshape",
        "label3",
        "shape",
        "bw",
        "len",
        "valid_label",
        "bw",
        "measure",
        "label",
        "bw",
        "label",
        "label",
        "label",
        "label",
        "label",
        "label",
        "label",
        "label",
        "np",
        "in1d",
        "label",
        "bg_label",
        "reshape",
        "label",
        "shape",
        "bw",
        "bw",
        "spacing",
        "max_iter",
        "max_ratio",
        "bw",
        "cover",
        "i",
        "bw",
        "shape",
        "bw",
        "i",
        "measure",
        "label",
        "current_slice",
        "measure",
        "regionprops",
        "label",
        "properties",
        "sort",
        "key",
        "x",
        "x",
        "area",
        "reverse",
        "prop",
        "area",
        "prop",
        "properties",
        "sum",
        "np",
        "sum",
        "area",
        "cover",
        "sum",
        "area",
        "count",
        "count",
        "np",
        "zeros",
        "current_slice",
        "shape",
        "dtype",
        "j",
        "count",
        "properties",
        "j",
        "bbox",
        "bb",
        "bb",
        "bb",
        "bb",
        "bb",
        "bb",
        "bb",
        "bb",
        "properties",
        "j",
        "convex_image",
        "bw",
        "i",
        "measure",
        "label",
        "bw",
        "measure",
        "regionprops",
        "label",
        "properties",
        "sort",
        "key",
        "x",
        "x",
        "area",
        "reverse",
        "label",
        "properties",
        "label",
        "bw",
        "bw",
        "i",
        "bw",
        "shape",
        "bw",
        "i",
        "measure",
        "label",
        "current_slice",
        "measure",
        "regionprops",
        "label",
        "prop",
        "properties",
        "prop",
        "bbox",
        "bb",
        "bb",
        "bb",
        "bb",
        "current_slice",
        "bb",
        "bb",
        "bb",
        "bb",
        "prop",
        "filled_image",
        "current_slice",
        "bw",
        "np",
        "copy",
        "bw",
        "found_flag",
        "iter_count",
        "max_iter",
        "measure",
        "label",
        "bw",
        "connectivity",
        "measure",
        "regionprops",
        "label",
        "properties",
        "sort",
        "key",
        "x",
        "x",
        "area",
        "reverse",
        "len",
        "properties",
        "properties",
        "area",
        "properties",
        "area",
        "max_ratio",
        "label",
        "properties",
        "label",
        "label",
        "properties",
        "label",
        "scipy",
        "ndimage",
        "binary_erosion",
        "bw",
        "iter_count",
        "found_flag",
        "scipy",
        "ndimage",
        "morphology",
        "distance_transform_edt",
        "bw1",
        "sampling",
        "spacing",
        "scipy",
        "ndimage",
        "morphology",
        "distance_transform_edt",
        "bw2",
        "sampling",
        "spacing",
        "bw0",
        "d1",
        "d2",
        "bw0",
        "d1",
        "d2",
        "extract_main",
        "bw1",
        "extract_main",
        "bw2",
        "bw0",
        "np",
        "zeros",
        "bw",
        "shape",
        "astype",
        "fill_2d_hole",
        "bw1",
        "fill_2d_hole",
        "bw2",
        "bw1",
        "bw2",
        "bw1",
        "bw2",
        "bw",
        "case_path",
        "load_scan",
        "case_path",
        "get_pixels_hu",
        "binarize_per_slice",
        "case_pixels",
        "spacing",
        "np",
        "copy",
        "bw",
        "flag",
        "cut_num",
        "bw",
        "shape",
        "np",
        "copy",
        "bw0",
        "all_slice_analysis",
        "bw",
        "spacing",
        "cut_num",
        "cut_num",
        "vol_limit",
        "cut_num",
        "cut_step",
        "fill_hole",
        "bw",
        "two_lung_only",
        "bw",
        "spacing",
        "case_pixels",
        "bw1",
        "bw2",
        "spacing",
        "os",
        "listdir",
        "INPUT_FOLDER",
        "patients",
        "sort",
        "step1_python",
        "os",
        "path",
        "join",
        "INPUT_FOLDER",
        "patients",
        "plt",
        "imshow",
        "m1",
        "plt",
        "figure",
        "plt",
        "imshow",
        "m2"
    ],
    "literals": [
        "'/'",
        "'float32'",
        "'float32'",
        "'bool'",
        "'__main__'",
        "'/work/DataBowl3/stage1/stage1/'"
    ],
    "variables": [
        "slices",
        "sec_num",
        "sec_num",
        "slice_num",
        "slices",
        "slice_thickness",
        "slice_thickness",
        "s",
        "SliceThickness",
        "image",
        "image",
        "intercept",
        "slope",
        "image",
        "slice_number",
        "image",
        "slice_number",
        "bw",
        "image_size",
        "grid_axis",
        "x",
        "y",
        "d",
        "nan_mask",
        "nan_mask",
        "current_bw",
        "current_bw",
        "label",
        "properties",
        "valid_label",
        "current_bw",
        "bw",
        "i",
        "bw0",
        "bw",
        "label",
        "mid",
        "bg_label",
        "label",
        "properties",
        "label",
        "x_axis",
        "y_axis",
        "x",
        "y",
        "d",
        "vols",
        "valid_label",
        "single_vol",
        "slice_area",
        "min_distance",
        "slice_area",
        "i",
        "min_distance",
        "i",
        "bw",
        "bw1",
        "bw1",
        "bw2",
        "bw2",
        "bw3",
        "label",
        "label3",
        "l_list",
        "valid_l3",
        "indices",
        "l3",
        "bw",
        "label",
        "bg_label",
        "bw",
        "current_slice",
        "label",
        "properties",
        "area",
        "count",
        "sum",
        "sum",
        "count",
        "bb",
        "bw",
        "i",
        "label",
        "properties",
        "bw",
        "current_slice",
        "label",
        "properties",
        "bb",
        "current_slice",
        "bw",
        "i",
        "found_flag",
        "iter_count",
        "bw0",
        "label",
        "properties",
        "found_flag",
        "bw1",
        "bw2",
        "bw",
        "iter_count",
        "d1",
        "d2",
        "bw1",
        "bw2",
        "bw1",
        "bw2",
        "bw1",
        "bw2",
        "bw1",
        "bw2",
        "bw",
        "case_pixels",
        "spacing",
        "bw",
        "flag",
        "cut_num",
        "cut_step",
        "bw0",
        "bw",
        "bw",
        "flag",
        "cut_num",
        "bw",
        "bw1",
        "bw2",
        "bw",
        "INPUT_FOLDER",
        "patients",
        "case_pixels",
        "m1",
        "m2",
        "spacing"
    ],
    "comments": [
        "linear algebra",
        "data processing, CSV file I/O (e.g. pd.read_csv)",
        "Convert to int16 (from sometimes int16),",
        "should be possible as values should always be low enough (<32k)",
        "Convert to Hounsfield units (HU)",
        "prepare a mask, with all corner values set to nan",
        "Check if corner pixels are identical, if so the slice  before Gaussian filtering",
        "select proper components",
        "in some cases, several top layers need to be removed first",
        "remove components access to corners",
        "select components based on volume",
        "prepare a distance map for further analysis",
        "select components based on their area and distance to center axis on all slices",
        "fill back the parts removed earlier",
        "bw1 is bw with removed slices, bw2 is a dilated version of bw, part of their intersection is returned as final mask",
        "fill 3d holes",
        "idendify corner components",
        "first_patient = load_scan(INPUT_FOLDER + patients[25])",
        "first_patient_pixels, spacing = get_pixels_hu(first_patient)",
        "plt.hist(first_patient_pixels.flatten(), bins=80, color='c')",
        "plt.xlabel(\"Hounsfield Units (HU)\")",
        "plt.ylabel(\"Frequency\")",
        "plt.show()",
        "# Show some slice in the middle",
        "h = 80",
        "plt.imshow(first_patient_pixels[h], cmap=plt.cm.gray)",
        "plt.show()",
        "bw = binarize_per_slice(first_patient_pixels, spacing)",
        "plt.imshow(bw[h], cmap=plt.cm.gray)",
        "plt.show()",
        "flag = 0",
        "cut_num = 0",
        "while flag == 0:",
        "bw, flag = all_slice_analysis(bw, spacing, cut_num=cut_num)",
        "cut_num = cut_num + 1",
        "plt.imshow(bw[h], cmap=plt.cm.gray)",
        "plt.show()",
        "bw = fill_hole(bw)",
        "plt.imshow(bw[h], cmap=plt.cm.gray)",
        "plt.show()",
        "bw1, bw2, bw = two_lung_only(bw, spacing)",
        "plt.imshow(bw[h], cmap=plt.cm.gray)",
        "plt.show()"
    ],
    "docstrings": [],
    "functions": [
        "load_scan",
        "get_pixels_hu",
        "binarize_per_slice",
        "all_slice_analysis",
        "fill_hole",
        "two_lung_only",
        "extract_main",
        "fill_2d_hole",
        "step1_python"
    ],
    "classes": []
}