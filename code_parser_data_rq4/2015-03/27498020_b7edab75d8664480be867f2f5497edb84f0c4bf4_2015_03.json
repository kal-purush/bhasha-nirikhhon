{
    "identifiers": [
        "numpy",
        "np",
        "scipy",
        "ndimage",
        "nd",
        "itemgetter",
        "itertools",
        "groupby",
        "astropy",
        "io",
        "fits",
        "copy",
        "scipy",
        "optimize",
        "curve_fit",
        "astropy",
        "convolution",
        "convolve",
        "cube",
        "clip_level",
        "rms_noise",
        "kernel_size",
        "save_name",
        "property_arrays",
        "cube",
        "cube",
        "cube",
        "shape",
        "cube",
        "shape",
        "save_name",
        "np",
        "ones",
        "cube",
        "shape",
        "np",
        "invert",
        "np",
        "isnan",
        "cube",
        "dtype",
        "np",
        "ones",
        "cube",
        "shape",
        "np",
        "arange",
        "cube",
        "shape",
        "np",
        "tile",
        "vel_channels",
        "np",
        "newaxis",
        "np",
        "newaxis",
        "shape",
        "shape",
        "cube",
        "header",
        "rms_noise",
        "isinstance",
        "rms_noise",
        "rms_noise",
        "np",
        "ones",
        "shape",
        "sigma",
        "np",
        "ones",
        "shape",
        "clean_cube",
        "cube",
        "clip_level",
        "sigma",
        "clean_cube",
        "np",
        "ma",
        "masked_invalid",
        "cube",
        "clean_cube",
        "noise_array",
        "sigma",
        "given_noise_cube",
        "cube",
        "rms_noise",
        "clip_level",
        "noise_array",
        "clip_level",
        "sigma",
        "kernel_size",
        "ValueError",
        "clean_cube",
        "mask_cube",
        "sigma",
        "moment_masking",
        "cube",
        "clip_level",
        "kernel_size",
        "nan_mask",
        "mask_cube",
        "np",
        "sum",
        "clean_cube",
        "nan_mask",
        "axis",
        "np",
        "where",
        "moment0_array",
        "np",
        "NaN",
        "sigma",
        "np",
        "sqrt",
        "np",
        "sum",
        "nan_mask",
        "clean_cube",
        "axis",
        "property_dict",
        "moment0_array",
        "property_dict",
        "error_array",
        "np",
        "sum",
        "clean_cube",
        "nan_mask",
        "weight_cube",
        "axis",
        "property_dict",
        "sigma",
        "np",
        "sqrt",
        "np",
        "sum",
        "weight_cube",
        "np",
        "nonzero",
        "clean_cube",
        "nan_mask",
        "axis",
        "property_dict",
        "property_dict",
        "property_dict",
        "np",
        "sqrt",
        "first_err_term",
        "second_err_term",
        "property_dict",
        "centroid_array",
        "property_dict",
        "error_array",
        "clean_cube",
        "nan_mask",
        "np",
        "ones",
        "shape",
        "np",
        "ones",
        "shape",
        "i",
        "shape",
        "j",
        "shape",
        "np",
        "where",
        "masked_clean",
        "i",
        "j",
        "_",
        "g",
        "groupby",
        "z",
        "i",
        "x",
        "i",
        "x",
        "continuous_sections",
        "append",
        "itemgetter",
        "g",
        "max",
        "continuous_sections",
        "key",
        "len",
        "np",
        "sum",
        "masked_clean",
        "k",
        "i",
        "j",
        "k",
        "integrating_section",
        "np",
        "sqrt",
        "len",
        "integrating_section",
        "sigma",
        "ValueError",
        "np",
        "NaN",
        "np",
        "NaN",
        "property_dict",
        "int_intensity_array",
        "property_dict",
        "error_array",
        "clean_cube",
        "nan_mask",
        "weight_cube",
        "nan_mask",
        "np",
        "empty",
        "shape",
        "np",
        "empty",
        "shape",
        "i",
        "shape",
        "j",
        "shape",
        "np",
        "sqrt",
        "np",
        "sum",
        "weight_clean",
        "i",
        "j",
        "property_dict",
        "i",
        "j",
        "masked_clean",
        "i",
        "j",
        "property_dict",
        "i",
        "j",
        "np",
        "isclose",
        "linewidth_array",
        "i",
        "j",
        "rtol",
        "np",
        "sum",
        "weight_clean",
        "i",
        "j",
        "property_dict",
        "i",
        "j",
        "masked_clean",
        "i",
        "j",
        "property_dict",
        "i",
        "j",
        "sigma",
        "np",
        "sum",
        "weight_clean",
        "i",
        "j",
        "property_dict",
        "i",
        "j",
        "np",
        "sum",
        "weight_clean",
        "i",
        "j",
        "property_dict",
        "i",
        "j",
        "masked_clean",
        "i",
        "j",
        "sigma",
        "np",
        "sum",
        "nan_mask",
        "i",
        "j",
        "property_dict",
        "i",
        "j",
        "np",
        "sqrt",
        "first_err_term",
        "second_err_term",
        "property_dict",
        "linewidth_array",
        "property_dict",
        "error_array",
        "np",
        "abs",
        "header",
        "np",
        "abs",
        "header",
        "header",
        "np",
        "abs",
        "header",
        "header",
        "np",
        "sum",
        "weight_cube",
        "axis",
        "vel_pix_division",
        "reference_velocity",
        "vel_pix_division",
        "header",
        "sigma",
        "np",
        "sqrt",
        "np",
        "sum",
        "physical_weights",
        "clean_cube",
        "nan_mask",
        "axis",
        "property_dict",
        "property_dict",
        "property_dict",
        "np",
        "sqrt",
        "first_err_term",
        "second_err_term",
        "property_dict",
        "property_dict",
        "vel_pix_division",
        "reference_velocity",
        "vel_pix_division",
        "header",
        "property_dict",
        "cent_error_array",
        "property_dict",
        "property_dict",
        "vel_pix_division",
        "property_dict",
        "property_dict",
        "vel_pix_division",
        "property_dict",
        "property_dict",
        "vel_pix_division",
        "property_dict",
        "property_dict",
        "vel_pix_division",
        "copy",
        "deepcopy",
        "header",
        "new_hdr",
        "new_hdr",
        "new_hdr",
        "new_hdr",
        "new_hdr",
        "new_hdr",
        "update",
        "copy",
        "deepcopy",
        "new_hdr",
        "save_name",
        "header",
        "prop",
        "prop",
        "moment0_specs",
        "moment0_error_specs",
        "prop",
        "centroid_specs",
        "centroid_error_specs",
        "prop",
        "int_int_specs",
        "int_int_error_specs",
        "prop",
        "linewidth_specs",
        "linewidth_error_specs",
        "new_hdr",
        "update",
        "value",
        "specs",
        "comment",
        "new_hdr",
        "add_comment",
        "specs",
        "new_err_hdr",
        "update",
        "value",
        "specs",
        "comment",
        "new_err_hdr",
        "add_comment",
        "specs_error",
        "property_dict",
        "prop",
        "append",
        "new_hdr",
        "property_dict",
        "prop",
        "append",
        "new_err_hdr",
        "new_hdr",
        "new_err_hdr",
        "property",
        "property_dict",
        "save",
        "physical_units",
        "save_path",
        "moment0",
        "centroid",
        "linewidth",
        "integrated_intensity",
        "physical_units",
        "pixel_to_physical_units",
        "make_headers",
        "save",
        "prop",
        "save_path",
        "join",
        "save_path",
        "save_name",
        "prop",
        "join",
        "save_path",
        "save_name",
        "prop",
        "join",
        "save_name",
        "prop",
        "join",
        "save_name",
        "prop",
        "fits",
        "writeto",
        "filename",
        "property_dict",
        "prop",
        "property_dict",
        "prop",
        "fits",
        "writeto",
        "filename_err",
        "property_dict",
        "prop",
        "property_dict",
        "prop",
        "data_cube",
        "noise_cube",
        "clip_level",
        "data_cube",
        "shape",
        "noise_cube",
        "shape",
        "ValueError",
        "clip_level",
        "np",
        "where",
        "noise_cube",
        "np",
        "NaN",
        "data_cube",
        "noise_cube",
        "clip_level",
        "np",
        "invert",
        "clipped_cube",
        "dtype",
        "np",
        "max",
        "inv_cube",
        "data_cube",
        "axis",
        "np",
        "mean",
        "noise_array",
        "clipped_cube",
        "data_cube",
        "noise_array",
        "sigma",
        "data_cube",
        "clip_level",
        "np",
        "ravel",
        "data_cube",
        "np",
        "isnan",
        "data_cube",
        "np",
        "histogram",
        "flat_cube",
        "bins",
        "len",
        "flat_cube",
        "bins",
        "bins",
        "x",
        "p",
        "p",
        "np",
        "exp",
        "np",
        "power",
        "x",
        "p",
        "np",
        "power",
        "p",
        "np",
        "max",
        "hist",
        "centres",
        "np",
        "argmax",
        "hist",
        "curve_fit",
        "gaussian",
        "centres",
        "hist",
        "p0",
        "maxfev",
        "len",
        "hist",
        "opts",
        "p0",
        "opts",
        "opts",
        "data_cube",
        "clip_level",
        "kernel_size",
        "__sigma__",
        "data_cube",
        "clip_level",
        "np",
        "isnan",
        "data_cube",
        "gauss_kern",
        "kernel_size",
        "ysize",
        "kernel_size",
        "zsize",
        "kernel_size",
        "convolve",
        "data_cube",
        "kernel",
        "normalize_kernel",
        "nd",
        "gaussian_filter",
        "data_cube",
        "kernel_size",
        "mode",
        "__sigma__",
        "smooth_cube",
        "clip_level",
        "smooth_cube",
        "clip_level",
        "sigma_smooth",
        "nd",
        "generate_binary_structure",
        "nd",
        "binary_dilation",
        "mask_cube",
        "structure",
        "dilate_struct",
        "np",
        "invert",
        "mask_cube",
        "dtype",
        "data_cube",
        "mask_cube",
        "data_cube",
        "mask_cube",
        "sigma_orig",
        "size",
        "ysize",
        "zsize",
        "size",
        "ysize",
        "size",
        "ysize",
        "zsize",
        "size",
        "zsize",
        "np",
        "mgrid",
        "size",
        "size",
        "ysize",
        "ysize",
        "zsize",
        "zsize",
        "np",
        "exp",
        "x",
        "size",
        "y",
        "ysize",
        "z",
        "zsize",
        "g",
        "g",
        "sum"
    ],
    "literals": [
        "\"cube\"",
        "\"Kernel Size must be given for moment masking.\"",
        "\"moment0\"",
        "\"moment0_error\"",
        "\"moment0\"",
        "\"moment0\"",
        "\"moment0_error\"",
        "\"moment0\"",
        "\"centroid\"",
        "\"centroid_error\"",
        "\"integrated_intensity\"",
        "\"integrated_intensity_error\"",
        "\"centroid\"",
        "\"moment0\"",
        "\"centroid\"",
        "\"centroid_error\"",
        "\"centroid\"",
        "\"centroid\"",
        "\"moment0\"",
        "\"linewidth\"",
        "\"linewidth_error\"",
        "\"CDELT3\"",
        "\"CDELT3\"",
        "\"CRVAL3\"",
        "\"CDELT3\"",
        "\"CRVAL3\"",
        "\"CRPIX3\"",
        "\"moment0\"",
        "\"moment0_error\"",
        "\"moment0\"",
        "\"centroid\"",
        "\"centroid\"",
        "\"CRPIX3\"",
        "\"centroid_error\"",
        "\"integrated_intensity\"",
        "\"integrated_intensity\"",
        "\"integrated_intensity_error\"",
        "\"integrated_intensity_error\"",
        "\"linewidth\"",
        "\"linewidth\"",
        "\"linewidth_error\"",
        "\"linewidth_error\"",
        "\"NAXIS3\"",
        "\"CRVAL3\"",
        "\"CRPIX3\"",
        "'CDELT3'",
        "'CTYPE3'",
        "\"NAXIS\"",
        "\"OBJECT\"",
        "'comment'",
        "\"= Image of the Zeroth Moment\"",
        "'BUNIT'",
        "'K'",
        "'name'",
        "'moment0'",
        "'comment'",
        "\"= Image of the First Moment\"",
        "'BUNIT'",
        "'km/s'",
        "'name'",
        "'centroid'",
        "'comment'",
        "\"= Image of the Second Moment\"",
        "'BUNIT'",
        "'km/s'",
        "'name'",
        "'linewidth'",
        "'comment'",
        "\"= Image of the Integrated Intensity\"",
        "'BUNIT'",
        "'K km/s'",
        "'name'",
        "'integrated_intensity'",
        "'comment'",
        "\"= Image of the Zeroth Moment Error\"",
        "'BUNIT'",
        "'K'",
        "'name'",
        "'moment0'",
        "'comment'",
        "\"= Image of the First Moment Error\"",
        "'BUNIT'",
        "'km/s'",
        "'name'",
        "'centroid'",
        "'comment'",
        "\"= Image of the Second Moment Error\"",
        "'BUNIT'",
        "'km/s'",
        "'name'",
        "'linewidth'",
        "'comment'",
        "\"= Image of the Integrated Intensity Error\"",
        "'BUNIT'",
        "'K km/s'",
        "'name'",
        "'integrated_intensity'",
        "'moment0'",
        "'centroid'",
        "'integrated_intensity'",
        "'linewidth'",
        "'moment0'",
        "'centroid'",
        "'integrated_intensity'",
        "'linewidth'",
        "\"BUNIT\"",
        "'BUNIT'",
        "''",
        "\"comment\"",
        "\"BUNIT\"",
        "'BUNIT'",
        "''",
        "\"comment\"",
        "\"_error\"",
        "\"COMMENT\"",
        "\"COMMENT\"",
        "'moment0'",
        "'centroid'",
        "'integrated_intensity'",
        "'linewidth'",
        "\"\"",
        "\".\"",
        "\".fits\"",
        "\"\"",
        "\".\"",
        "\"_error.fits\"",
        "\"\"",
        "\".\"",
        "\".fits\"",
        "\"\"",
        "\".\"",
        "\"_error.fits\"",
        "\"_error\"",
        "\"_error\"",
        "\"Error array has different dimensions.\"",
        "\"Fitting Failed. Sigma is %s\"",
        "\"Using astropy to convolve over nans\"",
        "\"mirror\"",
        "'__main__'"
    ],
    "variables": [
        "cube",
        "header",
        "shape",
        "save_name",
        "clean_cube",
        "noise_array",
        "nan_mask",
        "weight_cube",
        "vel_channels",
        "weight_cube",
        "sigma",
        "property_dict",
        "noise_type_flag",
        "sigma",
        "noise_array",
        "noise_mask",
        "noise_type_flag",
        "noise_mask",
        "noise_type_flag",
        "moment0_array",
        "moment0_array",
        "error_array",
        "centroid_array",
        "first_err_term",
        "second_err_term",
        "error_array",
        "masked_clean",
        "int_intensity_array",
        "error_array",
        "z",
        "continuous_sections",
        "integrating_section",
        "int_intensity_array",
        "i",
        "j",
        "error_array",
        "i",
        "j",
        "int_intensity_array",
        "i",
        "j",
        "error_array",
        "i",
        "j",
        "masked_clean",
        "weight_clean",
        "linewidth_array",
        "error_array",
        "linewidth_array",
        "i",
        "j",
        "error_array",
        "i",
        "j",
        "first_err_term",
        "second_err_term",
        "error_array",
        "i",
        "j",
        "vel_pix_division",
        "reference_velocity",
        "vel_pix_division",
        "reference_velocity",
        "physical_weights",
        "first_err_term",
        "second_err_term",
        "cent_error_array",
        "new_hdr",
        "new_err_hdr",
        "save_name",
        "moment0_specs",
        "centroid_specs",
        "linewidth_specs",
        "int_int_specs",
        "moment0_error_specs",
        "centroid_error_specs",
        "linewidth_error_specs",
        "int_int_error_specs",
        "specs",
        "specs_error",
        "specs",
        "specs_error",
        "specs",
        "specs_error",
        "specs",
        "specs_error",
        "filename",
        "filename_err",
        "filename",
        "filename_err",
        "noise_cube",
        "clipped_cube",
        "inv_cube",
        "noise_array",
        "sigma",
        "flat_cube",
        "hist",
        "bins",
        "centres",
        "p0",
        "opts",
        "cov",
        "sigma_orig",
        "kernel",
        "smooth_cube",
        "smooth_cube",
        "sigma_smooth",
        "mask_cube",
        "dilate_struct",
        "mask_cube",
        "noise_cube",
        "size",
        "ysize",
        "ysize",
        "zsize",
        "zsize",
        "x",
        "y",
        "z",
        "g"
    ],
    "comments": [
        "Licensed under an MIT open source license - see LICENSE",
        "cube.data",
        "cube.header",
        "self.noise_mask = self.noise_array < (clip_level * self.sigma)",
        "moment0_array *= self.noise_mask",
        "error_array *= self.noise_mask",
        "centroid_array *= self.noise_mask",
        "error_array *= self.noise_mask",
        "Lazy check to make sure we have units of km/s",
        "Centroid error needs to be recalculated when changing to physical",
        "units",
        "cent_error_array *= self.noise_mask",
        "Update header for array and the error array",
        "Reset the comments",
        "Append headers in the dict.",
        "Peak Height is p[0],Sigma is p[1],Mu is p[2]",
        "noise_array = np.max(noise_cube, axis=0)",
        "import sys",
        "fib(int(sys.argv[1]))",
        "from astropy.io.fits import getdata",
        "cube, header = getdata(\"filename\",header=True)",
        "shape = cube.shape",
        "cube[:,shape[0],:] = cube[:,0,:]",
        "cube[:,:,shape[1]] = cube[:,:,0]",
        "data = property_arrays((cube,header), rms_noise=0.001, save_name=\"filename\")",
        "data.return_all()"
    ],
    "docstrings": [
        "'''\n\nData Reduction Routines for PPV data cubes\n\n'''",
        "'''\n\n    Create property arrays from a data cube\n\n    Creates centroid (moment 1), integrated intensity,\n    velocity dispersion (moment 2), total intensity (moment 0).\n\n    '''",
        "\"\"\" Returns a normalized 3D gauss kernel array for convolutions \"\"\""
    ],
    "functions": [
        "moment0",
        "centroid",
        "integrated_intensity",
        "linewidth",
        "pixel_to_physical_units",
        "make_headers",
        "dataset",
        "return_all",
        "given_noise_cube",
        "__sigma__",
        "gaussian",
        "moment_masking",
        "gauss_kern"
    ],
    "classes": [
        "property_arrays"
    ]
}