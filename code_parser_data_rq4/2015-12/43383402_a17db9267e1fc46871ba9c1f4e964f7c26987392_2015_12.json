{
    "identifiers": [
        "sys",
        "traceback",
        "datetime",
        "bridge",
        "ThreatExchangeConnector",
        "pytx",
        "ThreatDescriptor",
        "sqlite3",
        "re",
        "dateutil",
        "parser",
        "dateutil",
        "tz",
        "json",
        "processing_engines",
        "re",
        "compile",
        "datetime",
        "datetime",
        "year",
        "month",
        "day",
        "tzinfo",
        "confidence",
        "conf_level",
        "confidence_level_map",
        "confidence",
        "conf_level",
        "conf_level",
        "cursor",
        "arraysize",
        "cursor",
        "fetchmany",
        "arraysize",
        "results",
        "result",
        "results",
        "result",
        "cur",
        "result",
        "result",
        "owner",
        "owner_cache",
        "cur",
        "execute",
        "result",
        "owner",
        "cur",
        "fetchone",
        "owner_cache",
        "add",
        "result",
        "owner",
        "result",
        "owner",
        "cur",
        "execute",
        "owner",
        "owner",
        "owner",
        "get",
        "result",
        "id",
        "result",
        "status",
        "result",
        "raw_indicator",
        "result",
        "result",
        "severity",
        "dateutil",
        "parser",
        "parse",
        "result",
        "last_updated",
        "replace",
        "tzinfo",
        "result",
        "threat_type",
        "result",
        "owner",
        "result",
        "description",
        "result",
        "share_level",
        "result",
        "confidence",
        "confidence_band",
        "result",
        "confidence",
        "join",
        "len",
        "insert_values",
        "join",
        "insert_values",
        "keys",
        "qstring",
        "cur",
        "execute",
        "sql_query",
        "insert_values",
        "values",
        "minimum_severity",
        "status_filter",
        "minimum_confidence",
        "processing_engines",
        "SEVERITY_LEVELS",
        "processing_engines",
        "SEVERITY_LEVELS",
        "index",
        "minimum_severity",
        "query",
        "append",
        "join",
        "severity_level",
        "severity_level",
        "severity_levels",
        "status_filter",
        "query",
        "append",
        "join",
        "status",
        "status",
        "status_filter",
        "query",
        "append",
        "minimum_confidence",
        "join",
        "query",
        "fn",
        "fn",
        "sqlite3",
        "connect",
        "dbfn",
        "detect_types",
        "sqlite3",
        "PARSE_DECLTYPES",
        "sqlite3",
        "PARSE_COLNAMES",
        "dbconn",
        "sqlite3",
        "Row",
        "dbconn",
        "execute",
        "cur",
        "fetchone",
        "create_tables",
        "dbconn",
        "executescript",
        "db_schema",
        "dbconn",
        "commit",
        "minimum_severity",
        "status_filter",
        "minimum_confidence",
        "dbconn",
        "cursor",
        "build_sql_query",
        "minimum_severity",
        "status_filter",
        "minimum_confidence",
        "q",
        "cur",
        "execute",
        "q",
        "res",
        "ResultIter",
        "cur",
        "processing_engines",
        "process_ioc",
        "res",
        "minimum_severity",
        "status_filter",
        "minimum_confidence",
        "report",
        "new_reports",
        "report",
        "ts",
        "dbconn",
        "execute",
        "ts",
        "dbconn",
        "commit",
        "ioc_types",
        "datetime",
        "datetime",
        "utcnow",
        "now",
        "datetime",
        "timedelta",
        "days",
        "now",
        "datetime",
        "timedelta",
        "days",
        "dbconn",
        "execute",
        "cur",
        "fetchone",
        "s",
        "dateutil",
        "parser",
        "parse",
        "s",
        "sqlite3",
        "OperationalError",
        "create_tables",
        "since_date",
        "strftime",
        "to_date",
        "strftime",
        "ioc_type",
        "ioc_types",
        "ioc_type",
        "since_date",
        "to_date",
        "result",
        "ThreatDescriptor",
        "objects",
        "since",
        "since_date",
        "until",
        "to_date",
        "type_",
        "ioc_type",
        "limit",
        "retries",
        "fields",
        "sys",
        "stdout",
        "write",
        "sys",
        "stdout",
        "flush",
        "dbconn",
        "cursor",
        "add_one_result",
        "cur",
        "result",
        "e",
        "traceback",
        "print_exc",
        "result",
        "to_dict",
        "dbconn",
        "rollback",
        "dbconn",
        "commit",
        "owner_cache",
        "add",
        "result",
        "owner",
        "cur",
        "close",
        "ThreatExchangeConnector",
        "logfile",
        "debug",
        "tx",
        "validate_config",
        "ThreatExchangeDb",
        "db",
        "cull_before",
        "dateutil",
        "parser",
        "parse",
        "db",
        "update",
        "tx",
        "create_feed",
        "report",
        "db",
        "generate_reports",
        "minimum_confidence",
        "minimum_severity",
        "new_feed",
        "add_report",
        "report",
        "count",
        "json",
        "dumps",
        "new_feed",
        "retrieve_feed",
        "sys",
        "exit",
        "main"
    ],
    "literals": [
        "\"([^ T]*)[T ](\\d+:\\d+:\\d+)(\\.\\d+)?(([\\+\\-Z])(.*))?\"",
        "\"LOW\"",
        "\"MEDIUM\"",
        "\"HIGH\"",
        "'An iterator that uses fetchmany to keep memory usage down'",
        "\"id\"",
        "\"SELECT * FROM owners WHERE id = ?\"",
        "\"id\"",
        "\"id\"",
        "\"INSERT INTO owners VALUES (?, ?, ?)\"",
        "\"id\"",
        "\"name\"",
        "\"email\"",
        "\"\"",
        "\"id\"",
        "\"status\"",
        "\"indicator\"",
        "\"indicator_type\"",
        "\"severity\"",
        "\"last_updated\"",
        "\"threat_type\"",
        "\"owner_id\"",
        "\"id\"",
        "\"description\"",
        "\"share_level\"",
        "\"confidence\"",
        "\"confidence_band\"",
        "\"(\"",
        "\", \"",
        "\"?\"",
        "\")\"",
        "\"INSERT OR REPLACE INTO indicator_descriptors (%s) VALUES %s\"",
        "\", \"",
        "'WARNING'",
        "\"SELECT * FROM indicator_descriptors,owners WHERE indicator_descriptors.owner_id = owners.id\"",
        "\"(%s)\"",
        "\" OR \"",
        "\"severity = '%s'\"",
        "\" AND \"",
        "\"status <> '%s'\"",
        "\"confidence >= %d\"",
        "\" AND \"",
        "\"SELECT count(*) FROM indicator_descriptors\"",
        "'WARNING'",
        "\"DELETE FROM indicator_descriptors WHERE last_updated < ?\"",
        "\"SELECT max(last_updated) FROM indicator_descriptors\"",
        "\"%Y-%m-%dT%H:%M:%S+0000\"",
        "\"%Y-%m-%d\"",
        "\"querying %s from %s to %s\"",
        "\"raw_indicator,owner,indicator{id,indicator},type,\"",
        "\"last_updated,share_level,severity,description,report_urls,\"",
        "\"status,confidence,threat_type\"",
        "'.'",
        "\"id\"",
        "\"threatexchangeconnector\"",
        "\"testing.config\"",
        "\"/tmp/cb-tx-test.log\"",
        "\"/tmp/blah.db\"",
        "'2012-12-09'",
        "\"IP_ADDRESS\"",
        "\"HASH_MD5\"",
        "\"DOMAIN\"",
        "\"UNKNOWN\"",
        "'__main__'"
    ],
    "variables": [
        "db_schema",
        "owner_cache",
        "tz_pattern",
        "unix_epoch",
        "confidence_level_map",
        "results",
        "owner",
        "insert_values",
        "qstring",
        "sql_query",
        "query",
        "severity_levels",
        "dbfn",
        "dbconn",
        "row_factory",
        "cur",
        "count",
        "cur",
        "q",
        "new_reports",
        "now",
        "since_date",
        "to_date",
        "cur",
        "s",
        "since_date",
        "since_date",
        "to_date",
        "cur",
        "tx",
        "db",
        "new_feed",
        "count"
    ],
    "comments": [
        "strip timezone",
        "tx.perform_feed_retrieval()",
        "f = file('/tmp/cb-out.json', 'wb')",
        "f.write(tx.handle_json_feed_request().get_data())",
        "f.close()"
    ],
    "docstrings": [
        "'''\ndrop table if exists owners;\ndrop table if exists indicator_descriptors;\ndrop index if exists descriptor_id_index;\ndrop index if exists owner_id_index;\ndrop index if exists descriptor_time_index;\n\ncreate table owners (\n  id text primary key,\n  name text,\n  email text\n);\n\ncreate table indicator_descriptors (\n  id text primary key,\n  status text,\n  indicator text,\n  indicator_type text,\n  severity text,\n  last_updated timestamp,\n  threat_type text,\n  owner_id text,\n  description text,\n  share_level text,\n  confidence integer,\n  confidence_band text,\n\n  FOREIGN KEY(owner_id) REFERENCES owners(id)\n);\n\ncreate unique index descriptor_id_index on indicator_descriptors(id);\ncreate unique index owner_id_index on owners(id);\ncreate index descriptor_time_index on indicator_descriptors(last_updated);\n'''"
    ],
    "functions": [
        "confidence_band",
        "ResultIter",
        "add_one_result",
        "build_sql_query",
        "create_tables",
        "generate_reports",
        "cull_before",
        "update",
        "main"
    ],
    "classes": [
        "ThreatExchangeDb"
    ]
}