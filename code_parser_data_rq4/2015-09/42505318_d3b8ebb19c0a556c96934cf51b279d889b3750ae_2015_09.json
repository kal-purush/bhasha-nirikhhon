{
    "identifiers": [
        "sys",
        "copy",
        "argparse",
        "biom",
        "taxonomies",
        "len",
        "taxonomies",
        "copy",
        "copy",
        "taxonomies",
        "curr_taxonomy",
        "taxonomies",
        "rank",
        "taxon",
        "curr_taxonomy",
        "consensus",
        "rank",
        "consensus",
        "rank",
        "taxon",
        "rank",
        "len",
        "consensus",
        "ancestor",
        "consensus",
        "rank",
        "consensus",
        "reference_file",
        "line",
        "open",
        "reference_file",
        "readlines",
        "line",
        "startswith",
        "line",
        "strip",
        "split",
        "parts",
        "endswith",
        "parts",
        "rank",
        "taxon",
        "parts",
        "split",
        "taxon",
        "split",
        "strip",
        "rank",
        "taxon_name",
        "taxonomy",
        "append",
        "taxon_name",
        "parts",
        "taxonomy",
        "taxonomy_by_seqid",
        "rdp_files",
        "current_rdp",
        "rdp_files",
        "open",
        "current_rdp",
        "line",
        "FH_rdp",
        "line",
        "strip",
        "split",
        "fields",
        "idx",
        "len",
        "fields",
        "idx",
        "fields",
        "idx",
        "taxonomy",
        "append",
        "fields",
        "idx",
        "split",
        "strip",
        "bootstraps",
        "append",
        "fields",
        "idx",
        "rdp_annot",
        "cluster_id",
        "taxonomy",
        "rdp_annot",
        "cluster_id",
        "bootstraps",
        "FH_rdp",
        "close",
        "rdp_annot",
        "blast_files",
        "taxonomy_by_subject",
        "current_blast",
        "blast_files",
        "open",
        "current_blast",
        "line",
        "FH_blast",
        "line",
        "strip",
        "split",
        "parts",
        "split",
        "parts",
        "blast_annot",
        "has_key",
        "query_id",
        "blast_annot",
        "query_id",
        "score",
        "score",
        "blast_annot",
        "query_id",
        "score",
        "parts",
        "split",
        "blast_annot",
        "query_id",
        "append",
        "subject_id",
        "taxonomy_by_subject",
        "subject_id",
        "parts",
        "parts",
        "parts",
        "parts",
        "parts",
        "parts",
        "FH_blast",
        "close",
        "blast_annot",
        "reference_file",
        "biom_in",
        "biom_out",
        "blast_files",
        "rdp_files",
        "get_tax_from_fasta",
        "reference_file",
        "blast_files",
        "get_bests_blast_affi",
        "blast_files",
        "taxonomy_by_reference",
        "taxonomy_by_reference",
        "rdp_files",
        "get_rdp_affi",
        "rdp_files",
        "BiomIO",
        "from_json",
        "biom_in",
        "cluster",
        "biom",
        "get_observations",
        "cluster",
        "blast_files",
        "cluster_blast_annot",
        "has_key",
        "cluster_id",
        "get_tax_consensus",
        "alignment",
        "alignment",
        "cluster_blast_annot",
        "cluster_id",
        "cluster_blast_annot",
        "cluster_id",
        "biom",
        "add_metadata",
        "cluster_id",
        "blast_affiliations",
        "biom",
        "add_metadata",
        "cluster_id",
        "blast_taxonomy",
        "rdp_files",
        "cluster_rdp_annot",
        "has_key",
        "cluster_id",
        "cluster_rdp_annot",
        "cluster_id",
        "cluster_rdp_annot",
        "cluster_id",
        "biom",
        "add_metadata",
        "cluster_id",
        "rdp_taxonomy",
        "biom",
        "add_metadata",
        "cluster_id",
        "bootstrap",
        "BiomIO",
        "write",
        "biom_out",
        "biom",
        "argparse",
        "ArgumentParser",
        "description",
        "parser",
        "add_argument",
        "action",
        "version",
        "__version__",
        "parser",
        "add_argument_group",
        "group_input",
        "add_argument",
        "required",
        "help",
        "group_input",
        "add_argument",
        "nargs",
        "required",
        "help",
        "group_input",
        "add_argument",
        "nargs",
        "required",
        "help",
        "group_input",
        "add_argument",
        "required",
        "help",
        "parser",
        "add_argument_group",
        "group_output",
        "add_argument",
        "required",
        "help",
        "parser",
        "parse_args",
        "args",
        "blast_file",
        "args",
        "rdp_file",
        "aff_to_metadata",
        "args",
        "reference",
        "args",
        "biom_in",
        "args",
        "biom_out",
        "args",
        "blast_file",
        "args",
        "rdp_file"
    ],
    "literals": [
        "'Maria Bernard - Sigenae AND Frederic Escudie - Plateforme bioinformatique Toulouse'",
        "'Copyright (C) 2015 INRA'",
        "'GNU General Public License'",
        "'2.2.1'",
        "'frogs@toulouse.inra.fr'",
        "'prod'",
        "\"Multi-affiliation\"",
        "\"Multi-affiliation\"",
        "\"\"",
        "\"Multi-affiliation\"",
        "\"Multi-affiliation\"",
        "'>'",
        "';'",
        "\";\"",
        "'[id:'",
        "\"Root\"",
        "\"\\t\"",
        "\"rootrank\"",
        "'[id:'",
        "'taxonomy'",
        "'bootstrap'",
        "\";\"",
        "'score'",
        "'score'",
        "'alignments'",
        "'score'",
        "\"#\"",
        "'alignments'",
        "'subject'",
        "'taxonomy'",
        "'evalue'",
        "'aln_length'",
        "'perc_identity'",
        "'perc_query_coverage'",
        "\"id\"",
        "'taxonomy'",
        "'alignments'",
        "'alignments'",
        "\"blast_affiliations\"",
        "\"observation\"",
        "\"blast_taxonomy\"",
        "\"observation\"",
        "'taxonomy'",
        "'bootstrap'",
        "\"rdp_taxonomy\"",
        "\"observation\"",
        "\"rdp_bootstrap\"",
        "\"observation\"",
        "\"__main__\"",
        "'Add affiliation results from Blast and/or RDP to BIOM file.'",
        "'-v'",
        "'--version'",
        "'version'",
        "'Inputs'",
        "'-f'",
        "'--reference'",
        "'Preformated reference file.'",
        "'-b'",
        "'--blast-file'",
        "\"*\"",
        "'Path to Blast output file.'",
        "'-r'",
        "'--rdp-file'",
        "\"*\"",
        "'Path to RDP Classifier output file.'",
        "'-i'",
        "'--biom-in'",
        "'Path to biom input file'",
        "'Outputs'",
        "'-o'",
        "'--biom-out'",
        "'Path to biom output file'",
        "\"at least one blast or one RDPClassifier output file is needed\\n\""
    ],
    "variables": [
        "__author__",
        "__copyright__",
        "__license__",
        "__version__",
        "__email__",
        "__status__",
        "consensus",
        "consensus",
        "consensus",
        "rank",
        "ancestor",
        "consensus",
        "rank",
        "ancestor",
        "taxonomy_by_seqid",
        "parts",
        "parts",
        "taxonomy",
        "taxon_name",
        "taxonomy_by_seqid",
        "rdp_annot",
        "FH_rdp",
        "fields",
        "cluster_id",
        "taxonomy",
        "bootstraps",
        "rdp_annot",
        "cluster_id",
        "blast_annot",
        "FH_blast",
        "parts",
        "query_id",
        "score",
        "blast_annot",
        "query_id",
        "subject_id",
        "taxonomy_by_reference",
        "cluster_blast_annot",
        "cluster_blast_annot",
        "cluster_rdp_annot",
        "cluster_rdp_annot",
        "biom",
        "cluster_id",
        "blast_taxonomy",
        "blast_affiliations",
        "blast_taxonomy",
        "blast_affiliations",
        "rdp_taxonomy",
        "rdp_bootstrap",
        "rdp_taxonomy",
        "bootstrap",
        "parser",
        "group_input",
        "group_output",
        "args"
    ],
    "comments": [
        "!/usr/bin/env python2.7",
        "",
        "Copyright (C) 2014 INRA",
        "",
        "This program is free software: you can redistribute it and/or modify",
        "it under the terms of the GNU General Public License as published by",
        "the Free Software Foundation, either version 3 of the License, or",
        "(at your option) any later version.",
        "",
        "This program is distributed in the hope that it will be useful,",
        "but WITHOUT ANY WARRANTY; without even the implied warranty of",
        "MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the",
        "GNU General Public License for more details.",
        "",
        "You should have received a copy of the GNU General Public License",
        "along with this program.  If not, see <http://www.gnu.org/licenses/>.",
        "",
        "",
        "",
        "FUNCTIONS",
        "",
        "",
        "Clean case with same taxon name in different branches:",
        "with taxonomies = [[\"A\", \"B\", \"C\"], [\"A\", \"L\", \"C\"]]",
        "consensus is [\"A\", \"Multi-affiliation\", \"C\"] but must be [\"A\", \"Multi-affiliation\", \"Multi-affiliation\"]",
        "Line example : '>ADC62191 Bacteria; Proteobacteria; Gammaproteobacteria; Chromatiales; Chromatiaceae; Allochromatium.; Allochromatium vinosum DSM 180'",
        "Removes last ';'",
        "Removes '[id:XXX]' in taxon name",
        "Skips the taxon named 'Root'.",
        "select best HSP",
        "Subject field : <ID>#<PARTIAL_DESC>",
        "Build an hash with the taxonomy for each gene (key=gene_id ; value=gene_taxonomy)",
        "Retrieve blast clusters annotations",
        "Retrieve rdp clusters annotations",
        "Add metadata to biom",
        "Blast",
        "Current observation has a match",
        "RDP",
        "",
        "",
        "MAIN",
        "",
        "",
        "Manage parameters",
        "Inputs",
        "Outputs",
        "Process"
    ],
    "docstrings": [
        "\"\"\"\n    @summary: Returns a consensus taxonomy from list of taxonomies.\n    @param taxonomies: [list] The taxonomies to process. Each taxonomy is a list of rank taxon.\n    @return: [list] The consensus taxonomy. The ambiguous ranks are replaced by \"Multi-affiliation\".\n    @note:\n        taxonomies = [ [\"Bacteria\", \"Proteobacteria\", \"Gamma Proteobacteria\", \"Enterobacteriales\"],\n                       [\"Bacteria\", \"Proteobacteria\", \"Beta Proteobacteria\", \"Methylophilales\"] ]\n        return = [\"Bacteria\", \"Proteobacteria\", \"Multi-affiliation\", \"Multi-affiliation\"]\n    \"\"\"",
        "\"\"\"\n    @summary: Returns taxonomies by sequence ID from a reference databank.\n    @param reference_file: [str] Path to the fasta with taxonomy in sequences descriptions.\n    @return: [dict] The taxonomies by sequence ID.\n    @note: Fasta sequence header example : '>ADC62191 Bacteria; Proteobacteria; Gammaproteobacteria; Chromatiales; Chromatiaceae; Allochromatium.; Allochromatium vinosum DSM 180'\n    \"\"\"",
        "\"\"\"\n    @summary: Returns taxonomies and bootstraps by query ID from a RDP result files.\n    @param rdp_files: [list] Path to the RDP result files.\n    @return: [dict] The taxonomies and bootstrap by sequence ID.\n    \"\"\"",
        "\"\"\"\n    @summary: Returns by query ID the blast metrics for the best HSP(s).\n    @param blast_files: [list] Path to the blast 'outfmt 6' result files.\n    @param taxonomy_by_subject: [dict] The taxonomies by subject sequence ID.\n    @return: [dict] The blast metrics by sequence ID. Example:\n        [\n            'query_12': [\n                {\n                    \"perc_identity\": 100.0,\n                    \"taxonomy\": [\n                        \"Bacteria\",\n                        \"Bacteroidetes\",\n                        \"Bacteroidia\",\n                        \"Bacteroidales\",\n                        \"Bacteroidaceae\",\n                        \"Bacteroides\",\n                        \"unknown species\"\n                    ],\n                    \"evalue\": \"0.0\",\n                    \"perc_query_coverage\": 100.0,\n                    \"subject\": \"FJ507190.1.1382\",\n                    \"aln_length\": 450\n                },\n                {\n                    \"perc_identity\": 100.0,\n                    \"taxonomy\": [\n                    \"Bacteria\",\n                        \"Bacteroidetes\",\n                        \"Bacteroidia\",\n                        \"Bacteroidales\",\n                        \"Bacteroidaceae\",\n                        \"Bacteroides\",\n                        \"unknown species\"\n                    ],\n                    \"evalue\": \"0.0\",\n                    \"perc_query_coverage\": 100.0,\n                    \"subject\": \"FJ507188.1.1382\",\n                    \"aln_length\": 450\n                },\n            ],\n            'query_15': [\n            ...\n        ]\n\n    \"\"\"",
        "\"\"\"\n    @summary: Add taxonomy metadata on biom file from a blast result.\n    @param reference_file: [str] The path to the reference file.\n    @param biom_in: [str] The path to the Biom file to process.\n    @param biom_out: [str] The path to the biom output file.\n    @param blast_files: [list] the list of the path to the blast results in tabular format (outfmt 6 with NCBI Blast+).\n    @param rdp_files: [list] the list of path to the RDPClassifier results.\n    \"\"\""
    ],
    "functions": [
        "get_tax_consensus",
        "get_tax_from_fasta",
        "get_rdp_affi",
        "get_bests_blast_affi",
        "aff_to_metadata"
    ],
    "classes": []
}