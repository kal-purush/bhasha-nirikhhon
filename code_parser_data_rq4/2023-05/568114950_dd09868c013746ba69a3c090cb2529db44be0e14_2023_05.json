{
    "identifiers": [
        "sys",
        "sys",
        "path",
        "append",
        "utils_gluex",
        "mkdir",
        "calcuate_accu",
        "filter_nan_for_dict",
        "numpy",
        "np",
        "datasets",
        "da",
        "datasets",
        "disable_caching",
        "disable_caching",
        "datasets",
        "load_metric",
        "load_dataset",
        "Value",
        "transformers",
        "AutoTokenizer",
        "DataCollatorWithPadding",
        "datasets",
        "concatenate_datasets",
        "transformers",
        "AutoModel",
        "torch",
        "time",
        "os",
        "json",
        "tqdm",
        "math",
        "ceil",
        "pandas",
        "pd",
        "transformers",
        "transformers",
        "get_linear_schedule_with_warmup",
        "torch",
        "utils",
        "data",
        "Dataset",
        "DataLoader",
        "torch",
        "source",
        "target",
        "kernel_mul",
        "kernel_num",
        "fix_sigma",
        "source",
        "size",
        "target",
        "size",
        "torch",
        "cat",
        "source",
        "target",
        "dim",
        "total",
        "unsqueeze",
        "expand",
        "total",
        "size",
        "total",
        "size",
        "total",
        "size",
        "total",
        "unsqueeze",
        "expand",
        "total",
        "size",
        "total",
        "size",
        "total",
        "size",
        "total0",
        "total1",
        "sum",
        "fix_sigma",
        "fix_sigma",
        "torch",
        "sum",
        "L2_distance",
        "data",
        "n_samples",
        "n_samples",
        "bandwidth",
        "kernel_mul",
        "kernel_num",
        "bandwidth",
        "kernel_mul",
        "i",
        "i",
        "kernel_num",
        "torch",
        "exp",
        "L2_distance",
        "bandwidth_temp",
        "bandwidth_temp",
        "bandwidth_list",
        "sum",
        "kernel_val",
        "source",
        "target",
        "kernel_mul",
        "kernel_num",
        "fix_sigma",
        "source",
        "size",
        "guassian_kernel",
        "source",
        "target",
        "kernel_mul",
        "kernel_mul",
        "kernel_num",
        "kernel_num",
        "fix_sigma",
        "fix_sigma",
        "torch",
        "mean",
        "kernels",
        "batch_size",
        "batch_size",
        "torch",
        "mean",
        "kernels",
        "batch_size",
        "batch_size",
        "torch",
        "mean",
        "kernels",
        "batch_size",
        "batch_size",
        "torch",
        "mean",
        "kernels",
        "batch_size",
        "batch_size",
        "XX",
        "YY",
        "XY",
        "YX",
        "loss",
        "ranking",
        "ood_tasks",
        "ranking",
        "task_names_ID",
        "glue_task_names",
        "args",
        "load_dataset",
        "args",
        "cache_dir",
        "data",
        "features",
        "keys",
        "data",
        "remove_columns",
        "args",
        "data",
        "examples",
        "round",
        "examples",
        "args",
        "data",
        "rename_column",
        "data",
        "rename_column",
        "args",
        "args",
        "args",
        "data",
        "rename_column",
        "data",
        "rename_column",
        "args",
        "data",
        "rename_column",
        "data",
        "rename_column",
        "data",
        "utils_lp",
        "preprocess_data",
        "preprocess_data_ood",
        "Dataset",
        "split",
        "dataframe",
        "tokenizer",
        "args",
        "seed",
        "num",
        "dataframe",
        "args",
        "data",
        "shuffle",
        "seed",
        "seed",
        "select",
        "num",
        "num",
        "args",
        "data",
        "examples",
        "tokenizer",
        "examples",
        "examples",
        "truncation",
        "add_special_tokens",
        "max_length",
        "max_len",
        "pad_to_max_length",
        "return_token_type_ids",
        "batched",
        "load_from_cache_file",
        "data",
        "remove_columns",
        "args",
        "data",
        "examples",
        "tokenizer",
        "examples",
        "truncation",
        "add_special_tokens",
        "max_length",
        "max_len",
        "pad_to_max_length",
        "return_token_type_ids",
        "batched",
        "load_from_cache_file",
        "data",
        "remove_columns",
        "index",
        "data",
        "index",
        "inputs",
        "inputs",
        "inputs",
        "torch",
        "tensor",
        "ids",
        "dtype",
        "torch",
        "torch",
        "tensor",
        "mask",
        "dtype",
        "torch",
        "torch",
        "tensor",
        "targets",
        "dtype",
        "torch",
        "len",
        "data",
        "torch",
        "nn",
        "Module",
        "args",
        "Classifier",
        "AutoModel",
        "from_pretrained",
        "os",
        "path",
        "basename",
        "args",
        "args",
        "l1",
        "config",
        "l1",
        "config",
        "eos_token_id",
        "input_ids",
        "attention_mask",
        "l1",
        "input_ids",
        "input_ids",
        "attention_mask",
        "attention_mask",
        "output_1",
        "hidden_state",
        "pooler",
        "args",
        "model",
        "training_loader_0",
        "training_loader_1",
        "model",
        "eval",
        "torch",
        "no_grad",
        "_",
        "data",
        "training_loader_0",
        "torch",
        "cuda",
        "empty_cache",
        "data",
        "to",
        "args",
        "dtype",
        "torch",
        "data",
        "to",
        "args",
        "dtype",
        "torch",
        "model",
        "ids",
        "mask",
        "squeeze",
        "output_0",
        "append",
        "outputs",
        "to",
        "args",
        "_",
        "data",
        "training_loader_1",
        "torch",
        "cuda",
        "empty_cache",
        "data",
        "to",
        "args",
        "dtype",
        "torch",
        "data",
        "to",
        "args",
        "dtype",
        "torch",
        "model",
        "ids",
        "mask",
        "squeeze",
        "output_1",
        "append",
        "outputs",
        "to",
        "args",
        "model",
        "torch",
        "cuda",
        "empty_cache",
        "torch",
        "cat",
        "output_0",
        "dim",
        "torch",
        "cat",
        "output_1",
        "dim",
        "mmd_rbf",
        "source",
        "output_0",
        "target",
        "output_1",
        "MMD_reuslt",
        "MMD_reuslt",
        "args",
        "time",
        "time",
        "AutoTokenizer",
        "from_pretrained",
        "args",
        "args",
        "tokenizer",
        "eos_token",
        "args",
        "args",
        "preprocess_data_in_domain",
        "args",
        "args",
        "preprocess_data_in_domain",
        "args",
        "args",
        "args",
        "preprocess_data_in_domain",
        "args",
        "args",
        "preprocess_data_ood",
        "args",
        "args",
        "args",
        "preprocess_data_ood",
        "args",
        "args",
        "preprocess_data_ood",
        "args",
        "ValueError",
        "glue_dataset",
        "data_0",
        "tokenizer",
        "args",
        "seed",
        "args",
        "num",
        "args",
        "glue_dataset",
        "data_1",
        "tokenizer",
        "args",
        "seed",
        "args",
        "num",
        "args",
        "args",
        "len",
        "args",
        "DataLoader",
        "training_set_0",
        "train_params",
        "DataLoader",
        "training_set_1",
        "train_params",
        "Classifier",
        "args",
        "torch",
        "nn",
        "DataParallel",
        "model",
        "device_ids",
        "args",
        "model",
        "cuda",
        "device",
        "args",
        "Evaluation",
        "args",
        "model",
        "training_loader_0",
        "training_loader_1",
        "args",
        "ID_task",
        "ID_task",
        "len",
        "preprocess_data_in_domain",
        "args",
        "ood_len_list",
        "append",
        "len_ID",
        "ood_task",
        "ood_tasks",
        "ID_task",
        "ood_task",
        "ood_len_list",
        "append",
        "len",
        "preprocess_data_ood",
        "args",
        "min",
        "ood_len_list",
        "utils_gluex",
        "mkdir",
        "mkdir",
        "args",
        "ID_task",
        "glue_task_names",
        "types",
        "ID_task",
        "get_min_length",
        "ID_task",
        "min",
        "args",
        "args",
        "ID_task",
        "ID_task",
        "i",
        "args",
        "i",
        "i",
        "args",
        "fintune",
        "args",
        "result",
        "append",
        "evaluation",
        "item",
        "times",
        "mkdir",
        "os",
        "path",
        "join",
        "args",
        "ID_task",
        "os",
        "path",
        "join",
        "args",
        "ID_task",
        "format",
        "args",
        "args",
        "num",
        "open",
        "output_result_path",
        "f",
        "result",
        "sum",
        "result",
        "len",
        "result",
        "times",
        "num",
        "args",
        "f",
        "write",
        "json",
        "dumps",
        "final_result",
        "ensure_ascii",
        "indent",
        "separators",
        "result",
        "OOD_task",
        "ood_tasks",
        "ID_task",
        "ID_task",
        "OOD_task",
        "i",
        "args",
        "i",
        "i",
        "args",
        "fintune",
        "args",
        "result",
        "append",
        "evaluation",
        "item",
        "times",
        "mkdir",
        "os",
        "path",
        "join",
        "args",
        "ID_task",
        "os",
        "path",
        "join",
        "args",
        "ID_task",
        "format",
        "args",
        "args",
        "num",
        "open",
        "output_result_path",
        "f",
        "result",
        "sum",
        "result",
        "len",
        "result",
        "times",
        "num",
        "args",
        "f",
        "write",
        "json",
        "dumps",
        "final_result",
        "ensure_ascii",
        "indent",
        "separators",
        "result",
        "idx0",
        "OOD_task_0",
        "ood_tasks",
        "ID_task",
        "idx1",
        "OOD_task_1",
        "ood_tasks",
        "ID_task",
        "idx0",
        "OOD_task_0",
        "OOD_task_1",
        "i",
        "args",
        "i",
        "i",
        "args",
        "fintune",
        "args",
        "result",
        "append",
        "evaluation",
        "item",
        "times",
        "mkdir",
        "os",
        "path",
        "join",
        "args",
        "ID_task",
        "os",
        "path",
        "join",
        "args",
        "ID_task",
        "format",
        "args",
        "args",
        "num",
        "open",
        "output_result_path",
        "f",
        "result",
        "sum",
        "result",
        "len",
        "result",
        "times",
        "num",
        "args",
        "f",
        "write",
        "json",
        "dumps",
        "final_result",
        "ensure_ascii",
        "indent",
        "separators",
        "result"
    ],
    "literals": [
        "\"../evaluation\"",
        "\"sst2\"",
        "\"single\"",
        "\"cola\"",
        "\"single\"",
        "\"mrpc\"",
        "\"pair\"",
        "\"stsb\"",
        "\"pair\"",
        "\"qqp\"",
        "\"pair\"",
        "\"mnli\"",
        "\"pair\"",
        "\"qnli\"",
        "\"pair\"",
        "\"rte\"",
        "\"pair\"",
        "\"wnli\"",
        "\"pair\"",
        "\"./datasets/glue\"",
        "\"task_name\"",
        "\"./huggingface/datasets\"",
        "\"idx\"",
        "\"train\"",
        "\"idx\"",
        "\"task_name\"",
        "\"stsb\"",
        "\"label\"",
        "\"label\"",
        "\"task_name\"",
        "\"qqp\"",
        "\"question1\"",
        "\"sentence1\"",
        "\"question2\"",
        "\"sentence2\"",
        "\"task_name\"",
        "\"mnli\"",
        "\"task_name\"",
        "\"mnli_matched\"",
        "\"task_name\"",
        "\"mnli_mismatched\"",
        "\"premise\"",
        "\"sentence1\"",
        "\"hypothesis\"",
        "\"sentence2\"",
        "\"task_name\"",
        "\"qnli\"",
        "\"question\"",
        "\"sentence1\"",
        "\"sentence\"",
        "\"sentence2\"",
        "\"train\"",
        "\"max_len\"",
        "\"type\"",
        "\"pair\"",
        "'sentence1'",
        "'sentence2'",
        "\"sentence1\"",
        "\"sentence2\"",
        "\"type\"",
        "\"single\"",
        "\"sentence\"",
        "\"sentence\"",
        "'input_ids'",
        "'attention_mask'",
        "'label'",
        "'ids'",
        "'mask'",
        "'targets'",
        "\"/yanglinyi/Models/\"",
        "\"checkpoint\"",
        "\"gpt2\"",
        "\"checkpoint\"",
        "'ids'",
        "\"device\"",
        "'mask'",
        "\"device\"",
        "\"device\"",
        "'ids'",
        "\"device\"",
        "'mask'",
        "\"device\"",
        "\"device\"",
        "\"MMD_result : \"",
        "\"checkpoint\"",
        "\"gpt2\"",
        "\"checkpoint\"",
        "\"mode\"",
        "\"id_vs_id\"",
        "\"task_name\"",
        "\"dataset_0\"",
        "\"task_name\"",
        "\"dataset_1\"",
        "\"mode\"",
        "\"id_vs_ood\"",
        "\"task_name\"",
        "\"dataset_0\"",
        "\"task_name\"",
        "\"dataset_1\"",
        "\"ID_name\"",
        "\"NULL\"",
        "\"mode\"",
        "\"ood_vs_ood\"",
        "\"ID_name\"",
        "\"NULL\"",
        "\"task_name\"",
        "\"dataset_0\"",
        "\"task_name\"",
        "\"dataset_1\"",
        "\"mode not specified\"",
        "\"task_name\"",
        "\"\"",
        "\"train\"",
        "\"seed_0\"",
        "\"sample_len\"",
        "\"train\"",
        "\"seed_1\"",
        "\"sample_len\"",
        "'batch_size'",
        "\"per_device_train_batch_size\"",
        "\"device\"",
        "'shuffle'",
        "'num_workers'",
        "\"device\"",
        "\"device\"",
        "\"sample_len\"",
        "\"task_name\"",
        "\"task_name\"",
        "\"task_name\"",
        "\"\"",
        "'__main__'",
        "\"type\"",
        "\"\"",
        "\"checkpoint\"",
        "\"/yanglinyi/Models/roberta-base\"",
        "\"per_device_train_batch_size\"",
        "\"max_len\"",
        "\"device\"",
        "\"sample_times\"",
        "\"dataset_0\"",
        "\"\"",
        "\"seed_0\"",
        "\"num\"",
        "\"dataset_1\"",
        "\"\"",
        "\"seed_1\"",
        "\"common_len\"",
        "\"\"",
        "\"sample_len\"",
        "\"\"",
        "\"output_dir\"",
        "\"./MMD/all_new_1/\"",
        "\"output_dir\"",
        "\"mode\"",
        "\"id_vs_id\"",
        "\"type\"",
        "\"common_len\"",
        "\"sample_len\"",
        "\"common_len\"",
        "\"num\"",
        "\"dataset_0\"",
        "\"dataset_1\"",
        "\"sample_times\"",
        "\"seed_1\"",
        "\"seed_0\"",
        "\"sample_times\"",
        "\"output_dir\"",
        "\"output_dir\"",
        "\"MMD_between_{0}_and_{1}_sample_num_{2}.json\"",
        "\"dataset_0\"",
        "\"dataset_1\"",
        "\"w\"",
        "\"MMD_for_each\"",
        "\"avearge_MMD\"",
        "\"sample_times\"",
        "\"num\"",
        "\"args\"",
        "','",
        "':'",
        "'\\n'",
        "\"mode\"",
        "\"id_vs_ood\"",
        "\"dataset_0\"",
        "\"dataset_1\"",
        "\"sample_times\"",
        "\"seed_1\"",
        "\"seed_0\"",
        "\"sample_times\"",
        "\"output_dir\"",
        "\"output_dir\"",
        "\"MMD_between_{0}_and_{1}_sample_num_{2}.json\"",
        "\"dataset_0\"",
        "\"dataset_1\"",
        "\"w\"",
        "\"MMD_for_each\"",
        "\"avearge_MMD\"",
        "\"sample_times\"",
        "\"num\"",
        "\"args\"",
        "','",
        "':'",
        "'\\n'",
        "\"mode\"",
        "\"ood_vs_ood\"",
        "\"dataset_0\"",
        "\"dataset_1\"",
        "\"sample_times\"",
        "\"seed_1\"",
        "\"seed_0\"",
        "\"sample_times\"",
        "\"output_dir\"",
        "\"output_dir\"",
        "\"MMD_between_{0}_and_{1}_sample_num_{2}.json\"",
        "\"dataset_0\"",
        "\"dataset_1\"",
        "\"w\"",
        "\"MMD_for_each\"",
        "\"avearge_MMD\"",
        "\"sample_times\"",
        "\"num\"",
        "\"args\"",
        "','",
        "':'",
        "'\\n'"
    ],
    "variables": [
        "n_samples",
        "total",
        "total0",
        "total1",
        "L2_distance",
        "bandwidth",
        "bandwidth",
        "bandwidth_list",
        "kernel_val",
        "batch_size",
        "kernels",
        "XX",
        "YY",
        "XY",
        "YX",
        "loss",
        "types",
        "data",
        "data",
        "data",
        "data",
        "data",
        "data",
        "data",
        "data",
        "data",
        "data",
        "max_len",
        "data",
        "num",
        "data",
        "data",
        "data",
        "data",
        "inputs",
        "ids",
        "mask",
        "targets",
        "l1",
        "pad_token_id",
        "output_1",
        "hidden_state",
        "pooler",
        "output_0",
        "output_1",
        "ids",
        "mask",
        "outputs",
        "ids",
        "mask",
        "outputs",
        "output_0",
        "output_1",
        "MMD_reuslt",
        "time_start",
        "tokenizer",
        "tokenizer",
        "pad_token",
        "args",
        "data_0",
        "args",
        "data_1",
        "args",
        "data_0",
        "args",
        "args",
        "data_1",
        "args",
        "args",
        "data_0",
        "args",
        "data_1",
        "args",
        "training_set_0",
        "training_set_1",
        "train_params",
        "training_loader_0",
        "training_loader_1",
        "model",
        "model",
        "model",
        "args",
        "len_ID",
        "ood_len_list",
        "args",
        "args",
        "args",
        "args",
        "args",
        "args",
        "args",
        "args",
        "args",
        "result",
        "times",
        "num",
        "args",
        "args",
        "evaluation",
        "num",
        "output_result_path",
        "final_result",
        "args",
        "args",
        "args",
        "result",
        "times",
        "num",
        "args",
        "args",
        "evaluation",
        "num",
        "output_result_path",
        "final_result",
        "args",
        "args",
        "args",
        "result",
        "times",
        "num",
        "args",
        "args",
        "evaluation",
        "num",
        "output_result_path",
        "final_result"
    ],
    "comments": [
        "/len(kernel_val)",
        "print(data)",
        "original#############",
        "self.tokenizer = AutoTokenizer.from_pretrained(args[\"checkpoint\"])",
        "print(self.max_len",
        "print(\"88888888888888888888888888888888888888888\")",
        "print(self.data)",
        "padding=\"max_length\",",
        "padding=\"max_length\",",
        "for gpt2 only",
        "choose the first embedding",
        "print(pooler.shape)",
        "targets = data['targets'].to(args[\"device\"][0], dtype=torch.long)",
        "targets = data['targets'].to(args[\"device\"][0], dtype=torch.long)",
        "input(\"enter to continue\")",
        "print(output_0.shape)",
        "for gpt2 only",
        "len_0 = len(data_0)",
        "len_1 = len(data_1)",
        "fintune(args)",
        "\"num_1\":1800,",
        "",
        "新增#####################################################"
    ],
    "docstrings": [],
    "functions": [
        "guassian_kernel",
        "mmd_rbf",
        "preprocess_data_in_domain",
        "__getitem__",
        "__len__",
        "forward",
        "Evaluation",
        "fintune",
        "get_min_length"
    ],
    "classes": [
        "glue_dataset",
        "Classifier"
    ]
}