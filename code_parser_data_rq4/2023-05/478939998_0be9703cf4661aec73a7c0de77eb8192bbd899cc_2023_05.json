{
    "identifiers": [
        "typing",
        "Union",
        "Optional",
        "torch",
        "dataclasses",
        "dataclass",
        "diffusers",
        "utils",
        "BaseOutput",
        "tqdm",
        "tqdm",
        "dataclass",
        "BaseOutput",
        "torch",
        "FloatTensor",
        "Optional",
        "torch",
        "FloatTensor",
        "torch",
        "nn",
        "Module",
        "wx",
        "we",
        "OLSSSchedulerModel",
        "len",
        "wx",
        "shape",
        "len",
        "we",
        "shape",
        "wx",
        "shape",
        "T",
        "we",
        "shape",
        "T",
        "we",
        "shape",
        "register_parameter",
        "torch",
        "nn",
        "Parameter",
        "wx",
        "register_parameter",
        "torch",
        "nn",
        "Parameter",
        "we",
        "t",
        "xT",
        "e_prev",
        "t",
        "len",
        "e_prev",
        "xT",
        "wx",
        "t",
        "e",
        "we",
        "e_prev",
        "we",
        "t",
        "x",
        "e",
        "we",
        "x",
        "to",
        "xT",
        "dtype",
        "timesteps",
        "model",
        "timesteps",
        "model",
        "num_inference_steps",
        "device",
        "Union",
        "torch",
        "device",
        "model",
        "to",
        "device",
        "sample",
        "torch",
        "FloatTensor",
        "args",
        "kwargs",
        "sample",
        "torch",
        "no_grad",
        "model_output",
        "torch",
        "FloatTensor",
        "timestep",
        "sample",
        "torch",
        "FloatTensor",
        "timesteps",
        "tolist",
        "index",
        "timestep",
        "t_prev",
        "t",
        "t_prev",
        "t_prev",
        "sample",
        "e_prev",
        "append",
        "model_output",
        "model",
        "t",
        "xT",
        "e_prev",
        "t",
        "len",
        "timesteps",
        "t",
        "OLSSSchedulerOutput",
        "prev_sample",
        "x",
        "pred_original_sample",
        "X",
        "Y",
        "X",
        "to",
        "torch",
        "float64",
        "Y",
        "to",
        "torch",
        "float64",
        "torch",
        "linalg",
        "lstsq",
        "X",
        "Y",
        "solution",
        "coef",
        "xT",
        "e_prev",
        "x",
        "torch",
        "concat",
        "xT",
        "e_prev",
        "dim",
        "xe_prev",
        "reshape",
        "xe_prev",
        "shape",
        "x",
        "flatten",
        "solve_linear_regression",
        "xe_prev",
        "T",
        "x",
        "coef",
        "coef",
        "torch",
        "matmul",
        "coef",
        "unsqueeze",
        "xe_prev",
        "to",
        "torch",
        "float64",
        "squeeze",
        "torch",
        "nn",
        "functional",
        "mse_loss",
        "x_pred",
        "x",
        "tolist",
        "wx",
        "we",
        "err",
        "torch",
        "no_grad",
        "steps_accelerate",
        "t_path",
        "x_path",
        "e_path",
        "i_path",
        "t_path",
        "shape",
        "i_path",
        "torch",
        "arange",
        "steps_inference",
        "steps_inference",
        "steps_accelerate",
        "steps_accelerate",
        "t_path",
        "i_path",
        "torch",
        "concat",
        "x_path",
        "i_path",
        "x_path",
        "e_path",
        "i_path",
        "torch",
        "zeros",
        "steps_accelerate",
        "dtype",
        "torch",
        "float64",
        "torch",
        "zeros",
        "steps_accelerate",
        "steps_accelerate",
        "dtype",
        "torch",
        "float64",
        "i",
        "steps_accelerate",
        "x_path",
        "i",
        "x_path",
        "e_path",
        "i",
        "wx",
        "i",
        "we",
        "i",
        "i",
        "solve_scheduer_parameters",
        "xT",
        "e_prev",
        "x",
        "t_path",
        "wx",
        "we",
        "x_prev",
        "e_prev",
        "x_flat",
        "i_lowerbound",
        "max_error",
        "i_lowerbound",
        "len",
        "x_flat",
        "i_upperbound",
        "i_lowerbound",
        "i_lowerbound",
        "i_upperbound",
        "x_flat",
        "i_next",
        "solve_scheduer_parameters",
        "x_prev",
        "e_prev",
        "x_goal",
        "err_step",
        "max_error",
        "i_next",
        "i_next",
        "i_lowerbound",
        "i_next",
        "max_steps",
        "t_path",
        "x_path",
        "e_path",
        "max_error",
        "t_path",
        "shape",
        "x_path",
        "reshape",
        "num_inference_steps",
        "e_path",
        "reshape",
        "num_inference_steps",
        "step",
        "max_steps",
        "x_flat",
        "i_path_acc",
        "step",
        "step",
        "e_flat",
        "i_path_acc",
        "i_path_acc",
        "step",
        "search_next_step_with_error_limit",
        "x_prev",
        "e_prev",
        "x_flat",
        "i_lowerbound",
        "max_error",
        "i_next",
        "num_inference_steps",
        "i_path_acc",
        "i_path_acc",
        "append",
        "i_next",
        "torch",
        "no_grad",
        "num_accelerate_steps",
        "t_path",
        "x_path",
        "e_path",
        "max_iter",
        "verbose",
        "it",
        "tqdm",
        "max_iter",
        "desc",
        "error_l",
        "error_r",
        "search_path_with_error_limit",
        "num_accelerate_steps",
        "t_path",
        "x_path",
        "e_path",
        "error_m",
        "path",
        "error_m",
        "error_m",
        "verbose",
        "error_m",
        "path",
        "len",
        "path",
        "path",
        "search_path_with_error_limit",
        "num_accelerate_steps",
        "t_path",
        "x_path",
        "e_path",
        "error_r",
        "resolve_diffusion_process",
        "num_accelerate_steps",
        "t_path",
        "x_path",
        "e_path",
        "i_path",
        "path",
        "timesteps",
        "wx",
        "we",
        "scheduler",
        "scheduler",
        "catch_x",
        "catch_e",
        "catch_x_",
        "num_inference_steps",
        "kwargs",
        "olss_scheduler",
        "scheduler",
        "set_timesteps",
        "num_inference_steps",
        "kwargs",
        "scheduler",
        "timesteps",
        "scheduler",
        "init_noise_sigma",
        "scheduler",
        "order",
        "result",
        "olss_scheduler",
        "set_timesteps",
        "num_inference_steps",
        "kwargs",
        "olss_scheduler",
        "timesteps",
        "scheduler",
        "init_noise_sigma",
        "scheduler",
        "order",
        "result",
        "model_output",
        "timestep",
        "sample",
        "kwargs",
        "olss_scheduler",
        "scheduler",
        "step",
        "model_output",
        "timestep",
        "sample",
        "kwargs",
        "timestep",
        "tolist",
        "timestep",
        "catch_x",
        "catch_x",
        "catch_e",
        "catch_x_",
        "catch_x",
        "timestep",
        "append",
        "sample",
        "clone",
        "detach",
        "cpu",
        "catch_e",
        "timestep",
        "append",
        "model_output",
        "clone",
        "detach",
        "cpu",
        "catch_x_",
        "timestep",
        "append",
        "result",
        "prev_sample",
        "clone",
        "detach",
        "cpu",
        "result",
        "olss_scheduler",
        "step",
        "model_output",
        "timestep",
        "sample",
        "kwargs",
        "result",
        "sample",
        "timestep",
        "sample",
        "original_samples",
        "noise",
        "timesteps",
        "scheduler",
        "add_noise",
        "original_samples",
        "noise",
        "timesteps",
        "result",
        "sorted",
        "t",
        "t",
        "catch_x",
        "reverse",
        "t",
        "t_path",
        "torch",
        "cat",
        "catch_x",
        "t",
        "dim",
        "x_path",
        "append",
        "x",
        "torch",
        "cat",
        "catch_e",
        "t",
        "dim",
        "e_path",
        "append",
        "e",
        "t_path",
        "torch",
        "cat",
        "catch_x_",
        "t_final",
        "dim",
        "x_path",
        "append",
        "x_final",
        "torch",
        "tensor",
        "t_path",
        "dtype",
        "torch",
        "int32",
        "torch",
        "stack",
        "x_path",
        "torch",
        "stack",
        "e_path",
        "t_path",
        "x_path",
        "e_path",
        "num_accelerate_steps",
        "OLSSSolver",
        "get_path",
        "solver",
        "resolve_diffusion_process_graph",
        "num_accelerate_steps",
        "t_path",
        "x_path",
        "e_path",
        "OLSSSchedulerModel",
        "wx",
        "we",
        "OLSSScheduler",
        "timesteps",
        "olss_model"
    ],
    "literals": [
        "\"wx\"",
        "\"we\"",
        "\"OLSS is solving the parameters\"",
        "f\"search for path with maximum error: {error_m}\"",
        "\"    cannot find such path\"",
        "f\"    find a path with length {len(path)}: {path}\""
    ],
    "variables": [
        "prev_sample",
        "pred_original_sample",
        "T",
        "x",
        "timesteps",
        "model",
        "init_noise_sigma",
        "order",
        "xT",
        "e_prev",
        "t_prev",
        "model",
        "t",
        "xT",
        "x",
        "xT",
        "e_prev",
        "t_prev",
        "t_prev",
        "X",
        "Y",
        "coef",
        "xe_prev",
        "xe_prev",
        "x",
        "coef",
        "wx",
        "we",
        "x_pred",
        "err",
        "steps_inference",
        "i_path",
        "t_path",
        "x_path",
        "e_path",
        "wx",
        "we",
        "x",
        "xT",
        "e_prev",
        "_",
        "i_next",
        "i_upperbound",
        "i_next",
        "x_goal",
        "_",
        "_",
        "err_step",
        "i_upperbound",
        "i_lowerbound",
        "i_next",
        "num_inference_steps",
        "x_flat",
        "e_flat",
        "i_path_acc",
        "x_prev",
        "e_prev",
        "i_lowerbound",
        "i_next",
        "error_l",
        "error_r",
        "error_m",
        "path",
        "error_l",
        "error_r",
        "path",
        "timesteps",
        "wx",
        "we",
        "scheduler",
        "olss_scheduler",
        "result",
        "timesteps",
        "init_noise_sigma",
        "order",
        "result",
        "timesteps",
        "init_noise_sigma",
        "order",
        "result",
        "timestep",
        "timestep",
        "timestep",
        "timestep",
        "result",
        "result",
        "t_path",
        "x_path",
        "e_path",
        "x",
        "e",
        "t_final",
        "x_final",
        "t_path",
        "x_path",
        "e_path",
        "solver",
        "t_path",
        "x_path",
        "e_path",
        "timesteps",
        "wx",
        "we",
        "olss_model",
        "olss_scheduler"
    ],
    "comments": [
        "coef = torch.linalg.pinv(X.T @ X) @ X.T @ Y",
        "prepare",
        "solve the ordinary least squares problem",
        "split the parameters",
        "error",
        "accelerate path",
        "parameters",
        "prepare for calculation",
        "search (greedy)"
    ],
    "docstrings": [],
    "functions": [
        "forward",
        "set_timesteps",
        "scale_model_input",
        "step",
        "solve_linear_regression",
        "solve_scheduer_parameters",
        "resolve_diffusion_process",
        "search_next_step_with_error_limit",
        "search_path_with_error_limit",
        "resolve_diffusion_process_graph",
        "set_timesteps",
        "step",
        "scale_model_input",
        "add_noise",
        "get_path",
        "prepare_olss"
    ],
    "classes": [
        "OLSSSchedulerOutput",
        "OLSSSchedulerModel",
        "OLSSScheduler",
        "OLSSSolver",
        "SchedulerWrapper"
    ]
}