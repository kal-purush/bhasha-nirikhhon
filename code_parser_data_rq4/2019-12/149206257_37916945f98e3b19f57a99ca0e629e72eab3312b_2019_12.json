{
    "identifiers": [
        "print_function",
        "flask_bootstrap",
        "Bootstrap",
        "flask",
        "Flask",
        "request",
        "session",
        "render_template",
        "redirect",
        "url_for",
        "flask",
        "_request_ctx_stack",
        "stack",
        "jaeger_client",
        "Tracer",
        "ConstSampler",
        "jaeger_client",
        "reporter",
        "NullReporter",
        "jaeger_client",
        "codecs",
        "B3Codec",
        "opentracing",
        "ext",
        "tags",
        "opentracing",
        "propagation",
        "Format",
        "opentracing_instrumentation",
        "request_context",
        "get_current_span",
        "span_in_context",
        "simplejson",
        "json",
        "requests",
        "sys",
        "json2html",
        "logging",
        "requests",
        "os",
        "asyncio",
        "http",
        "client",
        "http_client",
        "ImportError",
        "httplib",
        "http_client",
        "http_client",
        "HTTPConnection",
        "Flask",
        "logging",
        "basicConfig",
        "stream",
        "sys",
        "stdout",
        "level",
        "logging",
        "DEBUG",
        "logging",
        "getLogger",
        "requests_log",
        "setLevel",
        "logging",
        "DEBUG",
        "app",
        "logger",
        "addHandler",
        "logging",
        "StreamHandler",
        "sys",
        "stdout",
        "app",
        "logger",
        "setLevel",
        "logging",
        "DEBUG",
        "Bootstrap",
        "app",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "format",
        "detailsHostname",
        "servicesDomain",
        "format",
        "ratingsHostname",
        "servicesDomain",
        "format",
        "reviewsHostname",
        "servicesDomain",
        "ratings",
        "format",
        "detailsHostname",
        "servicesDomain",
        "details",
        "reviews",
        "productpage",
        "details",
        "reviews",
        "Tracer",
        "one_span_per_rpc",
        "service_name",
        "reporter",
        "NullReporter",
        "sampler",
        "ConstSampler",
        "decision",
        "extra_codecs",
        "Format",
        "HTTP_HEADERS",
        "B3Codec",
        "f",
        "args",
        "kwargs",
        "stack",
        "top",
        "request",
        "tracer",
        "extract",
        "Format",
        "HTTP_HEADERS",
        "request",
        "headers",
        "tags",
        "SPAN_KIND",
        "tags",
        "SPAN_KIND_RPC_SERVER",
        "tracer",
        "start_span",
        "operation_name",
        "child_of",
        "span_ctx",
        "tags",
        "rpc_tag",
        "e",
        "tracer",
        "start_span",
        "span_in_context",
        "span",
        "f",
        "args",
        "kwargs",
        "r",
        "f",
        "wrapper",
        "decorator",
        "request",
        "get_current_span",
        "tracer",
        "inject",
        "span_context",
        "span",
        "context",
        "format",
        "Format",
        "HTTP_HEADERS",
        "carrier",
        "carrier",
        "headers",
        "update",
        "carrier",
        "session",
        "session",
        "request",
        "headers",
        "request",
        "headers",
        "get",
        "ihdr",
        "incoming_headers",
        "request",
        "headers",
        "get",
        "ihdr",
        "val",
        "val",
        "headers",
        "app",
        "route",
        "app",
        "route",
        "productpage",
        "json2html",
        "convert",
        "json",
        "json",
        "dumps",
        "productpage",
        "table_attributes",
        "render_template",
        "serviceTable",
        "table",
        "app",
        "route",
        "app",
        "route",
        "methods",
        "request",
        "values",
        "get",
        "app",
        "make_response",
        "redirect",
        "request",
        "referrer",
        "user",
        "response",
        "app",
        "route",
        "methods",
        "app",
        "make_response",
        "redirect",
        "request",
        "referrer",
        "session",
        "pop",
        "response",
        "product_id",
        "headers",
        "getProductReviews",
        "product_id",
        "headers",
        "product_id",
        "headers",
        "asyncio",
        "gather",
        "getProductReviewsIgnoreResponse",
        "product_id",
        "headers",
        "_",
        "flood_factor",
        "product_id",
        "headers",
        "asyncio",
        "new_event_loop",
        "loop",
        "run_until_complete",
        "floodReviewsAsynchronously",
        "product_id",
        "headers",
        "loop",
        "close",
        "app",
        "route",
        "trace",
        "getForwardHeaders",
        "request",
        "session",
        "get",
        "getProduct",
        "product_id",
        "getProductDetails",
        "product_id",
        "headers",
        "flood_factor",
        "floodReviews",
        "product_id",
        "headers",
        "getProductReviews",
        "product_id",
        "headers",
        "render_template",
        "detailsStatus",
        "detailsStatus",
        "reviewsStatus",
        "reviewsStatus",
        "product",
        "product",
        "details",
        "details",
        "reviews",
        "reviews",
        "user",
        "user",
        "app",
        "route",
        "json",
        "dumps",
        "getProducts",
        "app",
        "route",
        "trace",
        "product_id",
        "getForwardHeaders",
        "request",
        "getProductDetails",
        "product_id",
        "headers",
        "json",
        "dumps",
        "details",
        "status",
        "app",
        "route",
        "trace",
        "product_id",
        "getForwardHeaders",
        "request",
        "getProductReviews",
        "product_id",
        "headers",
        "json",
        "dumps",
        "reviews",
        "status",
        "app",
        "route",
        "trace",
        "product_id",
        "getForwardHeaders",
        "request",
        "getProductRatings",
        "product_id",
        "headers",
        "json",
        "dumps",
        "ratings",
        "status",
        "product_id",
        "getProducts",
        "product_id",
        "len",
        "products",
        "products",
        "product_id",
        "product_id",
        "headers",
        "details",
        "details",
        "product_id",
        "requests",
        "get",
        "url",
        "headers",
        "headers",
        "timeout",
        "res",
        "res",
        "status_code",
        "res",
        "json",
        "res",
        "status_code",
        "res",
        "res",
        "status_code",
        "status",
        "product_id",
        "headers",
        "_",
        "reviews",
        "reviews",
        "product_id",
        "requests",
        "get",
        "url",
        "headers",
        "headers",
        "timeout",
        "res",
        "res",
        "status_code",
        "res",
        "json",
        "res",
        "status_code",
        "res",
        "res",
        "status_code",
        "status",
        "product_id",
        "headers",
        "ratings",
        "ratings",
        "product_id",
        "requests",
        "get",
        "url",
        "headers",
        "headers",
        "timeout",
        "res",
        "res",
        "status_code",
        "res",
        "json",
        "res",
        "status_code",
        "res",
        "res",
        "status_code",
        "status",
        "filename",
        "open",
        "filename",
        "data",
        "file",
        "write",
        "data",
        "file",
        "flush",
        "len",
        "sys",
        "argv",
        "logging",
        "error",
        "sys",
        "argv",
        "sys",
        "exit",
        "sys",
        "argv",
        "logging",
        "info",
        "p",
        "app",
        "run",
        "host",
        "port",
        "p",
        "debug",
        "threaded"
    ],
    "literals": [
        "\"requests.packages.urllib3\"",
        "b'_5#y2L\"F4Q8z\\n\\xec]/'",
        "\"\"",
        "\"SERVICES_DOMAIN\"",
        "\".\"",
        "\"SERVICES_DOMAIN\"",
        "\"details\"",
        "\"DETAILS_HOSTNAME\"",
        "\"DETAILS_HOSTNAME\"",
        "\"ratings\"",
        "\"RATINGS_HOSTNAME\"",
        "\"RATINGS_HOSTNAME\"",
        "\"reviews\"",
        "\"REVIEWS_HOSTNAME\"",
        "\"REVIEWS_HOSTNAME\"",
        "\"FLOOD_FACTOR\"",
        "\"FLOOD_FACTOR\"",
        "\"name\"",
        "\"http://{0}{1}:9080\"",
        "\"endpoint\"",
        "\"details\"",
        "\"children\"",
        "\"name\"",
        "\"http://{0}{1}:9080\"",
        "\"endpoint\"",
        "\"ratings\"",
        "\"children\"",
        "\"name\"",
        "\"http://{0}{1}:9080\"",
        "\"endpoint\"",
        "\"reviews\"",
        "\"children\"",
        "\"name\"",
        "\"http://{0}{1}:9080\"",
        "\"endpoint\"",
        "\"details\"",
        "\"children\"",
        "\"productpage\"",
        "\"details\"",
        "\"reviews\"",
        "'productpage'",
        "'op'",
        "'op'",
        "'user'",
        "'end-user'",
        "'user'",
        "'x-request-id'",
        "'x-datadog-trace-id'",
        "'x-datadog-parent-id'",
        "'x-datadog-sampled'",
        "'user-agent'",
        "'user-agent'",
        "'user-agent'",
        "'/'",
        "'/index.html'",
        "\"class=\\\"table table-condensed table-bordered table-hover\\\"\"",
        "'index.html'",
        "'/health'",
        "'Product page is healthy'",
        "'/login'",
        "'POST'",
        "'username'",
        "'user'",
        "'/logout'",
        "'GET'",
        "'user'",
        "'/productpage'",
        "'user'",
        "''",
        "'productpage.html'",
        "'/api/v1/products'",
        "'Content-Type'",
        "'application/json'",
        "'/api/v1/products/<product_id>'",
        "'Content-Type'",
        "'application/json'",
        "'/api/v1/products/<product_id>/reviews'",
        "'Content-Type'",
        "'application/json'",
        "'/api/v1/products/<product_id>/ratings'",
        "'Content-Type'",
        "'application/json'",
        "'id'",
        "'title'",
        "'The Comedy of Errors'",
        "'descriptionHtml'",
        "'<a href=\"https://en.wikipedia.org/wiki/The_Comedy_of_Errors\">Wikipedia Summary</a>: The Comedy of Errors is one of <b>William Shakespeare\\'s</b> early plays. It is his shortest and one of his most farcical comedies, with a major part of the humour coming from slapstick and mistaken identity, in addition to puns and word play.'",
        "'name'",
        "\"/\"",
        "'endpoint'",
        "\"/\"",
        "'error'",
        "'Sorry, product details are currently unavailable for this book.'",
        "'name'",
        "\"/\"",
        "'endpoint'",
        "\"/\"",
        "'error'",
        "'Sorry, product reviews are currently unavailable for this book.'",
        "'name'",
        "\"/\"",
        "'endpoint'",
        "\"/\"",
        "'error'",
        "'Sorry, product ratings are currently unavailable for this book.'",
        "'w'",
        "'__main__'",
        "\"usage: %s port\"",
        "\"start at port %s\"",
        "'0.0.0.0'"
    ],
    "variables": [
        "debuglevel",
        "app",
        "requests_log",
        "requests_log",
        "propagate",
        "app",
        "secret_key",
        "servicesDomain",
        "detailsHostname",
        "ratingsHostname",
        "reviewsHostname",
        "flood_factor",
        "details",
        "ratings",
        "reviews",
        "productpage",
        "service_dict",
        "tracer",
        "request",
        "span_ctx",
        "rpc_tag",
        "span",
        "span",
        "r",
        "wrapper",
        "headers",
        "span",
        "carrier",
        "headers",
        "incoming_headers",
        "headers",
        "val",
        "headers",
        "ihdr",
        "table",
        "user",
        "response",
        "session",
        "response",
        "loop",
        "product_id",
        "headers",
        "user",
        "product",
        "detailsStatus",
        "details",
        "reviewsStatus",
        "reviews",
        "headers",
        "status",
        "details",
        "headers",
        "status",
        "reviews",
        "headers",
        "status",
        "ratings",
        "products",
        "url",
        "res",
        "res",
        "status",
        "url",
        "res",
        "res",
        "status",
        "url",
        "res",
        "res",
        "status",
        "file",
        "p"
    ],
    "comments": [
        "!/usr/bin/python",
        "",
        "Copyright 2017 Istio Authors",
        "",
        "Licensed under the Apache License, Version 2.0 (the \"License\");",
        "you may not use this file except in compliance with the License.",
        "You may obtain a copy of the License at",
        "",
        "http://www.apache.org/licenses/LICENSE-2.0",
        "",
        "Unless required by applicable law or agreed to in writing, software",
        "distributed under the License is distributed on an \"AS IS\" BASIS,",
        "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
        "See the License for the specific language governing permissions and",
        "limitations under the License.",
        "These two lines enable debugging at httplib level (requests->urllib3->http.client)",
        "You will see the REQUEST, including HEADERS and DATA, and RESPONSE with HEADERS but without DATA.",
        "The only thing missing will be the response.body which is not logged.",
        "Python 2",
        "Set the secret key to some random bytes. Keep this really secret!",
        "A note on distributed tracing:",
        "",
        "Although Istio proxies are able to automatically send spans, they need some",
        "hints to tie together the entire trace. Applications need to propagate the",
        "appropriate HTTP headers so that when the proxies send span information, the",
        "spans can be correlated correctly into a single trace.",
        "",
        "To do this, an application needs to collect and propagate the following",
        "headers from the incoming request to any outgoing requests:",
        "",
        "x-request-id",
        "x-b3-traceid",
        "x-b3-spanid",
        "x-b3-parentspanid",
        "x-b3-sampled",
        "x-b3-flags",
        "",
        "This example code uses OpenTracing (http://opentracing.io/) to propagate",
        "the 'b3' (zipkin) headers. Using OpenTracing for this is not a requirement.",
        "Using OpenTracing allows you to add application-specific tracing later on,",
        "but you can just manually forward the headers if you prefer.",
        "",
        "The OpenTracing example here is very basic. It only forwards headers. It is",
        "intended as a reference to help people get started, eg how to create spans,",
        "extract/inject context, etc.",
        "A very basic OpenTracing tracer (with null reporter)",
        "Create a new span context, reading in values (traceid,",
        "spanid, etc) from the incoming x-b3-*** headers.",
        "Note: this tag means that the span will *not* be",
        "a child span. It will use the incoming traceid and",
        "spanid. We do this to propagate the headers verbatim.",
        "We failed to create a context, possibly due to no",
        "incoming x-b3-*** headers. Start a fresh span.",
        "Note: This is a fallback only, and will create fresh headers,",
        "not propagate headers.",
        "x-b3-*** headers can be populated using the opentracing span",
        "We handle other (non x-b3-***) headers manually",
        "Add user-agent to headers manually",
        "print \"incoming: \"+ihdr+\":\"+val",
        "The UI:",
        "a helper function for asyncio.gather, does not return a value",
        "flood reviews with unnecessary requests to demonstrate Istio rate limiting, asynchoronously",
        "the response is disregarded",
        "flood reviews with unnecessary requests to demonstrate Istio rate limiting",
        "TODO: replace default value",
        "The API:",
        "Data providers:",
        "Do not remove. Bug introduced explicitly for illustration in fault injection task",
        "TODO: Figure out how to achieve the same effect using Envoy retries/timeouts"
    ],
    "docstrings": [
        "'''\n    Function decorator that creates opentracing span from incoming b3 headers\n    '''",
        "\"\"\" Display productpage with normal user and test user buttons\"\"\""
    ],
    "functions": [
        "trace",
        "decorator",
        "wrapper",
        "getForwardHeaders",
        "index",
        "health",
        "login",
        "logout",
        "getProductReviewsIgnoreResponse",
        "floodReviewsAsynchronously",
        "floodReviews",
        "front",
        "productsRoute",
        "productRoute",
        "reviewsRoute",
        "ratingsRoute",
        "getProducts",
        "getProduct",
        "getProductDetails",
        "getProductReviews",
        "getProductRatings",
        "write",
        "flush"
    ],
    "classes": [
        "Writer"
    ]
}