{
    "identifiers": [
        "collections",
        "abc",
        "functools",
        "typing",
        "t",
        "absl",
        "app",
        "absl",
        "flags",
        "apache_beam",
        "beam",
        "numpy",
        "np",
        "pandas",
        "pd",
        "weatherbench2",
        "flag_utils",
        "xarray",
        "xr",
        "xarray_beam",
        "xbeam",
        "flags",
        "DEFINE_string",
        "help",
        "flags",
        "DEFINE_string",
        "help",
        "flags",
        "DEFINE_string",
        "help",
        "flags",
        "DEFINE_enum",
        "help",
        "flags",
        "DEFINE_string",
        "help",
        "flags",
        "DEFINE_list",
        "help",
        "flags",
        "DEFINE_list",
        "help",
        "flags",
        "DEFINE_list",
        "help",
        "flags",
        "DEFINE_bool",
        "help",
        "flags",
        "DEFINE_integer",
        "help",
        "flags",
        "DEFINE_string",
        "help",
        "flags",
        "DEFINE_string",
        "help",
        "flags",
        "DEFINE_string",
        "help",
        "flag_utils",
        "DEFINE_chunks",
        "help",
        "list_of_vars",
        "time_dependent_vars",
        "t",
        "Hashable",
        "t",
        "Hashable",
        "list_of_vars",
        "len",
        "list_of_vars",
        "list_of_vars",
        "_ALL",
        "time_dependent_vars",
        "_ALL",
        "list_of_vars",
        "ValueError",
        "_ALL",
        "list_of_vars",
        "list_of_vars",
        "key",
        "xbeam",
        "Key",
        "chunk",
        "xr",
        "Dataset",
        "method",
        "period",
        "pd",
        "Timedelta",
        "time_dim",
        "mean_vars",
        "min_vars",
        "max_vars",
        "add_mean_suffix",
        "xbeam",
        "Key",
        "xr",
        "Dataset",
        "key",
        "with_offsets",
        "time_dim",
        "chunk_var",
        "chunk",
        "data_vars",
        "chunk_var",
        "mean_vars",
        "rsmp_chunks",
        "append",
        "resample_in_time_core",
        "chunk",
        "method",
        "period",
        "rename",
        "chunk_var",
        "chunk_var",
        "add_mean_suffix",
        "chunk_var",
        "chunk_var",
        "min_vars",
        "rsmp_chunks",
        "append",
        "resample_in_time_core",
        "chunk",
        "method",
        "period",
        "rename",
        "chunk_var",
        "chunk_var",
        "chunk_var",
        "max_vars",
        "rsmp_chunks",
        "append",
        "resample_in_time_core",
        "chunk",
        "method",
        "period",
        "rename",
        "chunk_var",
        "chunk_var",
        "rsmp_key",
        "xr",
        "merge",
        "rsmp_chunks",
        "chunk",
        "xr",
        "Dataset",
        "method",
        "period",
        "pd",
        "Timedelta",
        "statistic",
        "t",
        "Union",
        "xr",
        "Dataset",
        "xr",
        "DataArray",
        "method",
        "pd",
        "to_timedelta",
        "np",
        "diff",
        "chunk",
        "TIME_DIM",
        "value",
        "data",
        "period",
        "delta_t",
        "ValueError",
        "delta_t",
        "period",
        "getattr",
        "chunk",
        "rolling",
        "TIME_DIM",
        "value",
        "period",
        "delta_t",
        "statistic",
        "method",
        "getattr",
        "chunk",
        "resample",
        "TIME_DIM",
        "value",
        "period",
        "statistic",
        "ValueError",
        "method",
        "argv",
        "abc",
        "Sequence",
        "xbeam",
        "open_zarr",
        "INPUT_PATH",
        "value",
        "TIME_START",
        "value",
        "TIME_STOP",
        "value",
        "ds",
        "sel",
        "TIME_DIM",
        "value",
        "TIME_START",
        "value",
        "TIME_STOP",
        "value",
        "k",
        "k",
        "v",
        "ds",
        "items",
        "TIME_DIM",
        "value",
        "v",
        "dims",
        "ds",
        "difference",
        "time_dependent_vars",
        "_get_vars",
        "MEAN_VARS",
        "value",
        "time_dependent_vars",
        "_get_vars",
        "MIN_VARS",
        "value",
        "time_dependent_vars",
        "_get_vars",
        "MAX_VARS",
        "value",
        "time_dependent_vars",
        "mean_vars",
        "union",
        "min_vars",
        "union",
        "max_vars",
        "keep_vars",
        "intersection",
        "nontime_vars",
        "ValueError",
        "TIME_DIM",
        "value",
        "keep_vars",
        "intersection",
        "nontime_vars",
        "ds",
        "keep_vars",
        "pd",
        "to_timedelta",
        "PERIOD",
        "value",
        "METHOD",
        "value",
        "resample_in_time_core",
        "ds",
        "time",
        "METHOD",
        "value",
        "period",
        "statistic",
        "time",
        "ds",
        "time",
        "isinstance",
        "ds",
        "xr",
        "Dataset",
        "xbeam",
        "make_template",
        "ds",
        "isel",
        "TIME_DIM",
        "value",
        "drop",
        "expand_dims",
        "TIME_DIM",
        "value",
        "rsmp_times",
        "rsmp_template",
        "copy",
        "rsmp_template",
        "mean_vars",
        "rsmp_template",
        "assign",
        "ADD_MEAN_SUFFIX",
        "value",
        "template_copy",
        "min_vars",
        "rsmp_template",
        "assign",
        "template_copy",
        "max_vars",
        "rsmp_template",
        "assign",
        "template_copy",
        "k",
        "v",
        "k",
        "v",
        "input_chunks",
        "items",
        "k",
        "TIME_DIM",
        "value",
        "input_chunks_without_time",
        "copy",
        "working_chunks",
        "update",
        "WORKING_CHUNKS",
        "value",
        "TIME_DIM",
        "value",
        "working_chunks",
        "ValueError",
        "TIME_DIM",
        "value",
        "len",
        "ds",
        "time",
        "input_chunks",
        "copy",
        "TIME_DIM",
        "value",
        "min",
        "len",
        "rsmp_times",
        "output_chunks",
        "TIME_DIM",
        "value",
        "max",
        "dtype",
        "itemsize",
        "rsmp_template",
        "values",
        "beam",
        "Pipeline",
        "runner",
        "RUNNER",
        "value",
        "argv",
        "argv",
        "root",
        "root",
        "xbeam",
        "DatasetToChunks",
        "ds",
        "input_chunks",
        "split_vars",
        "num_threads",
        "NUM_THREADS",
        "value",
        "xbeam",
        "Rechunk",
        "ds",
        "sizes",
        "input_chunks",
        "working_chunks",
        "itemsize",
        "itemsize",
        "beam",
        "MapTuple",
        "functools",
        "partial",
        "resample_in_time_chunk",
        "time_dim",
        "TIME_DIM",
        "value",
        "method",
        "METHOD",
        "value",
        "period",
        "period",
        "mean_vars",
        "mean_vars",
        "min_vars",
        "min_vars",
        "max_vars",
        "max_vars",
        "add_mean_suffix",
        "ADD_MEAN_SUFFIX",
        "value",
        "xbeam",
        "Rechunk",
        "rsmp_template",
        "sizes",
        "working_chunks",
        "output_chunks",
        "itemsize",
        "itemsize",
        "xbeam",
        "ChunksToZarr",
        "OUTPUT_PATH",
        "value",
        "template",
        "rsmp_template",
        "zarr_chunks",
        "output_chunks",
        "num_threads",
        "NUM_THREADS",
        "value",
        "app",
        "run",
        "main"
    ],
    "literals": [
        "r\"\"\"CLI to resample data to new time resolution.\n\nThe output will contain statistics of input variables specified by the flags\n--mean_vars, --min_vars etc...  Variables not associated with any flag will not\nappear in the output.\n\n\nExample Usage:\n\n  ```\n  export BUCKET=my-bucket\n  export PROJECT=my-project\n  export REGION=us-central1\n\n  python scripts/resample_in_time.py \\\n    --input_path=gs://weatherbench2/datasets/era5/1959-2022-6h-64x32_equiangular_with_poles_conservative.zarr \\\n    --output_path=gs://$BUCKET/datasets/era5/$USER/2020-2021-weekly-average-temperature.zarr \\\n    --runner=DataflowRunner \\\n    --time_start=2020 \\\n    --time_stop=2021 \\\n    --period=1w \\\n    --mean_vars=temperature \\\n    --working_chunks=\"latitude=12,longitude=12\" \\\n    -- \\\n    --project=$PROJECT \\\n    --temp_location=gs://$BUCKET/tmp/ \\\n    --setup_file=./setup.py \\\n    --requirements_file=./scripts/dataflow-requirements.txt \\\n    --job_name=compute-ensemble-mean-$USER\n  ```\n\"\"\"",
        "'input_path'",
        "'Input Zarr path.'",
        "'output_path'",
        "'Output Zarr path.'",
        "'runner'",
        "'beam.runners.Runner'",
        "'method'",
        "'resample'",
        "'resample'",
        "'rolling'",
        "'Whether to resample to new times, or use a rolling window.'",
        "'period'",
        "'1d'",
        "'Convertable to pandas.Timedelta. E.g. \"1d\" (one day) or \"1w\" (one'",
        "' week). See pandas.to_timedelta.'",
        "'mean_vars'",
        "'Comma-delimited list of variables to compute the mean of. Will result'",
        "' in \"_mean\" suffix added to variables unless --add_mean_suffix=false. '",
        "' Setting --mean_vars=ALL is equivalent to listing every time dependent'",
        "' variable.'",
        "'min_vars'",
        "'Comma-delimited list of variables to compute the minimum of. Will'",
        "' result in \"_min\" suffix added to variables. Setting --min_vars=ALL'",
        "' results is equivalent to listing every time dependent variable.'",
        "'max_vars'",
        "'Comma-delimited list of variables to compute the minimum of. Will'",
        "' result in \"_max\" suffix added to variables. Setting --max_vars=ALL is'",
        "' equivalent to listing every time dependent variable.'",
        "'add_mean_suffix'",
        "'Add suffix \"_mean\" to variable name when computing the mean.'",
        "'num_threads'",
        "'Number of chunks to load in parallel per worker.'",
        "'time_dim'",
        "'time'",
        "'Name for the time dimension to slice data on.'",
        "'time_start'",
        "'ISO 8601 timestamp (inclusive) at which to start resampling. If None,'",
        "' use the first time in --input_path.'",
        "'time_stop'",
        "'ISO 8601 timestamp (inclusive) at which to stop resampling. If None,'",
        "' use the last time in --input_path.'",
        "'working_chunks'",
        "''",
        "'Spatial chunk sizes to use during time downsampling, e.g.,'",
        "' \"longitude=10,latitude=10\". May not include \"--time_dim\".  In other'",
        "' words, the entire time series for each chunk is loaded into memory at'",
        "' once. So if there are many times, --working_chunks should be small in'",
        "' other dimensions.'",
        "'ALL'",
        "f'Cannot specify both {_ALL} and other variables. Found {list_of_vars}'",
        "'mean'",
        "f'{chunk_var}_mean'",
        "'min'",
        "f'{chunk_var}_min'",
        "'max'",
        "f'{chunk_var}_max'",
        "'rolling'",
        "f'{delta_t=} between chunk times did not evenly divide {period=}'",
        "'resample'",
        "f'Unhandled {method=}'",
        "'Statistics asked for on some variables that did not contain'",
        "f' {TIME_DIM.value}: {keep_vars.intersection(nontime_vars)}'",
        "'resample'",
        "'mean'",
        "'_mean'",
        "'_min'",
        "'_max'",
        "'cannot include time working chunks'",
        "'RechunkToWorkingChunks'",
        "'Stats'",
        "'RechunkToOutputChunks'",
        "'__main__'"
    ],
    "variables": [
        "INPUT_PATH",
        "OUTPUT_PATH",
        "RUNNER",
        "METHOD",
        "PERIOD",
        "MEAN_VARS",
        "MIN_VARS",
        "MAX_VARS",
        "ADD_MEAN_SUFFIX",
        "NUM_THREADS",
        "TIME_DIM",
        "TIME_START",
        "TIME_STOP",
        "WORKING_CHUNKS",
        "_ALL",
        "rsmp_key",
        "rsmp_chunks",
        "delta_t",
        "ds",
        "input_chunks",
        "ds",
        "time_dependent_vars",
        "nontime_vars",
        "mean_vars",
        "min_vars",
        "max_vars",
        "keep_vars",
        "ds",
        "period",
        "rsmp_times",
        "rsmp_times",
        "rsmp_template",
        "template_copy",
        "rsmp_template",
        "rsmp_template",
        "rsmp_template",
        "rsmp_template",
        "input_chunks_without_time",
        "working_chunks",
        "working_chunks",
        "output_chunks",
        "output_chunks",
        "itemsize",
        "unused_pcoll"
    ],
    "comments": [
        "Copyright 2024 Google LLC",
        "",
        "Licensed under the Apache License, Version 2.0 (the \"License\");",
        "you may not use this file except in compliance with the License.",
        "You may obtain a copy of the License at",
        "",
        "https://www.apache.org/licenses/LICENSE-2.0",
        "",
        "Unless required by applicable law or agreed to in writing, software",
        "distributed under the License is distributed on an \"AS IS\" BASIS,",
        "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
        "See the License for the specific language governing permissions and",
        "limitations under the License.",
        "==============================================================================",
        "Command line arguments",
        "Sentinal for including all variables.",
        "Remove time offset because each chunk contains the entire timeseries.",
        "Select the variables needed for statistics.",
        "Make the template",
        "All stats will give the same times, so use 'mean' arbitrarily.",
        "To satisfy pytype.",
        "Drop all variables...will add in below",
        "Get the working and output chunks",
        "Read, rechunk, compute stats",
        "pytype: disable=wrong-arg-types",
        "pytype: disable=wrong-arg-types"
    ],
    "docstrings": [
        "\"\"\"Get variables for a particular statistic.\"\"\"",
        "\"\"\"Resample a data chunk in time and return a requested time statistic.\n\n  Args:\n    key: An xarray beam key into a data chunk.\n    chunk: The data chunk.\n    method: resample or rolling.\n    period: The time frequency of the resampled data.\n    time_dim: Dimension indexing time in chunk.\n    mean_vars: Variables to compute the mean of.\n    min_vars: Variables to compute the min of.\n    max_vars: Variables to compute the max of.\n    add_mean_suffix: Whether to add a \"_mean\" suffix to variables after\n      computing the mean.\n\n  Returns:\n    The resampled data chunk and its key.\n  \"\"\"",
        "\"\"\"Core call to xarray resample or rolling.\"\"\""
    ],
    "functions": [
        "_get_vars",
        "resample_in_time_chunk",
        "resample_in_time_core",
        "main"
    ],
    "classes": []
}