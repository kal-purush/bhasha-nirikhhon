{
    "identifiers": [
        "features",
        "DetectorDescriptorTemplate",
        "DetectorAndDescriptor",
        "time",
        "os",
        "cv2",
        "numpy",
        "np",
        "scipy",
        "torch",
        "torch",
        "nn",
        "nn",
        "torch",
        "nn",
        "functional",
        "F",
        "argparse",
        "os",
        "path",
        "dirname",
        "torch",
        "cuda",
        "is_available",
        "torch",
        "device",
        "use_cuda",
        "argparse",
        "Namespace",
        "DetectorAndDescriptor",
        "model_file",
        "os",
        "path",
        "join",
        "dirname",
        "use_relu",
        "d2net",
        "name",
        "is_detector",
        "is_descriptor",
        "is_both",
        "patch_input",
        "D2Net",
        "model_file",
        "model_file",
        "use_relu",
        "use_relu",
        "use_cuda",
        "use_cuda",
        "model",
        "eval",
        "image",
        "resize_image",
        "image",
        "preprocess_image",
        "resized_image",
        "preprocessing",
        "args",
        "preprocessing",
        "torch",
        "no_grad",
        "args",
        "multiscale",
        "process_multiscale",
        "torch",
        "tensor",
        "input_image",
        "np",
        "newaxis",
        "astype",
        "np",
        "float32",
        "device",
        "device",
        "model",
        "process_multiscale",
        "torch",
        "tensor",
        "input_image",
        "np",
        "newaxis",
        "astype",
        "np",
        "float32",
        "device",
        "device",
        "model",
        "scales",
        "MAX_KPTS",
        "len",
        "scores",
        "MAX_KPTS",
        "len",
        "scores",
        "np",
        "argsort",
        "scores",
        "nb_kpts",
        "keypoints",
        "fact_i",
        "keypoints",
        "fact_j",
        "keypoints",
        "keypoints",
        "order",
        "keypoints",
        "image",
        "feature",
        "resize_image",
        "image",
        "preprocess_image",
        "resized_image",
        "preprocessing",
        "args",
        "preprocessing",
        "torch",
        "no_grad",
        "args",
        "multiscale",
        "process_multiscale",
        "torch",
        "tensor",
        "input_image",
        "np",
        "newaxis",
        "astype",
        "np",
        "float32",
        "device",
        "device",
        "model",
        "process_multiscale",
        "torch",
        "tensor",
        "input_image",
        "np",
        "newaxis",
        "astype",
        "np",
        "float32",
        "device",
        "device",
        "model",
        "scales",
        "MAX_KPTS",
        "len",
        "scores",
        "MAX_KPTS",
        "len",
        "scores",
        "np",
        "argsort",
        "scores",
        "nb_kpts",
        "descriptors",
        "order",
        "descriptors",
        "image",
        "resize_image",
        "image",
        "preprocess_image",
        "resized_image",
        "preprocessing",
        "args",
        "preprocessing",
        "torch",
        "no_grad",
        "args",
        "multiscale",
        "process_multiscale",
        "torch",
        "tensor",
        "input_image",
        "np",
        "newaxis",
        "astype",
        "np",
        "float32",
        "device",
        "device",
        "model",
        "process_multiscale",
        "torch",
        "tensor",
        "input_image",
        "np",
        "newaxis",
        "astype",
        "np",
        "float32",
        "device",
        "device",
        "model",
        "scales",
        "MAX_KPTS",
        "len",
        "scores",
        "MAX_KPTS",
        "len",
        "scores",
        "np",
        "argsort",
        "scores",
        "nb_kpts",
        "keypoints",
        "order",
        "keypoints",
        "fact_i",
        "keypoints",
        "fact_j",
        "keypoints",
        "keypoints",
        "descriptors",
        "order",
        "keypoints",
        "descriptors",
        "nn",
        "Module",
        "use_relu",
        "use_cuda",
        "DenseFeatureExtractionModule",
        "nn",
        "Sequential",
        "nn",
        "Conv2d",
        "padding",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "Conv2d",
        "padding",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "MaxPool2d",
        "stride",
        "nn",
        "Conv2d",
        "padding",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "Conv2d",
        "padding",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "MaxPool2d",
        "stride",
        "nn",
        "Conv2d",
        "padding",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "Conv2d",
        "padding",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "Conv2d",
        "padding",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "AvgPool2d",
        "stride",
        "nn",
        "Conv2d",
        "padding",
        "dilation",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "Conv2d",
        "padding",
        "dilation",
        "nn",
        "ReLU",
        "inplace",
        "nn",
        "Conv2d",
        "padding",
        "dilation",
        "use_relu",
        "use_cuda",
        "model",
        "cuda",
        "batch",
        "model",
        "batch",
        "use_relu",
        "F",
        "relu",
        "output",
        "output",
        "nn",
        "Module",
        "model_file",
        "use_relu",
        "use_cuda",
        "D2Net",
        "DenseFeatureExtractionModule",
        "use_relu",
        "use_relu",
        "use_cuda",
        "use_cuda",
        "HardDetectionModule",
        "HandcraftedLocalizationModule",
        "model_file",
        "use_cuda",
        "load_state_dict",
        "torch",
        "load",
        "model_file",
        "map_location",
        "location",
        "batch",
        "batch",
        "size",
        "dense_feature_extraction",
        "batch",
        "detection",
        "dense_features",
        "localization",
        "dense_features",
        "dense_features",
        "detections",
        "displacements",
        "nn",
        "Module",
        "edge_threshold",
        "HardDetectionModule",
        "edge_threshold",
        "torch",
        "tensor",
        "view",
        "torch",
        "tensor",
        "view",
        "torch",
        "tensor",
        "view",
        "batch",
        "batch",
        "size",
        "batch",
        "device",
        "torch",
        "max",
        "batch",
        "dim",
        "batch",
        "depth_wise_max",
        "depth_wise_max",
        "F",
        "max_pool2d",
        "batch",
        "stride",
        "padding",
        "batch",
        "local_max",
        "local_max",
        "F",
        "conv2d",
        "batch",
        "view",
        "h",
        "w",
        "dii_filter",
        "to",
        "device",
        "padding",
        "view",
        "b",
        "c",
        "h",
        "w",
        "F",
        "conv2d",
        "batch",
        "view",
        "h",
        "w",
        "dij_filter",
        "to",
        "device",
        "padding",
        "view",
        "b",
        "c",
        "h",
        "w",
        "F",
        "conv2d",
        "batch",
        "view",
        "h",
        "w",
        "djj_filter",
        "to",
        "device",
        "padding",
        "view",
        "b",
        "c",
        "h",
        "w",
        "dii",
        "djj",
        "dij",
        "dij",
        "dii",
        "djj",
        "dii",
        "dij",
        "djj",
        "edge_threshold",
        "edge_threshold",
        "torch",
        "min",
        "tr",
        "tr",
        "det",
        "threshold",
        "det",
        "torch",
        "min",
        "is_depth_wise_max",
        "torch",
        "min",
        "is_local_max",
        "is_not_edge",
        "is_depth_wise_max",
        "is_local_max",
        "is_not_edge",
        "detected",
        "nn",
        "Module",
        "HandcraftedLocalizationModule",
        "torch",
        "tensor",
        "view",
        "torch",
        "tensor",
        "view",
        "torch",
        "tensor",
        "view",
        "torch",
        "tensor",
        "view",
        "torch",
        "tensor",
        "view",
        "batch",
        "batch",
        "size",
        "batch",
        "device",
        "F",
        "conv2d",
        "batch",
        "view",
        "h",
        "w",
        "dii_filter",
        "to",
        "device",
        "padding",
        "view",
        "b",
        "c",
        "h",
        "w",
        "F",
        "conv2d",
        "batch",
        "view",
        "h",
        "w",
        "dij_filter",
        "to",
        "device",
        "padding",
        "view",
        "b",
        "c",
        "h",
        "w",
        "F",
        "conv2d",
        "batch",
        "view",
        "h",
        "w",
        "djj_filter",
        "to",
        "device",
        "padding",
        "view",
        "b",
        "c",
        "h",
        "w",
        "dii",
        "djj",
        "dij",
        "dij",
        "djj",
        "det",
        "dij",
        "det",
        "dii",
        "det",
        "dii",
        "dij",
        "djj",
        "det",
        "F",
        "conv2d",
        "batch",
        "view",
        "h",
        "w",
        "di_filter",
        "to",
        "device",
        "padding",
        "view",
        "b",
        "c",
        "h",
        "w",
        "F",
        "conv2d",
        "batch",
        "view",
        "h",
        "w",
        "dj_filter",
        "to",
        "device",
        "padding",
        "view",
        "b",
        "c",
        "h",
        "w",
        "inv_hess_00",
        "di",
        "inv_hess_01",
        "dj",
        "inv_hess_01",
        "di",
        "inv_hess_11",
        "dj",
        "inv_hess_00",
        "inv_hess_01",
        "inv_hess_11",
        "di",
        "dj",
        "torch",
        "stack",
        "step_i",
        "step_j",
        "dim",
        "image",
        "len",
        "image",
        "shape",
        "image",
        "np",
        "newaxis",
        "np",
        "repeat",
        "image",
        "image",
        "max",
        "resized_image",
        "shape",
        "args",
        "max_edge",
        "scipy",
        "misc",
        "imresize",
        "resized_image",
        "args",
        "max_edge",
        "max",
        "resized_image",
        "shape",
        "astype",
        "sum",
        "resized_image",
        "shape",
        "args",
        "max_sum_edges",
        "scipy",
        "misc",
        "imresize",
        "resized_image",
        "args",
        "max_sum_edges",
        "sum",
        "resized_image",
        "shape",
        "astype",
        "image",
        "shape",
        "resized_image",
        "shape",
        "image",
        "shape",
        "resized_image",
        "shape",
        "resized_image",
        "fact_i",
        "fact_j",
        "image",
        "preprocessing",
        "image",
        "astype",
        "np",
        "float32",
        "np",
        "transpose",
        "image",
        "preprocessing",
        "preprocessing",
        "image",
        "np",
        "array",
        "image",
        "mean",
        "reshape",
        "preprocessing",
        "image",
        "np",
        "array",
        "np",
        "array",
        "image",
        "mean",
        "reshape",
        "std",
        "reshape",
        "ValueError",
        "image",
        "image",
        "model",
        "scales",
        "image",
        "size",
        "image",
        "device",
        "b",
        "torch",
        "zeros",
        "torch",
        "zeros",
        "model",
        "dense_feature_extraction",
        "num_channels",
        "torch",
        "zeros",
        "idx",
        "scale",
        "scales",
        "F",
        "interpolate",
        "image",
        "scale_factor",
        "scale",
        "mode",
        "align_corners",
        "current_image",
        "size",
        "model",
        "dense_feature_extraction",
        "current_image",
        "current_image",
        "dense_features",
        "size",
        "previous_dense_features",
        "dense_features",
        "F",
        "interpolate",
        "previous_dense_features",
        "size",
        "h",
        "w",
        "mode",
        "align_corners",
        "previous_dense_features",
        "model",
        "detection",
        "dense_features",
        "banned",
        "F",
        "interpolate",
        "banned",
        "size",
        "h",
        "w",
        "torch",
        "min",
        "detections",
        "banned",
        "torch",
        "max",
        "torch",
        "max",
        "detections",
        "dim",
        "unsqueeze",
        "banned",
        "torch",
        "max",
        "detections",
        "dim",
        "unsqueeze",
        "torch",
        "nonzero",
        "detections",
        "t",
        "cpu",
        "detections",
        "model",
        "localization",
        "dense_features",
        "displacements",
        "fmap_pos",
        "fmap_pos",
        "fmap_pos",
        "displacements",
        "fmap_pos",
        "fmap_pos",
        "fmap_pos",
        "displacements",
        "torch",
        "min",
        "torch",
        "abs",
        "displacements_i",
        "torch",
        "abs",
        "displacements_j",
        "fmap_pos",
        "mask",
        "torch",
        "stack",
        "displacements_i",
        "mask",
        "displacements_j",
        "mask",
        "dim",
        "cpu",
        "mask",
        "displacements_i",
        "displacements_j",
        "fmap_pos",
        "valid_displacements",
        "valid_displacements",
        "interpolate_dense_features",
        "fmap_keypoints",
        "to",
        "device",
        "dense_features",
        "EmptyTensorError",
        "fmap_pos",
        "ids",
        "fmap_keypoints",
        "ids",
        "ids",
        "upscale_positions",
        "fmap_keypoints",
        "scaling_steps",
        "fmap_keypoints",
        "F",
        "normalize",
        "raw_descriptors",
        "dim",
        "cpu",
        "raw_descriptors",
        "keypoints",
        "h_init",
        "h_level",
        "keypoints",
        "w_init",
        "w_level",
        "fmap_pos",
        "cpu",
        "keypoints",
        "cpu",
        "torch",
        "cat",
        "keypoints",
        "torch",
        "ones",
        "keypoints",
        "size",
        "scale",
        "dim",
        "dense_features",
        "fmap_pos",
        "fmap_pos",
        "fmap_pos",
        "cpu",
        "idx",
        "fmap_pos",
        "torch",
        "cat",
        "all_keypoints",
        "keypoints",
        "dim",
        "torch",
        "cat",
        "all_descriptors",
        "descriptors",
        "dim",
        "torch",
        "cat",
        "all_scores",
        "scores",
        "dim",
        "keypoints",
        "descriptors",
        "dense_features",
        "dense_features",
        "previous_dense_features",
        "banned",
        "all_keypoints",
        "t",
        "numpy",
        "all_keypoints",
        "all_scores",
        "numpy",
        "all_scores",
        "all_descriptors",
        "t",
        "numpy",
        "all_descriptors",
        "keypoints",
        "scores",
        "descriptors",
        "pos",
        "scaling_steps",
        "_",
        "scaling_steps",
        "pos",
        "pos",
        "pos",
        "scaling_steps",
        "_",
        "scaling_steps",
        "pos",
        "pos",
        "pos",
        "dense_features",
        "return_corners",
        "pos",
        "device",
        "torch",
        "arange",
        "pos",
        "size",
        "device",
        "device",
        "dense_features",
        "size",
        "pos",
        "pos",
        "torch",
        "floor",
        "i",
        "torch",
        "floor",
        "j",
        "torch",
        "min",
        "i_top_left",
        "j_top_left",
        "torch",
        "floor",
        "i",
        "torch",
        "ceil",
        "j",
        "torch",
        "min",
        "i_top_right",
        "j_top_right",
        "w",
        "torch",
        "ceil",
        "i",
        "torch",
        "floor",
        "j",
        "torch",
        "min",
        "i_bottom_left",
        "h",
        "j_bottom_left",
        "torch",
        "ceil",
        "i",
        "torch",
        "ceil",
        "j",
        "torch",
        "min",
        "i_bottom_right",
        "h",
        "j_bottom_right",
        "w",
        "torch",
        "min",
        "torch",
        "min",
        "valid_top_left",
        "valid_top_right",
        "torch",
        "min",
        "valid_bottom_left",
        "valid_bottom_right",
        "i_top_left",
        "valid_corners",
        "j_top_left",
        "valid_corners",
        "i_top_right",
        "valid_corners",
        "j_top_right",
        "valid_corners",
        "i_bottom_left",
        "valid_corners",
        "j_bottom_left",
        "valid_corners",
        "i_bottom_right",
        "valid_corners",
        "j_bottom_right",
        "valid_corners",
        "ids",
        "valid_corners",
        "ids",
        "size",
        "EmptyTensorError",
        "i",
        "ids",
        "j",
        "ids",
        "i",
        "i_top_left",
        "j",
        "j_top_left",
        "dist_i_top_left",
        "dist_j_top_left",
        "dist_i_top_left",
        "dist_j_top_left",
        "dist_i_top_left",
        "dist_j_top_left",
        "dist_i_top_left",
        "dist_j_top_left",
        "w_top_left",
        "dense_features",
        "i_top_left",
        "j_top_left",
        "w_top_right",
        "dense_features",
        "i_top_right",
        "j_top_right",
        "w_bottom_left",
        "dense_features",
        "i_bottom_left",
        "j_bottom_left",
        "w_bottom_right",
        "dense_features",
        "i_bottom_right",
        "j_bottom_right",
        "torch",
        "cat",
        "i",
        "view",
        "j",
        "view",
        "dim",
        "return_corners",
        "descriptors",
        "pos",
        "ids",
        "torch",
        "stack",
        "torch",
        "stack",
        "i_top_left",
        "j_top_left",
        "dim",
        "torch",
        "stack",
        "i_top_right",
        "j_top_right",
        "dim",
        "torch",
        "stack",
        "i_bottom_left",
        "j_bottom_left",
        "dim",
        "torch",
        "stack",
        "i_bottom_right",
        "j_bottom_right",
        "dim",
        "dim",
        "descriptors",
        "pos",
        "ids",
        "corners"
    ],
    "literals": [
        "\"cuda:0\"",
        "\"cpu\"",
        "'torch'",
        "'./d2net_misc/d2_tf.pth'",
        "'D2Net'",
        "'gpu'",
        "'cpu'",
        "'model'",
        "'dense_features'",
        "'detections'",
        "'displacements'",
        "'float'",
        "'float'",
        "'caffe'",
        "'torch'",
        "'Unknown preprocessing parameter.'",
        "'bilinear'",
        "'bilinear'"
    ],
    "variables": [
        "dirname",
        "use_cuda",
        "device",
        "args",
        "args",
        "preprocessing",
        "args",
        "max_edge",
        "args",
        "max_sum_edges",
        "args",
        "multiscale",
        "args",
        "use_relu",
        "MAX_KPTS",
        "model",
        "resized_image",
        "fact_i",
        "fact_j",
        "input_image",
        "keypoints",
        "scores",
        "descriptors",
        "keypoints",
        "scores",
        "descriptors",
        "nb_kpts",
        "nb_kpts",
        "order",
        "keypoints",
        "keypoints",
        "resized_image",
        "fact_i",
        "fact_j",
        "input_image",
        "keypoints",
        "scores",
        "descriptors",
        "keypoints",
        "scores",
        "descriptors",
        "nb_kpts",
        "nb_kpts",
        "order",
        "descriptors",
        "resized_image",
        "fact_i",
        "fact_j",
        "input_image",
        "keypoints",
        "scores",
        "descriptors",
        "keypoints",
        "scores",
        "descriptors",
        "nb_kpts",
        "nb_kpts",
        "order",
        "keypoints",
        "keypoints",
        "keypoints",
        "descriptors",
        "model",
        "num_channels",
        "use_relu",
        "model",
        "output",
        "output",
        "dense_feature_extraction",
        "detection",
        "localization",
        "location",
        "location",
        "_",
        "_",
        "h",
        "w",
        "dense_features",
        "detections",
        "displacements",
        "edge_threshold",
        "dii_filter",
        "dij_filter",
        "djj_filter",
        "b",
        "c",
        "h",
        "w",
        "device",
        "depth_wise_max",
        "is_depth_wise_max",
        "local_max",
        "is_local_max",
        "dii",
        "dij",
        "djj",
        "det",
        "tr",
        "threshold",
        "is_not_edge",
        "detected",
        "di_filter",
        "dj_filter",
        "dii_filter",
        "dij_filter",
        "djj_filter",
        "b",
        "c",
        "h",
        "w",
        "device",
        "dii",
        "dij",
        "djj",
        "det",
        "inv_hess_00",
        "inv_hess_01",
        "inv_hess_11",
        "di",
        "dj",
        "step_i",
        "step_j",
        "image",
        "image",
        "resized_image",
        "resized_image",
        "resized_image",
        "fact_i",
        "fact_j",
        "image",
        "image",
        "image",
        "mean",
        "image",
        "mean",
        "std",
        "image",
        "b",
        "_",
        "h_init",
        "w_init",
        "device",
        "all_keypoints",
        "all_descriptors",
        "all_scores",
        "previous_dense_features",
        "banned",
        "current_image",
        "_",
        "_",
        "h_level",
        "w_level",
        "dense_features",
        "_",
        "_",
        "h",
        "w",
        "detections",
        "banned",
        "detections",
        "banned",
        "banned",
        "fmap_pos",
        "displacements",
        "displacements_i",
        "displacements_j",
        "mask",
        "fmap_pos",
        "valid_displacements",
        "fmap_keypoints",
        "raw_descriptors",
        "_",
        "ids",
        "fmap_pos",
        "fmap_keypoints",
        "keypoints",
        "descriptors",
        "fmap_pos",
        "keypoints",
        "keypoints",
        "scores",
        "all_keypoints",
        "all_descriptors",
        "all_scores",
        "previous_dense_features",
        "keypoints",
        "scores",
        "descriptors",
        "pos",
        "pos",
        "device",
        "ids",
        "_",
        "h",
        "w",
        "i",
        "j",
        "i_top_left",
        "j_top_left",
        "valid_top_left",
        "i_top_right",
        "j_top_right",
        "valid_top_right",
        "i_bottom_left",
        "j_bottom_left",
        "valid_bottom_left",
        "i_bottom_right",
        "j_bottom_right",
        "valid_bottom_right",
        "valid_corners",
        "i_top_left",
        "j_top_left",
        "i_top_right",
        "j_top_right",
        "i_bottom_left",
        "j_bottom_left",
        "i_bottom_right",
        "j_bottom_right",
        "ids",
        "i",
        "j",
        "dist_i_top_left",
        "dist_j_top_left",
        "w_top_left",
        "w_top_right",
        "w_bottom_left",
        "w_bottom_right",
        "descriptors",
        "pos",
        "corners"
    ],
    "comments": [
        "TODO: switch to PIL.Image due to deprecation of scipy.misc.imresize.",
        "RGB -> BGR",
        "Zero-center by mean pixel",
        "Sum the feature maps.",
        "Recover detections.",
        "Recover displacements.",
        "Valid corners",
        "Interpolation"
    ],
    "docstrings": [
        "\"\"\"\nPretrained Outdoot LF-Net Implementation (tensorflow)\nAuthor: Alex Butenko\n\"\"\""
    ],
    "functions": [
        "detect_feature",
        "extract_descriptor",
        "extract_all",
        "forward",
        "forward",
        "forward",
        "forward",
        "resize_image",
        "preprocess_image",
        "process_multiscale",
        "upscale_positions",
        "downscale_positions",
        "interpolate_dense_features"
    ],
    "classes": [
        "d2net",
        "DenseFeatureExtractionModule",
        "D2Net",
        "HardDetectionModule",
        "HandcraftedLocalizationModule",
        "EmptyTensorError"
    ]
}