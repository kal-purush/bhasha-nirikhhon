{
    "identifiers": [
        "org",
        "sakaiproject",
        "assignment",
        "impl",
        "org",
        "apache",
        "commons",
        "lang",
        "StringEscapeUtils",
        "org",
        "apache",
        "commons",
        "lang",
        "StringUtils",
        "org",
        "apache",
        "poi",
        "hssf",
        "usermodel",
        "org",
        "apache",
        "poi",
        "ss",
        "usermodel",
        "Cell",
        "org",
        "apache",
        "poi",
        "ss",
        "util",
        "WorkbookUtil",
        "org",
        "sakaiproject",
        "assignment",
        "api",
        "Assignment",
        "org",
        "sakaiproject",
        "assignment",
        "api",
        "AssignmentService",
        "org",
        "sakaiproject",
        "assignment",
        "api",
        "AssignmentSubmission",
        "org",
        "sakaiproject",
        "assignment",
        "impl",
        "sort",
        "AssignmentComparator",
        "org",
        "sakaiproject",
        "assignment",
        "impl",
        "sort",
        "UserComparator",
        "org",
        "sakaiproject",
        "entity",
        "api",
        "Entity",
        "org",
        "sakaiproject",
        "exception",
        "IdUnusedException",
        "org",
        "sakaiproject",
        "exception",
        "PermissionException",
        "org",
        "sakaiproject",
        "site",
        "api",
        "Site",
        "org",
        "sakaiproject",
        "site",
        "api",
        "SiteService",
        "org",
        "sakaiproject",
        "time",
        "api",
        "TimeService",
        "org",
        "sakaiproject",
        "user",
        "api",
        "CandidateDetailProvider",
        "org",
        "sakaiproject",
        "user",
        "api",
        "User",
        "org",
        "sakaiproject",
        "user",
        "api",
        "UserDirectoryService",
        "org",
        "sakaiproject",
        "util",
        "FormattedText",
        "org",
        "sakaiproject",
        "util",
        "ResourceLoader",
        "org",
        "sakaiproject",
        "util",
        "SortedIterator",
        "org",
        "slf4j",
        "Logger",
        "org",
        "slf4j",
        "LoggerFactory",
        "java",
        "io",
        "java",
        "io",
        "OutputStream",
        "java",
        "text",
        "NumberFormat",
        "java",
        "util",
        "log",
        "LoggerFactory",
        "getLogger",
        "rb",
        "assignmentService",
        "siteService",
        "timeService",
        "userDirectoryService",
        "candidateDetailProvider",
        "assignmentService",
        "assignmentService",
        "assignmentService",
        "siteService",
        "siteService",
        "siteService",
        "timeService",
        "timeService",
        "timeService",
        "userDirectoryService",
        "userDirectoryService",
        "userDirectoryService",
        "candidateDetailProvider",
        "candidateDetailProvider",
        "candidateDetailProvider",
        "retVal",
        "typeGradesString",
        "AssignmentService",
        "REF_TYPE_GRADES",
        "Entity",
        "SEPARATOR",
        "parts",
        "substring",
        "indexOf",
        "typeGradesString",
        "typeGradesString",
        "length",
        "split",
        "Entity",
        "SEPARATOR",
        "idSite",
        "parts",
        "length",
        "parts",
        "parts",
        "context",
        "parts",
        "length",
        "siteService",
        "siteGroupReference",
        "idSite",
        "parts",
        "siteService",
        "siteReference",
        "idSite",
        "siteTitle",
        "sheetName",
        "site",
        "site",
        "siteService",
        "getSite",
        "idSite",
        "siteTitle",
        "parts",
        "length",
        "site",
        "getTitle",
        "site",
        "getGroup",
        "parts",
        "getTitle",
        "site",
        "getTitle",
        "sheetName",
        "parts",
        "length",
        "site",
        "getGroup",
        "parts",
        "getTitle",
        "site",
        "getTitle",
        "e",
        "log",
        "debug",
        "idSite",
        "e",
        "getMessage",
        "allowGradeAny",
        "assignmentsList",
        "assignmentService",
        "getListAssignmentsForContext",
        "idSite",
        "assignment",
        "assignmentsList",
        "assignmentService",
        "allowGradeSubmission",
        "assignment",
        "getReference",
        "allowGradeAny",
        "allowGradeAny",
        "rowNum",
        "wb",
        "sheet",
        "wb",
        "createSheet",
        "WorkbookUtil",
        "createSafeSheetName",
        "sheetName",
        "row",
        "sheet",
        "createRow",
        "rowNum",
        "row",
        "createCell",
        "setCellValue",
        "rb",
        "getString",
        "row",
        "sheet",
        "createRow",
        "rowNum",
        "row",
        "createCell",
        "setCellValue",
        "row",
        "sheet",
        "createRow",
        "rowNum",
        "row",
        "createCell",
        "setCellValue",
        "rb",
        "getString",
        "siteTitle",
        "row",
        "sheet",
        "createRow",
        "rowNum",
        "row",
        "createCell",
        "setCellValue",
        "rb",
        "getString",
        "timeService",
        "newTime",
        "toStringLocalFull",
        "row",
        "sheet",
        "createRow",
        "rowNum",
        "row",
        "createCell",
        "setCellValue",
        "style",
        "wb",
        "createCellStyle",
        "cell",
        "headerRowNumber",
        "rowNum",
        "row",
        "sheet",
        "createRow",
        "rowNum",
        "cellColumnNum",
        "cell",
        "row",
        "createCell",
        "cellColumnNum",
        "cell",
        "setCellStyle",
        "style",
        "cell",
        "setCellValue",
        "rb",
        "getString",
        "cell",
        "row",
        "createCell",
        "cellColumnNum",
        "cell",
        "setCellStyle",
        "style",
        "cell",
        "setCellValue",
        "rb",
        "getString",
        "allowAddAnySubmissionUsers",
        "assignmentService",
        "allowAddAnySubmissionUsers",
        "context",
        "members",
        "userDirectoryService",
        "getUsers",
        "allowAddAnySubmissionUsers",
        "isNotesEnabled",
        "candidateDetailProvider",
        "site",
        "candidateDetailProvider",
        "isAdditionalNotesEnabled",
        "site",
        "submitterMap",
        "members",
        "sort",
        "user",
        "members",
        "submitter",
        "user",
        "getDisplayId",
        "user",
        "getSortName",
        "submitterMap",
        "put",
        "user",
        "getId",
        "submitter",
        "isNotesEnabled",
        "additionalNotes",
        "candidateDetailProvider",
        "getAdditionalNotes",
        "user",
        "site",
        "submitter",
        "setNotes",
        "additionalNotes",
        "rowNum",
        "results",
        "index",
        "assignmentSize",
        "assignmentsList",
        "size",
        "assignments",
        "assignmentsList",
        "iterator",
        "assignments",
        "hasNext",
        "a",
        "assignments",
        "next",
        "assignmentType",
        "a",
        "getContent",
        "getTypeOfGrade",
        "a",
        "getDraft",
        "assignmentService",
        "allowGradeSubmission",
        "a",
        "getReference",
        "rowNum",
        "headerRowNumber",
        "row",
        "sheet",
        "getRow",
        "rowNum",
        "cellColumnNum",
        "index",
        "cell",
        "row",
        "createCell",
        "cellColumnNum",
        "cell",
        "setCellStyle",
        "style",
        "cell",
        "setCellValue",
        "a",
        "getTitle",
        "sIterator",
        "assignmentService",
        "getSubmissions",
        "a",
        "iterator",
        "sIterator",
        "hasNext",
        "submission",
        "sIterator",
        "next",
        "a",
        "isGroup",
        "_users",
        "submission",
        "getSubmitters",
        "i",
        "_users",
        "i",
        "_users",
        "length",
        "i",
        "userId",
        "_users",
        "i",
        "getId",
        "submitter",
        "submitterMap",
        "get",
        "userId",
        "submitter",
        "assignmentService",
        "assignmentUsesAnonymousGrading",
        "a",
        "submitter",
        "userId",
        "submitter",
        "objects",
        "results",
        "get",
        "submitter",
        "objects",
        "objects",
        "Collections",
        "nCopies",
        "assignmentSize",
        "results",
        "put",
        "submitter",
        "objects",
        "submission",
        "getGraded",
        "submission",
        "getGrade",
        "assignmentType",
        "Assignment",
        "SCORE_GRADE_TYPE",
        "grade",
        "StringUtils",
        "trimToNull",
        "a",
        "getProperties",
        "getProperty",
        "AssignmentService",
        "PROP_ASSIGNMENT_ASSOCIATE_GRADEBOOK_ASSIGNMENT",
        "submission",
        "getGradeForUserInGradeBook",
        "userId",
        "submission",
        "getGradeForUserInGradeBook",
        "userId",
        "submission",
        "getGradeForUser",
        "userId",
        "submission",
        "getGradeForUser",
        "userId",
        "grade",
        "grade",
        "submission",
        "getGradeDisplay",
        "factor",
        "submission",
        "getAssignment",
        "getContent",
        "getFactor",
        "dec",
        "log10",
        "factor",
        "nbFormat",
        "FormattedText",
        "getNumberFormat",
        "dec",
        "dec",
        "f",
        "nbFormat",
        "parse",
        "grade",
        "floatValue",
        "style",
        "wb",
        "createCellStyle",
        "format",
        "j",
        "j",
        "dec",
        "j",
        "format",
        "format",
        "concat",
        "objects",
        "index",
        "format",
        "f",
        "e",
        "objects",
        "index",
        "submission",
        "getGradeForUser",
        "userId",
        "submission",
        "getGradeDisplay",
        "submission",
        "getGradeForUser",
        "userId",
        "objects",
        "index",
        "submission",
        "getGradeForUser",
        "userId",
        "submission",
        "getGradeDisplay",
        "submission",
        "getGradeForUser",
        "userId",
        "submission",
        "getSubmitted",
        "submission",
        "getTimeSubmitted",
        "objects",
        "index",
        "rb",
        "getString",
        "submitter",
        "submitterMap",
        "get",
        "submission",
        "getSubmitterId",
        "submitter",
        "assignmentService",
        "assignmentUsesAnonymousGrading",
        "a",
        "submitter",
        "submission",
        "getAnonymousSubmissionId",
        "submitter",
        "objects",
        "results",
        "get",
        "submitter",
        "objects",
        "objects",
        "Collections",
        "nCopies",
        "assignmentSize",
        "results",
        "put",
        "submitter",
        "objects",
        "submitter",
        "submission",
        "getGraded",
        "submission",
        "getGrade",
        "assignmentType",
        "Assignment",
        "SCORE_GRADE_TYPE",
        "grade",
        "submission",
        "getGradeDisplay",
        "factor",
        "submission",
        "getAssignment",
        "getContent",
        "getFactor",
        "dec",
        "log10",
        "factor",
        "nbFormat",
        "FormattedText",
        "getNumberFormat",
        "dec",
        "dec",
        "f",
        "nbFormat",
        "parse",
        "grade",
        "floatValue",
        "format",
        "j",
        "j",
        "dec",
        "j",
        "format",
        "format",
        "concat",
        "style",
        "setDataFormat",
        "wb",
        "createDataFormat",
        "getFormat",
        "format",
        "cell",
        "setCellStyle",
        "style",
        "objects",
        "index",
        "format",
        "f",
        "e",
        "objects",
        "index",
        "submission",
        "getGradeDisplay",
        "objects",
        "index",
        "submission",
        "getGradeDisplay",
        "submission",
        "getSubmitted",
        "submission",
        "getTimeSubmitted",
        "objects",
        "index",
        "rb",
        "getString",
        "index",
        "isNotesEnabled",
        "cellNum",
        "index",
        "rowNum",
        "headerRowNumber",
        "row",
        "sheet",
        "getRow",
        "rowNum",
        "cell",
        "row",
        "createCell",
        "cellNum",
        "cell",
        "setCellType",
        "cell",
        "setCellValue",
        "rb",
        "getString",
        "resultsIt",
        "results",
        "entrySet",
        "iterator",
        "resultsIt",
        "hasNext",
        "entry",
        "resultsIt",
        "next",
        "sheetRow",
        "sheet",
        "createRow",
        "rowNum",
        "submitter",
        "entry",
        "getKey",
        "rowValues",
        "entry",
        "getValue",
        "column",
        "submitter",
        "anonymous",
        "sheetRow",
        "createCell",
        "column",
        "setCellValue",
        "sheetRow",
        "createCell",
        "column",
        "setCellValue",
        "submitter",
        "id",
        "sheetRow",
        "createCell",
        "column",
        "setCellValue",
        "submitter",
        "sortName",
        "sheetRow",
        "createCell",
        "column",
        "setCellValue",
        "submitter",
        "id",
        "rowValue",
        "rowValues",
        "rowValue",
        "floatValue",
        "rowValue",
        "cell",
        "sheetRow",
        "createCell",
        "column",
        "Cell",
        "CELL_TYPE_NUMERIC",
        "cell",
        "setCellValue",
        "floatValue",
        "value",
        "style",
        "wb",
        "createCellStyle",
        "style",
        "setDataFormat",
        "wb",
        "createDataFormat",
        "getFormat",
        "floatValue",
        "format",
        "cell",
        "setCellStyle",
        "style",
        "rowValue",
        "cell",
        "sheetRow",
        "createCell",
        "column",
        "Cell",
        "CELL_TYPE_STRING",
        "cell",
        "setCellValue",
        "rowValue",
        "toString",
        "cell",
        "sheetRow",
        "createCell",
        "column",
        "Cell",
        "CELL_TYPE_STRING",
        "cell",
        "setCellValue",
        "rb",
        "getString",
        "isNotesEnabled",
        "startColumn",
        "column",
        "submitter",
        "notes",
        "ifPresent",
        "notes",
        "col",
        "startColumn",
        "note",
        "notes",
        "noteCell",
        "sheetRow",
        "createCell",
        "col",
        "Cell",
        "CELL_TYPE_STRING",
        "noteCell",
        "setCellValue",
        "note",
        "wb",
        "write",
        "e",
        "log",
        "warn",
        "e",
        "getMessage",
        "format",
        "value",
        "format",
        "format",
        "value",
        "value",
        "format",
        "value",
        "id",
        "original",
        "anonymous",
        "id",
        "id",
        "notes",
        "original",
        "notes",
        "id",
        "sortName",
        "anonymous",
        "id",
        "id",
        "sortName",
        "sortName",
        "anonymous",
        "id",
        "sortName",
        "notes",
        "Optional",
        "empty",
        "Override",
        "o",
        "o",
        "o",
        "getClass",
        "o",
        "getClass",
        "submitter",
        "o",
        "anonymous",
        "submitter",
        "anonymous",
        "id",
        "equals",
        "submitter",
        "id",
        "Override",
        "result",
        "anonymous",
        "result",
        "result",
        "id",
        "hashCode",
        "result",
        "Override",
        "o",
        "value",
        "compare",
        "anonymous",
        "o",
        "anonymous",
        "value",
        "anonymous",
        "value",
        "id",
        "compareTo",
        "o",
        "id",
        "value",
        "sortName",
        "compareTo",
        "o",
        "sortName",
        "value",
        "notes",
        "notes",
        "notes"
    ],
    "literals": [
        "\"assignment\"",
        "\"\"",
        "\"\"",
        "\" - \"",
        "\":getGradesSpreadsheet cannot get site context=\"",
        "\"download.spreadsheet.title\"",
        "\"\"",
        "\"download.spreadsheet.site\"",
        "\"download.spreadsheet.date\"",
        "\"\"",
        "\"download.spreadsheet.column.name\"",
        "\"download.spreadsheet.column.userid\"",
        "\"#,##0.\"",
        "\"0\"",
        "\"gen.nograd\"",
        "\"#,##0.\"",
        "\"0\"",
        "\"gen.nograd\"",
        "\"gen.notes\"",
        "\"\"",
        "\"listsub.nosub\"",
        "\"Failed to write out spreadsheet:\""
    ],
    "variables": [
        "assignmentService",
        "siteService",
        "timeService",
        "userDirectoryService",
        "candidateDetailProvider",
        "cell",
        "format",
        "value",
        "anonymous",
        "id",
        "sortName"
    ],
    "comments": [
        "get site title for display purpose",
        "ignore exception",
        "does current user allowed to grade any assignment?",
        "not permitted to download the spreadsheet",
        "Create a row and put some cells in it. Rows are 0 based.",
        "empty line",
        "site title",
        "download time",
        "empty line",
        "this is the header row number",
        "set up the header cells",
        "user name column",
        "user enterprise id column",
        "site members excluding those who can add assignments",
        "hashmap which stores the Excel row number for particular user",
        "For details of all the users in the site.",
        "put user displayid and sortname in the first two cells",
        "We have to build a Map of the results so that we can sort them afterwards so that we don't expose data",
        "by having the anonymous results in the same position as the original listing.",
        "the grade data portion starts from the third column, since the first two are used for user's display id and sort name",
        "for column header, check allow grade permission based on each assignment",
        "put in assignment title as the column header",
        "since the first two column is taken by student id and name",
        "begin to populate the column for this assignment, iterating through student list",
        "find right row",
        "Get the user ID for this result",
        "Create item and fill up if doesn't exist.",
        "graded and released",
        "numeric cell type?",
        "We get float number no matter the locale it was managed with.",
        "String cell type",
        "submitted, but no grade available yet",
        "if",
        "If the user doesn't have permission to submit in this site.",
        "Get the user ID for this result",
        "Create item and fill up if doesn't exist.",
        "find right row",
        "graded and released",
        "numeric cell type?",
        "We get float number no matter the locale it was managed with.",
        "if",
        "Add the notes header",
        "The map is already sorted and so we just iterate over it and output rows.",
        "getGradesSpreadsheet",
        "This small holder is so that we can hold details about a floating point number while building up the list.",
        "We can't create cells when we don't know where they will go yet.",
        "Create Anonymous one.",
        "Create normal one",
        "Sort by ID for anonymous ones",
        "Sort by sortName for normal ones."
    ],
    "docstrings": [
        "* Exporter for the assignments grades spreadsheet. This encapsulates all the Apache POI code.",
        "the resource bundle",
        "* Access and output the grades spreadsheet for the reference, either for an assignment or all assignments in a context.\n     *\n     * @param out The outputStream to stream the grades spreadsheet into.\n     * @param ref The reference, either to a specific assignment, or just to an assignment context.\n     * @return Whether the grades spreadsheet is successfully output.\n     * @throws IdUnusedException   if there is no object with this id.\n     * @throws PermissionException if the current user is not allowed to access this.",
        "* This holds details about the submitter for when we're writing out the spreadsheet."
    ],
    "functions": [
        "setAssignmentService",
        "setSiteService",
        "setTimeService",
        "setUserDirectoryService",
        "setCandidateDetailProvider",
        "getGradesSpreadsheet",
        "FloatCell",
        "Submitter",
        "Submitter",
        "equals",
        "hashCode",
        "compareTo",
        "setNotes"
    ],
    "classes": [
        "GradeSheetExporter",
        "FloatCell",
        "Submitter"
    ]
}