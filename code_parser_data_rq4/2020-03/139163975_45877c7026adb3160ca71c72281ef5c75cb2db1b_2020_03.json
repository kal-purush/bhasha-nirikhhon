{
    "identifiers": [
        "base64",
        "b64encode",
        "json",
        "os",
        "requests",
        "psycopg2",
        "psycopg2",
        "extras",
        "execute_values",
        "common",
        "logging",
        "get_logger",
        "os",
        "getenv",
        "os",
        "getenv",
        "os",
        "getenv",
        "os",
        "getenv",
        "os",
        "getenv",
        "os",
        "getenv",
        "get_logger",
        "account",
        "b64encode",
        "json",
        "dumps",
        "account",
        "encode",
        "decode",
        "psycopg2",
        "connect",
        "dbname",
        "DB_NAME",
        "user",
        "DB_USER",
        "password",
        "DB_PASS",
        "host",
        "DB_HOST",
        "port",
        "DB_PORT",
        "conn",
        "cursor",
        "cur",
        "execute",
        "build_auth_header",
        "cur",
        "fetchone",
        "cur",
        "execute",
        "rule",
        "cur",
        "fetchall",
        "requests",
        "get",
        "INSIGHTS_RULES_API",
        "rule",
        "headers",
        "headers",
        "response",
        "status_code",
        "LOGGER",
        "error",
        "response",
        "status_code",
        "json",
        "loads",
        "response",
        "content",
        "to_update",
        "append",
        "rule",
        "response_dict",
        "response_dict",
        "response_dict",
        "response_dict",
        "response_dict",
        "response_dict",
        "response_dict",
        "response_dict",
        "to_update",
        "execute_values",
        "cur",
        "to_update",
        "template",
        "page_size",
        "len",
        "to_update",
        "conn",
        "commit",
        "cur",
        "close",
        "conn",
        "close"
    ],
    "literals": [
        "'POSTGRESQL_DATABASE'",
        "'POSTGRESQL_USER'",
        "'POSTGRESQL_PASSWORD'",
        "'POSTGRESQL_HOST'",
        "'POSTGRESQL_PORT'",
        "'5432'",
        "'INSIGHTS_RULES_API'",
        "'http://platform_mock:8000/api/insights/v1/rule/'",
        "'identity'",
        "'account_number'",
        "'user'",
        "'username'",
        "'vulnerability-cron'",
        "'x-rh-identity'",
        "'%s%s'",
        "'Got %s status code from insights API'",
        "'description'",
        "'summary'",
        "'generic'",
        "'reboot_required'",
        "'playbook_count'",
        "'resolution_set'",
        "'resolution_risk'",
        "'risk'",
        "'node_id'",
        "'impacted_systems_count'",
        "'(%s::integer, %s, %s, %s, %s, %s::integer, %s::integer, %s::integer, %s::integer)'"
    ],
    "variables": [
        "DB_NAME",
        "DB_USER",
        "DB_PASS",
        "DB_HOST",
        "DB_PORT",
        "INSIGHTS_RULES_API",
        "LOGGER",
        "conn",
        "cur",
        "headers",
        "to_update",
        "response",
        "response_dict"
    ],
    "comments": [],
    "docstrings": [
        "\"\"\"\nPeriodic update of insights security rules\n\"\"\"",
        "\"\"\"Build base64 auth header\"\"\"",
        "\"\"\"Application entrypoint\"\"\"",
        "\"\"\"SELECT name from rh_account LIMIT 1\"\"\"",
        "\"\"\"SELECT id, name from insights_rule\"\"\"",
        "\"\"\"UPDATE insights_rule AS ir SET description_text = v.description, summary_text = v.summary, generic_text = v.generic,\n                            reboot_required = v.reboot_required, playbook_count = v.playbook_count, change_risk = v.change_risk,\n                            kbase_node_id = v.kbase_node_id, systems_affected = v.systems_affected FROM (VALUES %s)\n                            AS v(id, description, summary, generic, reboot_required, playbook_count, change_risk, kbase_node_id, systems_affected)\n                            WHERE v.id = ir.id\"\"\""
    ],
    "functions": [
        "build_auth_header",
        "run"
    ],
    "classes": []
}