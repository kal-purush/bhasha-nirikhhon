{
    "identifiers": [
        "json",
        "os",
        "typing",
        "TYPE_CHECKING",
        "Any",
        "boto3",
        "aws_lambda_powertools",
        "utilities",
        "parameters",
        "aws_lambda_powertools",
        "utilities",
        "typing",
        "LambdaContext",
        "psycopg2",
        "connect",
        "sql",
        "os",
        "environ",
        "os",
        "environ",
        "os",
        "environ",
        "Any",
        "parameters",
        "get_secret",
        "os",
        "environ",
        "json",
        "loads",
        "rds_fdw_root_secret",
        "rds_fdw_root_secret_key_value",
        "rds_fdw_root_secret_key_value",
        "TYPE_CHECKING",
        "mypy_boto3_iam",
        "IAMClient",
        "mypy_boto3_sts",
        "STSClient",
        "IAMClient",
        "boto3",
        "client",
        "STSClient",
        "boto3",
        "client",
        "username",
        "connect",
        "host",
        "rds_fdw_host",
        "database",
        "rds_fdw_db",
        "user",
        "rds_fdw_root_user",
        "password",
        "rds_fdw_root_pw",
        "sql",
        "SQL",
        "format",
        "username",
        "sql",
        "Identifier",
        "username",
        "sql",
        "SQL",
        "format",
        "username",
        "sql",
        "Identifier",
        "username",
        "sql",
        "SQL",
        "format",
        "username",
        "sql",
        "Identifier",
        "username",
        "sql",
        "SQL",
        "format",
        "username",
        "sql",
        "Identifier",
        "username",
        "sql",
        "SQL",
        "format",
        "username",
        "sql",
        "Identifier",
        "username",
        "sql",
        "SQL",
        "format",
        "username",
        "sql",
        "Identifier",
        "username",
        "conn",
        "cursor",
        "cur",
        "cur",
        "execute",
        "sql_create_user",
        "cur",
        "execute",
        "sql_user_create_schema",
        "cur",
        "execute",
        "sql_user_grant_schema_usage",
        "cur",
        "execute",
        "sql_user_grant_schema_privileges",
        "cur",
        "execute",
        "sql_user_grant_schema_execute",
        "cur",
        "execute",
        "sql_grant_iam_role",
        "conn",
        "rollback",
        "conn",
        "commit",
        "conn",
        "close",
        "username",
        "iam_policy_arn",
        "boto3_iam_client",
        "get_user",
        "UserName",
        "username",
        "boto3_iam_client",
        "exceptions",
        "NoSuchEntityException",
        "boto3_iam_client",
        "create_user",
        "UserName",
        "username",
        "boto3_iam_client",
        "attach_user_policy",
        "UserName",
        "username",
        "PolicyArn",
        "iam_policy_arn",
        "boto3_iam_client",
        "tag_user",
        "UserName",
        "username",
        "Tags",
        "username",
        "boto3_sts_client",
        "get_caller_identity",
        "aws_account_id",
        "rds_resource_id",
        "username",
        "resource_arn",
        "boto3_iam_client",
        "create_policy",
        "PolicyName",
        "username",
        "Path",
        "PolicyDocument",
        "json",
        "dumps",
        "iam_user_policy_document",
        "Description",
        "response",
        "_context",
        "LambdaContext",
        "generate_iam_user_policy",
        "username",
        "ensure_iam_user_exists",
        "username",
        "iam_policy_arn",
        "iam_policy_arn",
        "create_rds_user_from_iam",
        "username"
    ],
    "literals": [
        "\"RDS_FDW_HOST\"",
        "\"RDS_FDW_DB\"",
        "\"RDS_FDW_RESOURCE_ID\"",
        "\"RDS_FDW_ROOT\"",
        "\"username\"",
        "\"password\"",
        "\"iam\"",
        "\"sts\"",
        "\"CREATE ROLE {username} WITH LOGIN\"",
        "\"CREATE SCHEMA {username}\"",
        "\"GRANT USAGE ON SCHEMA {username} TO {username}\"",
        "\"GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA {username} TO {username}\"",
        "\"GRANT EXECUTE ON ALL FUNCTIONS IN SCHEMA {username} TO {username}\"",
        "\"GRANT rds_iam TO {username}\"",
        "\"Key\"",
        "\"BDE_Analytics_User\"",
        "\"Value\"",
        "\"True\"",
        "\"Account\"",
        "f\"arn:aws:rds-db:ap-southeast-2:{aws_account_id}:dbuser:{rds_resource_id}/{username}\"",
        "\"Version\"",
        "\"2012-10-17\"",
        "\"Statement\"",
        "\"Action\"",
        "\"rds-db:connect\"",
        "\"Resource\"",
        "\"Effect\"",
        "\"Allow\"",
        "f\"bde-analytics-iam-policy-{username}\"",
        "\"/bde-analytics-policies/\"",
        "\"IAM policy allowing user access to bde analytics.\"",
        "\"Policy\"",
        "\"Arn\"",
        "\"username\"",
        "\"username\"",
        "\"username\""
    ],
    "variables": [
        "rds_fdw_host",
        "rds_fdw_db",
        "rds_resource_id",
        "rds_fdw_root_secret",
        "rds_fdw_root_secret_key_value",
        "rds_fdw_root_user",
        "rds_fdw_root_pw",
        "IAMClient",
        "STSClient",
        "boto3_iam_client",
        "boto3_sts_client",
        "conn",
        "sql_create_user",
        "sql_user_create_schema",
        "sql_user_grant_schema_usage",
        "sql_user_grant_schema_privileges",
        "sql_user_grant_schema_execute",
        "sql_grant_iam_role",
        "aws_account_id",
        "resource_arn",
        "iam_user_policy_document",
        "response",
        "iam_policy_arn"
    ],
    "comments": [
        "----- Environment Variables -----",
        "Resource arn needs to be specific to a particular user to prevent individuals from connecting as another user.",
        "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.IAMPolicy.html"
    ],
    "docstrings": [],
    "functions": [
        "create_rds_user_from_iam",
        "ensure_iam_user_exists",
        "generate_iam_user_policy",
        "handler"
    ],
    "classes": []
}