{
    "identifiers": [
        "math",
        "torch",
        "torch",
        "nn",
        "functional",
        "F",
        "torch",
        "nn",
        "einsum",
        "einops",
        "rearrange",
        "repeat",
        "val",
        "val",
        "val",
        "d",
        "val",
        "exists",
        "val",
        "d",
        "p",
        "nn",
        "LeakyReLU",
        "p",
        "nn",
        "Module",
        "x",
        "x",
        "chunk",
        "dim",
        "F",
        "gelu",
        "gate",
        "x",
        "dim",
        "mult",
        "mult",
        "dim",
        "nn",
        "Sequential",
        "nn",
        "LayerNorm",
        "dim",
        "nn",
        "Linear",
        "dim",
        "inner_dim",
        "bias",
        "GEGLU",
        "nn",
        "Linear",
        "inner_dim",
        "dim",
        "bias",
        "nn",
        "Module",
        "dim",
        "dim_context",
        "dim_head",
        "heads",
        "causal",
        "num_null_kv",
        "norm_context",
        "heads",
        "causal",
        "dim_head",
        "dim_head",
        "heads",
        "dim_context",
        "dim",
        "causal",
        "AlibiPositionalBias",
        "heads",
        "heads",
        "nn",
        "LayerNorm",
        "dim",
        "nn",
        "LayerNorm",
        "dim_context",
        "norm_context",
        "nn",
        "Identity",
        "num_null_kv",
        "nn",
        "Parameter",
        "torch",
        "randn",
        "heads",
        "num_null_kv",
        "dim_head",
        "nn",
        "Linear",
        "dim",
        "inner_dim",
        "bias",
        "nn",
        "Linear",
        "dim_context",
        "inner_dim",
        "bias",
        "nn",
        "Linear",
        "inner_dim",
        "dim",
        "bias",
        "x",
        "mask",
        "context",
        "attn_bias",
        "x",
        "shape",
        "x",
        "device",
        "x",
        "dtype",
        "exists",
        "context",
        "context_norm",
        "context",
        "context",
        "x",
        "norm",
        "x",
        "to_q",
        "x",
        "to_kv",
        "kv_input",
        "chunk",
        "dim",
        "t",
        "rearrange",
        "t",
        "h",
        "heads",
        "q",
        "k",
        "v",
        "q",
        "scale",
        "repeat",
        "null_kv",
        "b",
        "batch",
        "r",
        "unbind",
        "dim",
        "torch",
        "cat",
        "nk",
        "k",
        "dim",
        "torch",
        "cat",
        "nv",
        "v",
        "dim",
        "einsum",
        "q",
        "k",
        "sim",
        "shape",
        "exists",
        "attn_bias",
        "F",
        "pad",
        "attn_bias",
        "num_null_kv",
        "value",
        "sim",
        "attn_bias",
        "exists",
        "mask",
        "F",
        "pad",
        "mask",
        "num_null_kv",
        "value",
        "rearrange",
        "mask",
        "sim",
        "masked_fill",
        "mask",
        "torch",
        "finfo",
        "sim",
        "dtype",
        "max",
        "causal",
        "sim",
        "rel_pos_bias",
        "sim",
        "torch",
        "ones",
        "i",
        "j",
        "device",
        "device",
        "dtype",
        "torch",
        "triu",
        "j",
        "i",
        "sim",
        "masked_fill",
        "causal_mask",
        "torch",
        "finfo",
        "sim",
        "dtype",
        "max",
        "sim",
        "softmax",
        "dim",
        "einsum",
        "attn",
        "v",
        "rearrange",
        "to_out",
        "nn",
        "Module",
        "heads",
        "heads",
        "torch",
        "Tensor",
        "_get_slopes",
        "heads",
        "rearrange",
        "slopes",
        "register_buffer",
        "slopes",
        "persistent",
        "register_buffer",
        "persistent",
        "i",
        "j",
        "device",
        "torch",
        "arange",
        "j",
        "i",
        "j",
        "device",
        "device",
        "torch",
        "arange",
        "j",
        "device",
        "device",
        "torch",
        "abs",
        "rearrange",
        "j_arange",
        "rearrange",
        "i_arange",
        "bias",
        "staticmethod",
        "heads",
        "n",
        "math",
        "log2",
        "n",
        "start",
        "start",
        "ratio",
        "i",
        "i",
        "n",
        "math",
        "log2",
        "heads",
        "is_integer",
        "get_slopes_power_of_2",
        "heads",
        "math",
        "floor",
        "math",
        "log2",
        "heads",
        "get_slopes_power_of_2",
        "closest_power_of_2",
        "get_slopes_power_of_2",
        "closest_power_of_2",
        "heads",
        "closest_power_of_2",
        "sim",
        "sim",
        "shape",
        "sim",
        "device",
        "exists",
        "bias",
        "bias",
        "shape",
        "j",
        "bias",
        "i",
        "j",
        "get_bias",
        "i",
        "j",
        "device",
        "bias",
        "slopes",
        "h",
        "bias",
        "shape",
        "F",
        "pad",
        "bias",
        "num_heads_unalibied",
        "register_buffer",
        "bias",
        "persistent",
        "bias",
        "nn",
        "Module",
        "dim",
        "heads",
        "num_dims",
        "layers",
        "log_dist",
        "cache_rel_pos",
        "num_dims",
        "log_dist",
        "nn",
        "ModuleList",
        "net",
        "append",
        "nn",
        "Sequential",
        "nn",
        "Linear",
        "num_dims",
        "dim",
        "leaky_relu",
        "_",
        "layers",
        "net",
        "append",
        "nn",
        "Sequential",
        "nn",
        "Linear",
        "dim",
        "dim",
        "leaky_relu",
        "net",
        "append",
        "nn",
        "Linear",
        "dim",
        "heads",
        "cache_rel_pos",
        "register_buffer",
        "persistent",
        "dimensions",
        "device",
        "torch",
        "device",
        "exists",
        "rel_pos",
        "cache_rel_pos",
        "torch",
        "arange",
        "d",
        "device",
        "device",
        "d",
        "dimensions",
        "torch",
        "stack",
        "torch",
        "meshgrid",
        "positions",
        "indexing",
        "rearrange",
        "grid",
        "rearrange",
        "grid",
        "rearrange",
        "grid",
        "log_dist",
        "torch",
        "sign",
        "rel_pos",
        "torch",
        "log",
        "rel_pos",
        "abs",
        "register_buffer",
        "rel_pos",
        "persistent",
        "rel_pos",
        "layer",
        "net",
        "layer",
        "rel_pos",
        "rearrange",
        "rel_pos",
        "nn",
        "Module",
        "dim",
        "depth",
        "dim_context",
        "causal",
        "dim_head",
        "heads",
        "ff_mult",
        "attn_num_null_kv",
        "has_cross_attn",
        "nn",
        "ModuleList",
        "_",
        "depth",
        "layers",
        "append",
        "nn",
        "ModuleList",
        "Attention",
        "dim",
        "dim",
        "dim_head",
        "dim_head",
        "heads",
        "heads",
        "causal",
        "causal",
        "Attention",
        "dim",
        "dim",
        "dim_head",
        "dim_head",
        "dim_context",
        "dim_context",
        "heads",
        "heads",
        "causal",
        "num_null_kv",
        "attn_num_null_kv",
        "has_cross_attn",
        "FeedForward",
        "dim",
        "dim",
        "mult",
        "ff_mult",
        "nn",
        "LayerNorm",
        "dim",
        "x",
        "attn_bias",
        "context",
        "self_attn_mask",
        "cross_attn_context_mask",
        "self_attn",
        "cross_attn",
        "ff",
        "layers",
        "self_attn",
        "x",
        "attn_bias",
        "attn_bias",
        "mask",
        "self_attn_mask",
        "x",
        "exists",
        "cross_attn",
        "exists",
        "context",
        "cross_attn",
        "x",
        "context",
        "context",
        "mask",
        "cross_attn_context_mask",
        "x",
        "ff",
        "x",
        "x",
        "norm_out",
        "x"
    ],
    "literals": [
        "'b n (h d) -> b h n d'",
        "'h (n r) d -> b h n r d'",
        "'b h i d, b h j d -> b h i j'",
        "'b j -> b 1 1 j'",
        "'b h i j, b h j d -> b h i d'",
        "'b h n d -> b n (h d)'",
        "'h -> h 1 1'",
        "'slopes'",
        "'bias'",
        "'j -> 1 1 j'",
        "'i -> 1 i 1'",
        "'bias'",
        "'rel_pos'",
        "'cpu'",
        "'ij'",
        "'c ... -> (...) c'",
        "'i c -> i 1 c'",
        "'j c -> 1 j c'",
        "'rel_pos'",
        "'i j h -> h i j'"
    ],
    "variables": [
        "x",
        "gate",
        "inner_dim",
        "heads",
        "causal",
        "scale",
        "inner_dim",
        "dim_context",
        "rel_pos_bias",
        "norm",
        "context_norm",
        "num_null_kv",
        "null_kv",
        "to_q",
        "to_kv",
        "to_out",
        "batch",
        "device",
        "dtype",
        "context",
        "kv_input",
        "x",
        "q",
        "k",
        "v",
        "q",
        "k",
        "v",
        "q",
        "nk",
        "nv",
        "k",
        "v",
        "sim",
        "i",
        "j",
        "attn_bias",
        "sim",
        "mask",
        "mask",
        "sim",
        "sim",
        "causal_mask",
        "sim",
        "attn",
        "heads",
        "slopes",
        "slopes",
        "i_arange",
        "j_arange",
        "bias",
        "start",
        "ratio",
        "closest_power_of_2",
        "h",
        "i",
        "j",
        "device",
        "bias",
        "bias",
        "num_heads_unalibied",
        "bias",
        "num_dims",
        "log_dist",
        "net",
        "cache_rel_pos",
        "positions",
        "grid",
        "grid",
        "rel_pos",
        "rel_pos",
        "rel_pos",
        "rel_pos",
        "layers",
        "norm_out",
        "x",
        "x",
        "x"
    ],
    "comments": [
        "helpers",
        "feedforward",
        "attention",
        "alibi positional bias for extrapolation",
        "2 for images, 3 for video",
        "transformer"
    ],
    "docstrings": [
        "\"\"\" from https://arxiv.org/abs/2111.09883 \"\"\""
    ],
    "functions": [
        "exists",
        "leaky_relu",
        "forward",
        "FeedForward",
        "forward",
        "get_bias",
        "_get_slopes",
        "get_slopes_power_of_2",
        "forward",
        "forward",
        "forward"
    ],
    "classes": [
        "GEGLU",
        "Attention",
        "AlibiPositionalBias",
        "ContinuousPositionBias",
        "Transformer"
    ]
}