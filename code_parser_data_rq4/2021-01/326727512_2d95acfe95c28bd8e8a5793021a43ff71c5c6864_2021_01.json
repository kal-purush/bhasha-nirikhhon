{
    "identifiers": [
        "__doc__",
        "numpy",
        "np",
        "sklearn",
        "datasets",
        "make_regression",
        "np",
        "random",
        "RandomState",
        "make_regression",
        "n_samples",
        "n_samples",
        "noise",
        "random_state",
        "rng",
        "rng",
        "lognormal",
        "size",
        "n_samples",
        "sample_weight",
        "n_samples",
        "sample_weight",
        "sum",
        "np",
        "average",
        "X",
        "axis",
        "weights",
        "normalized_weights",
        "X",
        "np",
        "average",
        "X",
        "axis",
        "weights",
        "normalized_weights",
        "X_centered",
        "np",
        "sqrt",
        "normalized_weights",
        "np",
        "newaxis",
        "np",
        "dot",
        "X_scaled",
        "T",
        "X_scaled",
        "sklearn",
        "linear_model",
        "ElasticNet",
        "ElasticNet",
        "alpha",
        "precompute",
        "gram",
        "lm",
        "fit",
        "X_centered",
        "y",
        "sample_weight",
        "normalized_weights"
    ],
    "literals": [],
    "variables": [
        "rng",
        "n_samples",
        "X",
        "y",
        "sample_weight",
        "normalized_weights",
        "X_offset",
        "X_centered",
        "X_scaled",
        "gram",
        "lm"
    ],
    "comments": [
        "%%",
        "Let's start by loading the dataset and creating some sample weights.",
        "normalize the sample weights",
        "%%",
        "To fit the elastic net using the `precompute` option together with the sample",
        "weights, we must first center the design matrix,  and rescale it by the",
        "normalized weights prior to computing the gram matrix.",
        "%%",
        "We can now proceed with fitting. We must passed the centered design matrix to",
        "`fit` otherwise the elastic net estimator will detect that it is uncentered",
        "and discard the gram matrix we passed. However, if we pass the scaled design",
        "matrix, the preprocessing code will incorrectly rescale it a second time."
    ],
    "docstrings": [
        "\"\"\"\n==========================================================================\nFitting an Elastic Net with a precomputed Gram Matrix and Weighted Samples\n==========================================================================\n\nThe following example shows how to precompute the gram matrix\nwhile using weighted samples with an ElasticNet.\n\nIf weighted samples are used, the design matrix must be centered and then\nrescaled by the square root of the weight vector before the gram matrix\nis computed.\n\n.. note::\n  `sample_weight` vector is also rescaled to sum to `n_samples`, see the\n   documentation for the `sample_weight` parameter to\n   :func:`linear_model.ElasticNet.fit`.\n\n\"\"\""
    ],
    "functions": [],
    "classes": []
}