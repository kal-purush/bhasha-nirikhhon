{
    "identifiers": [
        "os",
        "tempfile",
        "json",
        "logging",
        "time",
        "flask",
        "Flask",
        "request",
        "jsonify",
        "werkzeug",
        "utils",
        "secure_filename",
        "pdfplumber",
        "pdf2image",
        "convert_from_path",
        "PIL",
        "Image",
        "cv2",
        "numpy",
        "np",
        "io",
        "pandas",
        "pd",
        "docx",
        "Document",
        "ImportError",
        "openpyxl",
        "easyocr",
        "Flask",
        "logging",
        "basicConfig",
        "level",
        "logging",
        "INFO",
        "format",
        "logging",
        "getLogger",
        "tempfile",
        "mkdtemp",
        "os",
        "path",
        "join",
        "os",
        "getcwd",
        "os",
        "makedirs",
        "OUTPUT_FOLDER",
        "exist_ok",
        "app",
        "config",
        "UPLOAD_FOLDER",
        "app",
        "config",
        "easyocr",
        "Reader",
        "gpu",
        "easyocr",
        "Reader",
        "gpu",
        "easyocr",
        "Reader",
        "gpu",
        "filename",
        "filename",
        "filename",
        "rsplit",
        "lower",
        "ALLOWED_EXTENSIONS",
        "request",
        "headers",
        "get",
        "api_key",
        "api_key",
        "API_KEYS",
        "image",
        "np",
        "array",
        "image",
        "len",
        "img",
        "shape",
        "cv2",
        "cvtColor",
        "img",
        "cv2",
        "COLOR_GRAY2RGB",
        "img",
        "shape",
        "cv2",
        "cvtColor",
        "img",
        "cv2",
        "COLOR_RGBA2RGB",
        "cv2",
        "cvtColor",
        "img",
        "cv2",
        "COLOR_RGB2GRAY",
        "cv2",
        "adaptiveThreshold",
        "gray",
        "cv2",
        "ADAPTIVE_THRESH_GAUSSIAN_C",
        "cv2",
        "THRESH_BINARY",
        "Image",
        "fromarray",
        "processed",
        "e",
        "logger",
        "error",
        "e",
        "image",
        "image",
        "preprocess_image",
        "image",
        "reader_en_hi",
        "readtext",
        "np",
        "array",
        "processed_img",
        "reader_en_bn",
        "readtext",
        "np",
        "array",
        "processed_img",
        "reader_en_ur",
        "readtext",
        "np",
        "array",
        "processed_img",
        "join",
        "text",
        "text",
        "result_en_hi",
        "join",
        "text",
        "text",
        "result_en_bn",
        "join",
        "text",
        "text",
        "result_en_ur",
        "text_en_hi",
        "text_en_bn",
        "text_en_ur",
        "e",
        "logger",
        "error",
        "e",
        "page",
        "page_num",
        "pdf_path",
        "page_num",
        "page",
        "extract_text",
        "x_tolerance",
        "y_tolerance",
        "e",
        "logger",
        "warning",
        "e",
        "page",
        "images",
        "len",
        "result",
        "strip",
        "convert_from_path",
        "pdf_path",
        "first_page",
        "page_num",
        "last_page",
        "page_num",
        "dpi",
        "size",
        "images",
        "extract_text_from_image",
        "images",
        "len",
        "full_page_text",
        "len",
        "result",
        "full_page_text",
        "result",
        "images",
        "e",
        "logger",
        "error",
        "e",
        "result",
        "file_path",
        "Document",
        "ImportError",
        "Document",
        "file_path",
        "join",
        "paragraph",
        "text",
        "paragraph",
        "doc",
        "paragraphs",
        "text",
        "e",
        "logger",
        "error",
        "e",
        "file_path",
        "open",
        "file_path",
        "encoding",
        "f",
        "f",
        "read",
        "text",
        "e",
        "logger",
        "error",
        "e",
        "file_path",
        "pd",
        "read_csv",
        "file_path",
        "df",
        "to_string",
        "index",
        "text",
        "e",
        "logger",
        "error",
        "e",
        "file_path",
        "file_path",
        "endswith",
        "openpyxl",
        "load_workbook",
        "file_path",
        "sheet_name",
        "wb",
        "sheetnames",
        "wb",
        "sheet_name",
        "text",
        "sheet_name",
        "row",
        "sheet",
        "iter_rows",
        "values_only",
        "text",
        "join",
        "cell",
        "cell",
        "cell",
        "row",
        "pd",
        "read_excel",
        "file_path",
        "sheet_name",
        "sheet_name",
        "data",
        "df",
        "items",
        "text",
        "sheet_name",
        "data",
        "to_string",
        "index",
        "text",
        "e",
        "logger",
        "error",
        "e",
        "file_path",
        "Image",
        "open",
        "file_path",
        "extract_text_from_image",
        "image",
        "text",
        "e",
        "logger",
        "error",
        "e",
        "app",
        "route",
        "methods",
        "validate_api_key",
        "jsonify",
        "request",
        "files",
        "jsonify",
        "request",
        "files",
        "file",
        "file",
        "filename",
        "jsonify",
        "allowed_file",
        "file",
        "filename",
        "jsonify",
        "secure_filename",
        "file",
        "filename",
        "tempfile",
        "mkdtemp",
        "os",
        "path",
        "join",
        "temp_dir",
        "filename",
        "file",
        "save",
        "temp_path",
        "time",
        "time",
        "filename",
        "rsplit",
        "lower",
        "file_extension",
        "pdfplumber",
        "open",
        "temp_path",
        "pdf",
        "page_num",
        "page",
        "pdf",
        "pages",
        "process_pdf_page",
        "page",
        "page_num",
        "temp_path",
        "results",
        "append",
        "page_result",
        "page",
        "results",
        "combined_text",
        "page",
        "get",
        "page",
        "get",
        "filename",
        "len",
        "results",
        "round",
        "time",
        "time",
        "start_time",
        "len",
        "combined_text",
        "results",
        "file_extension",
        "process_docx",
        "temp_path",
        "filename",
        "round",
        "time",
        "time",
        "start_time",
        "len",
        "response",
        "file_extension",
        "process_txt",
        "temp_path",
        "filename",
        "round",
        "time",
        "time",
        "start_time",
        "len",
        "response",
        "file_extension",
        "process_csv",
        "temp_path",
        "filename",
        "round",
        "time",
        "time",
        "start_time",
        "len",
        "response",
        "file_extension",
        "process_excel",
        "temp_path",
        "filename",
        "round",
        "time",
        "time",
        "start_time",
        "len",
        "response",
        "file_extension",
        "process_image",
        "temp_path",
        "filename",
        "round",
        "time",
        "time",
        "start_time",
        "len",
        "response",
        "jsonify",
        "jsonify",
        "response",
        "e",
        "logger",
        "error",
        "e",
        "jsonify",
        "e",
        "temp_path",
        "os",
        "path",
        "exists",
        "temp_path",
        "os",
        "remove",
        "temp_path",
        "locals",
        "os",
        "path",
        "exists",
        "temp_dir",
        "os",
        "rmdir",
        "temp_dir",
        "e",
        "logger",
        "error",
        "e",
        "app",
        "run",
        "host",
        "port",
        "debug"
    ],
    "literals": [
        "'%(asctime)s - %(name)s - %(levelname)s - %(message)s'",
        "'pdf'",
        "'docx'",
        "'txt'",
        "'csv'",
        "'xlsx'",
        "'xls'",
        "'jpg'",
        "'jpeg'",
        "'png'",
        "'extracted_data'",
        "'UPLOAD_FOLDER'",
        "'MAX_CONTENT_LENGTH'",
        "\"your_api_key_1\"",
        "\"client1\"",
        "\"your_api_key_2\"",
        "\"client2\"",
        "'en'",
        "'hi'",
        "'en'",
        "'bn'",
        "'en'",
        "'ur'",
        "'.'",
        "'.'",
        "'X-API-KEY'",
        "f\"Image preprocessing failed: {str(e)}\"",
        "\" \"",
        "\" \"",
        "\" \"",
        "\" \"",
        "\" \"",
        "f\"OCR extraction failed: {str(e)}\"",
        "\"\"",
        "\"page\"",
        "\"native_text\"",
        "\"\"",
        "\"image_text\"",
        "\"\"",
        "\"type\"",
        "\"mixed\"",
        "\"native_text\"",
        "\"\"",
        "f\"Native text extraction failed: {str(e)}\"",
        "\"native_text\"",
        "\"native_text\"",
        "\"image_text\"",
        "\"type\"",
        "\"ocr_text\"",
        "\"native_text\"",
        "\"mixed\"",
        "f\"Page image processing failed: {str(e)}\"",
        "\"python-docx package is not installed\"",
        "\"\\n\"",
        "\"content\"",
        "\"page\"",
        "\"text\"",
        "\"type\"",
        "\"native_text\"",
        "f\"DOCX processing failed: {str(e)}\"",
        "'r'",
        "'utf-8'",
        "\"content\"",
        "\"page\"",
        "\"text\"",
        "\"type\"",
        "\"native_text\"",
        "f\"TXT processing failed: {str(e)}\"",
        "\"content\"",
        "\"page\"",
        "\"text\"",
        "\"type\"",
        "\"table_data\"",
        "f\"CSV processing failed: {str(e)}\"",
        "\"\"",
        "'.xlsx'",
        "f\"\\n\\nSheet: {sheet_name}\\n\"",
        "\"\\t\"",
        "\"\"",
        "\"\\n\"",
        "f\"\\n\\nSheet: {sheet_name}\\n{data.to_string(index=False)}\\n\"",
        "\"content\"",
        "\"page\"",
        "\"text\"",
        "\"type\"",
        "\"table_data\"",
        "f\"Excel processing failed: {str(e)}\"",
        "\"content\"",
        "\"page\"",
        "\"text\"",
        "\"type\"",
        "\"ocr_text\"",
        "f\"Image processing failed: {str(e)}\"",
        "'/process'",
        "'POST'",
        "\"error\"",
        "\"Invalid or missing API key\"",
        "'file'",
        "\"error\"",
        "\"No file provided\"",
        "'file'",
        "''",
        "\"error\"",
        "\"No selected file\"",
        "\"error\"",
        "\"Invalid file type\"",
        "'.'",
        "'pdf'",
        "\"\"",
        "\"native_text\"",
        "\"\"",
        "\"\\n\"",
        "\"image_text\"",
        "\"\"",
        "\"\\n\"",
        "\"metadata\"",
        "\"filename\"",
        "\"pages\"",
        "\"processing_time\"",
        "\"text_length\"",
        "\"content\"",
        "'docx'",
        "'metadata'",
        "\"filename\"",
        "\"pages\"",
        "\"processing_time\"",
        "\"text_length\"",
        "'content'",
        "'text'",
        "'txt'",
        "'metadata'",
        "\"filename\"",
        "\"pages\"",
        "\"processing_time\"",
        "\"text_length\"",
        "'content'",
        "'text'",
        "'csv'",
        "'metadata'",
        "\"filename\"",
        "\"pages\"",
        "\"processing_time\"",
        "\"text_length\"",
        "'content'",
        "'text'",
        "'xlsx'",
        "'xls'",
        "'metadata'",
        "\"filename\"",
        "\"pages\"",
        "\"processing_time\"",
        "\"text_length\"",
        "'content'",
        "'text'",
        "'jpg'",
        "'jpeg'",
        "'png'",
        "'metadata'",
        "\"filename\"",
        "\"pages\"",
        "\"processing_time\"",
        "\"text_length\"",
        "'content'",
        "'text'",
        "\"error\"",
        "\"Unsupported file type\"",
        "f\"Processing failed: {str(e)}\"",
        "\"error\"",
        "'temp_dir'",
        "f\"Cleanup failed: {str(e)}\"",
        "'__main__'",
        "'0.0.0.0'"
    ],
    "variables": [
        "Document",
        "app",
        "logger",
        "ALLOWED_EXTENSIONS",
        "UPLOAD_FOLDER",
        "OUTPUT_FOLDER",
        "API_KEYS",
        "reader_en_hi",
        "reader_en_bn",
        "reader_en_ur",
        "api_key",
        "img",
        "img",
        "img",
        "gray",
        "processed",
        "processed_img",
        "result_en_hi",
        "result_en_bn",
        "result_en_ur",
        "text_en_hi",
        "text_en_bn",
        "text_en_ur",
        "result",
        "result",
        "images",
        "full_page_text",
        "result",
        "result",
        "doc",
        "text",
        "text",
        "df",
        "text",
        "text",
        "wb",
        "sheet",
        "df",
        "image",
        "text",
        "file",
        "temp_path",
        "filename",
        "temp_dir",
        "temp_path",
        "start_time",
        "file_extension",
        "results",
        "page_result",
        "combined_text",
        "response",
        "response",
        "response",
        "response",
        "response",
        "response",
        "response",
        "response",
        "response",
        "response",
        "response"
    ],
    "comments": [
        "Handle case where python-docx is not installed",
        "Configure logging",
        "Configuration",
        "16MB limit",
        "API Key Configuration",
        "Initialize EasyOCR readers with GPU support",
        "Grayscale",
        "RGBA",
        "Convert to grayscale for processing",
        "Apply adaptive thresholding",
        "First try to extract native text",
        "Check if page has images or if native text extraction was insufficient",
        "Convert the entire page to image",
        "A4 size at 300dpi",
        "Extract text from the full page image",
        "Only use OCR text if we got more content than native extraction",
        "Explicit cleanup",
        ".xls",
        "API Key validation",
        "Save uploaded file temporarily",
        "Process file based on extension",
        "Combine results",
        "Clean up temporary files"
    ],
    "docstrings": [
        "\"\"\"Check if the provided API key is valid\"\"\"",
        "\"\"\"Enhance image for better OCR results\"\"\"",
        "\"\"\"Extract text from image using EasyOCR\"\"\"",
        "\"\"\"Process a single PDF page with mixed content\"\"\"",
        "\"\"\"Extract text from DOCX file\"\"\"",
        "\"\"\"Extract text from TXT file\"\"\"",
        "\"\"\"Extract data from CSV file\"\"\"",
        "\"\"\"Extract data from Excel file (XLSX or XLS)\"\"\"",
        "\"\"\"Extract text from image file (JPG, JPEG, PNG)\"\"\""
    ],
    "functions": [
        "allowed_file",
        "validate_api_key",
        "preprocess_image",
        "extract_text_from_image",
        "process_pdf_page",
        "process_docx",
        "process_txt",
        "process_csv",
        "process_excel",
        "process_image",
        "handle_file"
    ],
    "classes": []
}