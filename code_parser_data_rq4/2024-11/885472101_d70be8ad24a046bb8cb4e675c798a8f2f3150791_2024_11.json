{
    "identifiers": [
        "pandas",
        "pd",
        "PIL",
        "Image",
        "streamlit",
        "st",
        "streamlit",
        "components",
        "v1",
        "components",
        "apps",
        "data_utils",
        "DATA_PACKET",
        "format_classification_results",
        "apps",
        "app_utils",
        "DisableableButton",
        "reset_page_progress_state",
        "get_cached_style_intensity_classifier",
        "get_cached_word_attributions",
        "get_sti_metric",
        "get_cps_metric",
        "generate_style_transfer",
        "apps",
        "visualization_utils",
        "build_altair_classification_plot",
        "st",
        "session_state",
        "st",
        "session_state",
        "st",
        "session_state",
        "st",
        "session_state",
        "Image",
        "open",
        "st",
        "set_page_config",
        "page_title",
        "page_icon",
        "ffl_favicon",
        "layout",
        "initial_sidebar_state",
        "Image",
        "open",
        "st",
        "sidebar",
        "image",
        "ffl_logo",
        "st",
        "sidebar",
        "write",
        "st",
        "sidebar",
        "markdown",
        "st",
        "sidebar",
        "selectbox",
        "options",
        "DATA_PACKET",
        "keys",
        "DATA_PACKET",
        "style_attribute",
        "st",
        "sidebar",
        "markdown",
        "st",
        "sidebar",
        "caption",
        "st",
        "sidebar",
        "button",
        "on_click",
        "reset_page_progress_state",
        "st",
        "markdown",
        "st",
        "write",
        "st",
        "session_state",
        "page_progress",
        "st",
        "write",
        "st",
        "container",
        "st",
        "columns",
        "col1_1",
        "st",
        "radio",
        "horizontal",
        "col1_2",
        "input_type",
        "st",
        "text_input",
        "style_attribute",
        "help",
        "st",
        "selectbox",
        "style_attribute",
        "i",
        "i",
        "len",
        "STYLE_ATTRIBUTE_DATA",
        "examples",
        "help",
        "option",
        "split",
        "STYLE_ATTRIBUTE_DATA",
        "examples",
        "idx_key",
        "st",
        "text_area",
        "value",
        "text_sample",
        "placeholder",
        "disabled",
        "text_sample",
        "DisableableButton",
        "db1",
        "create_enabled_button",
        "st",
        "session_state",
        "page_progress",
        "db1",
        "disable",
        "st",
        "write",
        "st",
        "write",
        "STYLE_ATTRIBUTE_DATA",
        "attribute_AND_string",
        "st",
        "spinner",
        "get_cached_style_intensity_classifier",
        "style_data",
        "STYLE_ATTRIBUTE_DATA",
        "sic",
        "score",
        "text_sample",
        "pd",
        "DataFrame",
        "cls_result",
        "columns",
        "index",
        "v",
        "k",
        "v",
        "sic",
        "pipeline",
        "model",
        "config",
        "id2label",
        "items",
        "st",
        "container",
        "format_classification_results",
        "id2label",
        "sic",
        "pipeline",
        "model",
        "config",
        "id2label",
        "cls_result",
        "cls_result",
        "st",
        "markdown",
        "build_altair_classification_plot",
        "format_cls_result",
        "st",
        "altair_chart",
        "chart",
        "interactive",
        "use_container_width",
        "st",
        "markdown",
        "STYLE_ATTRIBUTE_DATA",
        "cls_model_path",
        "STYLE_ATTRIBUTE_DATA",
        "build_model_url",
        "text_sample",
        "cls_result",
        "capitalize",
        "round",
        "cls_result",
        "st",
        "write",
        "cls_result",
        "lower",
        "STYLE_ATTRIBUTE_DATA",
        "target_attribute",
        "st",
        "info",
        "STYLE_ATTRIBUTE_DATA",
        "attribute_THAN_string",
        "DisableableButton",
        "db2",
        "create_enabled_button",
        "st",
        "success",
        "STYLE_ATTRIBUTE_DATA",
        "attribute_THAN_string",
        "st",
        "session_state",
        "page_progress",
        "db2",
        "disable",
        "st",
        "write",
        "st",
        "write",
        "st",
        "spinner",
        "get_cached_word_attributions",
        "text_sample",
        "text_sample",
        "style_data",
        "STYLE_ATTRIBUTE_DATA",
        "components",
        "html",
        "html",
        "word_attributions_visual",
        "height",
        "scrolling",
        "st",
        "write",
        "STYLE_ATTRIBUTE_DATA",
        "source_attribute",
        "STYLE_ATTRIBUTE_DATA",
        "source_attribute",
        "DisableableButton",
        "db3",
        "create_enabled_button",
        "st",
        "session_state",
        "page_progress",
        "db3",
        "disable",
        "st",
        "write",
        "st",
        "write",
        "STYLE_ATTRIBUTE_DATA",
        "source_attribute",
        "STYLE_ATTRIBUTE_DATA",
        "target_attribute",
        "st",
        "expander",
        "st",
        "write",
        "st",
        "slider",
        "st",
        "write",
        "st",
        "slider",
        "st",
        "write",
        "st",
        "slider",
        "st",
        "markdown",
        "STYLE_ATTRIBUTE_DATA",
        "seq2seq_model_path",
        "STYLE_ATTRIBUTE_DATA",
        "build_model_url",
        "st",
        "columns",
        "col4_2",
        "st",
        "markdown",
        "max_gen_length",
        "num_beams",
        "temperature",
        "col4_3",
        "st",
        "container",
        "st",
        "write",
        "st",
        "button",
        "key",
        "on_click",
        "generate_style_transfer",
        "kwargs",
        "text_sample",
        "STYLE_ATTRIBUTE_DATA",
        "max_gen_length",
        "num_beams",
        "temperature",
        "st",
        "session_state",
        "st_result",
        "st",
        "warning",
        "STYLE_ATTRIBUTE_DATA",
        "source_attribute",
        "capitalize",
        "text_sample",
        "st",
        "info",
        "STYLE_ATTRIBUTE_DATA",
        "target_attribute",
        "capitalize",
        "st",
        "session_state",
        "st_result",
        "DisableableButton",
        "db4",
        "create_enabled_button",
        "st",
        "session_state",
        "page_progress",
        "db4",
        "disable",
        "st",
        "write",
        "st",
        "markdown",
        "st",
        "spinner",
        "get_sti_metric",
        "input_text",
        "text_sample",
        "output_text",
        "st",
        "session_state",
        "st_result",
        "style_data",
        "STYLE_ATTRIBUTE_DATA",
        "get_cps_metric",
        "input_text",
        "text_sample",
        "output_text",
        "st",
        "session_state",
        "st_result",
        "style_data",
        "STYLE_ATTRIBUTE_DATA",
        "st",
        "markdown",
        "unsafe_allow_html",
        "st",
        "columns",
        "col5_1",
        "st",
        "metric",
        "label",
        "value",
        "round",
        "sti",
        "st",
        "caption",
        "STYLE_ATTRIBUTE_DATA",
        "build_model_url",
        "col5_3",
        "st",
        "metric",
        "label",
        "value",
        "round",
        "cps",
        "st",
        "caption",
        "STYLE_ATTRIBUTE_DATA",
        "build_model_url"
    ],
    "literals": [
        "\"page_progress\"",
        "\"st_result\"",
        "\"static/images/cldr-favicon.ico\"",
        "\"CFFL: Text Style Transfer\"",
        "\"centered\"",
        "\"expanded\"",
        "\"static/images/ffllogo2@1x.png\"",
        "\"This prototype accompanies our [Text Style Transfer](https://blog.fastforwardlabs.com/2022/03/22/an-introduction-to-text-style-transfer.html)\\\n     blog series in which we explore the task of automatically neutralizing subjectivity bias in free text.\"",
        "\"## Select a style attribute\"",
        "\"What style would you like to transfer between?\"",
        "\"## Start over\"",
        "\"This application is intended to be run sequentially from top to bottom. If you wish to alter selections after \\\n    advancing through the app, push the button below to start fresh from the beginning.\"",
        "\"Restart from beginning\"",
        "\"# Exploring Intelligent Writing Assistance\"",
        "\"### 1. Input some text\"",
        "\"Type your own or choose from a preset example\"",
        "\"Choose preset\"",
        "\"Enter text\"",
        "\"Enter text\"",
        "f\"Enter some text to modify style from {style_attribute}\"",
        "\"You can also select one of our preset examples by toggling the radio button to the left.\"",
        "f\"Select a preset example to modify style from {style_attribute}\"",
        "f\"Example {i+1}\"",
        "\"You can also enter your own text by toggling the radio button to the left.\"",
        "\" \"",
        "\"Preview Text\"",
        "\"Enter some text above or toggle to choose a preset!\"",
        "\"\"",
        "\"Let's go!\"",
        "\"### 2. Detect style\"",
        "f\"\"\"\n            Before we can transfer style, we need to ensure the input text isn't already of the target style! To do so,\n            we classify the sample text with a model that has been fine-tuned to differentiate between\n            {STYLE_ATTRIBUTE_DATA.attribute_AND_string} tones. \n            \n            In a product setting, you could imagine this style detection process running continuously inside your favorite word processor as you write, \n            prompting you for action when it detects language that is at odds with your desired tone of voice.\n            \"\"\"",
        "\"Detecting style, hang tight!\"",
        "\"distribution\"",
        "\"Score\"",
        "\"##### Distribution Between Style Classes\"",
        "f\"\"\"\n            - **:hugging_face: Model:** [{STYLE_ATTRIBUTE_DATA.cls_model_path}]({STYLE_ATTRIBUTE_DATA.build_model_url(\"cls\")})\n            - **Input Text:** *\"{text_sample}\"*\n            - **Classification Result:** \\t {cls_result[0][\"label\"].capitalize()} ({round(cls_result[0][\"score\"]*100, 2)}%)\n            \"\"\"",
        "\"cls\"",
        "\"label\"",
        "\"score\"",
        "\" \"",
        "\"label\"",
        "f\"\"\"\n            **Looks like we have room for improvement!**\n            \n            The distribution of classification scores suggests that the input text is more {STYLE_ATTRIBUTE_DATA.attribute_THAN_string}. Therefore,\n            an automated style transfer may improve our intended tone of voice.\"\"\"",
        "\"Let's see why\"",
        "f\"\"\"**No work to be done!** \\n\\n\\n The distribution of classification scores suggests that the input text is less \\\n            {STYLE_ATTRIBUTE_DATA.attribute_THAN_string}. Therefore, there's no need to transfer style. \\\n            Enter a different text prompt or select one of the preset examples to re-run the analysis with.\"\"\"",
        "\"### 3. Interpret the classification result\"",
        "f\"\"\"\n        Interpreting our model's output is a crucial practice that helps build trust and justify taking real-world action from the\n        model predictions. In this case, we apply a popular model interpretability technique called [Integrated Gradients](https://arxiv.org/pdf/1703.01365.pdf) \n        to the Transformer-based classifier to explain the model's prediction in terms of its features.\"\"\"",
        "\"Interpreting the prediction, hang tight!\"",
        "f\"\"\"\n        The visual above displays word attributions using the [Transformers Interpret](https://github.com/cdpierse/transformers-interpret) library. \n        Positive attribution values (green) indicate tokens that contribute positively towards the \n        predicted class ({STYLE_ATTRIBUTE_DATA.source_attribute}), while negative values (red) indicate tokens that contribute negatively towards the predicted class.\n        \n        Visualizing word attributions is a helpful way to build intuition about what makes the input text _{STYLE_ATTRIBUTE_DATA.source_attribute}_!\"\"\"",
        "\"Next\"",
        "\"### 4. Generate a suggestion\"",
        "f\"Now that we've verified the input text is in fact *{STYLE_ATTRIBUTE_DATA.source_attribute}* and understand why that's the case, we can utilize a \\\n            text style transfer model to generate a suggested replacement that retains the same semantic meaning, but achieves the *{STYLE_ATTRIBUTE_DATA.target_attribute}* target style.\\\n            \\n\\n Expand the accordian below to toggle generation parameters, then click the button to transfer style!\"",
        "\"Toggle generation parameters\"",
        "\"**max_gen_length**\"",
        "\"Whats the maximum generation length desired?\"",
        "\"**num_beams**\"",
        "\"How many beams to use for beam-search decoding?\"",
        "\"**temperature**\"",
        "\"What sensitivity value to model next token probabilities?\"",
        "f\"\"\"\n        **:hugging_face: Model:** [{STYLE_ATTRIBUTE_DATA.seq2seq_model_path}]({STYLE_ATTRIBUTE_DATA.build_model_url(\"seq2seq\")})\n        \"\"\"",
        "\"seq2seq\"",
        "f\"\"\"\n            - **Max Generation Length:** {max_gen_length}\n            - **Number of Beams:** {num_beams}\n            - **Temperature:** {temperature}\n            \"\"\"",
        "\"\"",
        "\"Generate style transfer\"",
        "\"generate_text\"",
        "\"text_sample\"",
        "\"style_data\"",
        "\"max_gen_length\"",
        "\"num_beams\"",
        "\"temperature\"",
        "f\"\"\"**{STYLE_ATTRIBUTE_DATA.source_attribute.capitalize()} Input:** \"{text_sample}\" \"\"\"",
        "f\"\"\"\n            **{STYLE_ATTRIBUTE_DATA.target_attribute.capitalize()} Suggestion:** \"{st.session_state.st_result[0]}\" \"\"\"",
        "\"Next\"",
        "\"### 5. Evaluate the suggestion\"",
        "\"Evaluating text style transfer, hang tight!\"",
        "\"Style Transfer Intensity (STI)\"",
        "f\"{round(sti[0]*100,2)}%\"",
        "f\"\"\"\n                STI compares the style class distributions (determined by the [style classifier]({STYLE_ATTRIBUTE_DATA.build_model_url(\"cls\")}))\n                between the input text and generated suggestion using Earth Mover's Distance. Therefore, STI can be thought of as the percentage of the possible target style distribution\n                that was captured during the transfer.\n                \"\"\"",
        "\"cls\"",
        "\"Content Preservation Score (CPS)\"",
        "f\"{round(cps[0]*100,2)}%\"",
        "f\"\"\"\n                CPS compares the latent space embeddings (determined by [SentenceBERT]({STYLE_ATTRIBUTE_DATA.build_model_url(\"sbert\")}))\n                between the input text and generated suggestion using cosine similarity. Therefore, CPS can be thought of as the percentage of content that was perserved\n                during the style transfer.\n                \"\"\"",
        "\"sbert\""
    ],
    "variables": [
        "page_progress",
        "st_result",
        "ffl_favicon",
        "ffl_logo",
        "style_attribute",
        "STYLE_ATTRIBUTE_DATA",
        "col1_1",
        "col1_2",
        "input_type",
        "text_sample",
        "option",
        "idx_key",
        "text_sample",
        "db1",
        "sic",
        "cls_result",
        "cls_result_df",
        "format_cls_result",
        "chart",
        "db2",
        "word_attributions_visual",
        "db3",
        "max_gen_length",
        "num_beams",
        "temperature",
        "col4_1",
        "col4_2",
        "col4_3",
        "db4",
        "sti",
        "cps",
        "col5_1",
        "col5_2",
        "col5_3"
    ],
    "comments": [
        "###########################################################################",
        "",
        "CLOUDERA APPLIED MACHINE LEARNING PROTOTYPE (AMP)",
        "(C) Cloudera, Inc. 2022",
        "All rights reserved.",
        "",
        "Applicable Open Source License: Apache 2.0",
        "",
        "NOTE: Cloudera open source products are modular software products",
        "made up of hundreds of individual components, each of which was",
        "individually copyrighted.  Each Cloudera open source product is a",
        "collective work under U.S. Copyright Law. Your license to use the",
        "collective work is as provided in your written agreement with",
        "Cloudera.  Used apart from the collective work, this file is",
        "licensed for your use pursuant to the open source license",
        "identified above.",
        "",
        "This code is provided to you pursuant a written agreement with",
        "(i) Cloudera, Inc. or (ii) a third-party authorized to distribute",
        "this code. If you do not have a written agreement with Cloudera nor",
        "with an authorized and properly licensed third party, you do not",
        "have any rights to access nor to use this code.",
        "",
        "Absent a written agreement with Cloudera, Inc. (“Cloudera”) to the",
        "contrary, A) CLOUDERA PROVIDES THIS CODE TO YOU WITHOUT WARRANTIES OF ANY",
        "KIND; (B) CLOUDERA DISCLAIMS ANY AND ALL EXPRESS AND IMPLIED",
        "WARRANTIES WITH RESPECT TO THIS CODE, INCLUDING BUT NOT LIMITED TO",
        "IMPLIED WARRANTIES OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY AND",
        "FITNESS FOR A PARTICULAR PURPOSE; (C) CLOUDERA IS NOT LIABLE TO YOU,",
        "AND WILL NOT DEFEND, INDEMNIFY, NOR HOLD YOU HARMLESS FOR ANY CLAIMS",
        "ARISING FROM OR RELATED TO THE CODE; AND (D)WITH RESPECT TO YOUR EXERCISE",
        "OF ANY RIGHTS GRANTED TO YOU FOR THE CODE, CLOUDERA IS NOT LIABLE FOR ANY",
        "DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, PUNITIVE OR",
        "CONSEQUENTIAL DAMAGES INCLUDING, BUT NOT LIMITED TO, DAMAGES",
        "RELATED TO LOST REVENUE, LOST PROFITS, LOSS OF INCOME, LOSS OF",
        "BUSINESS ADVANTAGE OR UNAVAILABILITY, OR LOSS OR CORRUPTION OF",
        "DATA.",
        "",
        "###########################################################################",
        "SESSION STATE UTILS",
        "PAGE CONFIG",
        "SIDEBAR",
        "MAIN CONTENT",
        "1. INPUT EXAMPLE",
        "2. CLASSIFY INPUT",
        "3. Here's why",
        "4. SUGGEST GENERATED EDIT",
        "st.markdown(\"##### Text generation parameters\")",
        "5. EVALUATE THE SUGGESTION"
    ],
    "docstrings": [
        "\"\"\"\n    The goal of this application is to demonstrate how the NLP task of _text style transfer_ can be applied to enhance the human writing experience. \n    In this sense, we intend to peel back the curtains on how an intelligent writing assistant might function — walking through the logical steps needed to \n    automatically re-style a piece of text while building up confidence in the model output. \n\n    We emphasize the imperative for a human-in-the-loop user experience when designing natural language generation systems. We believe text style \n    transfer has the potential to empower writers to better express themselves, but not by blindly generating text. Rather, generative models, in conjunction with \n    interpretability methods, should be combined to help writers understand the nuances of linguistic style and suggest stylistic edits that _may_ improve their writing.\n\n    Select a style attribute from the sidebar and enter some text below to get started!\n    \"\"\"",
        "\"\"\"\n        Blindly prompting a writer with style suggestions without first checking quality would make for a noisy, error-prone product\n        with a poor user experience. Ultimately, we only want to suggest high quality edits. But what makes for a suggestion-worthy edit?\n\n        A comprehensive quality evaluation for text style transfer output should consider three criteria:\n        1. **Style strength** - To what degree does the generated text achieve the target style? \n        2. **Content preservation** - To what degree does the generated text retain the semantic meaning of the source text?\n        3. **Fluency** - To what degree does the generated text appear as if it were produced naturally by a human?\n\n        Below, we apply automated evaluation metrics - _Style Transfer Intensity (STI)_ & _Content Preservation Score (CPS)_ - to\n        measure the first two of these criteria by comparing the input text to the generated suggestion.\n        \"\"\"",
        "\"\"\"<hr style=\"height:2px;border:none;color:#333;background-color:#333;\" /> \"\"\""
    ],
    "functions": [],
    "classes": []
}