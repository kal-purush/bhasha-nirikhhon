{
    "identifiers": [
        "logging",
        "re",
        "os",
        "autotest",
        "client",
        "shared",
        "error",
        "autotest",
        "client",
        "shared",
        "utils",
        "virttest",
        "utils_net",
        "utils_test",
        "utils_misc",
        "virttest",
        "aexpect",
        "virttest",
        "remote",
        "virttest",
        "data_dir",
        "error",
        "context_aware",
        "test",
        "env",
        "access_sys",
        "access_targets",
        "disabled",
        "host_ip",
        "asys",
        "access_sys",
        "atgt",
        "access_targets",
        "logging",
        "debug",
        "atgt",
        "asys",
        "access_sys",
        "asys",
        "access_params",
        "atgt",
        "asys",
        "vms_tags",
        "env",
        "get_vm",
        "asys",
        "vm",
        "wait_for_login",
        "timeout",
        "timeout",
        "session",
        "cmd",
        "vm",
        "vm",
        "get_address",
        "utils",
        "system_output",
        "host_ip",
        "atgt",
        "vms_tags",
        "env",
        "get_vm",
        "atgt",
        "vm",
        "wait_for_get_address",
        "host_ip",
        "re",
        "sub",
        "access_re_sub_string",
        "access_params",
        "re",
        "sub",
        "access_re_sub_string",
        "access_params",
        "access_cmd",
        "atgt",
        "vms_tags",
        "env",
        "get_vm",
        "atgt",
        "target_vm",
        "get_address",
        "host_ip",
        "remote_login",
        "access_cmd",
        "target_ip",
        "remote_src",
        "host_ip",
        "remote",
        "LoginError",
        "err",
        "atgt",
        "out_err",
        "asys",
        "err",
        "output",
        "remote_login",
        "access_cmd",
        "ssh_src_ip",
        "target_vm",
        "host_ip",
        "remote",
        "LoginError",
        "err",
        "stat",
        "out_err",
        "asys",
        "out_err",
        "atgt",
        "err",
        "output",
        "out_err",
        "out_err",
        "run_func",
        "access_cmd",
        "timeout",
        "op_timeout",
        "access_params",
        "get",
        "check_string",
        "check_string",
        "aexpect",
        "ShellCmdError",
        "error",
        "CmdError",
        "aexpect",
        "ShellTimeoutError",
        "err",
        "isinstance",
        "err",
        "error",
        "CmdError",
        "err",
        "result_obj",
        "stderr",
        "err",
        "result_obj",
        "exit_status",
        "err",
        "output",
        "isinstance",
        "err",
        "aexpect",
        "ShellTimeoutError",
        "session",
        "close",
        "vm",
        "wait_for_login",
        "timeout",
        "timeout",
        "session",
        "cmd",
        "err",
        "status",
        "access_params",
        "get",
        "run_func",
        "access_params",
        "disabled",
        "atgt_disabled",
        "stat",
        "err_msg",
        "atgt",
        "err_msg",
        "err_msg",
        "access_cmd",
        "err_msg",
        "disabled",
        "atgt_disabled",
        "stat",
        "logging",
        "debug",
        "disabled",
        "stat",
        "err_msg",
        "atgt",
        "err_msg",
        "err_msg",
        "atgt",
        "err_msg",
        "err_msg",
        "access_cmd",
        "err_msg",
        "err_msg",
        "session",
        "close",
        "err_type",
        "error",
        "TestNAError",
        "err_msg",
        "error",
        "TestFail",
        "err_msg",
        "ref_cmd",
        "session",
        "close",
        "run_func",
        "ref_cmd",
        "timeout",
        "op_timeout",
        "aexpect",
        "ShellCmdError",
        "error",
        "CmdError",
        "aexpect",
        "ShellTimeoutError",
        "err",
        "isinstance",
        "err",
        "error",
        "CmdError",
        "err",
        "result_obj",
        "stderr",
        "err",
        "result_obj",
        "exit_status",
        "err",
        "output",
        "isinstance",
        "err",
        "aexpect",
        "ShellTimeoutError",
        "err",
        "status",
        "stat",
        "err_msg",
        "err_msg",
        "err_msg",
        "err_msg",
        "ref_cmd",
        "err_msg",
        "err_msg",
        "session",
        "close",
        "err_type",
        "error",
        "TestNAError",
        "err_msg",
        "error",
        "TestFail",
        "err_msg",
        "session",
        "close",
        "protocol",
        "in_port",
        "action",
        "extra_options",
        "protocol",
        "strip",
        "acl_cmd",
        "in_port",
        "strip",
        "extra_options",
        "strip",
        "acl_cmd",
        "join",
        "extra_options",
        "strip",
        "split",
        "action",
        "strip",
        "acl_cmd",
        "action",
        "strip",
        "acl_cmd",
        "acl_rules",
        "acl_setup_cmd",
        "re",
        "sub",
        "acl_setup_cmd",
        "re",
        "split",
        "acl_setup_cmd",
        "line",
        "acl_rules",
        "splitlines",
        "_",
        "lower",
        "_",
        "re",
        "split",
        "line",
        "_",
        "acl_item",
        "acl_option",
        "acl_item",
        "lower",
        "rule",
        "item_in_rule",
        "item_in_rule",
        "len",
        "acl_option",
        "client",
        "host",
        "src",
        "params_login",
        "host_ip",
        "src",
        "src",
        "src",
        "name",
        "logging",
        "info",
        "host",
        "src",
        "params_login",
        "params_login",
        "params_login",
        "params_login",
        "eval",
        "params_login",
        "get",
        "get",
        "host",
        "host_ip",
        "params_login",
        "params_login",
        "client",
        "port",
        "username",
        "host",
        "client",
        "username",
        "host",
        "port",
        "remote",
        "LoginBadClientError",
        "client",
        "src",
        "logging",
        "debug",
        "cmd",
        "aexpect",
        "ShellSession",
        "cmd",
        "linesep",
        "linesep",
        "prompt",
        "prompt",
        "params_login",
        "get",
        "client",
        "host",
        "username",
        "cmd",
        "password",
        "prompt",
        "cmd",
        "cmd",
        "cmd",
        "src",
        "wait_for_login",
        "logging",
        "debug",
        "cmd",
        "session",
        "sendline",
        "cmd",
        "remote",
        "handle_prompts",
        "session",
        "username",
        "password",
        "prompt",
        "timeout",
        "debug",
        "err",
        "session",
        "close",
        "err",
        "session",
        "cmd",
        "quit_cmd",
        "session",
        "close",
        "setup_target",
        "get",
        "setup_target",
        "utils",
        "system_output",
        "env",
        "get_vm",
        "setup_target",
        "setup_vm",
        "wait_for_login",
        "timeout",
        "timeout",
        "setup_session",
        "cmd",
        "object_params",
        "os_type",
        "setup_params",
        "get",
        "setup_params",
        "get",
        "re",
        "sub",
        "setup_params",
        "get",
        "setup_cmd",
        "error",
        "context",
        "setup_params",
        "get",
        "setup_target",
        "logging",
        "info",
        "prepare_cmd",
        "setup_func",
        "prepare_cmd",
        "timeout",
        "setup_timeout",
        "setup_func",
        "setup_cmd",
        "timeout",
        "setup_timeout",
        "setup_target",
        "setup_session",
        "close",
        "setup_target",
        "get",
        "setup_target",
        "utils",
        "system_output",
        "env",
        "get_vm",
        "setup_target",
        "setup_vm",
        "wait_for_login",
        "timeout",
        "timeout",
        "setup_session",
        "cmd",
        "object_params",
        "os_type",
        "setup_params",
        "get",
        "setup_params",
        "get",
        "re",
        "sub",
        "setup_params",
        "get",
        "stop_cmd",
        "error",
        "context",
        "setup_params",
        "get",
        "setup_target",
        "logging",
        "info",
        "stop_cmd",
        "setup_func",
        "stop_cmd",
        "timeout",
        "setup_timeout",
        "cleanup_cmd",
        "setup_func",
        "cleanup_cmd",
        "timeout",
        "setup_timeout",
        "setup_target",
        "setup_session",
        "close",
        "get",
        "get",
        "get",
        "vm",
        "env",
        "get_all_vms",
        "vm",
        "wait_for_login",
        "timeout",
        "timeout",
        "get",
        "session",
        "cmd",
        "get",
        "data_dir",
        "get_root_dir",
        "os",
        "path",
        "join",
        "root_dir",
        "get",
        "script",
        "get",
        "split",
        "os",
        "path",
        "join",
        "script_dir",
        "script",
        "vm",
        "copy_files_to",
        "script_path",
        "tmp_dir",
        "session",
        "close",
        "objects",
        "get",
        "br_name",
        "get",
        "setup_target",
        "get",
        "split",
        "setup_service",
        "setup_target",
        "get",
        "split",
        "get",
        "get",
        "split",
        "vms_tags",
        "env",
        "get_vm",
        "vms_tags",
        "vm",
        "virtnet",
        "nic",
        "ifname",
        "object_params",
        "params_nic",
        "get",
        "utils_net",
        "get_host_ip_address",
        "params_nic",
        "deny_target",
        "vms_tags",
        "env",
        "get_vm",
        "deny_target",
        "deny_vm",
        "wait_for_get_address",
        "deny_target",
        "host_ip",
        "acl_extra_options",
        "re",
        "sub",
        "deny_vm_ip",
        "acl_extra_options",
        "re",
        "sub",
        "target_port",
        "acl_extra_options",
        "target",
        "all_target",
        "target",
        "access_targets",
        "target",
        "vms_tags",
        "object_params",
        "os_type",
        "os_params",
        "object_params",
        "target",
        "access_param",
        "get",
        "access_sys",
        "target",
        "access_param",
        "access_sys",
        "target",
        "access_param",
        "get",
        "access_sys",
        "target",
        "access_param",
        "get",
        "check_from_output",
        "access_sys",
        "target",
        "check_from_output",
        "tgt",
        "access_targets",
        "access_param",
        "object_params",
        "tgt",
        "tgt_param",
        "get",
        "access_sys",
        "target",
        "tgt",
        "acl_disabled",
        "error",
        "context",
        "logging",
        "info",
        "access_service",
        "access_sys",
        "access_targets",
        "host_ip",
        "error",
        "context",
        "logging",
        "info",
        "utils_net",
        "openflow_manager",
        "br_name",
        "stdout",
        "re",
        "findall",
        "if_name",
        "br_infos",
        "if_port",
        "error",
        "TestNAError",
        "if_name",
        "br_name",
        "if_port",
        "get_acl_cmd",
        "acl_protocol",
        "if_port",
        "acl_extra_options",
        "utils_net",
        "openflow_manager",
        "br_name",
        "acl_cmd",
        "utils_net",
        "openflow_manager",
        "br_name",
        "stdout",
        "acl_rules_check",
        "acl_rules",
        "acl_cmd",
        "error",
        "TestFail",
        "acl_rules",
        "error",
        "context",
        "logging",
        "info",
        "access_service",
        "access_sys",
        "access_targets",
        "host_ip",
        "error",
        "context",
        "logging",
        "info",
        "get_acl_cmd",
        "acl_protocol",
        "if_port",
        "acl_extra_options",
        "utils_net",
        "openflow_manager",
        "br_name",
        "acl_cmd",
        "utils_net",
        "openflow_manager",
        "br_name",
        "stdout",
        "acl_rules_check",
        "acl_rules",
        "acl_cmd",
        "error",
        "TestFail",
        "acl_rules",
        "error",
        "context",
        "logging",
        "info",
        "access_service",
        "access_sys",
        "access_targets",
        "host_ip",
        "error",
        "context",
        "logging",
        "info",
        "get_acl_cmd",
        "acl_protocol",
        "if_port",
        "acl_extra_options",
        "utils_net",
        "openflow_manager",
        "br_name",
        "acl_cmd",
        "utils_net",
        "openflow_manager",
        "br_name",
        "stdout",
        "acl_rules_check",
        "acl_rules",
        "acl_cmd",
        "error",
        "TestFail",
        "acl_rules",
        "error",
        "context",
        "logging",
        "info",
        "access_service",
        "access_sys",
        "access_targets",
        "host_ip",
        "setup_target",
        "get",
        "split",
        "stop_service",
        "setup_target"
    ],
    "literals": [
        "\"\"",
        "\"\"",
        "\"Try to access target %s from %s\"",
        "'disabled_%s'",
        "\"localhost\"",
        "\"ACCESS_TARGET\"",
        "'access_cmd'",
        "\"ACCESS_TARGET\"",
        "'ref_cmd'",
        "\"ssh\"",
        "\"telnet\"",
        "\"localhost\"",
        "\"\"",
        "\"\"",
        "\"Failed to login %s \"",
        "\"from %s, err: %s\"",
        "\"Failed to login %s \"",
        "\"from %s, err: %s\"",
        "\"check_from_output\"",
        "\"clean_cmd\"",
        "'clean_cmd'",
        "\"Still can access %s after\"",
        "\" disable it from ovs. \"",
        "\"Command: %s. \"",
        "\"Output: %s\"",
        "\"Can not access target as expect.\"",
        "\"Can not access %s at the\"",
        "\" beginning. Please check your setup.\"",
        "\"ref\"",
        "\"Still can not access %s\"",
        "\" after enable the access\"",
        "\"Command: %s. \"",
        "\"Output: %s\"",
        "\"ref\"",
        "\"Refernce command failed at beginning.\"",
        "\"ref\"",
        "\"Refernce command failed after setup\"",
        "\" the rules\"",
        "\"Command: %s. \"",
        "\"Output: %s\"",
        "\"ref\"",
        "\",in_port=%s\"",
        "\",%s\"",
        "\",\"",
        "\",action=%s\"",
        "\"action=\"",
        "\"actions=\"",
        "\",\"",
        "\"[ ,]\"",
        "\"localhost\"",
        "\"Login %s from %s\"",
        "\"target_port\"",
        "\"username\"",
        "\"password\"",
        "\"shell_prompt\"",
        "\"'%s'\"",
        "\"shell_linesep\"",
        "r\"\\n\"",
        "\"quit_cmd\"",
        "\"exit\"",
        "\"^\\[.*\\][\\#\\$]\\s*$\"",
        "\"\\n\"",
        "\"host_username\"",
        "\"host_password\"",
        "\"exit\"",
        "\"ssh\"",
        "\"ssh -o UserKnownHostsFile=/dev/null \"",
        "\"-o StrictHostKeyChecking=no \"",
        "\"-o PreferredAuthentications=password -p %s %s@%s\"",
        "\"telnet\"",
        "\"telnet -l %s %s %s\"",
        "\"localhost\"",
        "\"Login with command %s\"",
        "\"os_type\"",
        "\"windows\"",
        "\"telnet\"",
        "\"C:\\\\telnet.py %s %s \"",
        "\"%s \\\"%s\\\" && \"",
        "\"C:\\\\wait_for_quit.py\"",
        "\"%s || ping 127.0.0.1 -n 5 -w 1000 > nul\"",
        "\" || sleep 5\"",
        "\"Sending login command: %s\"",
        "\"setup_timeout\"",
        "\"localhost\"",
        "\"linux\"",
        "\"os_type\"",
        "\"setup_cmd\"",
        "\"service SERVICE restart\"",
        "\"prepare_cmd\"",
        "\"SERVICE\"",
        "\"service\"",
        "\"\"",
        "\"Set up %s service in %s\"",
        "\"service\"",
        "\"localhost\"",
        "\"setup_timeout\"",
        "\"localhost\"",
        "\"linux\"",
        "\"os_type\"",
        "\"stop_cmd\"",
        "\"service SERVICE stop\"",
        "\"cleanup_cmd\"",
        "\"SERVICE\"",
        "\"service\"",
        "\"\"",
        "\"Stop %s service in %s\"",
        "\"service\"",
        "\"localhost\"",
        "\"login_timeout\"",
        "'360'",
        "\"op_timeout\"",
        "\"360\"",
        "'acl_protocol'",
        "\"acl_extra_options\"",
        "\"\"",
        "\"disable_iptables\"",
        "\"yes\"",
        "\"iptables -F\"",
        "\"copy_scripts\"",
        "\"shared\"",
        "\"scripts\"",
        "\"tmp_dir\"",
        "\"C:\\\\\"",
        "\"copy_scripts\"",
        "\"vms\"",
        "\"netdst\"",
        "\"private\"",
        "\"priv_brname\"",
        "'autotest-prbr0'",
        "\"setup_targets\"",
        "\"\"",
        "\"access_targets\"",
        "\"localhost\"",
        "\"deny_target\"",
        "\"localhost\"",
        "\"extra_target\"",
        "\"\"",
        "\"target_port\"",
        "\"nic1\"",
        "\"netdst\"",
        "\"private\"",
        "\"netdst\"",
        "\"priv_brname\"",
        "\"atbr0\"",
        "\"localhost\"",
        "\"NW_DST\"",
        "\"NW_DST\"",
        "\"TARGET_PORT\"",
        "\"os_type\"",
        "\"linux\"",
        "\"check_from_output\"",
        "'access_cmd'",
        "'access_cmd'",
        "'ref_cmd'",
        "'ref_cmd'",
        "\"\"",
        "'clean_cmd'",
        "'clean_guest'",
        "\"\"",
        "'check_from_output'",
        "\"acl_disabled\"",
        "\"yes\"",
        "'disabled_%s'",
        "\"Try to access target before setup the rules\"",
        "\"Disable the access in ovs\"",
        "\"show\"",
        "\"(\\d+)\\(%s\\)\"",
        "\"Can not find %s in bridge %s\"",
        "\"drop\"",
        "\"add-flow\"",
        "\"dump-flows\"",
        "\"Can not find the rules from\"",
        "\" ovs-ofctl: %s\"",
        "\"Try to acess target to exam the disable rules\"",
        "\"Enable the access in ovs\"",
        "\"normal\"",
        "\"mod-flows\"",
        "\"dump-flows\"",
        "\"Can not find the rules from\"",
        "\" ovs-ofctl: %s\"",
        "\"Try to acess target to exam the enable rules\"",
        "\"Delete the access rules in ovs\"",
        "\"\"",
        "\"del-flows\"",
        "\"dump-flows\"",
        "\"Still can find the rules from\"",
        "\" ovs-ofctl: %s\"",
        "\"Try to acess target to exam after delete the rules\"",
        "\"setup_targets\"",
        "\"\""
    ],
    "variables": [
        "err_msg",
        "err_type",
        "access_params",
        "atgt_disabled",
        "vm",
        "session",
        "run_func",
        "remote_src",
        "ssh_src_ip",
        "run_func",
        "remote_src",
        "ssh_src_ip",
        "vm",
        "access_re_sub_string",
        "access_re_sub_string",
        "access_cmd",
        "ref_cmd",
        "target_vm",
        "target_ip",
        "target_vm",
        "target_ip",
        "out_err",
        "stat",
        "stat",
        "out_err",
        "stat",
        "check_string",
        "stat",
        "stat",
        "stat",
        "session",
        "run_func",
        "stat",
        "err_type",
        "stat",
        "stat",
        "stat",
        "stat",
        "err_type",
        "acl_cmd",
        "acl_setup_cmd",
        "acl_option",
        "rule",
        "item_in_rule",
        "src_name",
        "src_name",
        "port",
        "username",
        "password",
        "prompt",
        "linesep",
        "quit_cmd",
        "prompt",
        "linesep",
        "username",
        "password",
        "quit_cmd",
        "cmd",
        "cmd",
        "session",
        "cmd",
        "cmd",
        "session",
        "setup_timeout",
        "setup_func",
        "os_type",
        "setup_vm",
        "setup_session",
        "setup_func",
        "os_type",
        "setup_params",
        "setup_cmd",
        "prepare_cmd",
        "setup_cmd",
        "setup_timeout",
        "setup_func",
        "os_type",
        "setup_vm",
        "setup_session",
        "setup_func",
        "os_type",
        "setup_params",
        "stop_cmd",
        "cleanup_cmd",
        "stop_cmd",
        "timeout",
        "op_timeout",
        "acl_protocol",
        "acl_extra_options",
        "session",
        "root_dir",
        "script_dir",
        "tmp_dir",
        "script_path",
        "vms_tags",
        "br_name",
        "br_name",
        "access_targets",
        "deny_target",
        "all_target",
        "target_port",
        "vm",
        "nic",
        "if_name",
        "params_nic",
        "params_nic",
        "host_ip",
        "deny_vm",
        "deny_vm_ip",
        "deny_vm_ip",
        "acl_extra_options",
        "acl_extra_options",
        "access_sys",
        "os_type",
        "os_type",
        "os_params",
        "access_param",
        "check_from_output",
        "access_sys",
        "target",
        "tgt_param",
        "acl_disabled",
        "br_infos",
        "if_port",
        "if_port",
        "acl_cmd",
        "acl_rules",
        "acl_cmd",
        "acl_rules",
        "acl_cmd",
        "acl_rules"
    ],
    "comments": [
        "Try to login from guest to host.",
        "We only support ssh for Linux in this test",
        "session.cmd_status_output(\"service iptables stop\")"
    ],
    "docstrings": [
        "\"\"\"\n    Test Step:\n        1. Boot up guest using the openvswitch bridge\n        2. Setup related service in test enviroment(http, ftp etc.)(optional)\n        3. Access the service in guest\n        4. Setup access control rules in ovs to disable the access\n        5. Access the service in guest\n        6. Setup access control rules in ovs to enable the access\n        7. Access the service in guest\n        8. Delete the access control rules in ovs\n        9. Access the service in guest\n\n    Params:\n        :param test: QEMU test object\n        :param params: Dictionary with the test parameters\n        :param env: Dictionary with test environment.\n    \"\"\""
    ],
    "functions": [
        "run",
        "access_service",
        "get_acl_cmd",
        "acl_rules_check",
        "remote_login",
        "setup_service",
        "stop_service"
    ],
    "classes": []
}