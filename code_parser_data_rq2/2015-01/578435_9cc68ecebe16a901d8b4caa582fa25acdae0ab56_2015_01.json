{
    "identifiers": [
        "com",
        "twitter",
        "elephantbird",
        "pig",
        "load",
        "java",
        "io",
        "DataOutputStream",
        "java",
        "io",
        "File",
        "java",
        "io",
        "FileOutputStream",
        "java",
        "io",
        "java",
        "util",
        "java",
        "util",
        "Arrays",
        "java",
        "util",
        "Iterator",
        "java",
        "util",
        "Random",
        "com",
        "google",
        "common",
        "primitives",
        "Bytes",
        "com",
        "twitter",
        "elephantbird",
        "mapreduce",
        "io",
        "BinaryBlockWriter",
        "com",
        "twitter",
        "elephantbird",
        "mapreduce",
        "io",
        "IdentityBinaryConverter",
        "org",
        "apache",
        "hadoop",
        "conf",
        "Configuration",
        "org",
        "apache",
        "hadoop",
        "fs",
        "FileUtil",
        "org",
        "apache",
        "pig",
        "PigServer",
        "org",
        "apache",
        "pig",
        "data",
        "DataByteArray",
        "org",
        "apache",
        "pig",
        "data",
        "Tuple",
        "org",
        "junit",
        "Assert",
        "org",
        "junit",
        "Assume",
        "org",
        "junit",
        "Before",
        "org",
        "junit",
        "Test",
        "com",
        "hadoop",
        "compression",
        "lzo",
        "LzopCodec",
        "com",
        "twitter",
        "elephantbird",
        "pig",
        "util",
        "PigTestUtil",
        "com",
        "twitter",
        "elephantbird",
        "util",
        "CoreTestUtil",
        "pigServer",
        "testDir",
        "getProperty",
        "inputDir",
        "testDir",
        "NUM_RECORDS",
        "expectedRecords",
        "NUM_RECORDS",
        "Before",
        "conf",
        "Assume",
        "assumeTrue",
        "CoreTestUtil",
        "okToRunLzoTests",
        "conf",
        "pigServer",
        "PigTestUtil",
        "makePigServer",
        "inputDir",
        "mkdirs",
        "blk_writer",
        "createLzoOut",
        "conf",
        "rand",
        "i",
        "i",
        "NUM_RECORDS",
        "i",
        "expectedRecords",
        "i",
        "rand",
        "nextInt",
        "b",
        "expectedRecords",
        "blk_writer",
        "write",
        "b",
        "blk_writer",
        "close",
        "Test",
        "Assume",
        "assumeTrue",
        "pigServer",
        "pigServer",
        "getPigContext",
        "getProperties",
        "setProperty",
        "pigServer",
        "registerQuery",
        "format",
        "inputDir",
        "toURI",
        "toString",
        "getName",
        "rows",
        "pigServer",
        "openIterator",
        "actual",
        "expectedRecords",
        "length",
        "rows",
        "hasNext",
        "actual",
        "add",
        "rows",
        "next",
        "get",
        "get",
        "actualRecords",
        "Bytes",
        "toArray",
        "actual",
        "Assert",
        "assertEquals",
        "expectedRecords",
        "length",
        "actual",
        "size",
        "Arrays",
        "sort",
        "expectedRecords",
        "Arrays",
        "sort",
        "actualRecords",
        "Assert",
        "assertArrayEquals",
        "expectedRecords",
        "actualRecords",
        "FileUtil",
        "fullyDelete",
        "inputDir",
        "name",
        "conf",
        "file",
        "inputDir",
        "name",
        "indexFile",
        "inputDir",
        "name",
        "codec",
        "conf",
        "setInt",
        "codec",
        "setConf",
        "conf",
        "file",
        "exists",
        "file",
        "codec",
        "createIndexedOutputStream",
        "file",
        "indexFile"
    ],
    "literals": [
        "\"test.build.data\"",
        "\"/TestBinvaryLoaderWithManySplits\"",
        "\"in\"",
        "\"1-block.lzo\"",
        "\"mapred.max.split.size\"",
        "\"1024\"",
        "\"A = load '%s' using %s as (bytes);\\n\"",
        "\"A\"",
        "\".index\"",
        "\"io.compression.codec.lzo.buffersize\""
    ],
    "variables": [
        "pigServer"
    ],
    "comments": [
        "write to block file.",
        "use just one record for each protobuf block so that we have lots of records at",
        "lzo level",
        "setUp might not have run because of missing lzo native libraries",
        "set low block size",
        "verify:",
        "read all the records and sort them since the splits are not processed in order",
        "set very small lzo blocks size so that we have lots of them."
    ],
    "docstrings": [
        "* Tests lzo loader with many splits (about 8K) to trigger corner cases.\n * Creates an indexed lzo file with 1M 1-byte records.\n *\n * The lzo buffer size is set to 512 bytes (default 256KB) so that we end up\n * with lots of lzo blocks.\n *\n * While loading in pig, set max split size to 1K. This verifies a bug fix\n * where the binary block reader was reading some records twice (pull #429)."
    ],
    "functions": [
        "setUp",
        "testLoaderWithMultiplePartitions",
        "DataOutputStream",
        "createLzoOut"
    ],
    "classes": [
        "TestBinaryLoaderWithManySplits"
    ]
}