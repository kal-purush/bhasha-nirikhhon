{
    "identifiers": [
        "typing",
        "Any",
        "Mapping",
        "collections",
        "OrderedDict",
        "gc",
        "os",
        "time",
        "numpy",
        "np",
        "pytest",
        "tqdm",
        "tqdm",
        "torch",
        "torch",
        "nn",
        "torch",
        "utils",
        "data",
        "dataloader",
        "DataLoader",
        "catalyst",
        "contrib",
        "dl",
        "utils",
        "catalyst",
        "typing",
        "Criterion",
        "Model",
        "Optimizer",
        "os",
        "environ",
        "get",
        "Enum",
        "dl",
        "Runner",
        "stage",
        "DataLoader",
        "contrib",
        "MNIST",
        "DATA_ROOT",
        "train",
        "download",
        "batch_size",
        "num_workers",
        "stage",
        "Model",
        "nn",
        "Sequential",
        "nn",
        "Flatten",
        "nn",
        "Linear",
        "in_features",
        "out_features",
        "nn",
        "BatchNorm1d",
        "nn",
        "Dropout",
        "nn",
        "ReLU",
        "nn",
        "Linear",
        "in_features",
        "out_features",
        "stage",
        "Criterion",
        "nn",
        "CrossEntropyLoss",
        "stage",
        "model",
        "Model",
        "Optimizer",
        "torch",
        "optim",
        "Adam",
        "model",
        "parameters",
        "lr",
        "batch",
        "Mapping",
        "Any",
        "NotImplementedError",
        "torch",
        "cuda",
        "is_available",
        "torch",
        "cuda",
        "synchronize",
        "torch",
        "cuda",
        "max_memory_allocated",
        "np",
        "nan",
        "used_memory",
        "irunner",
        "dl",
        "IRunner",
        "idx",
        "device",
        "num_epochs",
        "torch",
        "device",
        "device",
        "utils",
        "set_global_seed",
        "idx",
        "irunner",
        "get_loaders",
        "stage",
        "irunner",
        "get_model",
        "stage",
        "to",
        "device",
        "irunner",
        "get_criterion",
        "stage",
        "irunner",
        "get_optimizer",
        "stage",
        "model",
        "i",
        "num_epochs",
        "features",
        "targets",
        "loader",
        "features",
        "to",
        "device",
        "targets",
        "to",
        "device",
        "model",
        "features",
        "criterion",
        "logits",
        "targets",
        "epoch_loss",
        "loss",
        "item",
        "logits",
        "argmax",
        "dim",
        "keepdim",
        "epoch_score",
        "pred",
        "eq",
        "targets",
        "view_as",
        "pred",
        "sum",
        "item",
        "loss",
        "backward",
        "optimizer",
        "step",
        "optimizer",
        "zero_grad",
        "epoch_score",
        "len",
        "loader",
        "dataset",
        "epoch_loss",
        "len",
        "loader",
        "i",
        "epoch_score",
        "epoch_loss",
        "epoch_scores",
        "append",
        "epoch_score",
        "epoch_losses",
        "append",
        "epoch_loss",
        "epoch_scores",
        "epoch_losses",
        "_get_used_memory",
        "irunner",
        "dl",
        "IRunner",
        "idx",
        "device",
        "num_epochs",
        "utils",
        "set_global_seed",
        "idx",
        "irunner",
        "get_loaders",
        "stage",
        "irunner",
        "get_model",
        "stage",
        "to",
        "device",
        "irunner",
        "get_criterion",
        "stage",
        "irunner",
        "get_optimizer",
        "stage",
        "model",
        "dl",
        "SupervisedRunner",
        "runner",
        "train",
        "engine",
        "dl",
        "DeviceEngine",
        "device",
        "model",
        "model",
        "criterion",
        "criterion",
        "optimizer",
        "optimizer",
        "loaders",
        "loader",
        "num_epochs",
        "num_epochs",
        "verbose",
        "callbacks",
        "dl",
        "AccuracyCallback",
        "input_key",
        "runner",
        "_output_key",
        "target_key",
        "runner",
        "_target_key",
        "topk_args",
        "runner",
        "epoch_metrics",
        "runner",
        "epoch_metrics",
        "_get_used_memory",
        "irunner",
        "dl",
        "IRunner",
        "mode",
        "RunMode",
        "num_runs",
        "num_epochs",
        "torch",
        "cuda",
        "is_available",
        "torch",
        "backends",
        "cudnn",
        "i",
        "tqdm",
        "num_runs",
        "desc",
        "mode",
        "irunner",
        "__class__",
        "gc",
        "collect",
        "device",
        "torch",
        "cuda",
        "empty_cache",
        "torch",
        "cuda",
        "reset_max_memory_cached",
        "torch",
        "cuda",
        "reset_max_memory_allocated",
        "torch",
        "cuda",
        "reset_accumulated_memory_stats",
        "torch",
        "cuda",
        "reset_peak_memory_stats",
        "time",
        "sleep",
        "time",
        "perf_counter",
        "run_catalyst",
        "mode",
        "RunMode",
        "catalyst",
        "run_pytorch",
        "_run_fn",
        "irunner",
        "idx",
        "i",
        "device",
        "device",
        "num_epochs",
        "num_epochs",
        "time",
        "perf_counter",
        "hist_scores",
        "append",
        "final_score",
        "hist_losses",
        "append",
        "final_loss",
        "hist_time",
        "append",
        "time_end",
        "time_start",
        "hist_memory",
        "append",
        "used_memory",
        "hist_scores",
        "hist_losses",
        "hist_time",
        "hist_memory",
        "catalyst_values",
        "torch_values",
        "max_diff",
        "norm",
        "np",
        "asarray",
        "catalyst_values",
        "np",
        "mean",
        "torch_values",
        "diffs",
        "norm",
        "diffs",
        "np",
        "mean",
        "torch_values",
        "np",
        "mean",
        "diffs",
        "max_diff",
        "diffs",
        "max_diff",
        "catalyst_values",
        "torch_values",
        "max_diff",
        "norm",
        "np",
        "asarray",
        "catalyst_values",
        "np",
        "mean",
        "torch_values",
        "diffs",
        "norm",
        "np",
        "mean",
        "diffs",
        "max_diff",
        "diffs",
        "max_diff",
        "pytest",
        "mark",
        "parametrize",
        "TestMnistRunner",
        "pytest",
        "mark",
        "skipif",
        "IS_BENCHMARK_REQUIRED",
        "reason",
        "tmpdir",
        "irunner",
        "dl",
        "IRunner",
        "num_epochs",
        "num_runs",
        "precision",
        "max_diff_time",
        "max_diff_memory",
        "irunner",
        "irunner",
        "get_loaders",
        "score_runs",
        "irunner",
        "mode",
        "RunMode",
        "pytorch",
        "num_epochs",
        "num_epochs",
        "num_runs",
        "num_runs",
        "score_runs",
        "irunner",
        "mode",
        "RunMode",
        "catalyst",
        "num_epochs",
        "num_epochs",
        "num_runs",
        "num_runs",
        "pytorch",
        "catalyst",
        "catalyst_",
        "pytorch_",
        "catalyst",
        "pytorch",
        "np",
        "testing",
        "assert_almost_equal",
        "catalyst_",
        "pytorch_",
        "precision",
        "pytorch",
        "catalyst",
        "catalyst_",
        "pytorch_",
        "catalyst",
        "pytorch",
        "np",
        "testing",
        "assert_almost_equal",
        "catalyst_",
        "pytorch_",
        "precision",
        "pytorch",
        "catalyst",
        "assert_absolute_equal",
        "catalyst",
        "pytorch",
        "norm",
        "num_epochs",
        "max_diff",
        "max_diff_time",
        "torch",
        "cuda",
        "is_available",
        "pytorch",
        "catalyst",
        "assert_relative_equal",
        "catalyst",
        "pytorch",
        "max_diff",
        "max_diff_memory"
    ],
    "literals": [
        "\".\"",
        "\"BENCHMARK_REQUIRED\"",
        "\"0\"",
        "\"1\"",
        "\"catalyst\"",
        "\"pytorch\"",
        "\"OrderedDict[str, DataLoader]\"",
        "\"train\"",
        "\"cuda\"",
        "\"train\"",
        "\"train\"",
        "f\"Epoch {i} \\t Score: {epoch_score} \\t Loss: {epoch_loss}\"",
        "\"cuda\"",
        "\"train\"",
        "\"train\"",
        "\"train\"",
        "\"train\"",
        "\"accuracy01\"",
        "\"train\"",
        "\"loss\"",
        "\"cuda\"",
        "\"cpu\"",
        "f\"{mode} with {irunner.__class__.__name__}\"",
        "\"cuda\"",
        "\"scores\"",
        "\"losses\"",
        "\"time\"",
        "\"memory\"",
        "f\"Catalyst diff {diffs} worse than PyTorch (threshold {max_diff})\"",
        "f\"Catalyst {diffs} worse than PyTorch (threshold {max_diff})\"",
        "\"irunner,num_epochs,num_runs,precision,max_diff_time,max_diff_memory\"",
        "\"Benchmark is not required.\"",
        "f\"Scores are for... \\n PyTorch: {pytorch['scores']} \\n Catalyst: {catalyst['scores']}\"",
        "'scores'",
        "'scores'",
        "\"scores\"",
        "\"scores\"",
        "f\"Losses are for... \\n PyTorch: {pytorch['losses']} \\n Catalyst: {catalyst['losses']}\"",
        "'losses'",
        "'losses'",
        "\"losses\"",
        "\"losses\"",
        "f\"Times are for... \\n PyTorch: {pytorch['time']} \\n Catalyst: {catalyst['time']}\"",
        "'time'",
        "'time'",
        "\"time\"",
        "\"time\"",
        "f\"Memory usages are for... \\n PyTorch: {pytorch['memory']} \\n Catalyst: {catalyst['memory']}\"",
        "'memory'",
        "'memory'",
        "\"memory\"",
        "\"memory\""
    ],
    "variables": [
        "DATA_ROOT",
        "IS_BENCHMARK_REQUIRED",
        "catalyst",
        "pytorch",
        "used_memory",
        "used_memory",
        "device",
        "stage",
        "loader",
        "model",
        "criterion",
        "optimizer",
        "epoch_scores",
        "epoch_losses",
        "epoch_score",
        "epoch_loss",
        "features",
        "targets",
        "logits",
        "loss",
        "pred",
        "stage",
        "loader",
        "model",
        "criterion",
        "optimizer",
        "runner",
        "hist_scores",
        "hist_losses",
        "hist_time",
        "hist_memory",
        "device",
        "deterministic",
        "time_start",
        "_run_fn",
        "final_score",
        "final_loss",
        "used_memory",
        "time_end",
        "diffs",
        "diffs",
        "diffs",
        "diffs",
        "diffs",
        "irunner",
        "_",
        "pytorch",
        "catalyst"
    ],
    "comments": [
        "flake8: noqa",
        "prepare data",
        "score runs",
        "check performance",
        "check loss",
        "check time",
        "check memory"
    ],
    "docstrings": [
        "\"\"\"RunModes.\"\"\""
    ],
    "functions": [
        "get_loaders",
        "get_model",
        "get_criterion",
        "get_optimizer",
        "handle_batch",
        "_get_used_memory",
        "run_pytorch",
        "run_catalyst",
        "score_runs",
        "assert_relative_equal",
        "assert_absolute_equal",
        "test_benchmark"
    ],
    "classes": [
        "RunMode",
        "TestMnistRunner"
    ]
}