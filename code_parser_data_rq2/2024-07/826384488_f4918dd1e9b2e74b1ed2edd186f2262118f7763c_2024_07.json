{
    "identifiers": [
        "torch",
        "model",
        "time",
        "json",
        "inspect",
        "dataclasses",
        "asdict",
        "os",
        "ModelArgs",
        "vocab_size",
        "Moose",
        "model",
        "to",
        "device",
        "DataLoaderLite",
        "B",
        "max_batch_size",
        "T",
        "max_seq_len",
        "split",
        "DataLoaderLite",
        "B",
        "max_batch_size",
        "T",
        "max_seq_len",
        "split",
        "max_lr",
        "it",
        "it",
        "warmup_steps",
        "max_lr",
        "it",
        "warmup_steps",
        "it",
        "max_steps",
        "min_lr",
        "it",
        "warmup_steps",
        "max_steps",
        "warmup_steps",
        "decay_ratio",
        "math",
        "cos",
        "math",
        "pi",
        "decay_ratio",
        "min_lr",
        "coeff",
        "max_lr",
        "min_lr",
        "os",
        "makedirs",
        "log_dir",
        "exist_ok",
        "os",
        "path",
        "join",
        "log_dir",
        "open",
        "log_file",
        "f",
        "inspect",
        "signature",
        "torch",
        "optim",
        "AdamW",
        "parameters",
        "fused_available",
        "device",
        "torch",
        "optim",
        "AdamW",
        "model",
        "parameters",
        "lr",
        "weight_decay",
        "weight_decay",
        "fused",
        "use_fused",
        "total_batch_size",
        "max_batch_size",
        "max_seq_len",
        "total_batch_size",
        "max_batch_size",
        "max_seq_len",
        "total_batch_size",
        "grad_accum_steps",
        "iter",
        "max_steps",
        "time",
        "time",
        "optimizer",
        "zero_grad",
        "micro_step",
        "grad_accum_steps",
        "train_loader",
        "next_batch",
        "xb",
        "to",
        "device",
        "yb",
        "to",
        "device",
        "model",
        "xb",
        "targets",
        "yb",
        "loss",
        "grad_accum_steps",
        "loss_accum",
        "loss",
        "detach",
        "loss",
        "backward",
        "torch",
        "nn",
        "utils",
        "clip_grad_norm_",
        "model",
        "parameters",
        "get_lr",
        "iter",
        "param_group",
        "optimizer",
        "param_groups",
        "lr",
        "optimizer",
        "step",
        "torch",
        "cuda",
        "synchronize",
        "time",
        "time",
        "t1",
        "t0",
        "train_loader",
        "B",
        "train_loader",
        "T",
        "grad_accum_steps",
        "tokens_processed",
        "dt",
        "iter",
        "loss_accum",
        "item",
        "lr",
        "norm",
        "dt",
        "tokens_per_sec",
        "iter",
        "max_steps",
        "model",
        "eval",
        "val_loader",
        "reset",
        "torch",
        "no_grad",
        "_",
        "val_loss_steps",
        "val_loader",
        "next_batch",
        "x",
        "to",
        "device",
        "y",
        "to",
        "device",
        "model",
        "x",
        "y",
        "loss",
        "val_loss_steps",
        "val_loss_accum",
        "loss",
        "detach",
        "iter",
        "iter",
        "iter",
        "max_steps",
        "os",
        "path",
        "join",
        "log_dir",
        "iter",
        "model",
        "state_dict",
        "optimizer",
        "state_dict",
        "iter",
        "val_loss_accum",
        "item",
        "torch",
        "save",
        "checkpoint",
        "checkpoint_path",
        "version",
        "torch",
        "save",
        "model",
        "state_dict",
        "name",
        "asdict",
        "open",
        "name",
        "f",
        "json",
        "dump",
        "params_dict",
        "f"
    ],
    "literals": [
        "\"1_train_0\"",
        "\"train\"",
        "\"val\"",
        "\"log\"",
        "f\"log.txt\"",
        "\"w\"",
        "'fused'",
        "'cuda'",
        "\"make sure total_batch_size is divisible by B * T\"",
        "f\"total desired batch size: {total_batch_size}\"",
        "f\"=> calculated gradient accumulation steps: {grad_accum_steps}\"",
        "'lr'",
        "f\"step {iter:4d} | loss: {loss_accum.item():.6f} | lr {lr:.4e} | norm: {norm:.4f} | dt: {dt*1000:.2f}ms | tok/sec: {tokens_per_sec:.2f}\"",
        "f\"model_{iter:05d}.pt\"",
        "'model'",
        "'optimizer'",
        "'step'",
        "'val_loss'",
        "f'models/moose_{version}'",
        "f'{name}.pth'",
        "f'{name}.json'",
        "'w'"
    ],
    "variables": [
        "version",
        "model",
        "train_loader",
        "val_loader",
        "max_lr",
        "min_lr",
        "warmup_steps",
        "max_steps",
        "decay_ratio",
        "coeff",
        "log_dir",
        "log_file",
        "weight_decay",
        "fused_available",
        "use_fused",
        "optimizer",
        "total_batch_size",
        "grad_accum_steps",
        "t0",
        "loss_accum",
        "xb",
        "yb",
        "xb",
        "yb",
        "logits",
        "loss",
        "loss",
        "norm",
        "lr",
        "param_group",
        "t1",
        "dt",
        "tokens_processed",
        "tokens_per_sec",
        "val_loss_accum",
        "val_loss_steps",
        "x",
        "y",
        "x",
        "y",
        "logits",
        "loss",
        "loss",
        "checkpoint_path",
        "checkpoint",
        "name",
        "params_dict"
    ],
    "comments": [
        "coeff starts at 1 and goes to 0",
        "open for writing to clear the file",
        "by default this is train",
        "wait for the GPU to finish work",
        "time difference in seconds"
    ],
    "docstrings": [],
    "functions": [
        "get_lr"
    ],
    "classes": []
}