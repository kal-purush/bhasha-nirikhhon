{
    "identifiers": [
        "pymysql",
        "pandas",
        "pd",
        "streamlit",
        "st",
        "pymysql",
        "connect",
        "host",
        "user",
        "password",
        "database",
        "conn",
        "cursor",
        "pd",
        "read_excel",
        "file_name",
        "header",
        "skiprows",
        "df",
        "loc",
        "df",
        "columns",
        "get_level_values",
        "contains",
        "df",
        "loc",
        "df",
        "columns",
        "get_level_values",
        "contains",
        "df",
        "loc",
        "df",
        "values",
        "cur",
        "execute",
        "row",
        "row",
        "cur",
        "fetchall",
        "df",
        "df",
        "iloc",
        "isin",
        "existing_months",
        "len",
        "filtered_df",
        "filtered_df",
        "index",
        "row",
        "filtered_df",
        "iterrows",
        "cur",
        "execute",
        "row",
        "cur",
        "fetchone",
        "monthly_result",
        "cur",
        "execute",
        "row",
        "cur",
        "execute",
        "cur",
        "fetchone",
        "monthly_result",
        "cur",
        "execute",
        "row",
        "row",
        "cur",
        "fetchone",
        "region_result",
        "cur",
        "execute",
        "row",
        "row",
        "cur",
        "execute",
        "cur",
        "fetchone",
        "region_result",
        "row",
        "car_data_start_idx",
        "values",
        "i",
        "count",
        "car_counts",
        "pd",
        "isna",
        "count",
        "count",
        "replace",
        "i",
        "len",
        "race_types",
        "i",
        "len",
        "race_types",
        "car_types",
        "car_type_idx",
        "race_types",
        "race_type_idx",
        "cur",
        "execute",
        "car_type",
        "cur",
        "fetchone",
        "type_result",
        "car_type",
        "type_result",
        "cur",
        "execute",
        "race_type",
        "cur",
        "fetchone",
        "race_result",
        "race_type",
        "race_result",
        "type_id",
        "race_id",
        "cur",
        "execute",
        "region_id",
        "monthly_id",
        "type_id",
        "race_id",
        "count",
        "car_type",
        "race_type",
        "conn",
        "commit",
        "cur",
        "close",
        "conn",
        "close"
    ],
    "literals": [
        "'localhost'",
        "'squirrel'",
        "'squirrel'",
        "'cardb'",
        "'C:/Users/ljh10/Downloads/자동차등록현황보고_자동차등록대수현황 시도별 (201101 ~ 202412).xlsx'",
        "'계'",
        "'총계'",
        "'시군구'",
        "'계'",
        "'SELECT month_year FROM car_monthly'",
        "f\"필터링된 데이터 개수: {len(filtered_df)}\"",
        "'select monthly_id from car_monthly where month_year = %s'",
        "'insert into car_monthly (month_year) values (%s)'",
        "'car_monthly insert 실행'",
        "'select last_insert_id()'",
        "'select region_id from car_region where sido_name = %s and sigungu_name = %s'",
        "'insert into car_region (sido_name, sigungu_name) values (%s, %s)'",
        "'select last_insert_id()'",
        "'승용'",
        "'승합'",
        "'화물'",
        "'특수'",
        "'관용'",
        "'자가용'",
        "'영업용'",
        "\",\"",
        "\"\"",
        "'select type_id from car_type where type_name = %s'",
        "f\"Warning: '{car_type}' not found in car_type table\"",
        "'select race_id from race_type where race_name = %s'",
        "f\"Warning: '{race_type}' not found in car_race table\"",
        "f\"Skipping insertion for {car_type} {race_type} due to missing ID\""
    ],
    "variables": [
        "conn",
        "cur",
        "file_name",
        "df",
        "df",
        "df",
        "df",
        "existing_months",
        "filtered_df",
        "monthly_result",
        "monthly_id",
        "monthly_id",
        "region_result",
        "region_id",
        "region_id",
        "car_data_start_idx",
        "car_counts",
        "car_types",
        "race_types",
        "count",
        "car_type_idx",
        "race_type_idx",
        "car_type",
        "race_type",
        "type_result",
        "type_id",
        "type_id",
        "race_result",
        "race_id",
        "race_id"
    ],
    "comments": [
        "DB 연결",
        "DB에서 이미 존재하는 월 데이터 가져오기",
        "이미 존재하는 월 데이터를 집합으로 저장",
        "중복 제거된 데이터만 처리",
        "첫 번째 열(년월)이 DB에 없는 경우만 필터링",
        "필터링 결과 출력 (디버깅용)",
        "엑셀 데이터 처리",
        "월별 테이블에 해당 월 데이터가 있는지 확인",
        "conn.commit()",
        "아래서 카 데이터에 들어갈 예정",
        "car_region 중복 확인",
        "차량 수 데이터 처리",
        "차량 수가 시작되는 열의 인덱스",
        "차량 수 데이터",
        "차량 유형 및 사용 유형 정의",
        "차량 유형 리스트",
        "사용 유형 리스트",
        "천 단위 구분자 ',' 제거 및 NaN 처리",
        "문자열에서 ',' 제거 후 정수로 변환",
        "차량 유형 및 사용 유형 매핑",
        "차량 유형 인덱스 계산",
        "사용 유형 인덱스 계산",
        "차량 유형 ID 가져오기",
        "기본값 설정",
        "사용 유형 ID 가져오기",
        "기본값 설정",
        "type_id 또는 race_id가 None인 경우 삽입하지 않도록 처리",
        "데이터 삽입",
        "---------------------------------------------- DB에 excel파일의 데이터 삽입",
        "----------------------------------------------- DB에서 데이터 조회"
    ],
    "docstrings": [
        "'''\n                    insert into car_data (region_id, monthly_id, type_id, race_id, vehicle_count)\n                    values (%s, %s, %s, %s, %s)\n                    '''"
    ],
    "functions": [
        "insert_data"
    ],
    "classes": []
}