{
    "identifiers": [
        "pymysql",
        "boto3",
        "io",
        "sys",
        "csv",
        "datetime",
        "date",
        "awsglue",
        "utils",
        "getResolvedOptions",
        "getResolvedOptions",
        "sys",
        "argv",
        "args",
        "args",
        "table_name",
        "table_name",
        "sys",
        "argv",
        "getResolvedOptions",
        "sys",
        "argv",
        "optional_args",
        "date",
        "today",
        "load_type",
        "table_name",
        "date_filter",
        "table_name",
        "pymysql",
        "connect",
        "host",
        "db_endpoint",
        "user",
        "db_username",
        "password",
        "db_password",
        "database",
        "db_name",
        "cursorclass",
        "pymysql",
        "cursors",
        "DictCursor",
        "connection",
        "cursor",
        "cursor",
        "load_type",
        "table_name",
        "incr_column",
        "date_filter",
        "table_name",
        "cursor",
        "execute",
        "sql",
        "cursor",
        "fetchall",
        "convert_to_csv",
        "result",
        "boto3",
        "client",
        "s3",
        "put_object",
        "Body",
        "csv_data",
        "Bucket",
        "s3_bucket",
        "Key",
        "s3_key",
        "e",
        "e",
        "sys",
        "exit",
        "locals",
        "connection",
        "connection",
        "close",
        "data",
        "data",
        "io",
        "StringIO",
        "data",
        "keys",
        "csv",
        "DictWriter",
        "csv_file",
        "fieldnames",
        "fieldnames",
        "writer",
        "writeheader",
        "row",
        "data",
        "writer",
        "writerow",
        "row",
        "csv_file",
        "getvalue",
        "main"
    ],
    "literals": [
        "\"table_name\"",
        "\"load_type\"",
        "\"table_name\"",
        "\"load_type\"",
        "\"\"",
        "'apartment_viewings'",
        "\"viewed_at\"",
        "'apartments'",
        "\"listing_created_on\"",
        "\"apartment-rentals.c1yklxlrd3gk.us-east-1.rds.amazonaws.com\"",
        "\"admin\"",
        "\"Batman123\"",
        "\"rental_apartments\"",
        "\"gd-aws-de-labs\"",
        "'--date_filter'",
        "\"date_filter\"",
        "'date_filter'",
        "\"incremental\"",
        "f'raw_landing_zone/apartment_db/{table_name}/{date_filter}/data.csv'",
        "f'raw_landing_zone/apartment_db/{table_name}/data.csv'",
        "'incremental'",
        "f\"SELECT * FROM {table_name} where date({incr_column})='{date_filter}'\"",
        "f\"SELECT * FROM {table_name}\"",
        "'s3'",
        "'Data extracted and written to S3 successfully'",
        "f'Error: {str(e)}'",
        "'connection'",
        "\"\"",
        "'__main__'"
    ],
    "variables": [
        "args",
        "table_name",
        "load_type",
        "incr_column",
        "incr_column",
        "incr_column",
        "db_endpoint",
        "db_username",
        "db_password",
        "db_name",
        "s3_bucket",
        "optional_args",
        "date_filter",
        "date_filter",
        "s3_key",
        "s3_key",
        "connection",
        "sql",
        "sql",
        "result",
        "csv_data",
        "s3",
        "csv_file",
        "fieldnames",
        "writer"
    ],
    "comments": [
        "Import sys to use sys.exit()",
        "Import csv to write files in CSV format",
        "table_name = \"apartment_viewings\"",
        "load_type = \"incremental\"",
        "Database configuration",
        "Connect to the RDS database",
        "Execute SQL query to fetch data",
        "Generate CSV from data",
        "Write data to S3",
        "Exit with status 1 to indicate failure",
        "Create a CSV string from dictionary data",
        "Assumes all dictionaries have the same keys"
    ],
    "docstrings": [
        "\"\"\" Convert the list of dictionaries to CSV format. \"\"\""
    ],
    "functions": [
        "main",
        "convert_to_csv"
    ],
    "classes": []
}