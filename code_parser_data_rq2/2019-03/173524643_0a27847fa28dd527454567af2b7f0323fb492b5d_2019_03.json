{
    "identifiers": [
        "numpy",
        "np",
        "pandas",
        "pd",
        "counter",
        "time",
        "data",
        "init_cash",
        "transaction",
        "cash_balance",
        "crypto_balance",
        "total_balance",
        "position_current",
        "memory",
        "counter",
        "data",
        "np",
        "zeros",
        "shape",
        "dtype",
        "np",
        "zeros",
        "shape",
        "dtype",
        "data",
        "data",
        "np",
        "zeros",
        "shape",
        "dtype",
        "max",
        "i",
        "i",
        "candlestick_length",
        "memory",
        "clength_mean",
        "np",
        "zeros",
        "shape",
        "dtype",
        "memory",
        "clength_sigma",
        "pd",
        "DataFrame",
        "columns",
        "np",
        "zeros",
        "shape",
        "np",
        "zeros",
        "shape",
        "dtype",
        "data",
        "data",
        "counter",
        "long_ma_period",
        "np",
        "mean",
        "data",
        "axis",
        "index",
        "memory",
        "change_statue",
        "index",
        "position_current",
        "index",
        "memory",
        "position_old",
        "index",
        "position_change",
        "i",
        "rowi",
        "memory",
        "holding_record",
        "iterrows",
        "rowi",
        "index",
        "rowi",
        "record",
        "position_change",
        "record",
        "position_change",
        "record",
        "max",
        "position_change",
        "record",
        "min",
        "position_change",
        "record",
        "min",
        "position_change",
        "record",
        "max",
        "position_change",
        "record",
        "memory",
        "holding_record",
        "loc",
        "new_record",
        "position_change",
        "memory",
        "holding_record",
        "loc",
        "len",
        "memory",
        "holding_record",
        "counter",
        "index",
        "position_change",
        "average_price",
        "index",
        "memory",
        "change_statue",
        "memory",
        "holding_record",
        "drop",
        "memory",
        "holding_record",
        "memory",
        "holding_record",
        "index",
        "memory",
        "holding_record",
        "reset_index",
        "drop",
        "cash_balance",
        "i",
        "memory",
        "long_movingaverage",
        "i",
        "data",
        "item",
        "i",
        "memory",
        "holding_record",
        "loc",
        "memory",
        "holding_record",
        "cryptoindex",
        "i",
        "memory",
        "holding_record",
        "loc",
        "memory",
        "holding_record",
        "new_hopereturn",
        "i",
        "memory",
        "holding_record",
        "memory",
        "holding_record",
        "i",
        "len",
        "record",
        "record",
        "loc",
        "record",
        "loc",
        "transaction",
        "transaction",
        "j",
        "rowj",
        "record",
        "iterrows",
        "average_price",
        "i",
        "current_return",
        "j",
        "record",
        "loc",
        "j",
        "timecounter",
        "counter",
        "change_oldposition",
        "memory",
        "position_old",
        "position_current",
        "i",
        "position_current",
        "i",
        "record",
        "loc",
        "j",
        "change",
        "availablecash",
        "average_price",
        "i",
        "record",
        "loc",
        "j",
        "change",
        "transaction",
        "memory",
        "change_statue",
        "np",
        "mean",
        "memory",
        "closeprice",
        "axis",
        "np",
        "memory",
        "closeprice",
        "index",
        "memory",
        "movingaverage",
        "index",
        "data",
        "item",
        "index",
        "data",
        "item",
        "index",
        "data",
        "item",
        "index",
        "candlestick_length",
        "index",
        "memory",
        "clength_mean",
        "index",
        "memory",
        "clength_sigma",
        "index",
        "data",
        "item",
        "index",
        "memory",
        "long_movingaverage",
        "index",
        "availablecash",
        "average_price",
        "index",
        "adding_position",
        "index",
        "transaction",
        "memory",
        "change_statue",
        "index",
        "memory",
        "position_old",
        "position_current",
        "index",
        "position_current",
        "index",
        "adding_position",
        "index",
        "memory",
        "change_statue",
        "availablecash",
        "average_price",
        "index",
        "adding_position",
        "index",
        "transaction",
        "np",
        "vstack",
        "memory",
        "closeprice",
        "data",
        "memory",
        "clength_mean",
        "memory",
        "clength_sigma",
        "index",
        "value",
        "memory",
        "cl_mean_last",
        "candlestick_length",
        "index",
        "memory",
        "clength_mean",
        "memory",
        "negativecounter",
        "index",
        "value",
        "candlestick_length",
        "index",
        "memory",
        "negativecounter",
        "index",
        "memory",
        "clength_sigma",
        "value",
        "memory",
        "cl_mean_last",
        "index",
        "memory",
        "negativecounter",
        "index",
        "candlestick_length",
        "index",
        "memory",
        "negativecounter",
        "index",
        "memory",
        "clength_mean",
        "index",
        "memory",
        "negativecounter",
        "index",
        "memory",
        "long_movingaverage",
        "counter",
        "data",
        "counter",
        "position_current",
        "position_new",
        "memory"
    ],
    "literals": [
        "'float64'",
        "'float64'",
        "'int'",
        "'float64'",
        "'timecounter'",
        "'cryptoindex'",
        "'change'",
        "'unitprice'",
        "'hopereturn'",
        "'passtime'",
        "'int'",
        "'cryptoindex'",
        "'change'",
        "'change'",
        "'change'",
        "'passtime'",
        "'passtime'",
        "'hopereturn'",
        "'cryptoindex'",
        "'hopereturn'",
        "'unitprice'"
    ],
    "variables": [
        "ma_period",
        "long_ma_period",
        "memory",
        "closeprice",
        "memory",
        "movingaverage",
        "memory",
        "long_movingaverage",
        "candlestick_length",
        "memory",
        "negativecounter",
        "memory",
        "clength_mean",
        "memory",
        "cl_mean_last",
        "memory",
        "clength_sigma",
        "memory",
        "cl_sigma_last",
        "memory",
        "holding_record",
        "memory",
        "position_old",
        "memory",
        "change_statue",
        "candlestick_length",
        "average_price",
        "position_change",
        "position_change",
        "record",
        "new_record",
        "new_record",
        "position_change",
        "new_record",
        "position_change",
        "i",
        "index",
        "memory",
        "holding_record",
        "memory",
        "holding_record",
        "availablecash",
        "new_hopereturn",
        "record",
        "current_return",
        "change_oldposition",
        "i",
        "change_oldposition",
        "i",
        "memory",
        "movingaverage",
        "memory",
        "closeprice",
        "adding_position",
        "index",
        "index",
        "memory",
        "closeprice",
        "memory",
        "cl_mean_last",
        "memory",
        "cl_sigma_last",
        "index",
        "index",
        "memory",
        "long_movingaverage",
        "position_new"
    ],
    "comments": [
        "-*- coding: utf-8 -*-",
        "Created on Fri Oct 27",
        "moving average time period",
        "a counter for number of minute bars that have already been tested",
        "current time in string format such as \"2018-07-30 00:30:00\"",
        "data for current minute bar (in format 2)",
        "your initial cash, a constant",
        "transaction ratio, a constant",
        "your cash balance at current minute",
        "your crpyto currency balance at current minute",
        "your total balance at current minute",
        "your position for 4 crypto currencies at this minute",
        "a class, containing the information you saved so far",
        "1. initialization",
        "type: numpy.darray",
        "calculate: Open Price - Close Price",
        "if we dicide to changing our position, change the change_statue at this mimute",
        "and every mimute checking the change_statue to record what we did last mimute",
        "2. Check last mimute our position was changed or not.",
        "availablecash is used to make sure our cash won't be lower than limit_cash.",
        "3. update our hopereturn (reduce 0.001 per day)",
        "if it's a up tendency now, we won't decrease our hope return ratio.",
        "decrease holp return only when it passed half day.",
        "4. check memory.holding_record if current price satisfies our hopereturn and change our position",
        "even if next minute the average_price decrease 0.01 time.",
        "5. decide whether to add our position or not",
        "calculate movering average for cuttent mimute",
        "delete the (counter - 4) mimute closeprice and add a new close price",
        "buy less BTC",
        "we will buy adding_position[index] currency[index]",
        "even if next mimute the average price of currency[index] will increase 0.02 time",
        "set the position changing flag",
        "refleshment variables",
        "End of strategy"
    ],
    "docstrings": [
        "'''Our strategy:\n        Our strategy divided into four parts: \n        1. Find suitable timestamp to add four cryptocurrencies.\n            For a type of crypto, think about all \"Down\" timestamp: a.k.a closeprice is smaller than openprice.\n            In these Down timestamp, let's assume the outcome of \"openprice minus closeprice\" obbeys the normal distrbution.\n            Hence, it's less likely happened that the gap between open and close price is larger than mean plus 3 times std. \n            (\"Three Sigma\")\n            If this situation really happens, the average price will have a significant down performance.\n            We can update mean and std every mimute and compare with curent gap, helping do adding positions strategy.\n\n            If: \n            1). current timestamp is a \"Down\" timestamp, also the gap between openprice and closeprice is larger than \"Three Sigma\",\n            2). what's more, the closeprice is smaller than short-term Simplfied Moving Average(5 mimutes),\n                which means a relative low price in a short time period, \n            3). and the closeprice is smaller than long-term Exponential Moving Average(60 mimutes), which means a down trend,\n            4). our cash is available to add this positons including transaction costs, \n                even if next minute the average_price increase 0.02 time.\n            we will add positions of the actuall crypto (The change is now 0.1 unit for BTC and 1 unit for other three cryptos.),\n            and change the \"changing position\" signal of this crypto to 1.\n        2. Check and record what we did in last minute.\n            At the start of every mimute, check four cryptos' \"changing position\" signial equals to 1 or 0.\n            If it equals 1, we maked a decision to change our positions in last minute. (increase or decrease)\n            Update our record sheet in memory.holding_record.\n                Sample DataFrame:\n                    timecounter        | cryptoindex | change           |  unitprice     | hopereturn  | passtime\n                    ---------------------------------------------------------------------------------------------\n                    (changing counter) | (0,1,2,3)   | (positive_value) | (buying price) | (1.002)     | (how many mimutes passed) \n    \n            If we added position, we will add a row into the DataFrame, \n            else we will refresh our oldest record(decrease the value of 'change').\n            Each time we will drop records whose 'change' equals to zero.\n            After update the dataframe, change the \"changing position\" signal to 0.\n\n        3. Update our hopereturn ratio in memory.holding_record.\n            Since it's a short term investment, we will change our hopereturn as time going by.\n            For every row in the record DataFrame, if in current mimute the long-EMA is larger than close price of the actual crypto,\n            'passtime' add 1.\n            Then update 'hopereturn' column as 1.002 - 'passtime' * 0.001 / 1440 (decrease 0.001 for 12 hours.)\n\n        4. Check it's suitable time to release our position.\n            If current price satisifies our hope return, even the price decrease 0.01 time, release the position.\n            For detail calculations, please check the comment in that block, an example is provided.\n            Change the 'changing position signal' of the actual crypto to 1.\n            Add our availablecash at the same time.\n\n        The order of these four parts in every minute is: 2-3-4-1, namely:\n            -- check last minute change \n            -- update holding record dataframe \n            -- update hope return ratio \n            -- check whether add position or not.\n        Attention: decreasing positions is superior to increasing postions.\n    '''",
        "'''\n                Example: \n                Couter == 500, add position 0.5 unit at average price $6500, hopereturn is 1.0020.\n                With the extra transaction cost ratio 0.0005, the actual buying price is 6500 * 1.0005 = 6503.25.\n                When counter == 600, the new hopereturn is 1.0020 - 0.001*(600-500)/1440 = 1.0019\n                With the extra transaction cost ration, the hope return price should be 6503.25*1.0019/(1-0.0005)=6507.7394\n                '''"
    ],
    "functions": [
        "handle_bar"
    ],
    "classes": []
}