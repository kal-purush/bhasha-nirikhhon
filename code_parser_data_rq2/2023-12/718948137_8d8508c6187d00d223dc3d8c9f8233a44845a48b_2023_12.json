{
    "identifiers": [
        "torch",
        "torch",
        "nn",
        "nn",
        "model",
        "BaseModel",
        "utils",
        "l2norm",
        "nn",
        "Module",
        "L2Module",
        "x",
        "l2norm",
        "x",
        "x",
        "nn",
        "Module",
        "opt",
        "AttentionMechanism",
        "opt",
        "embed_dim",
        "embed_dim",
        "nn",
        "Sequential",
        "nn",
        "Linear",
        "input_dim",
        "embed_dim",
        "nn",
        "ReLU",
        "nn",
        "Linear",
        "embed_dim",
        "embed_dim",
        "nn",
        "Softmax",
        "dim",
        "x",
        "attention",
        "x",
        "BaseModel",
        "word2idx",
        "opt",
        "ARTEMIS",
        "word2idx",
        "opt",
        "nn",
        "Sequential",
        "nn",
        "Linear",
        "embed_dim",
        "embed_dim",
        "L2Module",
        "AttentionMechanism",
        "opt",
        "AttentionMechanism",
        "opt",
        "opt",
        "model_version",
        "model_version",
        "compute_score_artemis",
        "compute_score_broadcast_artemis",
        "model_version",
        "compute_score_EM",
        "compute_score_broadcast_EM",
        "model_version",
        "compute_score_IS",
        "compute_score_broadcast_IS",
        "model_version",
        "compute_score_arithmetic",
        "compute_score_broadcast_arithmetic",
        "model_version",
        "compute_score_crossmodal",
        "compute_score_broadcast_crossmodal",
        "model_version",
        "compute_score_visualsearch",
        "compute_score_broadcast_visualsearch",
        "model_version",
        "compute_score_cpt",
        "compute_score_broadcast_cpt",
        "opt",
        "gradcam",
        "ConceptNet",
        "nn",
        "Linear",
        "r_fg",
        "r_bg",
        "m",
        "t_fg",
        "t_bg",
        "store_intermediary",
        "compute_score_broadcast_FG",
        "r_fg",
        "m",
        "t_fg",
        "compute_score_broadcast_BG",
        "r_bg",
        "m",
        "t_bg",
        "fg_score",
        "bg_score",
        "r",
        "m",
        "t",
        "concept_net",
        "r",
        "t",
        "noun_encoder",
        "txt_enc",
        "embed",
        "all_nouns",
        "src_trg_fg",
        "cls_weights",
        "t",
        "compute_score_broadcast_FG",
        "src_fg",
        "m",
        "trg_fg",
        "compute_score_broadcast_BG",
        "src_bg",
        "m",
        "trg_bg",
        "fg_score",
        "bg_score",
        "cls_logits",
        "r",
        "m",
        "t",
        "compute_score_broadcast_EM",
        "r",
        "m",
        "t",
        "r",
        "m",
        "t",
        "compute_score_broadcast_IS",
        "r",
        "m",
        "t",
        "a",
        "x",
        "l2norm",
        "a",
        "x",
        "r",
        "m",
        "t",
        "store_intermediary",
        "compute_score_EM",
        "r",
        "m",
        "t",
        "store_intermediary",
        "compute_score_IS",
        "r",
        "m",
        "t",
        "store_intermediary",
        "store_intermediary",
        "hold_results",
        "EM",
        "hold_results",
        "IS",
        "EM",
        "IS",
        "r",
        "m",
        "t",
        "compute_score_broadcast_EM",
        "r",
        "m",
        "t",
        "compute_score_broadcast_IS",
        "r",
        "m",
        "t",
        "r",
        "m",
        "t",
        "store_intermediary",
        "Transform_m",
        "m",
        "apply_attention",
        "Attention_EM",
        "m",
        "t",
        "store_intermediary",
        "hold_results",
        "Tr_m",
        "hold_results",
        "A_EM_t",
        "Tr_m",
        "A_EM_t",
        "sum",
        "r",
        "m",
        "t",
        "r",
        "size",
        "Attention_EM",
        "m",
        "Transform_m",
        "m",
        "apply_attention",
        "A_EM",
        "view",
        "batch_size",
        "embed_dim",
        "t",
        "view",
        "batch_size",
        "embed_dim",
        "Tr_m",
        "view",
        "batch_size",
        "embed_dim",
        "A_EM_all_t",
        "sum",
        "EM_score",
        "r",
        "m",
        "t",
        "store_intermediary",
        "apply_attention",
        "Attention_IS",
        "m",
        "r",
        "apply_attention",
        "Attention_IS",
        "m",
        "t",
        "store_intermediary",
        "hold_results",
        "A_IS_r",
        "hold_results",
        "A_IS_t",
        "A_IS_r",
        "A_IS_t",
        "sum",
        "r",
        "m",
        "t",
        "r",
        "size",
        "Attention_IS",
        "m",
        "apply_attention",
        "A_IS",
        "r",
        "apply_attention",
        "A_IS",
        "view",
        "batch_size",
        "embed_dim",
        "t",
        "view",
        "batch_size",
        "embed_dim",
        "A_IS_r",
        "view",
        "batch_size",
        "embed_dim",
        "A_IS_all_t",
        "sum",
        "IS_score",
        "r",
        "m",
        "t",
        "store_intermediary",
        "l2norm",
        "r",
        "m",
        "t",
        "sum",
        "r",
        "m",
        "t",
        "l2norm",
        "r",
        "m",
        "mm",
        "t",
        "t",
        "r",
        "m",
        "t",
        "store_intermediary",
        "m",
        "t",
        "sum",
        "r",
        "m",
        "t",
        "m",
        "mm",
        "t",
        "t",
        "r",
        "m",
        "t",
        "store_intermediary",
        "r",
        "t",
        "sum",
        "r",
        "m",
        "t",
        "r",
        "mm",
        "t",
        "t",
        "images_src",
        "images_trg",
        "sentences",
        "lengths",
        "hold_results",
        "clear",
        "get_image_embedding",
        "images_src",
        "gradcam",
        "hold_results",
        "img_enc",
        "get_activation",
        "get_image_embedding",
        "images_trg",
        "gradcam",
        "hold_results",
        "img_enc",
        "get_activation",
        "get_txt_embedding",
        "sentences",
        "lengths",
        "compute_score",
        "r",
        "m",
        "t",
        "store_intermediary"
    ],
    "literals": [
        "\"ARTEMIS\"",
        "\"EM-only\"",
        "\"IS-only\"",
        "\"late-fusion\"",
        "\"cross-modal\"",
        "\"visual-search\"",
        "\"cpt\"",
        "\"EM\"",
        "\"IS\"",
        "\"Tr_m\"",
        "\"A_EM_t\"",
        "\"A_IS_r\"",
        "\"A_IS_t\"",
        "\"r_activation\"",
        "\"t_activation\""
    ],
    "variables": [
        "x",
        "embed_dim",
        "input_dim",
        "attention",
        "Transform_m",
        "Attention_EM",
        "Attention_IS",
        "model_version",
        "compute_score",
        "compute_score_broadcast",
        "compute_score",
        "compute_score_broadcast",
        "compute_score",
        "compute_score_broadcast",
        "compute_score",
        "compute_score_broadcast",
        "compute_score",
        "compute_score_broadcast",
        "compute_score",
        "compute_score_broadcast",
        "compute_score",
        "compute_score_broadcast",
        "gradcam",
        "hold_results",
        "concept_net",
        "noun_encoder",
        "fg_score",
        "bg_score",
        "src_trg_fg",
        "src_fg",
        "src_bg",
        "trg_fg",
        "trg_bg",
        "cls_weights",
        "cls_logits",
        "fg_score",
        "bg_score",
        "EM",
        "IS",
        "Tr_m",
        "A_EM_t",
        "batch_size",
        "A_EM",
        "Tr_m",
        "A_EM_all_t",
        "EM_score",
        "A_IS_r",
        "A_IS_t",
        "batch_size",
        "A_IS",
        "A_IS_r",
        "A_IS_all_t",
        "IS_score",
        "r",
        "t",
        "m"
    ],
    "comments": [
        "",
        "Artemis                                 ##",
        "Copyright (c) 2022-present NAVER Corp.  ##",
        "CC BY-NC-SA 4.0                         ##",
        "",
        "--- modules",
        "--- scoring strategy",
        "--- for heatmap processing",
        "holding intermediate results",
        "",
        "",
        "",
        "All scoring methods exist in 2 versions:",
        "- a \"regular\" version, which returns a tensor of shape (batch_size), where",
        "coefficient (i) is the score between query (i) and target (i).",
        "- a broadcast version, which returns a tensor of shape (batch_size,",
        "batch_size), corresponding to the score matrix where coefficient (i,j)",
        "is the score between query (i) and target (j).",
        "Shape notations in comments:",
        "Bq: \"query\" batch size (number of queries) [in practice, Bq = B]",
        "Bt: \"target\" batch size (number of targets) [in practice, Bt = B]",
        "d: embedding dimension",
        "",
        "shape (Bq, d)",
        "shape (Bq, d)",
        "apply each query attention mechanism to all targets",
        "shape (Bq, Bt, d)",
        "shape (Bq, Bt) ; coefficient (i,j) is the IS score between query i and target j",
        "shape (Bq, d)",
        "shape (Bq, d)",
        "apply each query attention mechanism to all targets",
        "shape (Bq, Bt, d)",
        "shape (Bq, Bt) ; coefficient (i,j) is the IS score between query i and target j",
        "",
        "",
        "clean previously stored results, if any",
        "compute embeddings & store activation map if in gradcam mode for heatmap visualizations"
    ],
    "docstrings": [
        "\"\"\"\n    Module defining the architecture of the attention mechanisms in ARTEMIS.\n    \"\"\"",
        "\"\"\"\n    ARTEMIS: Attention-based Retrieval with Text-Explicit Matching and Implicit Similarity,\n    ICLR 2022\n    \"\"\"",
        "*** SCORING METHODS",
        "*** FOR HEATMAP PROCESSING"
    ],
    "functions": [
        "forward",
        "forward",
        "compute_score_cpt",
        "compute_score_broadcast_cpt",
        "compute_score_broadcast_FG",
        "compute_score_broadcast_BG",
        "apply_attention",
        "compute_score_artemis",
        "compute_score_broadcast_artemis",
        "compute_score_EM",
        "compute_score_broadcast_EM",
        "compute_score_IS",
        "compute_score_broadcast_IS",
        "compute_score_arithmetic",
        "compute_score_broadcast_arithmetic",
        "compute_score_crossmodal",
        "compute_score_broadcast_crossmodal",
        "compute_score_visualsearch",
        "compute_score_broadcast_visualsearch",
        "forward_save_intermediary"
    ],
    "classes": [
        "L2Module",
        "AttentionMechanism",
        "ARTEMIS"
    ]
}