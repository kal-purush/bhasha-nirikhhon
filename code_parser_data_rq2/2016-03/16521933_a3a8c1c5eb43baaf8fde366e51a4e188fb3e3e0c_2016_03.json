{
    "identifiers": [
        "math",
        "numpy",
        "image",
        "nsamples",
        "contrast",
        "bpmask",
        "zmask",
        "zsc_sample",
        "image",
        "nsamples",
        "bpmask",
        "zmask",
        "len",
        "samples",
        "samples",
        "sort",
        "samples",
        "samples",
        "npix",
        "npix",
        "samples",
        "center_pixel",
        "samples",
        "center_pixel",
        "samples",
        "center_pixel",
        "max",
        "MIN_NPIXELS",
        "npix",
        "MAX_REJECT",
        "max",
        "npix",
        "zsc_fit_line",
        "samples",
        "npix",
        "KREJ",
        "ngrow",
        "MAX_ITERATIONS",
        "ngoodpix",
        "minpix",
        "zmin",
        "zmax",
        "contrast",
        "zslope",
        "contrast",
        "max",
        "zmin",
        "median",
        "center_pixel",
        "zslope",
        "min",
        "zmax",
        "median",
        "npix",
        "center_pixel",
        "zslope",
        "z1",
        "z2",
        "image",
        "maxpix",
        "bpmask",
        "zmask",
        "image",
        "shape",
        "image",
        "shape",
        "max",
        "math",
        "sqrt",
        "nc",
        "nl",
        "maxpix",
        "stride",
        "image",
        "stride",
        "stride",
        "flatten",
        "samples",
        "maxpix",
        "samples",
        "npix",
        "krej",
        "ngrow",
        "maxiter",
        "npix",
        "numpy",
        "arange",
        "npix",
        "xnorm",
        "xscale",
        "npix",
        "max",
        "MIN_NPIXELS",
        "npix",
        "MAX_REJECT",
        "npix",
        "numpy",
        "zeros",
        "npix",
        "dtype",
        "niter",
        "maxiter",
        "ngoodpix",
        "last_ngoodpix",
        "ngoodpix",
        "minpix",
        "numpy",
        "where",
        "badpix",
        "GOOD_PIXEL",
        "xnorm",
        "goodpixels",
        "sum",
        "xnorm",
        "goodpixels",
        "xnorm",
        "goodpixels",
        "sum",
        "xnorm",
        "goodpixels",
        "samples",
        "goodpixels",
        "sum",
        "samples",
        "goodpixels",
        "sum",
        "len",
        "goodpixels",
        "sum",
        "sumxx",
        "sumx",
        "sumx",
        "sumxx",
        "sumy",
        "sumx",
        "sumxy",
        "delta",
        "sum",
        "sumxy",
        "sumx",
        "sumy",
        "delta",
        "xnorm",
        "slope",
        "intercept",
        "samples",
        "fitted",
        "zsc_compute_sigma",
        "flat",
        "badpix",
        "npix",
        "sigma",
        "krej",
        "threshold",
        "threshold",
        "numpy",
        "where",
        "flat",
        "lcut",
        "numpy",
        "where",
        "flat",
        "hcut",
        "BAD_PIXEL",
        "BAD_PIXEL",
        "numpy",
        "ones",
        "ngrow",
        "dtype",
        "numpy",
        "convolve",
        "badpix",
        "kernel",
        "mode",
        "len",
        "numpy",
        "where",
        "badpix",
        "GOOD_PIXEL",
        "niter",
        "intercept",
        "slope",
        "slope",
        "xscale",
        "ngoodpix",
        "zstart",
        "zslope",
        "flat",
        "badpix",
        "npix",
        "numpy",
        "where",
        "badpix",
        "GOOD_PIXEL",
        "flat",
        "goodpixels",
        "sum",
        "flat",
        "goodpixels",
        "flat",
        "goodpixels",
        "sum",
        "len",
        "goodpixels",
        "ngoodpix",
        "ngoodpix",
        "sumz",
        "sumz",
        "ngoodpix",
        "sumsq",
        "ngoodpix",
        "sumz",
        "sumz",
        "ngoodpix",
        "ngoodpix",
        "temp",
        "math",
        "sqrt",
        "temp",
        "ngoodpix",
        "mean",
        "sigma"
    ],
    "literals": [
        "\"int32\"",
        "\"int32\"",
        "'same'"
    ],
    "variables": [
        "MAX_REJECT",
        "MIN_NPIXELS",
        "GOOD_PIXEL",
        "BAD_PIXEL",
        "KREJ",
        "MAX_ITERATIONS",
        "samples",
        "npix",
        "zmin",
        "zmax",
        "center_pixel",
        "median",
        "median",
        "minpix",
        "ngrow",
        "ngoodpix",
        "zstart",
        "zslope",
        "z1",
        "z2",
        "zslope",
        "z1",
        "z2",
        "nc",
        "nl",
        "stride",
        "stride",
        "samples",
        "xscale",
        "xnorm",
        "xnorm",
        "ngoodpix",
        "minpix",
        "last_ngoodpix",
        "badpix",
        "goodpixels",
        "sumx",
        "sumxx",
        "sumxy",
        "sumy",
        "sum",
        "delta",
        "intercept",
        "slope",
        "fitted",
        "flat",
        "ngoodpix",
        "mean",
        "sigma",
        "threshold",
        "lcut",
        "hcut",
        "below",
        "above",
        "badpix",
        "below",
        "badpix",
        "above",
        "kernel",
        "badpix",
        "ngoodpix",
        "zstart",
        "zslope",
        "goodpixels",
        "sumz",
        "sumsq",
        "ngoodpix",
        "mean",
        "sigma",
        "mean",
        "sigma",
        "mean",
        "temp",
        "sigma",
        "sigma"
    ],
    "comments": [
        "Sample the image",
        "For a zero-indexed array",
        "",
        "Fit a line to the sorted array of samples",
        "Figure out which pixels to use for the zscale algorithm",
        "Returns the 1-d array samples",
        "Don't worry about the bad pixel mask or zmask for the moment",
        "Sample in a square grid, and return the first maxpix in the sample",
        "",
        "First re-map indices from -1.0 to 1.0",
        "This is the mask used in k-sigma clipping.  0 is good, 1 is bad",
        "",
        "Iterate",
        "Accumulate sums to calculate straight line fit",
        "Slope and intercept",
        "Subtract fitted line from the data array",
        "Compute the k-sigma rejection threshold",
        "Detect and reject pixels further than k*sigma from the fitted line",
        "Convolve with a kernel of length ngrow",
        "Transform the line coefficients back to the X range [0:npix-1]",
        "Compute the rms deviation from the mean of a flattened array.",
        "Ignore rejected pixels",
        "Accumulate sum and sum of squares"
    ],
    "docstrings": [
        "\"\"\"Implement IRAF zscale algorithm\n    nsamples=1000 and contrast=0.25 are the IRAF display task defaults\n    bpmask and zmask not implemented yet\n    image is a 2-d numpy array\n    returns (z1, z2)\n    \"\"\""
    ],
    "functions": [
        "zscale",
        "zsc_sample",
        "zsc_fit_line",
        "zsc_compute_sigma"
    ],
    "classes": []
}