{
    "identifiers": [
        "os",
        "sys",
        "re",
        "time",
        "math",
        "subprocess",
        "h5py",
        "pickle",
        "numpy",
        "np",
        "scipy",
        "sp",
        "tqdm",
        "tqdm",
        "tqdm",
        "shutil",
        "pathlib",
        "pathlib",
        "Path",
        "PurePosixPath",
        "numba",
        "numba",
        "jit",
        "njit",
        "datetime",
        "timeit",
        "matplotlib",
        "mpl",
        "mpl",
        "use",
        "matplotlib",
        "pyplot",
        "plt",
        "cmocean",
        "colorcet",
        "cmasher",
        "PIL",
        "tsec",
        "divmod",
        "tsec",
        "divmod",
        "m",
        "divmod",
        "h",
        "d",
        "h",
        "m",
        "s",
        "time_str",
        "label",
        "output",
        "kwargs",
        "kwargs",
        "get",
        "kwargs",
        "get",
        "terminal_width",
        "len",
        "label",
        "len",
        "output",
        "label",
        "ndots",
        "output",
        "s",
        "text",
        "text",
        "fig",
        "list_of_axes",
        "kwargs",
        "kwargs",
        "get",
        "kwargs",
        "get",
        "dpi_out",
        "fig",
        "dpi",
        "fig",
        "get_size_inches",
        "dpi_out",
        "fig",
        "transFigure",
        "inverted",
        "fig",
        "get_figwidth",
        "fig",
        "get_figheight",
        "len",
        "list_of_axes",
        "np",
        "zeros",
        "nax",
        "dtype",
        "np",
        "float64",
        "np",
        "zeros",
        "nax",
        "dtype",
        "np",
        "float64",
        "ai",
        "axis",
        "list_of_axes",
        "axis",
        "get_position",
        "bounds",
        "np",
        "array",
        "x0",
        "y0",
        "dx",
        "dy",
        "axis",
        "get_tightbbox",
        "fig",
        "canvas",
        "get_renderer",
        "call_axes_locator",
        "bounds",
        "np",
        "array",
        "x0",
        "y0",
        "dx",
        "dy",
        "axis_tb_px",
        "dpi_out",
        "fig",
        "dpi",
        "axis_tb_px",
        "fig_px_x",
        "ax_tb_px",
        "ax_tb_px",
        "max",
        "ax_tb_px",
        "min",
        "marg_L_px",
        "offset_px",
        "fig_px_x",
        "marg_L_px",
        "marg_R_px",
        "offset_px",
        "math",
        "ceil",
        "w_px",
        "px_base",
        "px_base",
        "fig_px_y",
        "w_px",
        "dpi_out",
        "h_px",
        "dpi_out",
        "ai",
        "axis",
        "list_of_axes",
        "axis",
        "get_position",
        "bounds",
        "x0",
        "x_shift_px",
        "fig_px_x",
        "y0",
        "dx",
        "dy",
        "np",
        "array",
        "x0n",
        "y0n",
        "dxn",
        "dyn",
        "fig",
        "set_size_inches",
        "w_inch",
        "h_inch",
        "forward",
        "fig",
        "get_size_inches",
        "dpi_out",
        "fig",
        "get_figwidth",
        "fig",
        "get_figheight",
        "ai",
        "axis",
        "list_of_axes",
        "ax_tb_pct",
        "ai",
        "axis",
        "set_position",
        "x0n",
        "w",
        "w_adj",
        "y0n",
        "dxn",
        "w",
        "w_adj",
        "dyn",
        "fn_cgd",
        "NotImplementedError",
        "np",
        "zeros",
        "dtype",
        "np",
        "float32",
        "data",
        "extra",
        "fn_h5",
        "kwargs",
        "NotImplementedError",
        "np",
        "zeros",
        "dtype",
        "np",
        "float32",
        "data",
        "extra",
        "fn_h5",
        "scalar",
        "kwargs",
        "kwargs",
        "get",
        "kwargs",
        "get",
        "kwargs",
        "get",
        "kwargs",
        "get",
        "kwargs",
        "get",
        "kwargs",
        "get",
        "kwargs",
        "get",
        "verbose",
        "verbose",
        "Path",
        "fn_h5",
        "Path",
        "os",
        "path",
        "relpath",
        "fn_h5",
        "Path",
        "fn_h5",
        "exists",
        "FileNotFoundError",
        "fn_h5",
        "verbose",
        "even_print",
        "fn_h5",
        "os",
        "path",
        "getsize",
        "fn_h5",
        "h5py",
        "File",
        "fn_h5",
        "f1",
        "f1",
        "f1",
        "f1",
        "f1",
        "np",
        "copy",
        "f1",
        "np",
        "copy",
        "f1",
        "np",
        "copy",
        "f1",
        "x",
        "shape",
        "y",
        "shape",
        "np",
        "zeros",
        "nx",
        "ny",
        "dtype",
        "np",
        "uint8",
        "i",
        "nx",
        "j",
        "ny",
        "obstacle",
        "i",
        "j",
        "np",
        "isclose",
        "Re",
        "U_inf",
        "lchar",
        "nu_inf",
        "rtol",
        "atol",
        "ValueError",
        "verbose",
        "even_print",
        "lchar",
        "verbose",
        "even_print",
        "U_inf",
        "verbose",
        "even_print",
        "Re",
        "verbose",
        "even_print",
        "nu_inf",
        "verbose",
        "even_print",
        "nx",
        "verbose",
        "even_print",
        "ny",
        "f1",
        "keys",
        "sorted",
        "dss",
        "dss",
        "dset_names",
        "re",
        "match",
        "dss",
        "np",
        "array",
        "sorted",
        "re",
        "findall",
        "tss_",
        "tss_",
        "tss",
        "dtype",
        "np",
        "int32",
        "np",
        "all",
        "np",
        "diff",
        "ti",
        "AssertionError",
        "ti",
        "shape",
        "verbose",
        "even_print",
        "nt",
        "verbose",
        "scalar",
        "verbose",
        "even_print",
        "scalar",
        "NotImplementedError",
        "ti_min",
        "ti",
        "min",
        "max",
        "ti_min",
        "ti",
        "min",
        "ti_max",
        "ti",
        "max",
        "min",
        "ti_max",
        "ti",
        "max",
        "verbose",
        "even_print",
        "ti_min",
        "verbose",
        "even_print",
        "ti_max",
        "ti_max",
        "ti_min",
        "xi_min",
        "max",
        "xi_min",
        "xi_max",
        "nx",
        "min",
        "xi_max",
        "nx",
        "verbose",
        "even_print",
        "xi_min",
        "verbose",
        "even_print",
        "xi_max",
        "np",
        "copy",
        "x",
        "xi_min",
        "xi_max",
        "x",
        "shape",
        "yi_min",
        "max",
        "yi_min",
        "yi_max",
        "ny",
        "min",
        "yi_max",
        "ny",
        "verbose",
        "even_print",
        "yi_min",
        "verbose",
        "even_print",
        "yi_max",
        "np",
        "copy",
        "y",
        "yi_min",
        "yi_max",
        "y",
        "shape",
        "np",
        "copy",
        "obstacle_img",
        "xi_min",
        "xi_max",
        "yi_min",
        "yi_max",
        "nx",
        "ValueError",
        "nx",
        "ny",
        "ValueError",
        "ny",
        "nt",
        "ValueError",
        "nt",
        "verbose",
        "verbose",
        "even_print",
        "nx",
        "verbose",
        "even_print",
        "ny",
        "verbose",
        "even_print",
        "nt",
        "verbose",
        "np",
        "zeros",
        "shape",
        "nx",
        "ny",
        "nt",
        "dtype",
        "np",
        "float32",
        "verbose",
        "tqdm",
        "total",
        "nt",
        "ncols",
        "desc",
        "leave",
        "file",
        "sys",
        "stdout",
        "tii",
        "ti_min",
        "ti_max",
        "tiii",
        "np",
        "copy",
        "f1",
        "ti",
        "tii",
        "xi_min",
        "xi_max",
        "yi_min",
        "yi_max",
        "np",
        "copy",
        "f1",
        "ti",
        "tii",
        "xi_min",
        "xi_max",
        "yi_min",
        "yi_max",
        "np",
        "sqrt",
        "u",
        "v",
        "verbose",
        "progress_bar",
        "update",
        "verbose",
        "progress_bar",
        "close",
        "data",
        "shape",
        "nx",
        "ny",
        "nt",
        "AssertionError",
        "data",
        "shape",
        "nx",
        "ny",
        "verbose",
        "even_print",
        "data",
        "nbytes",
        "verbose",
        "even_print",
        "ndof",
        "np",
        "reshape",
        "data",
        "ndof",
        "nt",
        "order",
        "shape_orig",
        "U_inf",
        "lchar",
        "Re",
        "nu_inf",
        "nx",
        "ny",
        "nt",
        "x",
        "y",
        "obstacle",
        "obstacle_img",
        "verbose",
        "even_print",
        "shape_orig",
        "verbose",
        "even_print",
        "data",
        "shape",
        "verbose",
        "data",
        "extra",
        "data",
        "exact",
        "optimal",
        "svd_rank",
        "sort_by_amp_coeff",
        "exact",
        "even_print",
        "exact",
        "optimal",
        "even_print",
        "optimal",
        "svd_rank",
        "sort_by_amp_coeff",
        "isinstance",
        "data",
        "np",
        "ndarray",
        "ValueError",
        "data",
        "ndim",
        "ValueError",
        "data",
        "ndof",
        "nt",
        "data",
        "shape",
        "even_print",
        "data",
        "nbytes",
        "even_print",
        "data",
        "shape",
        "even_print",
        "data",
        "dtype",
        "even_print",
        "ndof",
        "even_print",
        "nt",
        "np",
        "zeros",
        "shape",
        "ndof",
        "nt",
        "dtype",
        "data",
        "dtype",
        "np",
        "mean",
        "data",
        "axis",
        "dtype",
        "np",
        "float64",
        "astype",
        "data",
        "dtype",
        "data_prime",
        "data",
        "data_mean",
        "np",
        "newaxis",
        "np",
        "copy",
        "data_prime",
        "tol",
        "snapshot_data",
        "snapshot_data",
        "timeit",
        "default_timer",
        "np",
        "linalg",
        "svd",
        "X",
        "full_matrices",
        "V",
        "conj",
        "T",
        "even_print",
        "timeit",
        "default_timer",
        "start_time",
        "even_print",
        "Sigma",
        "max",
        "even_print",
        "Sigma",
        "min",
        "even_print",
        "np",
        "log10",
        "Sigma",
        "max",
        "Sigma",
        "min",
        "np",
        "copy",
        "Sigma",
        "even_print",
        "Sigma_full",
        "shape",
        "svd_rank",
        "U",
        "shape",
        "svd_rank",
        "isinstance",
        "svd_rank",
        "min",
        "svd_rank",
        "U",
        "shape",
        "ValueError",
        "even_print",
        "rank",
        "np",
        "copy",
        "U",
        "rank",
        "np",
        "copy",
        "Sigma",
        "rank",
        "np",
        "copy",
        "V",
        "rank",
        "np",
        "linalg",
        "multi_dot",
        "U",
        "T",
        "conj",
        "Y",
        "V",
        "np",
        "reciprocal",
        "Sigma",
        "timeit",
        "default_timer",
        "lambda_dmd",
        "vr_dmd",
        "sp",
        "linalg",
        "eig",
        "A_tilde",
        "right",
        "left",
        "overwrite_a",
        "even_print",
        "timeit",
        "default_timer",
        "start_time",
        "exact",
        "np",
        "copy",
        "np",
        "dot",
        "Y",
        "V",
        "np",
        "reciprocal",
        "Sigma",
        "np",
        "copy",
        "U",
        "np",
        "dot",
        "basis",
        "vr_dmd",
        "dof",
        "n_modes",
        "modes",
        "shape",
        "even_print",
        "n_modes",
        "even_print",
        "dof",
        "np",
        "vander",
        "lambda_dmd",
        "nt",
        "increasing",
        "timeit",
        "default_timer",
        "optimal",
        "np",
        "linalg",
        "solve",
        "__get_optimal_fit_matrices",
        "alpha_dmd",
        "sp",
        "linalg",
        "lstsq",
        "modes",
        "snapshot_data",
        "even_print",
        "timeit",
        "default_timer",
        "start_time",
        "snapshot_data",
        "nbytes",
        "modes",
        "nbytes",
        "alpha_dmd",
        "nbytes",
        "dmd_info_size",
        "original_info_size",
        "even_print",
        "original_info_size",
        "even_print",
        "dmd_info_size",
        "even_print",
        "reduction_info_fac",
        "sort_by_amp_coeff",
        "np",
        "abs",
        "alpha_dmd",
        "np",
        "flip",
        "np",
        "argsort",
        "alpha_dmd_abs",
        "np",
        "copy",
        "alpha_dmd",
        "sort_key",
        "np",
        "copy",
        "lambda_dmd",
        "sort_key",
        "np",
        "copy",
        "modes",
        "sort_key",
        "np",
        "copy",
        "vander",
        "sort_key",
        "np",
        "multiply",
        "np",
        "dot",
        "modes",
        "conj",
        "T",
        "modes",
        "np",
        "conj",
        "np",
        "dot",
        "vander",
        "vander",
        "conj",
        "T",
        "exact",
        "np",
        "conj",
        "np",
        "diag",
        "np",
        "linalg",
        "multi_dot",
        "vander",
        "snapshot_data",
        "conj",
        "T",
        "modes",
        "np",
        "conj",
        "np",
        "diag",
        "np",
        "linalg",
        "multi_dot",
        "vander",
        "V",
        "np",
        "diag",
        "Sigma",
        "conj",
        "vr_dmd",
        "P",
        "q",
        "__get_mean_removed",
        "__do_svd",
        "__get_dmd_modes",
        "__get_dmd_amp_coefficients",
        "r",
        "r",
        "n_modes",
        "even_print",
        "r",
        "timeit",
        "default_timer",
        "np",
        "real",
        "np",
        "dot",
        "modes",
        "r",
        "np",
        "dot",
        "np",
        "diag",
        "alpha_dmd",
        "r",
        "vander",
        "r",
        "even_print",
        "timeit",
        "default_timer",
        "start_time",
        "snapshot_data_reconst",
        "snapshot_data",
        "np",
        "mean",
        "np",
        "abs",
        "snapshot_data_delta",
        "even_print",
        "adiff",
        "Path",
        "fn_h5",
        "exists",
        "FileNotFoundError",
        "fn_h5",
        "dmd_data_loader_lbm",
        "fn_h5",
        "scalar",
        "ti_min",
        "ti_max",
        "dmd",
        "data",
        "data",
        "svd_rank",
        "exact",
        "optimal",
        "sort_by_amp_coeff",
        "d",
        "run",
        "open",
        "f",
        "pickle",
        "dump",
        "d",
        "extra",
        "f",
        "protocol",
        "open",
        "f",
        "pickle",
        "load",
        "f",
        "d",
        "reconstruct",
        "r",
        "mpl",
        "style",
        "use",
        "colors",
        "blue",
        "yellow",
        "red",
        "green",
        "purple",
        "orange",
        "cyan",
        "extra",
        "extra",
        "extra",
        "extra",
        "extra",
        "extra",
        "extra",
        "extra",
        "x",
        "lchar",
        "min",
        "x",
        "lchar",
        "max",
        "y",
        "lchar",
        "min",
        "y",
        "lchar",
        "max",
        "plt",
        "close",
        "plt",
        "figure",
        "figsize",
        "dpi",
        "plt",
        "gca",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "hasattr",
        "d",
        "d",
        "Sigma_full",
        "shape",
        "d",
        "Sigma",
        "shape",
        "diff",
        "np",
        "arange",
        "d",
        "Sigma",
        "shape",
        "d",
        "Sigma",
        "shape",
        "diff",
        "d",
        "Sigma_full",
        "diff",
        "ax1",
        "scatter",
        "aa",
        "bb",
        "c",
        "zorder",
        "s",
        "marker",
        "linewidth",
        "edgecolors",
        "alpha",
        "ax1",
        "scatter",
        "np",
        "arange",
        "d",
        "Sigma",
        "shape",
        "d",
        "Sigma",
        "c",
        "red",
        "zorder",
        "s",
        "marker",
        "linewidth",
        "edgecolors",
        "alpha",
        "ax1",
        "set_xlabel",
        "ax1",
        "set_ylabel",
        "ax1",
        "set_xlim",
        "left",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "tight_layout",
        "pad",
        "plt",
        "gcf",
        "get_size_inches",
        "fig1",
        "savefig",
        "fn_png1",
        "dpi",
        "dpi_out",
        "ax1",
        "set_yscale",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "savefig",
        "fn_png2",
        "dpi",
        "dpi_out",
        "min",
        "r",
        "d",
        "alpha_dmd",
        "shape",
        "plt",
        "close",
        "plt",
        "figure",
        "figsize",
        "dpi",
        "plt",
        "gca",
        "ax1",
        "set_aspect",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "axvline",
        "x",
        "linestyle",
        "linewidth",
        "c",
        "alpha",
        "zorder",
        "label",
        "ax1",
        "axhline",
        "y",
        "linestyle",
        "linewidth",
        "c",
        "alpha",
        "zorder",
        "label",
        "ax1",
        "scatter",
        "np",
        "real",
        "d",
        "alpha_dmd",
        "r",
        "np",
        "imag",
        "d",
        "alpha_dmd",
        "r",
        "c",
        "blue",
        "zorder",
        "s",
        "marker",
        "linewidth",
        "edgecolors",
        "alpha",
        "ri",
        "r",
        "ax1",
        "annotate",
        "ri",
        "xy",
        "np",
        "real",
        "d",
        "alpha_dmd",
        "ri",
        "np",
        "imag",
        "d",
        "alpha_dmd",
        "ri",
        "xycoords",
        "xytext",
        "va",
        "ha",
        "color",
        "ax1",
        "xaxis",
        "label",
        "get_color",
        "zorder",
        "textcoords",
        "fontsize",
        "max",
        "np",
        "abs",
        "np",
        "real",
        "d",
        "alpha_dmd",
        "max",
        "np",
        "abs",
        "np",
        "imag",
        "d",
        "alpha_dmd",
        "max",
        "rng_x",
        "rng_y",
        "ax1",
        "set_xlim",
        "rng",
        "rng",
        "ax1",
        "set_ylim",
        "rng",
        "rng",
        "ax1",
        "set_xlabel",
        "ax1",
        "set_ylabel",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "tight_layout",
        "pad",
        "plt",
        "gcf",
        "get_size_inches",
        "fig_trim_x",
        "fig1",
        "ax1",
        "offset_px",
        "dpi",
        "dpi_out",
        "fig1",
        "savefig",
        "fn_png",
        "dpi",
        "dpi_out",
        "plt",
        "close",
        "plt",
        "figure",
        "figsize",
        "dpi",
        "plt",
        "gca",
        "ax1",
        "set_aspect",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "plt",
        "Circle",
        "radius",
        "color",
        "ax1",
        "xaxis",
        "label",
        "get_color",
        "alpha",
        "fill",
        "ls",
        "lw",
        "zorder",
        "ax1",
        "add_patch",
        "c1",
        "ax1",
        "scatter",
        "np",
        "real",
        "d",
        "lambda_dmd",
        "np",
        "imag",
        "d",
        "lambda_dmd",
        "c",
        "yellow",
        "zorder",
        "s",
        "marker",
        "linewidth",
        "edgecolors",
        "alpha",
        "ax1",
        "set_xlabel",
        "ax1",
        "set_ylabel",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "tight_layout",
        "pad",
        "plt",
        "gcf",
        "get_size_inches",
        "fig_trim_x",
        "fig1",
        "ax1",
        "offset_px",
        "dpi",
        "dpi_out",
        "fig1",
        "savefig",
        "fn_png",
        "dpi",
        "dpi_out",
        "np",
        "reshape",
        "np",
        "copy",
        "d",
        "data_mean",
        "nx",
        "ny",
        "order",
        "mpl",
        "colors",
        "Normalize",
        "vmin",
        "vmax",
        "cmasher",
        "cm",
        "iceburn",
        "plt",
        "close",
        "plt",
        "figure",
        "figsize",
        "dpi",
        "plt",
        "gca",
        "ax1",
        "set_aspect",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "imshow",
        "data_mean",
        "T",
        "U_inf",
        "origin",
        "aspect",
        "interpolation",
        "extent",
        "extent",
        "cmap",
        "cmap",
        "norm",
        "norm",
        "ax1",
        "imshow",
        "obstacle_img",
        "transpose",
        "origin",
        "aspect",
        "extent",
        "extent",
        "interpolation",
        "ax1",
        "xaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "xaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "fig1",
        "colorbar",
        "im1",
        "ax",
        "ax1",
        "orientation",
        "aspect",
        "fraction",
        "pad",
        "cbar",
        "ax",
        "set_ylabel",
        "cbar",
        "ax",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "set_xlabel",
        "ax1",
        "set_ylabel",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "tight_layout",
        "pad",
        "ax1",
        "get_position",
        "bounds",
        "cbar",
        "ax",
        "get_position",
        "bounds",
        "cbar",
        "ax",
        "set_position",
        "x0B",
        "y0A",
        "dxB",
        "dyA",
        "plt",
        "gcf",
        "get_size_inches",
        "fig_trim_x",
        "fig1",
        "ax1",
        "cbar",
        "ax",
        "offset_px",
        "dpi",
        "dpi_out",
        "fig1",
        "savefig",
        "fn_png",
        "dpi",
        "dpi_out",
        "np",
        "reshape",
        "d",
        "snapshot_data",
        "nx",
        "ny",
        "nt",
        "order",
        "mpl",
        "colors",
        "Normalize",
        "vmin",
        "vmax",
        "cmasher",
        "cm",
        "iceburn",
        "plt",
        "close",
        "plt",
        "figure",
        "figsize",
        "dpi",
        "plt",
        "gca",
        "ax1",
        "set_aspect",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "imshow",
        "umagI",
        "T",
        "U_inf",
        "origin",
        "aspect",
        "extent",
        "extent",
        "interpolation",
        "cmap",
        "cmap",
        "norm",
        "norm",
        "ax1",
        "imshow",
        "obstacle_img",
        "transpose",
        "origin",
        "aspect",
        "extent",
        "extent",
        "interpolation",
        "ax1",
        "xaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "xaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "fig1",
        "colorbar",
        "im1",
        "ax",
        "ax1",
        "orientation",
        "aspect",
        "fraction",
        "pad",
        "cbar",
        "ax",
        "set_ylabel",
        "cbar",
        "ax",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "set_xlabel",
        "ax1",
        "set_ylabel",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "tight_layout",
        "pad",
        "ax1",
        "get_position",
        "bounds",
        "cbar",
        "ax",
        "get_position",
        "bounds",
        "cbar",
        "ax",
        "set_position",
        "x0B",
        "y0A",
        "dxB",
        "dyA",
        "plt",
        "gcf",
        "get_size_inches",
        "fig_trim_x",
        "fig1",
        "ax1",
        "cbar",
        "ax",
        "offset_px",
        "dpi",
        "dpi_out",
        "fig1",
        "savefig",
        "fn_png",
        "dpi",
        "dpi_out",
        "np",
        "reshape",
        "d",
        "snapshot_data_reconst",
        "real",
        "nx",
        "ny",
        "nt",
        "order",
        "mpl",
        "colors",
        "Normalize",
        "vmin",
        "vmax",
        "cmasher",
        "cm",
        "iceburn",
        "plt",
        "close",
        "plt",
        "figure",
        "figsize",
        "dpi",
        "plt",
        "gca",
        "ax1",
        "set_aspect",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "imshow",
        "umagI_reconst",
        "T",
        "U_inf",
        "origin",
        "aspect",
        "interpolation",
        "extent",
        "extent",
        "cmap",
        "cmap",
        "norm",
        "norm",
        "ax1",
        "imshow",
        "obstacle_img",
        "transpose",
        "origin",
        "aspect",
        "extent",
        "extent",
        "interpolation",
        "ax1",
        "xaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "xaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "fig1",
        "colorbar",
        "im1",
        "ax",
        "ax1",
        "orientation",
        "aspect",
        "fraction",
        "pad",
        "cbar",
        "ax",
        "set_ylabel",
        "cbar",
        "ax",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "set_xlabel",
        "ax1",
        "set_ylabel",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "tight_layout",
        "pad",
        "ax1",
        "get_position",
        "bounds",
        "cbar",
        "ax",
        "get_position",
        "bounds",
        "cbar",
        "ax",
        "set_position",
        "x0B",
        "y0A",
        "dxB",
        "dyA",
        "plt",
        "gcf",
        "get_size_inches",
        "fig_trim_x",
        "fig1",
        "ax1",
        "cbar",
        "ax",
        "offset_px",
        "dpi",
        "dpi_out",
        "fig1",
        "savefig",
        "fn_png",
        "dpi",
        "dpi_out",
        "i_mode",
        "np",
        "reshape",
        "d",
        "modes",
        "i_mode",
        "real",
        "nx",
        "ny",
        "order",
        "mpl",
        "colors",
        "Normalize",
        "vmin",
        "np",
        "abs",
        "modeX",
        "max",
        "vmax",
        "np",
        "abs",
        "modeX",
        "max",
        "cmasher",
        "cm",
        "redshift",
        "plt",
        "close",
        "plt",
        "figure",
        "figsize",
        "dpi",
        "plt",
        "gca",
        "ax1",
        "set_aspect",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "imshow",
        "modeX",
        "T",
        "origin",
        "aspect",
        "extent",
        "extent",
        "interpolation",
        "cmap",
        "cmap",
        "norm",
        "norm",
        "ax1",
        "imshow",
        "obstacle_img",
        "transpose",
        "origin",
        "aspect",
        "extent",
        "extent",
        "interpolation",
        "ax1",
        "xaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "xaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "set_xlabel",
        "ax1",
        "set_ylabel",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "tight_layout",
        "pad",
        "plt",
        "gcf",
        "get_size_inches",
        "fig_trim_x",
        "fig1",
        "ax1",
        "offset_px",
        "dpi",
        "dpi_out",
        "fig1",
        "savefig",
        "fn_png",
        "dpi",
        "dpi_out",
        "os",
        "path",
        "isdir",
        "Path",
        "mkdir",
        "parents",
        "exist_ok",
        "i_mode",
        "d",
        "modes",
        "shape",
        "i_mode",
        "np",
        "reshape",
        "d",
        "modes",
        "i_mode",
        "real",
        "nx",
        "ny",
        "order",
        "mpl",
        "colors",
        "Normalize",
        "vmin",
        "np",
        "abs",
        "modeX",
        "max",
        "vmax",
        "np",
        "abs",
        "modeX",
        "max",
        "cmasher",
        "cm",
        "redshift",
        "plt",
        "close",
        "plt",
        "figure",
        "figsize",
        "dpi",
        "plt",
        "gca",
        "ax1",
        "set_aspect",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "tick_params",
        "axis",
        "which",
        "direction",
        "ax1",
        "imshow",
        "modeX",
        "T",
        "origin",
        "aspect",
        "extent",
        "extent",
        "interpolation",
        "cmap",
        "cmap",
        "norm",
        "norm",
        "ax1",
        "imshow",
        "obstacle_img",
        "transpose",
        "origin",
        "aspect",
        "extent",
        "extent",
        "interpolation",
        "ax1",
        "xaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "xaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_major_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "yaxis",
        "set_minor_locator",
        "mpl",
        "ticker",
        "MultipleLocator",
        "ax1",
        "set_xlabel",
        "ax1",
        "set_ylabel",
        "fig1",
        "tight_layout",
        "pad",
        "fig1",
        "tight_layout",
        "pad",
        "plt",
        "gcf",
        "get_size_inches",
        "fig_trim_x",
        "fig1",
        "ax1",
        "offset_px",
        "dpi",
        "dpi_out",
        "fig1",
        "savefig",
        "fn_png",
        "dpi",
        "dpi_out"
    ],
    "literals": [
        "'Agg'",
        "'%dd:%dh:%02dm:%02ds'",
        "'terminal_width'",
        "'s'",
        "' '",
        "'.'",
        "' '",
        "'offset_px'",
        "'dpi'",
        "'dmd_data_loader_ns3d() not yet implemented'",
        "'U_inf'",
        "'lchar'",
        "'dmd_data_loader_1d() not yet implemented'",
        "'U_inf'",
        "'lchar'",
        "'umag'",
        "'verbose'",
        "'ti_min'",
        "'ti_max'",
        "'xi_min'",
        "'xi_max'",
        "'yi_min'",
        "'yi_max'",
        "'\\n'",
        "'dmd_data_loader_lbm()'",
        "'-'",
        "'%s not found!'",
        "'%s'",
        "'%0.1f [GB]'",
        "'r'",
        "'U_inf'",
        "'lchar'",
        "'Re'",
        "'nu_inf'",
        "'x'",
        "'y'",
        "'obstacle'",
        "'Re!=U_inf*lchar/nu_inf'",
        "'lchar'",
        "'%i [lattice units]'",
        "'U_inf'",
        "'%0.5e [lattice units]'",
        "'Re'",
        "'%0.1f'",
        "'nu_inf'",
        "'%0.5e'",
        "'nx (full)'",
        "'%i'",
        "'ny (full)'",
        "'%i'",
        "r'ts_\\d'",
        "r'[0-9]+'",
        "'ti not constant'",
        "'nt (full)'",
        "'%i'",
        "'-'",
        "'umag'",
        "'dmd scalar'",
        "\">>> scalar='%s' not a valid choice (or not yet implemented)\"",
        "\">>> options are: 'umag'\"",
        "'ti_min'",
        "'%i'",
        "'ti_max'",
        "'%i'",
        "'xi_min'",
        "'%i'",
        "'xi_max'",
        "'%i'",
        "'yi_min'",
        "'%i'",
        "'yi_max'",
        "'%i'",
        "'nx=%i (not >0)'",
        "'ny=%i (not >0)'",
        "'nt=%i (not >0)'",
        "'-'",
        "'nx'",
        "'%i'",
        "'ny'",
        "'%i'",
        "'nt'",
        "'%i'",
        "'-'",
        "'data read'",
        "'ts_%06d/u'",
        "'ts_%06d/v'",
        "'data.shape!=(nx,ny,nt)'",
        "'dmd data size'",
        "'%0.3f [GB]'",
        "'ndof (nx·ny)'",
        "'%i'",
        "'C'",
        "'shape_orig'",
        "'U_inf'",
        "'lchar'",
        "'Re'",
        "'nu_inf'",
        "'nx'",
        "'ny'",
        "'nt'",
        "'x'",
        "'y'",
        "'obstacle'",
        "'obstacle_img'",
        "'data shape (original)'",
        "'%s'",
        "'data shape for dmd'",
        "'%s'",
        "'-'",
        "'\\n'",
        "'dmd.__init__()'",
        "'-'",
        "'exact'",
        "'%s'",
        "'optimal'",
        "'%s'",
        "'data should be of type np.ndarray'",
        "'data should have have ndim=2'",
        "'data size'",
        "'%0.3f [GB]'",
        "'data shape'",
        "'%s'",
        "'data dtype'",
        "'%s'",
        "'n dof'",
        "'%i'",
        "'nt'",
        "'%i'",
        "'-'",
        "'svd()'",
        "'%0.2f [s]'",
        "'Σ max'",
        "'%0.8f'",
        "'Σ min'",
        "'%0.8f'",
        "'log10(Σ_max/Σ_min)'",
        "'%0.2f'",
        "'SVD rank (full)'",
        "'%i'",
        "'SVD rank'",
        "'%i'",
        "'get eigvals, eigvecs of Ã'",
        "'%0.2f [s]'",
        "'n modes'",
        "'%i'",
        "'n dof'",
        "'%i'",
        "'get amplitude coeffs'",
        "'%0.2f [s]'",
        "'snapshot data size'",
        "'%0.3f [GB]'",
        "'DMD data size'",
        "'%0.3f [GB]'",
        "'data reduction'",
        "'%0.2f [%%]'",
        "'\\n'",
        "'dmd.run()'",
        "'-'",
        "'-'",
        "'\\n'",
        "'dmd.reconstruct()'",
        "'-'",
        "'reconstruction rank'",
        "'%i'",
        "'do reconstruction'",
        "'%0.2f [s]'",
        "'reconstruction: mean absolute diff'",
        "'%0.3e'",
        "'-'",
        "'__main__'",
        "'../data/lbm_cylinder_1/data.h5'",
        "'%s not found!'",
        "'umag'",
        "'dmd.dat'",
        "'wb'",
        "'dmd.dat'",
        "'rb'",
        "'dark_background'",
        "'#ff44ff'",
        "'#00d7ff'",
        "'#00ffff'",
        "'#00fb00'",
        "'#f9d300'",
        "'#ff8800'",
        "'#ff004d'",
        "'nx'",
        "'ny'",
        "'nt'",
        "'U_inf'",
        "'lchar'",
        "'x'",
        "'y'",
        "'obstacle_img'",
        "'sigma.png'",
        "'sigma_log.png'",
        "'all'",
        "'x'",
        "'both'",
        "'out'",
        "'y'",
        "'both'",
        "'out'",
        "'Sigma_full'",
        "'gray'",
        "'o'",
        "'k'",
        "'o'",
        "'k'",
        "r'$i$'",
        "r'$\\Sigma_{i}$'",
        "'log'",
        "'alpha.png'",
        "'all'",
        "'equal'",
        "'x'",
        "'both'",
        "'out'",
        "'y'",
        "'both'",
        "'out'",
        "'dashed'",
        "'lightgray'",
        "'dashed'",
        "'lightgray'",
        "'o'",
        "'k'",
        "'%i'",
        "'data'",
        "'center'",
        "'left'",
        "'offset points'",
        "r'Re($\\alpha_{i}$)'",
        "r'Im($\\alpha_{i}$)'",
        "'lambda.png'",
        "'all'",
        "'equal'",
        "'x'",
        "'both'",
        "'out'",
        "'y'",
        "'both'",
        "'out'",
        "'dashed'",
        "'o'",
        "'k'",
        "r'Re($\\lambda_{i}$)'",
        "r'Im($\\lambda_{i}$)'",
        "'C'",
        "'data_mean.png'",
        "'all'",
        "'equal'",
        "'x'",
        "'both'",
        "'out'",
        "'y'",
        "'both'",
        "'out'",
        "'lower'",
        "'equal'",
        "'none'",
        "'lower'",
        "'equal'",
        "'none'",
        "'vertical'",
        "r'$\\overline{u_{mag}}/U_{\\infty}$'",
        "'y'",
        "'both'",
        "'out'",
        "r'$x/\\ell_{char}$'",
        "r'$y/\\ell_{char}$'",
        "'C'",
        "'umagI.png'",
        "'all'",
        "'equal'",
        "'x'",
        "'both'",
        "'out'",
        "'y'",
        "'both'",
        "'out'",
        "'lower'",
        "'equal'",
        "'none'",
        "'lower'",
        "'equal'",
        "'none'",
        "'vertical'",
        "r'$u_{mag}^{\\prime}/U_{\\infty}$'",
        "'y'",
        "'both'",
        "'out'",
        "r'$x/\\ell_{char}$'",
        "r'$y/\\ell_{char}$'",
        "'C'",
        "'umagI_reconst.png'",
        "'all'",
        "'equal'",
        "'x'",
        "'both'",
        "'out'",
        "'y'",
        "'both'",
        "'out'",
        "'lower'",
        "'equal'",
        "'none'",
        "'lower'",
        "'equal'",
        "'none'",
        "'vertical'",
        "r'$u_{mag}^{\\prime}/U_{\\infty}$'",
        "' (reconstructed)'",
        "'y'",
        "'both'",
        "'out'",
        "r'$x/\\ell_{char}$'",
        "r'$y/\\ell_{char}$'",
        "'mode_%04d.png'",
        "'C'",
        "'all'",
        "'equal'",
        "'x'",
        "'both'",
        "'out'",
        "'y'",
        "'both'",
        "'out'",
        "'lower'",
        "'equal'",
        "'none'",
        "'lower'",
        "'equal'",
        "'none'",
        "r'$x/\\ell_{char}$'",
        "r'$y/\\ell_{char}$'",
        "'modes'",
        "'modes'",
        "'modes/mode_%04d.png'",
        "'C'",
        "'all'",
        "'equal'",
        "'x'",
        "'both'",
        "'out'",
        "'y'",
        "'both'",
        "'out'",
        "'lower'",
        "'equal'",
        "'none'",
        "'lower'",
        "'equal'",
        "'none'",
        "r'$x/\\ell_{char}$'",
        "r'$y/\\ell_{char}$'"
    ],
    "variables": [
        "m",
        "s",
        "h",
        "m",
        "d",
        "h",
        "time_str",
        "terminal_width",
        "s",
        "ndots",
        "text",
        "offset_px",
        "dpi_out",
        "dpi_out",
        "fig_px_x",
        "fig_px_y",
        "transFigInv",
        "w",
        "h",
        "nax",
        "ax_tb_pct",
        "ax_tb_px",
        "x0",
        "y0",
        "dx",
        "dy",
        "ax_tb_pct",
        "ai",
        "x0",
        "y0",
        "dx",
        "dy",
        "axis_tb_px",
        "ax_tb_px",
        "ai",
        "marg_R_px",
        "marg_L_px",
        "x_shift_px",
        "px_base",
        "w_px",
        "w_px",
        "h_px",
        "w_inch",
        "h_inch",
        "x0",
        "y0",
        "dx",
        "dy",
        "x0n",
        "y0n",
        "dxn",
        "dyn",
        "ax_tb_pct",
        "ai",
        "fig_px_x",
        "fig_px_y",
        "w_adj",
        "h_adj",
        "x0n",
        "y0n",
        "dxn",
        "dyn",
        "data",
        "extra",
        "data",
        "extra",
        "verbose",
        "ti_min",
        "ti_max",
        "xi_min",
        "xi_max",
        "yi_min",
        "yi_max",
        "fn_h5",
        "fn_h5",
        "U_inf",
        "lchar",
        "Re",
        "nu_inf",
        "x",
        "y",
        "obstacle",
        "nx",
        "ny",
        "obstacle_img",
        "obstacle_img",
        "i",
        "j",
        "dset_names",
        "tss",
        "ti",
        "nt",
        "ti_min",
        "ti_min",
        "ti_max",
        "ti_max",
        "nt",
        "xi_min",
        "xi_min",
        "xi_max",
        "xi_max",
        "x",
        "nx",
        "yi_min",
        "yi_min",
        "yi_max",
        "yi_max",
        "y",
        "ny",
        "obstacle_img",
        "data",
        "tiii",
        "progress_bar",
        "u",
        "v",
        "data",
        "tiii",
        "shape_orig",
        "ndof",
        "data",
        "extra",
        "exact",
        "optimal",
        "svd_rank",
        "sort_by_amp_coeff",
        "data",
        "data_prime",
        "data_mean",
        "snapshot_data",
        "X",
        "Y",
        "start_time",
        "U",
        "Sigma",
        "V",
        "V",
        "Sigma_full",
        "rank",
        "rank",
        "U",
        "Sigma",
        "V",
        "A_tilde",
        "start_time",
        "basis",
        "basis",
        "modes",
        "vander",
        "start_time",
        "alpha_dmd",
        "_",
        "_",
        "_",
        "original_info_size",
        "dmd_info_size",
        "reduction_info_fac",
        "alpha_dmd_abs",
        "sort_key",
        "alpha_dmd",
        "lambda_dmd",
        "modes",
        "vander",
        "P",
        "q",
        "q",
        "r",
        "start_time",
        "snapshot_data_reconst",
        "snapshot_data_delta",
        "adiff",
        "fn_h5",
        "data",
        "extra",
        "d",
        "d",
        "extra",
        "colors",
        "purple",
        "blue",
        "cyan",
        "green",
        "yellow",
        "orange",
        "red",
        "cl1",
        "cl2",
        "cl3",
        "cl4",
        "cl5",
        "cl6",
        "cl7",
        "nx",
        "ny",
        "nt",
        "U_inf",
        "lchar",
        "x",
        "y",
        "obstacle_img",
        "extent",
        "fn_png1",
        "fn_png2",
        "fig1",
        "ax1",
        "diff",
        "aa",
        "bb",
        "dpi_out",
        "fn_png",
        "r",
        "r",
        "fig1",
        "ax1",
        "rng_x",
        "rng_y",
        "rng",
        "dpi_out",
        "fn_png",
        "fig1",
        "ax1",
        "c1",
        "dpi_out",
        "data_mean",
        "norm",
        "cmap",
        "fn_png",
        "fig1",
        "ax1",
        "im1",
        "im1_obstacle",
        "cbar",
        "x0A",
        "y0A",
        "dxA",
        "dyA",
        "x0B",
        "y0B",
        "dxB",
        "dyB",
        "dpi_out",
        "umagI",
        "norm",
        "cmap",
        "fn_png",
        "fig1",
        "ax1",
        "im1",
        "im1_obstacle",
        "cbar",
        "x0A",
        "y0A",
        "dxA",
        "dyA",
        "x0B",
        "y0B",
        "dxB",
        "dyB",
        "dpi_out",
        "umagI_reconst",
        "norm",
        "cmap",
        "fn_png",
        "fig1",
        "ax1",
        "im1",
        "im1_obstacle",
        "cbar",
        "x0A",
        "y0A",
        "dxA",
        "dyA",
        "x0B",
        "y0B",
        "dxB",
        "dyB",
        "dpi_out",
        "i_mode",
        "fn_png",
        "modeX",
        "norm",
        "cmap",
        "fig1",
        "ax1",
        "im1",
        "im1_obstacle",
        "dpi_out",
        "fn_png",
        "modeX",
        "norm",
        "cmap",
        "fig1",
        "ax1",
        "im1",
        "im1_obstacle",
        "dpi_out"
    ],
    "comments": [
        "!/usr/bin/env python3",
        "-*- coding: utf-8 -*-",
        "utilities",
        "======================================================================",
        "return string",
        "sys.stdout.write(text)",
        "this is used to make sure OUTPUT png px dims are divisible by N",
        "print('fig size px : %i %i'%(fig_px_x, fig_px_y))",
        "print('w, h : %0.2f %0.2f'%(w, h))",
        "percent values of the axis tightbox",
        "print('x0, y0, dx, dy : %0.2f %0.2f %0.2f %0.2f'%(x0, y0, dx, dy))",
        "pixel values of the axis tightbox",
        "print('x0, y0, dx, dy : %0.2f %0.2f %0.2f %0.2f'%(x0, y0, dx, dy))",
        "scale by dpi ratio [png:screen]",
        "current width of (untrimmed) margins (in [x])",
        "print('marg_L_px : %0.2f'%(marg_L_px,))",
        "print('marg_R_px : %0.2f'%(marg_R_px,))",
        "n pixels to move all axes left by (fig canvas is 'trimmed' from right)",
        "print('x_shift_px : %0.2f'%(x_shift_px,))",
        "get new canvas size",
        "make sure height in px divisible by N (important for video encoding)",
        "w_px   += 1*px_base ## maybe helpful in case labels have \\infty etc., where get_position() slightly underestimates",
        "print('w_px, h_px : %0.2f %0.2f'%(w_px, h_px))",
        "get shifted axis bound values",
        "print('x0n, y0n, dxn, dyn : %0.4f %0.4f %0.4f %0.4f'%(x0n, y0n, dxn, dyn))",
        "resize canvas",
        "print('w_adj, h_adj : %0.2f %0.2f'%(w_adj, h_adj))",
        "print('w_adj, h_adj : %0.2f %0.2f'%(w_adj*dpi_out, h_adj*dpi_out))",
        "do shift",
        "Dynamic Mode Decomposition (DMD)",
        "======================================================================",
        "dummy",
        "dummy",
        "dummy",
        "dummy",
        "=== open HDF5 file & copy data",
        "transparent",
        "gray, opaque",
        "check that Re=U_inf*lchar/nu_inf",
        "report flow parameters",
        "get ts_XXXXXX dataset info",
        "make sure that scalar to be used is valid",
        "=== reduce bounds of data for analysis",
        "crop obstacle img",
        "check that nx,ny,nt are all >0",
        "report the bounds of the cropped data to be used",
        "=== copy data to memory (data read)",
        "if reading multiple scalars, could use structured array, but for now just",
        "read single scalar",
        "names   = [ 'u','v','umag' ]",
        "formats = [ np.float32 for n in names ]",
        "",
        "## 4D [scalar][x,y,t] structured array",
        "data = np.zeros(shape=(nx,ny,nt), dtype={'names':names, 'formats':formats})",
        "index in structured array",
        "",
        "data['u'][:,:,tiii] = u",
        "data['v'][:,:,tiii] = v",
        "",
        "data['umag'][:,:,tiii] = np.sqrt(u**2+v**2)",
        "",
        "reshape data for DMD analysis",
        "a dictionary of any 'extra' data in addition to the actual data to return (can get used for plotting etc)",
        "=== methods of .run()",
        "if False: ## this is for if the data passed is a numpy stuctured array (outdated)",
        "",
        "## [t] mean",
        "names   = self.data.dtype.names",
        "formats = [ self.data[a].dtype for a in self.data.dtype.names ]",
        "data_mean = np.zeros(shape=(self.nx,self.ny), dtype={'names':names, 'formats':formats})",
        "for scalar in self.data.dtype.names:",
        "data_mean[scalar][:,:] = np.mean( self.data[scalar], axis=-1 )",
        "",
        "## get prime (') variables / temporal mean-removed variables",
        "names      = self.data.dtype.names",
        "formats    = [ self.data[a].dtype for a in self.data.dtype.names ]",
        "data_prime = np.zeros(shape=(self.nx,self.ny,self.nt), dtype={'names':names, 'formats':formats})",
        "for scalar in self.data.dtype.names:",
        "data_prime[scalar][:,:,:] = self.data[scalar] - data_mean[scalar][:,:,np.newaxis]",
        "even_print('dmd data size (prime)', '%0.3f [GB]'%(data_prime.nbytes/1024**3,))",
        "self.data_mean  = np.zeros(shape=(self.ndof,),        dtype=self.data.dtype)",
        "times [0..nt-1]",
        "times [1..nt]",
        "compute (reduced) Singular Value Decomposition (SVD) representation of snapshot series X",
        "X = U·Σ·V*",
        "",
        "",
        "dof,full_rank = U.shape",
        "svd_rep_rank = np.linalg.matrix_rank(np.diag(Sigma), tol=tol) #, hermitian=True)",
        "even_print('X full rank','%i'%full_rank)",
        "even_print('SVD matrix rank (tol=%.1e)'%(tol,),'%i'%svd_rep_rank)",
        "even_print('SVD possible reduction', '%i'%(full_rank-svd_rep_rank))",
        "make a backup of full SV vector",
        "truncate the SVD system",
        "https://github.com/mathLab/PyDMD/blob/c98ede0e32e8fb4a690145218f86d39f85da4dc0/pydmd/dmdoperator.py#L51",
        "the reduced Koopman operator Ã ('A_tilde')",
        "Ã = (U*)·Y·V·inv(Σ)",
        "",
        "compute eigenvalues / eigenvectors of Ã",
        "Ã·w = λ·w",
        "",
        "exact",
        "projected",
        "DMD modes",
        "self.modes_L2_norm = sp.linalg.norm(np.abs(self.modes), axis=0, ord=2)",
        "print(self.modes_L2_norm)",
        "Vandermonde Matrix",
        "get amplitude coefficients",
        "report data reduction",
        "sort eigenvalues / eigenvectors / modes by amplitude coefficients",
        "--> not sure if this should even be done, needs verification!",
        "",
        "self.V.conj().T,",
        "self.reconstruct(r=None)",
        "===",
        "",
        "main",
        "======================================================================",
        "retrieve data, run DMD, save",
        "=== identify data file for DMD & load data into memory",
        "=== run DMD",
        "=== serialize data to binary file",
        "load from pickled file",
        "reconstruct umag' field",
        "============================== #",
        "plot",
        "============================== #",
        "set up plotting environment",
        "dark bg",
        "colors = ['#d339ee', '#0085ff', '#00a6a0', '#009b00', '#9c8300', '#e15800', '#ff0033'] ## white bg",
        "get data from 'extra' dictionary from the dmd_data_loader",
        "for imshow()",
        "plot: singular values Σ",
        "ax1.set_aspect('equal')",
        "ax1.set_yscale('log',base=10)",
        "",
        "",
        "",
        "",
        "ax1.set_ylim(bottom=0)",
        "",
        "",
        "plt.show()",
        "",
        "save a semilog version of same plot",
        "",
        "plt.show()",
        "plot: alpha_dmd (amplitude coefficients)",
        "",
        "plot eigenvalues on complex plane",
        "",
        "annotate the scatterplot",
        "",
        "",
        "",
        "",
        "",
        "",
        "plt.show()",
        "plot: DMD eigenvalues on unit circle",
        "circle (outer)",
        "plot eigenvalues on complex plane",
        "",
        "",
        "",
        "plt.show()",
        "plot: mean(umag)",
        "cmap = mpl.cm.RdBu_r",
        "",
        "",
        "",
        "",
        "rotation=90, labelpad=10",
        "cbar.set_ticks([2.80,2.85,2.90,2.95,3.00])",
        "",
        "",
        "",
        "",
        "",
        "plt.show()",
        "plot: umag' at t=0",
        "cmap = mpl.cm.RdBu_r",
        "",
        "",
        "",
        "",
        "rotation=90, labelpad=10",
        "cbar.set_ticks([2.80,2.85,2.90,2.95,3.00])",
        "",
        "",
        "",
        "",
        "",
        "plt.show()",
        "plot: umag' (reconstructed)",
        "cmap = mpl.cm.RdBu_r",
        "",
        "",
        "",
        "",
        "rotation=90, labelpad=10",
        "cbar.set_ticks([2.80,2.85,2.90,2.95,3.00])",
        "",
        "",
        "",
        "",
        "",
        "plt.show()",
        "plot: 1x DMD mode",
        "cmap = mpl.cm.RdBu_r",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "plt.show()",
        "plot: all DMD modes",
        "cmap = mpl.cm.RdBu_r",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "plt.show()"
    ],
    "docstrings": [
        "'''\n========================================================================\n\nDynamic Mode Decomposition (DMD)\n\n========================================================================\n'''",
        "'''\n    format seconds as dd:hh:mm:ss\n    '''",
        "'''\n    print/return a fixed width message\n    '''",
        "'''\n    trims the figure in (x) / width dimension\n    - typical use case : single equal aspect figure needs to be scooted / trimmed\n    '''",
        "'''\n    retrieve data from an NS3D result HDF5 (EAS4, RGD, CGD, etc.) in preparation for DMD analysis\n    '''",
        "'''\n    retrieve data from a 1D chaotic oscillator result\n    '''",
        "'''\n    retrieve data from a 2D LBM simulation result & prepare it for DMD analysis\n    -----\n    - returned 'data' is a numpy array with shape (ndof,nt)\n    - returned 'extra' is a dict of any extra information (for plotting, etc)\n    '''",
        "'''\n    Dynamic Mode Decomposition (DMD)\n    \n    Description\n    -----------\n    - Approximate a linear operator 'A' such that x(t+1)=A·x(t) for a snapshot series 'x'\n    - For data gathered from a non-linear process, this approximation can be interpreted as a\n       linear tangent approximation\n    - Inspection of 'A' (eigenvalues, eigenvectors, pseudoeigenvalues, energy amplification, \n          resonance behaviour, etc.) allows for extraction of dynamic characteristics\n    \n    Bibliography\n    ------------\n    Schmid, P. J. (2010) Dynamic mode decomposition of numerical and experimental data.\n    Journal of Fluid Mechanics 656, doi: 10.1017/S0022112010001217\n    \n    Jonathan H. Tu, Clarence W. Rowley, Dirk M. Luchtenburg, Steven L. Brunton, J. Nathan Kutz.\n    On dynamic mode decomposition: Theory and applications.\n    Journal of Computational Dynamics, 2014, 1(2): 391-421. doi: 10.3934/jcd.2014.1.391\tshu \n    --> projected vs exact DMD\n    \n    Jovanovic, M. R., Schmid, P. J. & Nichols, J. W. (2014) Sparsity-promoting dynamic mode decomposition.\n    Physics of Fluids 26, doi: 10.1063/1.4863670\n    --> http://people.ece.umn.edu/users/mihailo/papers/jovschnicPOF14.pdf\n    \n    Hemati and Rowley, De-biasing the dynamic mode decomposition\n        for applied Koopman spectral analysis, arXiv:1502.03854 (2015).\n    --> total least squares DMD\n    \n    Brunton, S. L., & Kutz, J. N. (2022).\n    Data-driven science and engineering: Machine learning, dynamical systems, and control.\n    --> http://databookuw.com/databook.pdf\n    \n    '''",
        "'''\n        initialize the DMD analyzer\n        -----\n        - data should be a numpy array with ndim=2\n            axis 0 is the data per snapshot\n            axis 1 are the snapshots (here interpreted as time, though doesnt have to be)\n        - data.shape = (ndof,nt) where e.g. ndof=nx*ny*nz (spatial degrees of freedom)\n        '''",
        "'''\n        get mean data (in time), then get mean-removed data\n        '''",
        "'''\n        singular value decomposition (SVD)\n        '''",
        "'''\n        get DMD modes\n        '''",
        "'''\n        compute amplitude coefficients\n        - this can be done 'optimally' (error minimized between modes over all snapshots)\n           or this can be done using only a single snapshot\n        '''",
        "'''\n        get P,q for optimal amplitude coefficient calculation\n        '''",
        "'''\n        run wrapper to fit data (do SVD, get modes, assimilate data to modes)\n        '''",
        "'''\n        reconstruct the snapshot data from DMD modes\n        '''"
    ],
    "functions": [
        "format_time_string",
        "even_print",
        "fig_trim_x",
        "dmd_data_loader_ns3d",
        "dmd_data_loader_1d",
        "dmd_data_loader_lbm",
        "__get_mean_removed",
        "__do_svd",
        "__get_dmd_modes",
        "__get_dmd_amp_coefficients",
        "__get_optimal_fit_matrices",
        "run",
        "reconstruct"
    ],
    "classes": [
        "dmd"
    ]
}