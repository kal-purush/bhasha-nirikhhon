{
    "identifiers": [
        "numpy",
        "np",
        "numpy",
        "asarray",
        "ar",
        "rasterio",
        "argparse",
        "os",
        "time",
        "argparse",
        "ArgumentParser",
        "parser",
        "add_argument",
        "parser",
        "parse_args",
        "R16",
        "scene",
        "inpath",
        "args",
        "inpath",
        "R16",
        "profile",
        "R16",
        "read",
        "R16_data",
        "factor",
        "rasterio",
        "open",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "profile_R16",
        "dst",
        "dst",
        "write",
        "R16_rc",
        "R550",
        "R16",
        "BT37",
        "BT11",
        "BT12",
        "profile",
        "scene",
        "inpath",
        "args",
        "inpath",
        "SICE_toolchain",
        "R550",
        "R16",
        "R550",
        "R16",
        "rasterio",
        "open",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "profile",
        "dst",
        "dst",
        "write",
        "NDSI",
        "np",
        "empty",
        "R550",
        "shape",
        "R550",
        "shape",
        "copy",
        "np",
        "nan",
        "copy",
        "copy",
        "ar",
        "R550",
        "ar",
        "NDSI",
        "R550",
        "ar",
        "BT12",
        "ar",
        "BT11",
        "BT37",
        "ar",
        "R550",
        "ar",
        "NDSI",
        "ar",
        "R16",
        "ar",
        "BT12",
        "ar",
        "BT11",
        "BT37",
        "ar",
        "R550",
        "ar",
        "BT12",
        "ar",
        "R550",
        "t1",
        "cloud_detection",
        "t2",
        "cloud_detection",
        "cloud_detection",
        "t3",
        "cloud_detection",
        "BT12",
        "t4",
        "np",
        "minimum",
        "THR1",
        "THRmax",
        "t5",
        "ar",
        "BT11",
        "BT37",
        "THR",
        "ar",
        "NDSI",
        "R550",
        "S",
        "ar",
        "NDSI",
        "NDSI",
        "ar",
        "BT12",
        "ar",
        "R550",
        "cloud_detection",
        "t6",
        "cloud_detection",
        "SICE_toolchain",
        "cloud_detection",
        "cloud_detection",
        "profile",
        "copy",
        "profile_cloud_detection",
        "update",
        "dtype",
        "rasterio",
        "int16",
        "rasterio",
        "open",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "profile_cloud_detection",
        "dst",
        "dst",
        "write",
        "cloud_detection",
        "astype",
        "np",
        "int16",
        "cloud_detection",
        "NDSI",
        "os",
        "listdir",
        "args",
        "inpath",
        "i",
        "scene",
        "scenes",
        "rasterio",
        "open",
        "args",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "profile",
        "rasterio",
        "open",
        "args",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "radiometric_calibration",
        "R16",
        "R16",
        "scene",
        "scene",
        "rasterio",
        "open",
        "args",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "read",
        "rasterio",
        "open",
        "args",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "read",
        "rasterio",
        "open",
        "args",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "read",
        "rasterio",
        "open",
        "args",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "read",
        "rasterio",
        "open",
        "args",
        "inpath",
        "os",
        "sep",
        "scene",
        "os",
        "sep",
        "read",
        "SCDA_v20",
        "R550",
        "R550",
        "R16",
        "R16",
        "BT37",
        "BT37",
        "BT11",
        "BT11",
        "BT12",
        "BT12",
        "scene",
        "scene",
        "profile",
        "profile"
    ],
    "literals": [
        "'inpath'",
        "'S5_reflectance_an_rc_x.tif'",
        "'w'",
        "'NDSI.tif'",
        "'w'",
        "'SCDA_v20.tif'",
        "'w'",
        "'S1_reflectance_an_x.tif'",
        "'S5_reflectance_an_x.tif'",
        "'S1_reflectance_an_x.tif'",
        "'S5_reflectance_an_rc_x.tif'",
        "'S7_BT_an_x.tif'",
        "'S8_BT_an_x.tif'",
        "'S9_BT_an_x.tif'"
    ],
    "variables": [
        "parser",
        "args",
        "profile_R16",
        "factor",
        "R16_data",
        "R16_rc",
        "NDSI",
        "THR",
        "THR",
        "THRmax",
        "THRmax",
        "S",
        "S",
        "t1",
        "t2",
        "t3",
        "t4",
        "t5",
        "cloud_detection",
        "cloud_detection",
        "cloud_detection",
        "THR1",
        "THRmax",
        "THR",
        "S",
        "t6",
        "cloud_detection",
        "cloud_detection",
        "cloud_detection",
        "profile_cloud_detection",
        "scenes",
        "profile",
        "R16",
        "R550",
        "R16",
        "BT37",
        "BT11",
        "BT12",
        "cd",
        "NDSI"
    ],
    "comments": [
        "-*- coding: utf-8 -*-",
        "determining the NDSI, needed for the cloud detection",
        "initializing thresholds",
        "tests 1 to 5, only based on inputs",
        "test 6, based on fluctuating thresholds",
        "writing results",
        "listing scenes for a given date",
        "saving profile metadata only for the first iteration",
        "calibrating R16",
        "loading inputs",
        "running SCDA v2.0 and v1.4"
    ],
    "docstrings": [
        "\"\"\"\n\n@author: Adrien Wehrlé, GEUS (Geological Survey of Denmark and Greenland)\n\nImplementation of the Simple Cloud Detection Algorithm (SCDA) v2.0\nusing SLSTR bands, described in Fig. 5 of METSÄMÄKI et al, 2015.\n\nMETSÄMÄKI, Sari, PULLIAINEN, Jouni, SALMINEN, Miia, et al. Introduction \nto GlobSnow Snow Extent products with considerations for accuracy assessment. \nRemote Sensing of Environment, 2015, vol. 156, p. 96-108.\n\nThe original syntax has been preserved to easily link back to the description\nof the algorithm.\n\n\nINPUTS:\n    inpath: Path to the folder of a given date containing extracted scenes\n                in .tif format. [string]\n            \nOUTPUTS:\n        {inpath}/NDSI.tif: Normalized Difference Snow Index (NDSI) in a \n                           .tif file, stored in {inpath}. [.tif]\n        {inpath}/SCDA_v20.tif: Simple Cloud Detection Algorithm (SCDA) v2.0\n                               results in a .tif file, stored in {inpath}. [.tif]\n        {inpath}/SCDA_v14.tif: Simple Cloud Detection Algorithm (SCDA) v1.4\n                               results in a .tif file, stored in {inpath}. [.tif]\n    \n\n\"\"\"",
        "'''\n    Sentinel-3 Product Notice – SLSTR:\n    \"Based on the analysis performed to-date, a recommendation has been put forward to users to\n    adjust the S5 and S6 reflectances by factors of 1.12 and 1.20 respectively in the nadir view and\n    1.15 and 1.26 in the oblique view. Uncertainty estimates on these differences are still to be\n    evaluated and comparisons with other techniques have yet to be included.\"\n    \n    INPUTS:\n        R16: Dataset reader for Top of Atmosphere (TOA) reflectance channel S5.\n             Central wavelengths at 1.6um. [rasterio.io.DatasetReader]\n        scene: Scene on which to compute SCDA. [string]\n        \n    OUTPUTS:\n        {inpath}/S5_reflectance_an_rc_x.tif: Adjusted Top of Atmosphere (TOA)\n                                             reflectance for channel S5.\n    '''",
        "'''\n    \n    INPUTS:\n        inpath: Path to the folder of a given date containing extracted scenes\n                in .tif format. [string]\n        SICE_toolchain: if True: cloud=255, clear=1\n                        if False: cloud=1, clear=0\n        profile: Profile to save outputs. [rasterio.profiles.Profile]\n        scene: Scene on which to compute the SCDA. [string]\n        R550, R16: Top of Atmosphere (TOA) reflectances for channels S1 and S5.\n                   Central wavelengths at 550nm and 1.6um. [arrays]\n        BT37, BT11, BT12: Gridded pixel Brightness Temperatures (BT) for channels \n                          S7, S8 and S9 (1km TIR grid, nadir view). Central \n                          wavelengths at 3.7, 11 and 12 um. [arrays]\n              \n    OUTPUTS:\n        {inpath}/NDSI.tif: Normalized Difference Snow Index (NDSI) in a \n                           .tif file, stored in {inpath}. [.tif]\n        {inpath}/SCDA.tif: Simple Cloud Detection Algorithm (SCDA) results \n                           in a .tif file, stored in {inpath}. \n                           clouds=1, clear=0 [.tif]\n         \n    '''"
    ],
    "functions": [
        "radiometric_calibration",
        "SCDA_v20"
    ],
    "classes": []
}