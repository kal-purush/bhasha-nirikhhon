{
    "identifiers": [
        "os",
        "sys",
        "logging",
        "slack",
        "requests",
        "json",
        "arrow",
        "asyncio",
        "aioredis",
        "pickle",
        "requests",
        "auth",
        "HTTPBasicAuth",
        "flask",
        "Flask",
        "jsonify",
        "request",
        "slackeventsapi",
        "SlackEventAdapter",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "Flask",
        "logging",
        "getLogger",
        "app",
        "logger",
        "gunicorn_logger",
        "handlers",
        "app",
        "logger",
        "setLevel",
        "gunicorn_logger",
        "level",
        "SlackEventAdapter",
        "SLACK_SIGNING_SECRET",
        "app",
        "slack",
        "WebClient",
        "token",
        "os",
        "environ",
        "os",
        "environ",
        "get",
        "os",
        "environ",
        "get",
        "data",
        "data",
        "emoji",
        "slack_events_adapter",
        "on",
        "event_data",
        "event_data",
        "event_data",
        "event_data",
        "event_data",
        "app",
        "route",
        "methods",
        "app",
        "route",
        "methods",
        "json",
        "loads",
        "request",
        "form",
        "get",
        "data",
        "data",
        "asyncio",
        "run",
        "redis_pool",
        "data",
        "client",
        "chat_postEphemeral",
        "channel",
        "channel_id",
        "user",
        "user_id",
        "text",
        "app",
        "route",
        "methods",
        "request",
        "form",
        "get",
        "request",
        "form",
        "get",
        "request",
        "form",
        "get",
        "token",
        "abort",
        "client",
        "chat_postMessage",
        "channel",
        "request",
        "form",
        "get",
        "text",
        "response",
        "response",
        "app",
        "route",
        "methods",
        "request",
        "form",
        "get",
        "request",
        "form",
        "get",
        "request",
        "form",
        "get",
        "token",
        "abort",
        "text",
        "replace",
        "replace",
        "split",
        "ex",
        "text",
        "_get_image_by_tag",
        "repository",
        "_get_image_vulnerabilities",
        "image",
        "vulnerability",
        "vulnerabilities",
        "vulnerability",
        "high",
        "append",
        "vulnerability",
        "vulnerability",
        "medium",
        "append",
        "vulnerability",
        "vulnerability",
        "low",
        "append",
        "vulnerability",
        "vulnerability",
        "negligible",
        "append",
        "vulnerability",
        "vulnerability",
        "append",
        "vulnerability",
        "vulnerability",
        "high",
        "options",
        "append",
        "vulnerability",
        "vulnerability",
        "slack_notification",
        "append",
        "options",
        "client",
        "chat_postMessage",
        "channel",
        "SLACK_CHANNEL",
        "blocks",
        "slack_notification",
        "app",
        "route",
        "methods",
        "request",
        "form",
        "get",
        "request",
        "form",
        "get",
        "request",
        "form",
        "get",
        "token",
        "abort",
        "text",
        "replace",
        "replace",
        "split",
        "ex",
        "text",
        "_add_repository",
        "repository",
        "json",
        "loads",
        "ae",
        "arrow",
        "Arrow",
        "fromtimestamp",
        "ae",
        "arrow",
        "Arrow",
        "fromtimestamp",
        "ae",
        "ae",
        "subscription_value",
        "tag",
        "subscription_value",
        "options",
        "append",
        "tag",
        "tag",
        "slack_notification",
        "append",
        "repository",
        "options",
        "slack_notification",
        "append",
        "slack_notification",
        "append",
        "ae",
        "ae",
        "client",
        "chat_postMessage",
        "channel",
        "SLACK_CHANNEL",
        "blocks",
        "slack_notification",
        "app",
        "route",
        "methods",
        "json",
        "loads",
        "request",
        "data",
        "data",
        "data",
        "data",
        "data",
        "data",
        "notification_payload",
        "notification_payload",
        "notification_payload",
        "notification_payload",
        "asyncio",
        "run",
        "redis_pool",
        "data",
        "arrow",
        "Arrow",
        "fromtimestamp",
        "created_at",
        "level",
        "message",
        "details",
        "details",
        "details",
        "slack_notification",
        "append",
        "details",
        "details",
        "details",
        "details",
        "details",
        "slack_notification",
        "append",
        "slack_notification",
        "append",
        "notification_user",
        "notification_user_email",
        "notification_id",
        "app",
        "route",
        "methods",
        "json",
        "loads",
        "request",
        "data",
        "asyncio",
        "run",
        "redis_pool",
        "data",
        "app",
        "route",
        "methods",
        "json",
        "loads",
        "request",
        "data",
        "asyncio",
        "run",
        "redis_pool",
        "data",
        "app",
        "route",
        "methods",
        "json",
        "loads",
        "request",
        "data",
        "asyncio",
        "run",
        "redis_pool",
        "data",
        "app",
        "route",
        "methods",
        "json",
        "loads",
        "request",
        "data",
        "data",
        "data",
        "data",
        "data",
        "data",
        "notification_payload",
        "notification_payload",
        "notification_payload",
        "current_evaluation",
        "notification_payload",
        "last_evaluation",
        "asyncio",
        "run",
        "redis_pool",
        "data",
        "_get_image_by_tag",
        "subscription_key",
        "_get_image_vulnerabilities",
        "image",
        "subscription_key",
        "current_analysis_status",
        "arrow",
        "Arrow",
        "fromtimestamp",
        "created_at",
        "last_analysis_status",
        "vulnerabilities",
        "x",
        "x",
        "vulnerabilities",
        "x",
        "x",
        "x",
        "vulnerabilities",
        "x",
        "x",
        "x",
        "vulnerabilities",
        "x",
        "x",
        "x",
        "vulnerabilities",
        "x",
        "x",
        "x",
        "vulnerabilities",
        "x",
        "slack_notification",
        "append",
        "len",
        "high",
        "len",
        "medium",
        "len",
        "low",
        "len",
        "negligible",
        "len",
        "slack_notification",
        "append",
        "slack_notification",
        "append",
        "notification_user",
        "notification_user_email",
        "notification_id",
        "client",
        "chat_postMessage",
        "channel",
        "SLACK_CHANNEL",
        "blocks",
        "slack_notification",
        "repository",
        "repository",
        "requests",
        "post",
        "ANCHORE_CLI_URL",
        "payload",
        "auth",
        "HTTPBasicAuth",
        "ANCHORE_CLI_USER",
        "ANCHORE_CLI_PASS",
        "response",
        "status_code",
        "ValueError",
        "response",
        "status_code",
        "response",
        "text",
        "response",
        "json",
        "image_id",
        "requests",
        "get",
        "ANCHORE_CLI_URL",
        "image_id",
        "auth",
        "HTTPBasicAuth",
        "ANCHORE_CLI_USER",
        "ANCHORE_CLI_PASS",
        "response",
        "status_code",
        "ValueError",
        "image_id",
        "response",
        "status_code",
        "response",
        "text",
        "response",
        "json",
        "tag",
        "requests",
        "get",
        "ANCHORE_CLI_URL",
        "tag",
        "auth",
        "HTTPBasicAuth",
        "ANCHORE_CLI_USER",
        "ANCHORE_CLI_PASS",
        "response",
        "status_code",
        "ValueError",
        "tag",
        "response",
        "status_code",
        "response",
        "text",
        "response",
        "json",
        "data",
        "aioredis",
        "create_redis_pool",
        "REDIS_URL",
        "password",
        "REDIS_PASS",
        "pickle",
        "dumps",
        "data",
        "redis",
        "xadd",
        "REDIS_STREAM",
        "fields",
        "ae",
        "redis",
        "close",
        "redis",
        "wait_closed",
        "app",
        "run",
        "host",
        "port",
        "debug"
    ],
    "literals": [
        "\"ANCHORE_CLI_USER\"",
        "\"admin\"",
        "\"ANCHORE_CLI_PASS\"",
        "\"ANCHORE_CLI_URL\"",
        "\"http://hooky-anchore-engine-api:8228/v1\"",
        "\"SLACK_CHANNEL\"",
        "\"SLACK_SIGNING_SECRET\"",
        "\"gunicorn.error\"",
        "\"/slack/events\"",
        "\"SLACK_API_TOKEN\"",
        "\"REDIS_URL\"",
        "\"redis://redis-master\"",
        "\"REDIS_PASS\"",
        "\"ae\"",
        "\":heavy_check_mark:\"",
        "\":x:\"",
        "\"message\"",
        "\"token\"",
        "\"team_id\"",
        "\"api_app_id\"",
        "\"event\"",
        "\"/healthz\"",
        "\"GET\"",
        "\"OK\"",
        "\"/\"",
        "\"POST\"",
        "\"payload\"",
        "\"container\"",
        "\"channel_id\"",
        "\"user\"",
        "\"id\"",
        "\"Not Implemented.\"",
        "\"\"",
        "\"/analyse_image\"",
        "\"POST\"",
        "\"token\"",
        "\"command\"",
        "\"text\"",
        "\"user_id\"",
        "\"Hello world!\"",
        "\"ok\"",
        "\"message\"",
        "\"text\"",
        "\"Hello world!\"",
        "\"\"",
        "\"/image_vulnerabilities\"",
        "\"POST\"",
        "\"token\"",
        "\"command\"",
        "\"text\"",
        "\"<\"",
        "\"\"",
        "\">\"",
        "\"\"",
        "\"|\"",
        "\"image_detail\"",
        "\"imageId\"",
        "\"vulnerabilities\"",
        "\"severity\"",
        "\"High\"",
        "\"severity\"",
        "\"Medium\"",
        "\"severity\"",
        "\"Low\"",
        "\"severity\"",
        "\"Negligible\"",
        "\"severity\"",
        "\"Unknown\"",
        "\"blocks\"",
        "\"type\"",
        "\"section\"",
        "\"text\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "\"*Vulnerability Report*\"",
        "\"text\"",
        "\"type\"",
        "\"plain_text\"",
        "\"text\"",
        "f\"{vulnerability['vuln']}\"",
        "'vuln'",
        "\"emoji\"",
        "\"value\"",
        "f\"{vulnerability['url']}\"",
        "'url'",
        "\"blocks\"",
        "\"type\"",
        "\"section\"",
        "\"text\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "\"High Vulnerabilities:\"",
        "\"accessory\"",
        "\"type\"",
        "\"static_select\"",
        "\"placeholder\"",
        "\"type\"",
        "\"plain_text\"",
        "\"text\"",
        "f\"Select a CVE\"",
        "\"emoji\"",
        "\"options\"",
        "\"blocks\"",
        "\"\"",
        "\"/add_repository\"",
        "\"POST\"",
        "\"token\"",
        "\"command\"",
        "\"text\"",
        "\"<\"",
        "\"\"",
        "\">\"",
        "\"\"",
        "\"|\"",
        "\"subscription_value\"",
        "\"blocks\"",
        "\"type\"",
        "\"section\"",
        "\"text\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "\"*Added Repository*\"",
        "\"type\"",
        "\"section\"",
        "\"fields\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Created At*:\\n{arrow.Arrow.fromtimestamp(ae['created_at'])}\"",
        "'created_at'",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Last Updated*:\\n{arrow.Arrow.fromtimestamp(ae['last_updated'])}\"",
        "'last_updated'",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Subscription Key*:\\n{ae['subscription_key']}\"",
        "'subscription_key'",
        "\"repotags\"",
        "\"repotags\"",
        "\"text\"",
        "\"type\"",
        "\"plain_text\"",
        "\"text\"",
        "f\"{tag}\"",
        "\"emoji\"",
        "\"value\"",
        "f\"{tag}\"",
        "\"blocks\"",
        "\"type\"",
        "\"section\"",
        "\"text\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "\"Discovered Tags:\"",
        "\"accessory\"",
        "\"type\"",
        "\"static_select\"",
        "\"placeholder\"",
        "\"type\"",
        "\"plain_text\"",
        "\"text\"",
        "f\"{repository}\"",
        "\"emoji\"",
        "\"options\"",
        "\"blocks\"",
        "\"type\"",
        "\"divider\"",
        "\"blocks\"",
        "\"type\"",
        "\"context\"",
        "\"elements\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*User*: {ae['userId']}\\n*Subscription ID*: {ae['subscription_id']}\"",
        "'userId'",
        "'subscription_id'",
        "\"blocks\"",
        "\"\"",
        "\"/general\"",
        "\"POST\"",
        "\"created_at\"",
        "\"data\"",
        "\"notification_user\"",
        "\"data\"",
        "\"notification_user_email\"",
        "\"data\"",
        "\"notification_type\"",
        "\"data\"",
        "\"notification_payload\"",
        "\"notificationId\"",
        "\"event\"",
        "\"level\"",
        "\"event\"",
        "\"message\"",
        "\"event\"",
        "\"details\"",
        "\"blocks\"",
        "\"type\"",
        "\"section\"",
        "\"text\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "\"*General Update*\"",
        "\"type\"",
        "\"section\"",
        "\"fields\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Created At*:\\n{arrow.Arrow.fromtimestamp(created_at)}\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Level*:\\n{level}\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Message*:\\n{message}\"",
        "\"result\"",
        "\"result\"",
        "\"updated_image_count\"",
        "\"result\"",
        "\"updated_record_count\"",
        "\"blocks\"",
        "\"type\"",
        "\"section\"",
        "\"fields\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Group*:\\n{details['result']['group']}\"",
        "'result'",
        "'group'",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Updated image count*:\\n{details['result']['updated_image_count']}\"",
        "'result'",
        "'updated_image_count'",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Status*:\\n{details['result']['status']}\"",
        "'result'",
        "'status'",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Updated record count*:\\n{details['result']['updated_record_count']}\"",
        "'result'",
        "'updated_record_count'",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Total time (seconds)*:\\n{details['result']['total_time_seconds']}\"",
        "'result'",
        "'total_time_seconds'",
        "\"blocks\"",
        "\"type\"",
        "\"divider\"",
        "\"blocks\"",
        "\"type\"",
        "\"context\"",
        "\"elements\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*User*: {notification_user} ({notification_user_email})\\n*ID*: {notification_id}\"",
        "\"\"",
        "\"/tag_update\"",
        "\"POST\"",
        "\"\"",
        "\"/policy_eval\"",
        "\"POST\"",
        "\"\"",
        "\"/error_event\"",
        "\"POST\"",
        "\"\"",
        "\"/analysis_update\"",
        "\"POST\"",
        "\"created_at\"",
        "\"data\"",
        "\"notification_user\"",
        "\"data\"",
        "\"notification_user_email\"",
        "\"data\"",
        "\"notification_type\"",
        "\"data\"",
        "\"notification_payload\"",
        "\"notificationId\"",
        "\"subscription_key\"",
        "\"curr_eval\"",
        "\"analysis_status\"",
        "\"last_eval\"",
        "\"analysis_status\"",
        "\"image_detail\"",
        "\"imageId\"",
        "\"blocks\"",
        "\"type\"",
        "\"section\"",
        "\"text\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Analysis Update*\"",
        "\"type\"",
        "\"section\"",
        "\"fields\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Subscription Key*:\\n{subscription_key}\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Current Evaluation*:\\n{current_analysis_status}\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Created At*:\\n{arrow.Arrow.fromtimestamp(created_at)}\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Last Evaluation*:\\n{last_analysis_status}\"",
        "\"vulnerabilities\"",
        "\"vulnerabilities\"",
        "\"severity\"",
        "\"High\"",
        "\"vulnerabilities\"",
        "\"severity\"",
        "\"Medium\"",
        "\"vulnerabilities\"",
        "\"severity\"",
        "\"Low\"",
        "\"vulnerabilities\"",
        "\"severity\"",
        "\"Negligible\"",
        "\"vulnerabilities\"",
        "\"severity\"",
        "\"Unknown\"",
        "\"blocks\"",
        "\"type\"",
        "\"section\"",
        "\"fields\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*Vulnerabilities*:\\nHigh: {len(high)}\\nMedium: {len(medium)}\\nLow: {len(low)}\\nNegligible: {len(negligible)}\\nUnknown: {len(unknown)}\"",
        "\"blocks\"",
        "\"type\"",
        "\"divider\"",
        "\"blocks\"",
        "\"type\"",
        "\"context\"",
        "\"elements\"",
        "\"type\"",
        "\"mrkdwn\"",
        "\"text\"",
        "f\"*User:* {notification_user} ({notification_user_email})\\n*ID:* {notification_id}\"",
        "\"blocks\"",
        "\"\"",
        "\"repository\"",
        "f\"{ANCHORE_CLI_URL}/repositories\"",
        "f\"POST /repositories {response.status_code} {response.text}\"",
        "f\"{ANCHORE_CLI_URL}/images/by_id/{image_id}/vuln/all\"",
        "f\"GET /images/by_id/{image_id}/vuln/all {response.status_code} {response.text}\"",
        "f\"{ANCHORE_CLI_URL}/images/\"",
        "\"fulltag\"",
        "f\"GET /images/?fulltag={tag} {response.status_code} {response.text}\"",
        "\"data\"",
        "\"__main__\"",
        "\"0.0.0.0\""
    ],
    "variables": [
        "ANCHORE_CLI_USER",
        "ANCHORE_CLI_PASS",
        "ANCHORE_CLI_URL",
        "SLACK_CHANNEL",
        "SLACK_SIGNING_SECRET",
        "app",
        "gunicorn_logger",
        "handlers",
        "slack_events_adapter",
        "client",
        "REDIS_URL",
        "REDIS_PASS",
        "REDIS_STREAM",
        "emoji",
        "emoji",
        "token",
        "team_id",
        "api_app_id",
        "data",
        "channel_id",
        "user_id",
        "response",
        "token",
        "command",
        "text",
        "response",
        "token",
        "command",
        "text",
        "high",
        "medium",
        "low",
        "negligible",
        "repository",
        "repository",
        "image",
        "vulnerabilities",
        "slack_notification",
        "slack_notification",
        "options",
        "response",
        "token",
        "command",
        "text",
        "repository",
        "repository",
        "ae",
        "subscription_value",
        "slack_notification",
        "slack_notification",
        "options",
        "response",
        "data",
        "created_at",
        "notification_user",
        "notification_user_email",
        "notification_type",
        "notification_payload",
        "notification_id",
        "level",
        "message",
        "details",
        "slack_notification",
        "slack_notification",
        "data",
        "data",
        "data",
        "data",
        "created_at",
        "notification_user",
        "notification_user_email",
        "notification_type",
        "notification_payload",
        "notification_id",
        "subscription_key",
        "current_evaluation",
        "current_analysis_status",
        "last_evaluation",
        "last_analysis_status",
        "image",
        "vulnerabilities",
        "slack_notification",
        "slack_notification",
        "high",
        "medium",
        "low",
        "negligible",
        "response",
        "payload",
        "payload",
        "response",
        "response",
        "response",
        "redis",
        "ae",
        "ae",
        "result"
    ],
    "comments": [
        "!/usr/bin/env python3",
        "Slack webhook action handler",
        "response_url = data[\"response_url\"]",
        "actions = data[\"actions\"]",
        "repository = actions[0][\"placeholder\"][\"text\"]",
        "tag = actions[0][\"selected_option\"][\"text\"][\"text\"]",
        "slack_notification[\"blocks\"].append({\"type\": \"divider\"})",
        "slack_notification[\"blocks\"].append({",
        "\"type\": \"context\",",
        "\"elements\": [",
        "{",
        "\"type\": \"mrkdwn\",",
        "\"text\": f\"*User*: {ae['userId']}\\n*Subscription ID*: {ae['subscription_id']}\"",
        "}",
        "]",
        "}",
        ")",
        "response = client.chat_postMessage(",
        "channel=SLACK_CHANNEL,",
        "blocks=slack_notification[\"blocks\"]",
        ")"
    ],
    "docstrings": [
        "\"\"\"\n    Anchore Engine General Update Slack notification webhook handler.\n    \"\"\"",
        "\"\"\"\n    Anchore Engine Tag Update Slack notification webhook handler.\n    \"\"\"",
        "\"\"\"\n    Anchore Engine Policy Eval Slack notification webhook handler.\n    \"\"\"",
        "\"\"\"\n    Anchore Engine Error Event Slack notification webhook handler.\n    \"\"\"",
        "\"\"\"\n    Anchore Engine Analysis Update Slack notification webhook handler.\n    \"\"\""
    ],
    "functions": [
        "get_emoji",
        "reaction_added",
        "healthz",
        "index",
        "analyse_image",
        "image_vulnerabilities",
        "add_repository",
        "general",
        "tag_update",
        "policy_eval",
        "error_event",
        "analysis_update",
        "_add_repository",
        "_get_image_vulnerabilities",
        "_get_image_by_tag",
        "redis_pool"
    ],
    "classes": []
}