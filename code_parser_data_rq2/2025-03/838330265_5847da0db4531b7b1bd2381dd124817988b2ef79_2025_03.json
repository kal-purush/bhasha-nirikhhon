{
    "identifiers": [
        "asyncio",
        "datetime",
        "datetime",
        "timedelta",
        "sqlalchemy",
        "and_",
        "db",
        "database",
        "FlatRecord",
        "get_db",
        "MonitoringTask",
        "core",
        "rabbitmq_client",
        "RabbitMQClient",
        "core",
        "config",
        "settings",
        "next",
        "get_db",
        "RabbitMQClient",
        "connect",
        "datetime",
        "now",
        "timedelta",
        "minutes",
        "settings",
        "DEFAULT_LAST_MINUTES_GETTING",
        "db",
        "query",
        "MonitoringTask",
        "MonitoringTask",
        "last_updated",
        "time_threshold",
        "all",
        "task",
        "tasks",
        "db",
        "query",
        "FlatRecord",
        "FlatRecord",
        "flat_url",
        "like",
        "task",
        "url",
        "task",
        "last_got_flat",
        "flats_query",
        "FlatRecord",
        "first_seen",
        "task",
        "last_got_flat",
        "all",
        "flats_query",
        "FlatRecord",
        "first_seen",
        "time_threshold",
        "all",
        "flats_to_send",
        "rabbit_client",
        "send_message",
        "exchange",
        "body",
        "task",
        "chat_id",
        "flat",
        "title",
        "flat",
        "price",
        "flat",
        "location",
        "flat",
        "created_at",
        "strftime",
        "flat",
        "image_url",
        "flat",
        "flat_url",
        "flat",
        "description",
        "flat",
        "flats_to_send",
        "datetime",
        "now",
        "datetime",
        "now",
        "db",
        "commit",
        "db",
        "close",
        "rabbit_client",
        "close_connection"
    ],
    "literals": [
        "f\"%{task.url}%\"",
        "\"flats\"",
        "\"type\"",
        "\"SEND_FLATS\"",
        "\"chat_id\"",
        "\"flats\"",
        "\"title\"",
        "\"price\"",
        "\"location\"",
        "\"created_at\"",
        "\"%H:%M\"",
        "\"image_url\"",
        "\"flat_url\"",
        "\"description\""
    ],
    "variables": [
        "db",
        "rabbit_client",
        "time_threshold",
        "tasks",
        "flats_query",
        "flats_to_send",
        "flats_to_send",
        "task",
        "last_updated",
        "task",
        "last_got_flat"
    ],
    "comments": [
        "checker.py",
        "Find users who haven't received updates in DEFAULT_LAST_MINUTES_GETTING",
        "Find flats for this user's URL that they haven't seen yet",
        "If they have a last_got_flat timestamp, only send flats newer than that",
        "Otherwise, send flats from the last DEFAULT_LAST_MINUTES_GETTING",
        "Send flats to RabbitMQ for the Telegram service to handle",
        "Update the last_updated and last_got_flat timestamps"
    ],
    "docstrings": [],
    "functions": [
        "check_and_send_flats"
    ],
    "classes": []
}