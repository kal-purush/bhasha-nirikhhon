{
    "identifiers": [
        "numpy",
        "np",
        "pandas",
        "pd",
        "helper",
        "construct_grouped_ts",
        "compute_individual_ts",
        "sklearn",
        "preprocessing",
        "OneHotEncoder",
        "LabelEncoder",
        "tensorflow",
        "keras",
        "models",
        "Model",
        "keras",
        "layers",
        "Input",
        "Dense",
        "LSTM",
        "Dropout",
        "Concatenate",
        "Embedding",
        "keras",
        "optimizers",
        "Adam",
        "keras",
        "regularizers",
        "l2",
        "calendar",
        "sales_train",
        "endog",
        "prices_df",
        "calendar",
        "copy",
        "sales_train",
        "copy",
        "endog",
        "copy",
        "prices_df",
        "copy",
        "construct_agg_endog",
        "prepare_dataset_encoder",
        "construct_grouped_ts",
        "sales_train",
        "endog",
        "agg_1",
        "agg_2",
        "drop_inactive",
        "return_ratio",
        "sales_train",
        "groupby",
        "size",
        "reset_index",
        "ratio_df",
        "agg_idx",
        "agg_endog",
        "copy",
        "ratio_df",
        "copy",
        "agg_sales_train",
        "copy",
        "agg_idx",
        "copy",
        "calendar",
        "sales_train",
        "prices_df",
        "agg_endog",
        "agg_idx",
        "agg_sales_train",
        "pd",
        "DataFrame",
        "index",
        "calendar",
        "index",
        "event_type",
        "format",
        "event_type",
        "np",
        "where",
        "calendar",
        "loc",
        "calendar_exog",
        "index",
        "event_type",
        "axis",
        "OneHotEncoder",
        "drop",
        "sparse",
        "pd",
        "DataFrame",
        "wday_encoder",
        "fit_transform",
        "calendar",
        "loc",
        "calendar_exog",
        "index",
        "columns",
        "format",
        "i",
        "i",
        "pd",
        "concat",
        "calendar_exog",
        "wday_df",
        "axis",
        "pd",
        "DataFrame",
        "index",
        "calendar",
        "index",
        "columns",
        "agg_endog",
        "columns",
        "idx",
        "snap_exog",
        "columns",
        "sales_train",
        "agg_idx",
        "idx",
        "state_id",
        "unique",
        "calendar",
        "loc",
        "snap_exog",
        "index",
        "format",
        "state",
        "pd",
        "DataFrame",
        "index",
        "calendar",
        "index",
        "columns",
        "agg_endog",
        "columns",
        "idx",
        "price_exog",
        "columns",
        "prices_df",
        "T",
        "loc",
        "agg_idx",
        "idx",
        "mean",
        "price_exog",
        "price_exog",
        "max",
        "calendar_exog",
        "snap_exog",
        "price_discount",
        "OneHotEncoder",
        "drop",
        "sparse",
        "fit",
        "agg_sales_train",
        "calendar",
        "fillna",
        "inplace",
        "LabelEncoder",
        "fit",
        "calendar",
        "dept_store_encoder",
        "event_encoder",
        "exog_index",
        "exog_cols",
        "np",
        "zeros",
        "exog_cols",
        "shape",
        "exog_index",
        "shape",
        "encoder_exog",
        "astype",
        "np",
        "float32",
        "exog_index",
        "exog_cols",
        "np",
        "repeat",
        "np",
        "array",
        "calendar_exog",
        "loc",
        "exog_index",
        "reshape",
        "exog_index",
        "shape",
        "repeats",
        "exog_cols",
        "shape",
        "axis",
        "np",
        "concatenate",
        "decoder_exog",
        "np",
        "array",
        "snap_exog",
        "loc",
        "exog_index",
        "exog_cols",
        "T",
        "reshape",
        "exog_cols",
        "shape",
        "axis",
        "np",
        "concatenate",
        "decoder_exog",
        "np",
        "array",
        "price_discount",
        "loc",
        "exog_index",
        "exog_cols",
        "T",
        "reshape",
        "exog_cols",
        "shape",
        "axis",
        "dept_store_encoder",
        "transform",
        "agg_sales_train",
        "loc",
        "exog_cols",
        "np",
        "repeat",
        "np",
        "expand_dims",
        "id_features",
        "axis",
        "repeats",
        "exog_index",
        "shape",
        "axis",
        "np",
        "concatenate",
        "decoder_exog",
        "id_features",
        "axis",
        "decoder_exog",
        "astype",
        "np",
        "float32",
        "exog_index",
        "exog_cols",
        "event_encoder",
        "transform",
        "calendar",
        "loc",
        "exog_index",
        "reshape",
        "np",
        "repeat",
        "event_name",
        "repeats",
        "exog_cols",
        "shape",
        "axis",
        "event_name",
        "num_layers",
        "num_units",
        "input_window",
        "output_window",
        "encoder_exog_size",
        "decoder_exog_size",
        "lr",
        "dropout_rate",
        "l2_regu",
        "l2",
        "model",
        "dataset_generator",
        "num_layers",
        "num_units",
        "input_window",
        "output_window",
        "encoder_exog_size",
        "decoder_exog_size",
        "lr",
        "dropout_rate",
        "l2_regu",
        "model",
        "dataset_generator",
        "num_layers",
        "num_units",
        "input_window",
        "output_window",
        "encoder_exog_size",
        "decoder_exog_size",
        "dropout_rate",
        "l2_regu",
        "Embedding",
        "input_dim",
        "output_dim",
        "mask_zero",
        "name",
        "Input",
        "shape",
        "input_window",
        "Input",
        "shape",
        "input_window",
        "encoder_exog_size",
        "Concatenate",
        "encoder_input",
        "encoder_exog_input",
        "i",
        "num_layers",
        "LSTM",
        "num_units",
        "i",
        "kernel_regularizer",
        "l2_regu",
        "recurrent_regularizer",
        "l2_regu",
        "dropout",
        "dropout_rate",
        "recurrent_dropout",
        "return_sequences",
        "return_state",
        "name",
        "format",
        "i",
        "i",
        "encoder_lstm",
        "encoder_concat_input",
        "encoder_lstm",
        "encoder_lstm_res",
        "i",
        "i",
        "encoder_lstm",
        "i",
        "encoder_lstm_outputs",
        "i",
        "encoder_lstm_state_h",
        "encoder_lstm_state_c",
        "Input",
        "shape",
        "output_window",
        "Input",
        "shape",
        "output_window",
        "decoder_exog_size",
        "Input",
        "shape",
        "output_window",
        "event_embed",
        "decoder_event_input",
        "Concatenate",
        "decoder_input",
        "decoder_exog_input",
        "decoder_event_embed",
        "i",
        "num_layers",
        "LSTM",
        "num_units",
        "i",
        "kernel_regularizer",
        "l2_regu",
        "recurrent_regularizer",
        "l2_regu",
        "dropout",
        "dropout_rate",
        "recurrent_dropout",
        "return_sequences",
        "return_state",
        "name",
        "format",
        "i",
        "i",
        "decoder_lstm",
        "decoder_concat_input",
        "initial_state",
        "encoder_lstm_res",
        "i",
        "decoder_lstm",
        "decoder_lstm_res",
        "i",
        "initial_state",
        "encoder_lstm_res",
        "i",
        "i",
        "decoder_lstm",
        "i",
        "decoder_lstm_outputs",
        "Dense",
        "activation",
        "kernel_regularizer",
        "l2_regu",
        "name",
        "decoder_lstm_outputs",
        "Model",
        "inputs",
        "encoder_input",
        "encoder_exog_input",
        "decoder_input",
        "decoder_exog_input",
        "decoder_event_input",
        "outputs",
        "decoder_output",
        "Adam",
        "learning_rate",
        "lr",
        "model",
        "compile",
        "optimizer",
        "adam",
        "loss",
        "model",
        "summary",
        "model",
        "model",
        "train_endog",
        "w",
        "sliding_freq",
        "input_window",
        "output_window",
        "np",
        "arange",
        "input_window",
        "train_endog",
        "shape",
        "output_window",
        "sliding_freq",
        "t",
        "timestamp",
        "train_endog",
        "iloc",
        "t",
        "input_window",
        "t",
        "output_window",
        "T",
        "dropna",
        "copy",
        "endog_slide",
        "np",
        "array",
        "endog_slide",
        "iloc",
        "reshape",
        "np",
        "arange",
        "endog_slide",
        "shape",
        "endog_slide",
        "iloc",
        "sample_batch_index",
        "input_window",
        "endog_slide",
        "iloc",
        "sample_batch_index",
        "input_window",
        "np",
        "zeros",
        "Y_endog",
        "shape",
        "dataset_generator",
        "load_encoder_exog",
        "X_endog",
        "columns",
        "X_endog",
        "index",
        "dataset_generator",
        "load_decoder_exog",
        "Y_endog",
        "columns",
        "Y_endog",
        "index",
        "dataset_generator",
        "load_event_name",
        "Y_endog",
        "columns",
        "Y_endog",
        "index",
        "X_endog_f",
        "append",
        "np",
        "array",
        "X_endog",
        "reshape",
        "input_window",
        "Y_endog_f",
        "append",
        "np",
        "array",
        "Y_endog",
        "reshape",
        "output_window",
        "X_decoder_f",
        "append",
        "X_decoder",
        "encoder_exog_f",
        "append",
        "encoder_exog",
        "decoder_exog_f",
        "append",
        "decoder_exog",
        "decoder_event_f",
        "append",
        "decoder_event",
        "w_f",
        "append",
        "np",
        "array",
        "w",
        "X_endog",
        "index",
        "np",
        "concatenate",
        "X_endog_f",
        "axis",
        "np",
        "concatenate",
        "Y_endog_f",
        "axis",
        "np",
        "concatenate",
        "X_decoder_f",
        "axis",
        "np",
        "concatenate",
        "encoder_exog_f",
        "axis",
        "np",
        "concatenate",
        "decoder_exog_f",
        "axis",
        "np",
        "concatenate",
        "decoder_event_f",
        "axis",
        "np",
        "concatenate",
        "w_f",
        "axis",
        "X_endog_f",
        "encoder_exog_f",
        "X_decoder_f",
        "decoder_exog_f",
        "decoder_event_f",
        "Y_endog_f",
        "w_f",
        "input_endog",
        "output_window",
        "np",
        "arange",
        "input_endog",
        "index",
        "input_endog",
        "index",
        "output_window",
        "input_endog",
        "T",
        "dropna",
        "copy",
        "X_endog",
        "index",
        "np",
        "array",
        "X_endog",
        "iloc",
        "reshape",
        "X_endog",
        "first_obs",
        "dataset_generator",
        "load_encoder_exog",
        "X_endog",
        "columns",
        "obs_items",
        "dataset_generator",
        "load_decoder_exog",
        "val_index",
        "obs_items",
        "dataset_generator",
        "load_event_name",
        "val_index",
        "obs_items",
        "np",
        "zeros",
        "X_endog",
        "shape",
        "output_window",
        "model",
        "predict",
        "np",
        "array",
        "X_endog",
        "reshape",
        "X_endog",
        "shape",
        "encoder_exog",
        "X_decoder",
        "decoder_exog",
        "decoder_event",
        "reshape",
        "output_window",
        "forecast",
        "first_obs",
        "pd",
        "DataFrame",
        "np",
        "NaN",
        "index",
        "val_index",
        "columns",
        "input_endog",
        "columns",
        "forecast",
        "T",
        "forecast_df"
    ],
    "literals": [
        "'dept_id'",
        "'store_id'",
        "'dept_id'",
        "'store_id'",
        "'Sporting'",
        "'Cultural'",
        "'National'",
        "'Religious'",
        "'is_{}'",
        "'event_type_1'",
        "'event_type_2'",
        "'first'",
        "'wday'",
        "'w7'",
        "'w{}'",
        "'snap_{}'",
        "'first'",
        "'dept_id'",
        "'store_id'",
        "'event_name_1'",
        "'missing'",
        "'event_name_1'",
        "'dept_id'",
        "'store_id'",
        "'event_name_1'",
        "'event_embed'",
        "'encoder_lstm_{}'",
        "'outputs'",
        "'model'",
        "'outputs'",
        "'states'",
        "'decoder_lstm_{}'",
        "'states'",
        "'outputs'",
        "'states'",
        "'model'",
        "'outputs'",
        "'decoder_output'",
        "'mse'"
    ],
    "variables": [
        "calendar",
        "sales_train",
        "endog",
        "prices_df",
        "agg_endog",
        "ratio_df",
        "agg_sales_train",
        "agg_idx",
        "agg_endog",
        "ratio_df",
        "agg_sales_train",
        "agg_idx",
        "calendar",
        "sales_train",
        "prices_df",
        "agg_endog",
        "agg_idx",
        "agg_sales_train",
        "calendar_exog",
        "calendar_exog",
        "wday_encoder",
        "wday_df",
        "calendar_exog",
        "snap_exog",
        "state",
        "snap_exog",
        "idx",
        "price_exog",
        "price_exog",
        "idx",
        "price_discount",
        "calendar_exog",
        "snap_exog",
        "price_discount",
        "dept_store_encoder",
        "event_encoder",
        "dept_store_encoder",
        "event_encoder",
        "encoder_exog",
        "decoder_exog",
        "decoder_exog",
        "decoder_exog",
        "id_features",
        "id_features",
        "decoder_exog",
        "event_name",
        "event_name",
        "num_layers",
        "num_units",
        "input_window",
        "output_window",
        "encoder_exog_size",
        "decoder_exog_size",
        "lr",
        "dropout_rate",
        "l2_regu",
        "model",
        "dataset_generator",
        "num_layers",
        "num_units",
        "input_window",
        "output_window",
        "encoder_exog_size",
        "decoder_exog_size",
        "dropout_rate",
        "l2_regu",
        "event_embed",
        "encoder_input",
        "encoder_exog_input",
        "encoder_concat_input",
        "encoder_lstm_res",
        "encoder_lstm",
        "encoder_lstm_outputs",
        "encoder_lstm_state_h",
        "encoder_lstm_state_c",
        "encoder_lstm_outputs",
        "encoder_lstm_state_h",
        "encoder_lstm_state_c",
        "encoder_lstm_res",
        "encoder_lstm_res",
        "encoder_lstm_res",
        "decoder_input",
        "decoder_exog_input",
        "decoder_event_input",
        "decoder_event_embed",
        "decoder_concat_input",
        "decoder_lstm_res",
        "decoder_lstm",
        "decoder_lstm_outputs",
        "_",
        "_",
        "decoder_lstm_outputs",
        "_",
        "_",
        "decoder_lstm_res",
        "decoder_lstm_res",
        "decoder_output",
        "model",
        "adam",
        "model",
        "input_window",
        "output_window",
        "timestamp",
        "X_endog_f",
        "Y_endog_f",
        "X_decoder_f",
        "encoder_exog_f",
        "decoder_exog_f",
        "decoder_event_f",
        "w_f",
        "endog_slide",
        "endog_slide",
        "sample_batch_index",
        "X_endog",
        "Y_endog",
        "X_decoder",
        "encoder_exog",
        "decoder_exog",
        "decoder_event",
        "X_endog_f",
        "Y_endog_f",
        "X_decoder_f",
        "encoder_exog_f",
        "decoder_exog_f",
        "decoder_event_f",
        "w_f",
        "output_window",
        "val_index",
        "X_endog",
        "obs_items",
        "first_obs",
        "encoder_exog",
        "decoder_exog",
        "decoder_event",
        "X_decoder",
        "forecast",
        "forecast_df",
        "forecast_df",
        "obs_items"
    ],
    "comments": [
        "indicator for dept_store_id",
        "Prepare exog dataset ---------------------------------------------------------------",
        "Prepare calendar exog: event_type & wday on a date",
        "drop Sat.",
        "Prepare snap_exog: if there is snap event on that date & dept_store ts",
        "Prepare price discount on that date & dept_store ts",
        "mean price across item_store for a dept_store ts",
        "normalized",
        "Prepare encoder ----------------------------------------------------------------------",
        "Create encoder for dept_store_id",
        "Create encoder for event name",
        "Append with id features",
        "Provide the load method for training & inference of model",
        "Define embedding layers (item_id, event_name), in case the embedding layers are applied to both encoder and decoder.",
        "Define encoder model",
        "endog input for encoder",
        "Define decoder model",
        "endog input for decoder. It is always a vector of 0s, meaning that model is trained unconditionally without using any forecast information.",
        "training mode of model",
        "remove the first obs as to remove trend",
        "decoder endog input, which is always 0 as training unconditionally",
        "store_item pair that has complete input",
        "remove the first obs to remove trend",
        "Add back the first obs"
    ],
    "docstrings": [
        "\"\"\"\nClass implementation for training LSTM on dept_store level\nThere are two types of data: endog (the historical time-series / lag-features) and exog (features other than lag-features)\nexog data is prepared through DatasetGeneratorDeptStore class\nendog data is prepared through agg_endog (on dept_store level)\n\nmodel is trained using VanillaLSTMDeptStore class, \nand is trained unconditionally (i.e. the decoder does not take any forecast value as input).\n\"\"\"",
        "\"\"\"\n    Provide exog dataset generation method (load_) for training & inference of VanillaLSTMDeptStore\n    \"\"\"",
        "\"\"\"\n        Construct agg_endog on dept_store level\n        \"\"\"",
        "\"\"\"\n        Prepare dataset and encoder for load methods\n        \"\"\"",
        "\"\"\"\n        Load encoder_exog at timestamp (exog_index), dept_stores (exog_columns).\n        encoder_exog with shape (n_ts, n_timestamp, n_features)\n        \n        Currently, no encoder exog is used for dept_store_level, thus is set all 0.\n        \"\"\"",
        "\"\"\"\n        Load decoder_exog at timestamp (exog_index), dept_stores (exog_columns).\n        decoder_exog with shape (n_ts, n_timestamp, n_features)\n        \"\"\"",
        "\"\"\"\n        Load event_id at timestamp (exog_index), dept_stores (exog_columns).\n        event_name with shape (n_ts, n_timestamp).\n        \"\"\"",
        "\"\"\"\n        Build Vanilla LSTM encoder-decoder network.\n        \"\"\"",
        "\"\"\"\n        Prepare full dataset for training\n        \"\"\"",
        "\"\"\"\n        Return forecast using input_endog.\n        \"\"\""
    ],
    "functions": [
        "construct_agg_endog",
        "prepare_dataset_encoder",
        "load_encoder_exog",
        "load_decoder_exog",
        "load_event_name",
        "build_model",
        "prepare_training_dataset",
        "get_forecast"
    ],
    "classes": [
        "DatasetGeneratorDeptStore",
        "VanillaLSTMDeptStore"
    ]
}