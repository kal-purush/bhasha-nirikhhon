{
    "identifiers": [
        "os",
        "subprocess",
        "sys",
        "time",
        "sonic_py_common",
        "logger",
        "swsscommon",
        "swsscommon",
        "logger",
        "Logger",
        "property",
        "config_db_connector",
        "swsscommon",
        "ConfigDBConnector",
        "config_db_connector",
        "connect",
        "config_db_connector",
        "property",
        "state_db_connector",
        "swsscommon",
        "SonicV2Connector",
        "host",
        "state_db_connector",
        "connect",
        "state_db_connector",
        "STATE_DB",
        "state_db_connector",
        "property",
        "config_db",
        "get_keys",
        "config_db",
        "get_entry",
        "localhost_key",
        "metadata",
        "metadata",
        "lower",
        "config_db",
        "get_table",
        "intf",
        "intf",
        "mux_cables",
        "mux_intfs",
        "index",
        "index",
        "zfill",
        "intf_mark",
        "cmd",
        "subprocess",
        "call",
        "cmd",
        "shell",
        "log",
        "log_info",
        "format",
        "cmd",
        "run_command",
        "intf",
        "mark",
        "run_command",
        "format",
        "intf",
        "mark",
        "intf",
        "mark",
        "state_db",
        "state_db",
        "STATE_DB",
        "intf",
        "mark",
        "is_dualtor",
        "clear_dhcp_packet_marks",
        "index",
        "intf",
        "get_mux_intfs",
        "generate_mark_from_index",
        "index",
        "apply_mark_in_ebtables",
        "intf",
        "mark",
        "update_mark_in_state_db",
        "intf",
        "mark",
        "log",
        "log_info",
        "MarkDhcpPacket",
        "mark_dhcp_packet",
        "apply_marks"
    ],
    "literals": [
        "'mark_dhcp_packet'",
        "'127.0.0.1'",
        "'DEVICE_METADATA'",
        "'DEVICE_METADATA'",
        "'subtype'",
        "'dualtor'",
        "'subtype'",
        "'MUX_CABLE'",
        "\"0x67\"",
        "\"run command: {}\"",
        "\"sudo ebtables -F INPUT\"",
        "\"sudo ebtables -A INPUT -i {} -j mark --mark-set {}\"",
        "'DHCP_PACKET_MARK'",
        "\"Finish marking dhcp packets in ebtables.\"",
        "'__main__'"
    ],
    "variables": [
        "log",
        "config_db_connector",
        "state_db_connector",
        "config_db_connector",
        "state_db_connector",
        "localhost_key",
        "metadata",
        "mux_cables",
        "mux_intfs",
        "intf_mark",
        "mark",
        "mark_dhcp_packet"
    ],
    "comments": [
        "!/usr/bin/env python3"
    ],
    "docstrings": [
        "\"\"\"\n    Class used to configure dhcp packet mark in ebtables\n    \"\"\"",
        "\"\"\"\n        Returns config DB connector.\n        Initializes the connector during the first call\n        \"\"\"",
        "\"\"\"\n        Returns the state DB connector.\n        Initializes the connector during the first call\n        \"\"\"",
        "\"\"\"\n        Checks if script is running on a dual ToR system\n        \"\"\"",
        "\"\"\"\n        Returns a list of mux cable interfaces\n        \"\"\"",
        "'''\n        type: string, format: hexadecimal\n        Example: 0x67001, 0x67002, ...\n        '''",
        "'''\n        Flush the INPUT chain in ebtables upon restart\n        '''",
        "\"\"\"\n        Writes dhcp packet marks in ebtables\n        \"\"\""
    ],
    "functions": [
        "config_db",
        "state_db",
        "is_dualtor",
        "get_mux_intfs",
        "generate_mark_from_index",
        "run_command",
        "clear_dhcp_packet_marks",
        "apply_mark_in_ebtables",
        "update_mark_in_state_db",
        "apply_marks"
    ],
    "classes": [
        "MarkDhcpPacket"
    ]
}