{
    "identifiers": [
        "Drawing",
        "Globalization",
        "IO",
        "Threading",
        "Windows",
        "Forms",
        "Microsoft",
        "PowerToys",
        "Telemetry",
        "MouseWithoutBorders",
        "Class",
        "MouseWithoutBorders",
        "Core",
        "DragDrop",
        "isDragging",
        "DragDrop",
        "isDragging",
        "value",
        "wParam",
        "Setting",
        "Values",
        "TransferFile",
        "wParam",
        "Common",
        "WM_LBUTTONDOWN",
        "MouseDown",
        "DragMachine",
        "MachineStuff",
        "desMachineID",
        "MachineStuff",
        "dropMachineID",
        "ID",
        "NONE",
        "Logger",
        "LogDebug",
        "wParam",
        "Common",
        "WM_LBUTTONUP",
        "MouseDown",
        "Logger",
        "LogDebug",
        "wParam",
        "Common",
        "WM_RBUTTONUP",
        "IsDropping",
        "IsDropping",
        "Common",
        "LastIDWithClipboardData",
        "ID",
        "NONE",
        "MachineStuff",
        "desMachineID",
        "Common",
        "MachineID",
        "Logger",
        "LogDebug",
        "Common",
        "DoSomethingInUIThread",
        "_",
        "NativeMethods",
        "PostMessage",
        "Common",
        "MainForm",
        "Handle",
        "NativeMethods",
        "WM_CHECK_EXPLORER_DRAG_DROP",
        "IntPtr",
        "IntPtr",
        "SendCheckExplorerDragDrop",
        "Logger",
        "LogDebug",
        "DATA",
        "Common",
        "RunOnLogonDesktop",
        "Common",
        "RunOnScrSaverDesktop",
        "Des",
        "Common",
        "MachineID",
        "Des",
        "ID",
        "ALL",
        "Logger",
        "LogDebug",
        "MachineStuff",
        "dropMachineID",
        "Src",
        "MouseDown",
        "IsDropping",
        "Logger",
        "LogDebug",
        "Common",
        "DoSomethingInUIThread",
        "_",
        "NativeMethods",
        "PostMessage",
        "Common",
        "MainForm",
        "Handle",
        "NativeMethods",
        "WM_CHECK_EXPLORER_DRAG_DROP",
        "IntPtr",
        "IntPtr",
        "IsDropping",
        "IntPtr",
        "NativeMethods",
        "FindWindow",
        "Common",
        "HELPER_FORM_TEXT",
        "h",
        "ToInt32",
        "_",
        "Interlocked",
        "Exchange",
        "dragDropStep05ExCalledByIpc",
        "Common",
        "MainForm",
        "Hide",
        "Common",
        "MainFormVisible",
        "_",
        "NativeMethods",
        "SetWindowPos",
        "h",
        "NativeMethods",
        "HWND_TOPMOST",
        "NativeMethods",
        "SWP_SHOWWINDOW",
        "i",
        "i",
        "dragDropStep05ExCalledByIpc",
        "Logger",
        "LogDebug",
        "_",
        "NativeMethods",
        "GetCursorPos",
        "p",
        "Logger",
        "LogDebug",
        "p",
        "X",
        "ToString",
        "CultureInfo",
        "CurrentCulture",
        "p",
        "Y",
        "ToString",
        "CultureInfo",
        "CurrentCulture",
        "_",
        "NativeMethods",
        "SetWindowPos",
        "h",
        "NativeMethods",
        "HWND_TOPMOST",
        "p",
        "X",
        "i",
        "p",
        "Y",
        "i",
        "_",
        "NativeMethods",
        "SendMessage",
        "h",
        "IntPtr",
        "Zero",
        "IntPtr",
        "Zero",
        "Sleep",
        "Application",
        "DoEvents",
        "Logger",
        "LogDebug",
        "Logger",
        "LogDebug",
        "Logger",
        "LogDebug",
        "dragFileName",
        "Logger",
        "LogDebug",
        "_",
        "Interlocked",
        "Exchange",
        "dragDropStep05ExCalledByIpc",
        "Common",
        "RunOnLogonDesktop",
        "Common",
        "RunOnScrSaverDesktop",
        "IsDropping",
        "_",
        "Common",
        "ImpersonateLoggedOnUserAndDoSomething",
        "IsNullOrEmpty",
        "dragFileName",
        "File",
        "Exists",
        "dragFileName",
        "Directory",
        "Exists",
        "dragFileName",
        "Common",
        "LastDragDropFile",
        "dragFileName",
        "MachineStuff",
        "dropMachineID",
        "ID",
        "NONE",
        "MachineStuff",
        "dropMachineID",
        "MachineStuff",
        "newDesMachineID",
        "DragDropStep06",
        "Logger",
        "LogDebug",
        "dragFileName",
        "_",
        "NativeMethods",
        "PostMessage",
        "Common",
        "MainForm",
        "Handle",
        "NativeMethods",
        "WM_HIDE_DD_HELPER",
        "IntPtr",
        "IntPtr",
        "Logger",
        "LogDebug",
        "dragFileName",
        "_",
        "NativeMethods",
        "PostMessage",
        "Common",
        "MainForm",
        "Handle",
        "NativeMethods",
        "WM_HIDE_DD_HELPER",
        "IntPtr",
        "IntPtr",
        "Logger",
        "LogDebug",
        "Logger",
        "LogDebug",
        "IsDropping",
        "Common",
        "MainFormVisible",
        "SendDropBegin",
        "MouseDown",
        "IsDragging",
        "Logger",
        "LogDebug",
        "SendClipboardBeatDragDrop",
        "SendDropBegin",
        "DATA",
        "Receiver",
        "GetNameOfMachineWithClipboardData",
        "Logger",
        "LogDebug",
        "DATA",
        "Des",
        "Common",
        "MachineID",
        "Common",
        "RunOnLogonDesktop",
        "Common",
        "RunOnScrSaverDesktop",
        "IsDropping",
        "MachineStuff",
        "dropMachineID",
        "Common",
        "MachineID",
        "Logger",
        "LogDebug",
        "wParam",
        "wParam",
        "Common",
        "WM_MOUSEMOVE",
        "IsDropping",
        "Common",
        "DoSomethingInUIThread",
        "_",
        "NativeMethods",
        "PostMessage",
        "Common",
        "MainForm",
        "Handle",
        "NativeMethods",
        "WM_SHOW_DRAG_DROP",
        "IntPtr",
        "IntPtr",
        "wParam",
        "Common",
        "WM_LBUTTONUP",
        "IsDropping",
        "IsDragging",
        "IsDropping",
        "DragDropStep10",
        "IsDragging",
        "Common",
        "LastIDWithClipboardData",
        "ID",
        "NONE",
        "Logger",
        "LogDebug",
        "IsDropping",
        "IsDragging",
        "Common",
        "LastIDWithClipboardData",
        "ID",
        "NONE",
        "Common",
        "DoSomethingInUIThread",
        "_",
        "NativeMethods",
        "PostMessage",
        "Common",
        "MainForm",
        "Handle",
        "NativeMethods",
        "WM_HIDE_DRAG_DROP",
        "IntPtr",
        "IntPtr",
        "PowerToysTelemetry",
        "Log",
        "WriteEvent",
        "MouseWithoutBorders",
        "Telemetry",
        "MouseWithoutBordersDragAndDropEvent",
        "Common",
        "GetRemoteClipboard",
        "Logger",
        "LogDebug",
        "SendClipboardBeatDragDropEnd",
        "IsDropping",
        "IsDragging",
        "DragMachine",
        "ID",
        "Common",
        "LastIDWithClipboardData",
        "ID",
        "NONE",
        "Common",
        "LastDragDropFile",
        "MouseDown",
        "Logger",
        "LogDebug",
        "IsDropping",
        "Common",
        "LastIDWithClipboardData",
        "ID",
        "NONE",
        "Common",
        "DoSomethingInUIThread",
        "_",
        "NativeMethods",
        "PostMessage",
        "Common",
        "MainForm",
        "Handle",
        "NativeMethods",
        "WM_HIDE_DRAG_DROP",
        "IntPtr",
        "IntPtr",
        "Type",
        "PackageType",
        "ExplorerDragDrop",
        "Src",
        "MachineStuff",
        "newDesMachineID",
        "Des",
        "MachineStuff",
        "desMachineID",
        "MachineName",
        "Common",
        "MachineName",
        "Common",
        "SkSend",
        "MachineStuff",
        "dropMachineID",
        "Common",
        "MachineID",
        "IsDropping",
        "SendClipboardBeatDragDropEnd",
        "MachineStuff",
        "newDesMachineID",
        "Common",
        "MachineID",
        "MachineStuff",
        "dropMachineID",
        "MachineStuff",
        "newDesMachineID",
        "SendDropBegin",
        "IsDropping",
        "Common",
        "SendPackage",
        "ID",
        "ALL",
        "PackageType",
        "ClipboardDragDrop",
        "Logger",
        "LogDebug",
        "Common",
        "SendPackage",
        "MachineStuff",
        "dropMachineID",
        "PackageType",
        "ClipboardDragDropOperation",
        "MachineStuff",
        "desMachineID",
        "Common",
        "MachineID",
        "Common",
        "SendPackage",
        "MachineStuff",
        "desMachineID",
        "PackageType",
        "ClipboardDragDropEnd",
        "DragDrop",
        "dragMachine",
        "DragDrop",
        "dragMachine",
        "value",
        "DragDrop",
        "isDropping",
        "DragDrop",
        "isDropping",
        "value"
    ],
    "literals": [
        "\"DragDropStep01: MouseDown\"",
        "\"DragDropStep01: MouseUp\"",
        "\"DragDropStep02: SendCheckExplorerDragDrop sent to myself\"",
        "\"DragDropStep02: SendCheckExplorerDragDrop sent\"",
        "\"DragDropStep03: ExplorerDragDrop Received.\"",
        "\"DragDropStep03: Mouse is down, check if dragging...sending WM_CHECK_EXPLORER_DRAG_DROP to myself...\"",
        "\"DragDropStep04: DragDropStep05ExCalledByIpc.\"",
        "\"DragDropStep04: Moving Mouse Without Borders Helper to (\"",
        "\", \"",
        "\")\"",
        "\"DragDropStep04: Mouse without Borders Helper not found!\"",
        "\"DragDropStep04: IsDropping == true, skip checking\"",
        "\"DragDropStep04: Got WM_CHECK_EXPLORER_DRAG_DROP, done with processing jump to DragDropStep05...\"",
        "\"DragDropStep05 called.\"",
        "\"DragDropStep05: File dragging: \"",
        "\"DragDropStep05: File not found: [\"",
        "\"]\"",
        "\"DragDropStep05: WM_HIDE_DDHelper sent\"",
        "\"DragDropStep05: IsDropping == true, change drop machine...\"",
        "\"DragDropStep06: SendClipboardBeatDragDrop\"",
        "\"DragDropStep08: ClipboardDragDrop Received. machine with drag file was set\"",
        "\"DragDropStep08_2: ClipboardDragDropOperation Received. IsDropping set\"",
        "\"DragDropStep10: Hide the form and get data...\"",
        "\"desktop\"",
        "\"DragDropStep11: Mouse drag coming back, canceling drag/drop\"",
        "\"DragDropStep12: ClipboardDragDropEnd received\"",
        "\"SendDropBegin...\""
    ],
    "variables": [
        "isDragging",
        "IsDragging",
        "dragDropStep05ExCalledByIpc",
        "IntPtr",
        "h",
        "Point",
        "p",
        "i",
        "DATA",
        "isDropping",
        "ID",
        "dragMachine",
        "ID",
        "DragMachine",
        "IsDropping",
        "MouseDown"
    ],
    "comments": [
        "Copyright (c) Microsoft Corporation",
        "The Microsoft Corporation licenses this file to you under the MIT license.",
        "See the LICENSE file in the project root for more information.",
        "Drag/Drop implementation.",
        "</summary>",
        "<history>",
        "2008 created by Truong Do (ductdo).",
        "2009-... modified by Truong Do (TruongDo).",
        "2023- Included in PowerToys.",
        "</history>",
        "Common.DragDrop.cs\n * Drag&Drop is one complicated implementation of the tool with some tricks.\n *\n * SEQUENCE OF EVENTS:\n * DragDropStep01: MachineX: Remember mouse down state since it could be a start of a dragging\n * DragDropStep02: MachineY: Send an message to the MachineX to ask it to check if it is\n *                           doing drag/drop\n * DragDropStep03: MachineX: Got explorerDragDrop, send WM_CHECK_EXPLORER_DRAG_DROP to its mainForm\n * DragDropStep04: MachineX: Show Mouse Without Borders Helper form at mouse cursor to get DragEnter event.\n * DragDropStepXX: MachineX: Mouse Without Borders Helper: Called by DragEnter, check if dragging a single file,\n *                           remember the file (set as its window caption)\n * DragDropStep05: MachineX: Get the file name from Mouse Without Borders Helper, hide Mouse Without Borders Helper window\n * DragDropStep06: MachineX: Broadcast a message saying that it has some drag file.\n * DragDropStep08: MachineY: Got ClipboardDragDrop, isDropping set, get the MachineX name from the package.\n * DragDropStep09: MachineY: Since isDropping is true, show up the drop form (looks like an icon).\n * DragDropStep10: MachineY: MouseUp, set isDropping to false, hide the drop \"icon\" and get data.\n * DragDropStep11: MachineX: Mouse move back without drop event, cancelling drag/dop\n *                           SendClipboardBeatDragDropEnd\n * DragDropStep12: MachineY: Hide the drop \"icon\" when received ClipboardDragDropEnd.\n *\n * FROM VERSION 1.6.3: Drag/Drop is temporary removed, Drop action cannot be done from a lower integrity app to a higher one.\n * We have to run a helper process...\n * http://forums.microsoft.com/MSDN/ShowPost.aspx?PageIndex=1&SiteID=1&PageID=1&PostID=736086\n *\n * 2008.10.28: Trying to restore the Drag/Drop feature by adding the drag/drop helper process. Coming in version\n * 1.6.5\n *",
        "Drop machine is the machine that sent ExplorerDragDrop",
        "NativeMethods.SetWindowText(h, \"\");",
        "WM_PAINT",
        "if (GetText(h).Length > 1) break;",
        "WM_HIDE_DRAG_DROP",
        "To dropMachineID set in DragDropStep03",
        "Show/Move form",
        "Hide form, get data",
        "desMachineID = current drop machine",
        "newDesMachineID = new drop machine",
        "1. Cancelling dropping in current drop machine",
        "Drag/Drop coming through me",
        "Drag/Drop coming back",
        "2. SendClipboardBeatDragDrop to new drop machine",
        "new drop machine is not me",
        "New drop machine is me"
    ],
    "docstrings": [
        "<summary>",
        "* possibleDropMachineID is used as desID sent in DragDropStep06();\n                     *",
        "* package.src = newDesMachineID:\n         * sent from the master machine but the src must be the\n         * new des machine since the previous des machine will get this and set\n         * to possibleDropMachineID in DragDropStep3()\n         *"
    ],
    "functions": [
        "DragDropStep01",
        "DragDropStep02",
        "DragDropStep03",
        "DragDropStep04",
        "DragDropStep05Ex",
        "DragDropStep06",
        "DragDropStep08",
        "DragDropStep08_2",
        "DragDropStep09",
        "DragDropStep10",
        "DragDropStep11",
        "DragDropStep12",
        "SendCheckExplorerDragDrop",
        "ChangeDropMachine",
        "SendClipboardBeatDragDrop",
        "SendDropBegin",
        "SendClipboardBeatDragDropEnd"
    ],
    "classes": [
        "DragDrop"
    ]
}