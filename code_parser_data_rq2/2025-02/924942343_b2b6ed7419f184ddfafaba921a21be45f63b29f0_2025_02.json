{
    "identifiers": [
        "os",
        "argparse",
        "json",
        "glob",
        "numpy",
        "np",
        "json",
        "h5py",
        "pandas",
        "pd",
        "concurrent",
        "futures",
        "scipy",
        "io",
        "sio",
        "tifffile",
        "imread",
        "matplotlib",
        "pyplot",
        "plt",
        "scipy",
        "stats",
        "pearsonr",
        "scipy",
        "io",
        "sio",
        "file_path",
        "file_type",
        "file_type",
        "h5py",
        "File",
        "file_path",
        "h5_file",
        "h5_file",
        "keys",
        "h5_file",
        "h5_file",
        "keys",
        "h5_file",
        "h5_file",
        "h5_file",
        "h5_file",
        "keys",
        "h5_file",
        "h5_file",
        "keys",
        "h5_file",
        "h5_file",
        "h5_file",
        "file_type",
        "sio",
        "loadmat",
        "file_path",
        "mat_contents",
        "data_key",
        "structured_array",
        "ravel",
        "structured_array",
        "ravel",
        "ValueError",
        "file_type",
        "motion_c_data",
        "motion_r_data",
        "e",
        "file_path",
        "e",
        "file_type",
        "data_dir",
        "file_type",
        "folder",
        "sorted",
        "os",
        "listdir",
        "data_dir",
        "folder",
        "isdigit",
        "os",
        "path",
        "join",
        "data_dir",
        "folder",
        "os",
        "path",
        "isdir",
        "folder_path",
        "folder",
        "file",
        "os",
        "listdir",
        "folder_path",
        "os",
        "path",
        "join",
        "folder_path",
        "file",
        "file",
        "endswith",
        "file",
        "folder_path",
        "lower",
        "folder_path",
        "lower",
        "imread",
        "file_path",
        "tiff_data",
        "e",
        "file_path",
        "e",
        "file",
        "endswith",
        "process_alignment_data",
        "file_path",
        "file_type",
        "file",
        "endswith",
        "process_alignment_data",
        "file_path",
        "file_type",
        "tiff_dict",
        "aData_dict",
        "data_dict",
        "folder_index",
        "motion_c_data",
        "motion_r_data",
        "data_dict",
        "items",
        "np",
        "sqrt",
        "np",
        "abs",
        "motion_c_data",
        "np",
        "abs",
        "motion_r_data",
        "result",
        "result_dict",
        "combined_motion_dict",
        "folder_index",
        "motion_total",
        "combined_motion_dict",
        "items",
        "np",
        "percentile",
        "motion_total",
        "np",
        "argwhere",
        "motion_total",
        "top_5_percentile",
        "flatten",
        "np",
        "unique",
        "top_5_indices",
        "unique_indices",
        "tolist",
        "unique_indices_dict",
        "data_dir",
        "folder_name",
        "file_extension",
        "os",
        "path",
        "join",
        "data_dir",
        "folder_name",
        "os",
        "path",
        "isdir",
        "folder_path",
        "read_tiff_h5_aData",
        "folder_path",
        "file_extension",
        "compute_euclidean_norm",
        "aData_dict",
        "compute_percentiles",
        "motion_total_dict",
        "top_5_indices_dict",
        "tiff_dict",
        "src",
        "dst",
        "folder_names",
        "folder",
        "ext",
        "folder_names",
        "items",
        "os",
        "path",
        "join",
        "src",
        "folder",
        "os",
        "path",
        "isdir",
        "folder_path",
        "ext",
        "ext",
        "startswith",
        "ext",
        "f",
        "endswith",
        "ext",
        "f",
        "os",
        "listdir",
        "folder_path",
        "os",
        "path",
        "isfile",
        "os",
        "path",
        "join",
        "folder_path",
        "f",
        "valid_folders",
        "add",
        "folder",
        "root",
        "dirs",
        "files",
        "os",
        "walk",
        "src",
        "os",
        "path",
        "relpath",
        "root",
        "src",
        "rel_path",
        "startswith",
        "folder",
        "folder",
        "valid_folders",
        "os",
        "path",
        "join",
        "dst",
        "rel_path",
        "os",
        "makedirs",
        "dest_dir",
        "exist_ok",
        "data_dir",
        "output_path",
        "copy_folder_structure",
        "data_dir",
        "output_path",
        "folder_names",
        "os",
        "path",
        "basename",
        "x",
        "x",
        "glob",
        "glob",
        "os",
        "path",
        "join",
        "data_dir",
        "os",
        "path",
        "isdir",
        "x",
        "folder",
        "ext",
        "folder_names",
        "items",
        "folder",
        "found_folders",
        "os",
        "path",
        "join",
        "data_dir",
        "folder",
        "methods_indices",
        "folder",
        "tiff_indices",
        "folder",
        "process_folder",
        "data_dir",
        "folder",
        "ext",
        "method_name",
        "indices_dict",
        "methods_indices",
        "items",
        "isinstance",
        "indices_dict",
        "label",
        "value",
        "indices_dict",
        "items",
        "label",
        "all_indices",
        "all_indices",
        "label",
        "append",
        "value",
        "indices_dict",
        "key",
        "values",
        "all_indices",
        "items",
        "item",
        "sublist",
        "values",
        "item",
        "sublist",
        "np",
        "unique",
        "merged_array",
        "key",
        "value",
        "value",
        "values",
        "key",
        "values",
        "unique_indices",
        "items",
        "folder",
        "indices",
        "tiff_indices",
        "items",
        "index",
        "tiff_array",
        "indices",
        "items",
        "mean_registered_movies",
        "folder",
        "np",
        "nanmean",
        "tiff_array",
        "axis",
        "frames_with_motion",
        "folder",
        "tiff_array",
        "unique_indices",
        "index",
        "folder",
        "indices",
        "frames_with_motion",
        "items",
        "index",
        "frames",
        "indices",
        "items",
        "frame",
        "frames",
        "pearsonr",
        "np",
        "nan_to_num",
        "mean_registered_movies",
        "folder",
        "index",
        "flatten",
        "nan",
        "np",
        "nan_to_num",
        "frame",
        "flatten",
        "nan",
        "correlation_values",
        "append",
        "correl_temp",
        "correlation_results",
        "folder",
        "np",
        "mean",
        "correlation_values",
        "os",
        "path",
        "join",
        "output_path",
        "folder",
        "index",
        "os",
        "makedirs",
        "save_dir",
        "exist_ok",
        "plt",
        "figure",
        "plt",
        "hist",
        "correlation_values",
        "bins",
        "edgecolor",
        "plt",
        "title",
        "folder",
        "index",
        "plt",
        "xlabel",
        "plt",
        "ylabel",
        "os",
        "path",
        "join",
        "save_dir",
        "plt",
        "savefig",
        "histogram_file",
        "plt",
        "close",
        "os",
        "path",
        "join",
        "save_dir",
        "open",
        "correl_temp_file",
        "f",
        "json",
        "dump",
        "correlation_values",
        "f",
        "os",
        "path",
        "join",
        "save_dir",
        "open",
        "corr_results_file",
        "f",
        "json",
        "dump",
        "correlation_results",
        "f",
        "correlation_values",
        "plt",
        "figure",
        "plt",
        "hist",
        "correlation_across_methods",
        "folder",
        "bins",
        "edgecolor",
        "np",
        "mean",
        "correlation_across_methods",
        "folder",
        "plt",
        "title",
        "folder",
        "correlation_across_methods_mean",
        "plt",
        "xlabel",
        "plt",
        "ylabel",
        "os",
        "path",
        "join",
        "output_path",
        "folder",
        "plt",
        "savefig",
        "histogram_file",
        "plt",
        "close",
        "argparse",
        "ArgumentParser",
        "parser",
        "add_argument",
        "required",
        "help",
        "parser",
        "add_argument",
        "help",
        "parser",
        "parse_args",
        "run",
        "args",
        "input",
        "args",
        "output"
    ],
    "literals": [
        "'h5'",
        "'r'",
        "'MotionC'",
        "'MotionC'",
        "'C'",
        "'C'",
        "'aData/motionC'",
        "'aData/motionC'",
        "'MotionR'",
        "'MotionR'",
        "'R'",
        "'R'",
        "'aData/motionR'",
        "'aData/motionR'",
        "'mat'",
        "'aData'",
        "'motionC'",
        "'motionR'",
        "f\"Unsupported file type: {file_type}\"",
        "f\"Error reading {file_path}: {e}\"",
        "'h5'",
        "'mat'",
        "'.tif'",
        "'.tiff'",
        "\"DOWNSAMPLED\"",
        "\"suite2p\"",
        "\"caiman\"",
        "f\"Error reading TIFF file {file_path}: {e}\"",
        "'.h5'",
        "'_ALIGNMENTDATA.mat'",
        "f\".{ext}\"",
        "'.'",
        "'suite2p'",
        "'h5'",
        "'caiman_stripCaiman'",
        "'h5'",
        "'stripRegisteration_matlab'",
        "'mat'",
        "'stripRegisteration'",
        "'h5'",
        "\"Folder structure copied to output directory.\"",
        "'*'",
        "f\"Warning: Expected dict but got {type(indices_dict)}\"",
        "'black'",
        "f'Histogram - Method: {folder}, Simulation: {index}'",
        "'Intensity'",
        "'Frequency'",
        "'histogram.png'",
        "'correlation.json'",
        "'w'",
        "'correlation_results.json'",
        "'w'",
        "'black'",
        "f'Histogram - Method: {folder}, Mean: {correlation_across_methods_mean:.2f}'",
        "'Intensity'",
        "'Frequency'",
        "'histogram.png'",
        "\"__main__\"",
        "\"-i\"",
        "\"--input\"",
        "\"Input to the folder that contains tiff files.\"",
        "\"-o\"",
        "\"--output\"",
        "\"../results/\"",
        "\"Output folder to save the results.\""
    ],
    "variables": [
        "motion_c_data",
        "motion_r_data",
        "motion_c_data",
        "motion_c_data",
        "motion_c_data",
        "motion_r_data",
        "motion_r_data",
        "motion_r_data",
        "mat_contents",
        "data_key",
        "structured_array",
        "motion_c_data",
        "motion_r_data",
        "tiff_dict",
        "aData_dict",
        "folder_path",
        "folder_num",
        "file_path",
        "tiff_data",
        "tiff_dict",
        "folder_num",
        "aData_dict",
        "folder_num",
        "aData_dict",
        "folder_num",
        "result_dict",
        "result",
        "result_dict",
        "folder_index",
        "unique_indices_dict",
        "top_5_percentile",
        "top_5_indices",
        "unique_indices",
        "unique_indices_dict",
        "folder_index",
        "folder_path",
        "tiff_dict",
        "aData_dict",
        "motion_total_dict",
        "top_5_indices_dict",
        "valid_folders",
        "folder_path",
        "ext",
        "rel_path",
        "dest_dir",
        "folder_names",
        "found_folders",
        "methods_indices",
        "tiff_indices",
        "folder_path",
        "all_indices",
        "all_indices",
        "label",
        "unique_indices",
        "merged_array",
        "unique_indices",
        "key",
        "unique_values",
        "mean_registered_movies",
        "frames_with_motion",
        "mean_registered_movies",
        "folder",
        "frames_with_motion",
        "folder",
        "index",
        "index",
        "correlation_results",
        "correlation_across_methods",
        "correlation_results",
        "folder",
        "correlation_across_methods",
        "folder",
        "correlation_values",
        "correl_temp",
        "_",
        "index",
        "save_dir",
        "histogram_file",
        "correl_temp_file",
        "corr_results_file",
        "correlation_across_methods",
        "folder",
        "correlation_across_methods_mean",
        "histogram_file",
        "parser",
        "args"
    ],
    "comments": [
        "Common function to process .h5 and .mat files",
        "Initialize variables",
        "Process .h5 file",
        "Check for MotionC at different levels",
        "Check for aData/motionC",
        "Check for MotionR at different levels",
        "Check for aData/motionR",
        "Process .mat file",
        "Assuming the structured array is stored under 'aData'",
        "Adjust this if the key is different",
        "Access the structured array",
        "Extract motionC and motionR",
        "Skip non-numeric folders immediately",
        "Ensure it's a directory",
        "Convert folder name to integer for dictionary keys",
        "Full path to the file",
        "Check for TIFF files",
        "print('tiff_data:', folder, tiff_data.shape)",
        "print('[DEBUG]:', data_dict.items())",
        "Initialize the output dictionary",
        "Iterate through each folder in the dictionary",
        "Compute the desired formula for each element",
        "MotionC and MotionR is combined to single array",
        "Store the result in the output dictionary",
        "Return the final result dictionary after processing all items",
        "Initialize a dictionary to store unique indices",
        "Process each folder",
        "Compute the 95th percentile",
        "Extract indices of values above or equal to the 95th percentile",
        "Compute unique indices",
        "Store unique indices in the dictionary",
        "Convert to list for readability",
        "1. Extract tiff and alignment data (motionC and motionR)",
        "2. Combine motionC and motionR by  normalized Euclidean norm by computing the magnitude of a vector with the two components",
        "3. Get the top 5% with the highest motion",
        "Validate which folders contain at least one file of the specified type",
        "Copy directory structure for valid folders and their subdirectories",
        "Create output directory",
        "if not os.path.exists(output_path):",
        "print(\"Creating output directory...\")",
        "os.makedirs(output_path)",
        "Copy folder structure from input to output",
        "Use glob to find directories matching the names",
        "Group indices by their tif folder id",
        "Get unique indices for each movie across different registeration methods",
        "Extract unique values for each group",
        "Compute mean and get frames with highest motion for each registered movie of each method",
        "print(folder,index, tiff_array.shape)",
        "print('tiff_array[unique_indices[index], :, :]', tiff_array[unique_indices[index], :, :].shape)",
        "Compute correlation between mean registered movies and frames with motion using Pearson correlation",
        "Compute Pearson correlation between flattened arrays after replacing nan's",
        "Iterate through 616 frames",
        "print('Correlation values for', folder, ':', len(correlation_values), '\\n')",
        "Store the mean value of correl_temp (the correlation coefficient and p-value) in your results",
        "Construct the directory for this folder and index",
        "Plot the histogram for the flattened frame data",
        "Save the histogram to the designated file path",
        "Save the correl_temp values as JSON; correl_temp is a tuple so it will be stored as a list in JSON",
        "Save the correlation_results dictionary as JSON within the same folder.",
        "Here we write the full correlation_results dict; if you prefer only the latest folder's data,",
        "you could dump correlation_results[folder] instead.",
        "Plot the histogram for the flattened frame data",
        "have mean of correlation values as title",
        "Save the histogram to the designated file path",
        "Create argument parser",
        "Parse the arguments",
        "Assign the parsed arguments to params dictionary"
    ],
    "docstrings": [
        "\"\"\"\n    Process a file (.h5 or .mat) to extract MotionC, MotionR, and metadata.\n\n    Args:\n        file_path (str): Path to the file.\n        sim_description (str): Simulation description or folder name.\n        file_type (str): Type of the file ('h5' or 'mat').\n        model_name (str, optional): Model name for .h5 files.\n\n    Returns:\n        tuple: (sim_description, motionC, motionR, metadata, model_name)\n    \"\"\"",
        "\"\"\"\n    Reads TIFF files and alignment data from a directory structure.\n\n    Args:\n        data_dir (str): Path to the main directory containing subfolders.\n        file_type (str): File type for alignment data processing ('h5' or 'mat').\n\n    Returns:\n        tuple: A tuple containing two dictionaries:\n            - tiff_dict (dict): Dictionary of TIFF data, with folder number as keys.\n            - aData_dict (dict): Dictionary of alignment data, with folder number as keys.\n    \"\"\""
    ],
    "functions": [
        "process_alignment_data",
        "read_tiff_h5_aData",
        "compute_euclidean_norm",
        "compute_percentiles",
        "process_folder",
        "copy_folder_structure",
        "run"
    ],
    "classes": []
}