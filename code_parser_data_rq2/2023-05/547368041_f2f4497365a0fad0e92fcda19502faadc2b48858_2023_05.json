{
    "identifiers": [
        "numpy",
        "np",
        "h5py",
        "scipy",
        "interpolate",
        "scipy",
        "integrate",
        "scipy",
        "stats",
        "kstest",
        "scipy",
        "optimize",
        "opt",
        "matplotlib",
        "pyplot",
        "plt",
        "os",
        "errno",
        "file",
        "run",
        "thr",
        "isinstance",
        "file",
        "h5py",
        "_hl",
        "files",
        "File",
        "file",
        "run",
        "run",
        "run",
        "isinstance",
        "thr",
        "isinstance",
        "thr",
        "file",
        "attrs",
        "items",
        "atr",
        "file",
        "file",
        "file",
        "file",
        "np",
        "exp",
        "file",
        "np",
        "exp",
        "file",
        "m1_pdf",
        "m2_pdf",
        "np",
        "exp",
        "file",
        "np",
        "sqrt",
        "omega_m",
        "z",
        "omega_m",
        "c",
        "z",
        "H0",
        "A",
        "z_pdf",
        "dL_dif",
        "m1",
        "m2",
        "m1",
        "m2",
        "m1",
        "m2",
        "z",
        "m1",
        "z",
        "m2",
        "z",
        "m1",
        "m2",
        "m1",
        "z",
        "m2",
        "z",
        "m1",
        "m2",
        "m1",
        "m2",
        "mu",
        "Mtot",
        "file",
        "snr",
        "thr",
        "found_snr",
        "found_any",
        "sum",
        "dL",
        "dLmid",
        "emax",
        "gamma",
        "delta",
        "alpha",
        "dL",
        "dLmid",
        "frac",
        "alpha",
        "np",
        "exp",
        "gamma",
        "frac",
        "delta",
        "frac",
        "emax",
        "denom",
        "m1_det",
        "m2_det",
        "cte",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "cte",
        "Mc",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "cte",
        "a_20",
        "M",
        "a_01",
        "eta",
        "a_21",
        "M",
        "eta",
        "a_30",
        "M",
        "a_10",
        "M",
        "pol",
        "Mc",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "cte",
        "a_20",
        "M",
        "a_01",
        "eta",
        "a_21",
        "M",
        "eta",
        "a_30",
        "M",
        "a_sqrt",
        "M",
        "pol",
        "Mc",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "cte",
        "a_20",
        "M",
        "a_01",
        "eta",
        "a_21",
        "M",
        "eta",
        "a_30",
        "M",
        "a_10",
        "M",
        "a_11",
        "M",
        "eta",
        "pol",
        "Mc",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "cte",
        "a_20",
        "M",
        "a_01",
        "eta",
        "a_21",
        "M",
        "eta",
        "a_30",
        "M",
        "pol",
        "Mc",
        "power_param",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "cte",
        "a_20",
        "M",
        "a_01",
        "eta",
        "a_21",
        "M",
        "eta",
        "a_30",
        "M",
        "a_10",
        "M",
        "a_11",
        "M",
        "eta",
        "pol",
        "Mc",
        "np",
        "exp",
        "M",
        "Mstar",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "cte",
        "a_20",
        "M",
        "a_01",
        "eta",
        "a_21",
        "M",
        "eta",
        "a_10",
        "M",
        "a_11",
        "M",
        "eta",
        "pol",
        "Mc",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "np",
        "exp",
        "b_0",
        "b_1",
        "Mtot",
        "b_2",
        "Mtot",
        "m1_det",
        "m2_det",
        "m1_det",
        "m2_det",
        "np",
        "exp",
        "b_0",
        "L",
        "np",
        "exp",
        "k",
        "Mtot",
        "M_0",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "emax_fun",
        "getattr",
        "Found_injections",
        "dmid_fun",
        "m1",
        "z",
        "m2",
        "z",
        "emax_fun",
        "shape_params",
        "shape_params",
        "shape_params",
        "np",
        "sum",
        "sigmoid",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "dmid_params",
        "emax",
        "gamma",
        "delta",
        "getattr",
        "Found_injections",
        "emax_fun",
        "shape_params",
        "shape_params",
        "shape_params",
        "np",
        "sum",
        "sigmoid",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "dmid_params",
        "emax",
        "m1_det",
        "m2_det",
        "emax_params",
        "gamma",
        "delta",
        "Nexp",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "emax_fun",
        "dL",
        "found_any",
        "dL_pdf",
        "found_any",
        "m_pdf",
        "found_any",
        "z",
        "found_any",
        "m1",
        "found_any",
        "m2",
        "found_any",
        "m1",
        "z",
        "m2",
        "z",
        "getattr",
        "Found_injections",
        "dmid_fun",
        "emax_fun",
        "shape_params",
        "shape_params",
        "shape_params",
        "sigmoid",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "dmid_params",
        "emax",
        "gamma",
        "delta",
        "m_pdf",
        "dL_pdf",
        "Ntotal",
        "getattr",
        "Found_injections",
        "emax_fun",
        "shape_params",
        "shape_params",
        "shape_params",
        "sigmoid",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "dmid_params",
        "emax",
        "m1_det",
        "m2_det",
        "emax_params",
        "gamma",
        "delta",
        "m_pdf",
        "dL_pdf",
        "Ntotal",
        "lamda",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "emax_fun",
        "Nexp",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "emax_fun",
        "np",
        "sum",
        "np",
        "log",
        "lamda",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "emax_fun",
        "lnL",
        "methods",
        "dmid_fun",
        "dmid_params_guess",
        "shape_params",
        "emax_fun",
        "opt",
        "minimize",
        "fun",
        "in_param",
        "logL",
        "dmid_fun",
        "in_param",
        "shape_params",
        "emax_fun",
        "x0",
        "np",
        "array",
        "dmid_params_guess",
        "args",
        "method",
        "methods",
        "res",
        "x",
        "res",
        "fun",
        "params_res",
        "min_likelihood",
        "methods",
        "dmid_fun",
        "dmid_params",
        "shape_params_guess",
        "opt",
        "minimize",
        "fun",
        "in_param",
        "logL",
        "dmid_fun",
        "dmid_params",
        "in_param",
        "x0",
        "np",
        "array",
        "shape_params_guess",
        "args",
        "method",
        "methods",
        "res",
        "x",
        "res",
        "fun",
        "gamma",
        "delta",
        "emax",
        "min_likelihood",
        "methods",
        "dmid_fun",
        "dmid_params",
        "shape_params_guess",
        "emax_fun",
        "opt",
        "minimize",
        "fun",
        "in_param",
        "logL",
        "dmid_fun",
        "dmid_params",
        "in_param",
        "emax_fun",
        "x0",
        "np",
        "array",
        "shape_params_guess",
        "args",
        "method",
        "methods",
        "res",
        "x",
        "res",
        "fun",
        "opt_params",
        "min_likelihood",
        "methods",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "emax_fun",
        "precision",
        "np",
        "zeros",
        "np",
        "zeros",
        "len",
        "dmid_params",
        "np",
        "zeros",
        "len",
        "shape_params",
        "emax_fun",
        "shape_params",
        "i",
        "MLE_dmid",
        "methods",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "emax_fun",
        "np",
        "vstack",
        "all_dmid_params",
        "dmid_params",
        "emax_fun",
        "MLE_shape",
        "methods",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "all_gamma",
        "append",
        "gamma_opt",
        "all_delta",
        "append",
        "delta_opt",
        "all_emax",
        "append",
        "emax_opt",
        "np",
        "append",
        "total_lnL",
        "maxL_2",
        "gamma_opt",
        "delta_opt",
        "emax_opt",
        "emax_fun",
        "MLE_emax",
        "methods",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "emax_fun",
        "shape_params",
        "shape_params",
        "all_gamma",
        "append",
        "gamma_opt",
        "all_delta",
        "append",
        "delta_opt",
        "np",
        "vstack",
        "all_emax_params",
        "params_emax",
        "np",
        "append",
        "total_lnL",
        "maxL_2",
        "maxL_2",
        "np",
        "abs",
        "total_lnL",
        "i",
        "total_lnL",
        "i",
        "np",
        "abs",
        "total_lnL",
        "i",
        "total_lnL",
        "i",
        "precision",
        "precision",
        "i",
        "np",
        "total_lnL",
        "emax_fun",
        "np",
        "column_stack",
        "all_gamma",
        "all_delta",
        "all_emax",
        "total_lnL",
        "run",
        "dmid_fun",
        "np",
        "savetxt",
        "run",
        "dmid_fun",
        "shape_results",
        "header",
        "shape_header",
        "fmt",
        "emax_fun",
        "np",
        "column_stack",
        "all_gamma",
        "all_delta",
        "np",
        "all_emax_params",
        "axis",
        "total_lnL",
        "emax_params_names",
        "emax_fun",
        "run",
        "dmid_fun",
        "emax_fun",
        "np",
        "savetxt",
        "run",
        "dmid_fun",
        "emax_fun",
        "shape_results",
        "header",
        "shape_header",
        "fmt",
        "np",
        "all_dmid_params",
        "axis",
        "np",
        "column_stack",
        "all_dmid_params",
        "total_lnL",
        "dmid_params_names",
        "dmid_fun",
        "np",
        "savetxt",
        "name_dmid",
        "dmid_results",
        "header",
        "dmid_header",
        "fmt",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "emax_fun",
        "getattr",
        "Found_injections",
        "dmid_fun",
        "dL",
        "Mc",
        "Mtot",
        "eta",
        "Mc_det",
        "Mtot_det",
        "os",
        "mkdir",
        "run",
        "dmid_fun",
        "emax_dic",
        "emax_fun",
        "OSError",
        "e",
        "e",
        "errno",
        "errno",
        "EEXIST",
        "emax_fun",
        "getattr",
        "Found_injections",
        "emax_fun",
        "shape_params",
        "shape_params",
        "shape_params",
        "np",
        "argsort",
        "dic",
        "dic",
        "indexo",
        "dL",
        "indexo",
        "m1",
        "indexo",
        "m2",
        "indexo",
        "z",
        "indexo",
        "m1o",
        "zo",
        "m2o",
        "zo",
        "emax_fun",
        "np",
        "cumsum",
        "sigmoid",
        "dLo",
        "dmid",
        "m1o_det",
        "m2o_det",
        "dmid_params",
        "emax",
        "m1o_det",
        "m2o_det",
        "emax_params",
        "gamma",
        "delta",
        "np",
        "cumsum",
        "sigmoid",
        "dLo",
        "dmid",
        "m1o_det",
        "m2o_det",
        "dmid_params",
        "emax",
        "gamma",
        "delta",
        "dic",
        "found_any",
        "np",
        "argsort",
        "var_found",
        "var_found",
        "indexo_found",
        "np",
        "arange",
        "len",
        "var_foundo",
        "plt",
        "figure",
        "plt",
        "plot",
        "varo",
        "cmd",
        "markersize",
        "label",
        "plt",
        "plot",
        "var_foundo",
        "real_found_inj",
        "markersize",
        "label",
        "plt",
        "xlabel",
        "plt",
        "ylabel",
        "plt",
        "legend",
        "loc",
        "run",
        "dmid_fun",
        "emax_dic",
        "emax_fun",
        "plt",
        "savefig",
        "name",
        "format",
        "m1",
        "z",
        "m2",
        "z",
        "emax_fun",
        "sigmoid",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "dmid_params",
        "emax",
        "m1_det",
        "m2_det",
        "emax_params",
        "gamma",
        "delta",
        "sigmoid",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "dmid_params",
        "emax",
        "gamma",
        "delta",
        "x",
        "np",
        "sum",
        "pdet",
        "dic",
        "value",
        "np",
        "sum",
        "pdet",
        "value",
        "x",
        "np",
        "array",
        "values",
        "kstest",
        "var_foundo",
        "x",
        "cdf",
        "x",
        "stat",
        "pvalue",
        "nbins",
        "dmid_fun",
        "dmid_params",
        "shape_params",
        "var_cmd",
        "var_binned",
        "emax_fun",
        "os",
        "mkdir",
        "run",
        "dmid_fun",
        "emax_dic",
        "emax_fun",
        "OSError",
        "e",
        "e",
        "errno",
        "errno",
        "EEXIST",
        "os",
        "mkdir",
        "run",
        "dmid_fun",
        "emax_dic",
        "emax_fun",
        "var_binned",
        "OSError",
        "e",
        "e",
        "errno",
        "errno",
        "EEXIST",
        "os",
        "mkdir",
        "run",
        "dmid_fun",
        "emax_dic",
        "emax_fun",
        "var_binned",
        "var_cmd",
        "OSError",
        "e",
        "e",
        "errno",
        "errno",
        "EEXIST",
        "emax_fun",
        "getattr",
        "Found_injections",
        "emax_fun",
        "shape_params",
        "shape_params",
        "shape_params",
        "getattr",
        "Found_injections",
        "dmid_fun",
        "dL",
        "Mc",
        "Mtot",
        "eta",
        "Mc_det",
        "Mtot_det",
        "bin_dic",
        "var_binned",
        "np",
        "argsort",
        "data_not_sorted",
        "data_not_sorted",
        "index",
        "dL",
        "index",
        "m1",
        "index",
        "m2",
        "index",
        "z",
        "index",
        "m1o",
        "zo",
        "m2o",
        "zo",
        "Mc",
        "index",
        "Mtot",
        "index",
        "eta",
        "index",
        "Mc_det",
        "index",
        "Mtot_det",
        "index",
        "found_any",
        "index",
        "N",
        "m",
        "N",
        "size",
        "m",
        "np",
        "arange",
        "m",
        "sep",
        "searchsorted",
        "np",
        "arange",
        "N",
        "size",
        "idx",
        "N",
        "argsort",
        "argsort",
        "equal_bin",
        "data",
        "nbins",
        "var_binned",
        "i",
        "nbins",
        "data",
        "index_bins",
        "i",
        "dLo",
        "index_bins",
        "i",
        "m1o",
        "index_bins",
        "i",
        "m2o",
        "index_bins",
        "i",
        "zo",
        "index_bins",
        "i",
        "m1o_det",
        "index_bins",
        "i",
        "m2o_det",
        "index_bins",
        "i",
        "Mco",
        "index_bins",
        "i",
        "Mtoto",
        "index_bins",
        "i",
        "etao",
        "index_bins",
        "i",
        "Mco_det",
        "index_bins",
        "i",
        "Mtoto_det",
        "index_bins",
        "i",
        "dL_inbin",
        "Mc_inbin",
        "Mtot_inbin",
        "eta_inbin",
        "Mc_det_inbin",
        "Mtot_det_inbin",
        "np",
        "argsort",
        "cmd_dic",
        "var_cmd",
        "cmd_dic",
        "var_cmd",
        "indexo",
        "dL_inbin",
        "indexo",
        "m1_inbin",
        "indexo",
        "m2_inbin",
        "indexo",
        "z_inbin",
        "indexo",
        "m1_det_inbin",
        "indexo",
        "m2_det_inbin",
        "indexo",
        "emax_fun",
        "np",
        "cumsum",
        "sigmoid",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "dmid_params",
        "emax",
        "m1_det",
        "m2_det",
        "emax_params",
        "gamma",
        "delta",
        "np",
        "cumsum",
        "sigmoid",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "dmid_params",
        "emax",
        "gamma",
        "delta",
        "found_any_o",
        "index_bins",
        "i",
        "cmd_dic",
        "var_cmd",
        "found_inj_index_inbin",
        "np",
        "argsort",
        "found_inj_inbin",
        "found_inj_inbin",
        "indexo_found",
        "np",
        "arange",
        "len",
        "found_inj_inbin_sorted",
        "plt",
        "figure",
        "plt",
        "plot",
        "varo",
        "cmd",
        "markersize",
        "label",
        "plt",
        "plot",
        "found_inj_inbin_sorted",
        "real_found_inj",
        "markersize",
        "label",
        "plt",
        "xlabel",
        "var_cmd",
        "plt",
        "ylabel",
        "plt",
        "legend",
        "loc",
        "plt",
        "title",
        "var_binned",
        "i",
        "data_inbin",
        "data_inbin",
        "run",
        "dmid_fun",
        "emax_dic",
        "emax_fun",
        "var_binned",
        "var_cmd",
        "i",
        "plt",
        "savefig",
        "name",
        "format",
        "plt",
        "close",
        "emax_fun",
        "sigmoid",
        "dL_inbin",
        "dmid",
        "m1_det_inbin",
        "m2_det_inbin",
        "dmid_params",
        "emax",
        "m1_det_inbin",
        "m2_det_inbin",
        "emax_params",
        "gamma",
        "delta",
        "sigmoid",
        "dL_inbin",
        "dmid",
        "m1_det_inbin",
        "m2_det_inbin",
        "dmid_params",
        "emax",
        "gamma",
        "delta",
        "x",
        "np",
        "sum",
        "pdet",
        "cmd_dic",
        "var_cmd",
        "value",
        "np",
        "sum",
        "pdet",
        "value",
        "x",
        "np",
        "array",
        "values",
        "kstest",
        "found_inj_inbin_sorted",
        "x",
        "cdf",
        "x",
        "var_cmd",
        "i",
        "stat",
        "pvalue",
        "plt",
        "close",
        "h5py",
        "File",
        "run",
        "Found_injections",
        "file",
        "run",
        "os",
        "mkdir",
        "run",
        "OSError",
        "e",
        "e",
        "errno",
        "errno",
        "EEXIST",
        "os",
        "mkdir",
        "run",
        "dmid_fun",
        "OSError",
        "e",
        "e",
        "errno",
        "errno",
        "EEXIST",
        "os",
        "mkdir",
        "run",
        "dmid_fun",
        "emax_fun",
        "OSError",
        "e",
        "e",
        "errno",
        "errno",
        "EEXIST",
        "gamma_guess",
        "delta_guess",
        "emax_guess",
        "cte_guess",
        "cte_guess",
        "a20_guess",
        "a01_guess",
        "a21_guess",
        "a30_guess",
        "a10_guess",
        "cte_guess",
        "a20_guess",
        "a01_guess",
        "a21_guess",
        "a30_guess",
        "a10_guess",
        "a11_guess",
        "cte_guess",
        "a20_guess",
        "a01_guess",
        "a21_guess",
        "a30_guess",
        "asqrt_guess",
        "cte_guess",
        "a20_guess",
        "a01_guess",
        "a21_guess",
        "a30_guess",
        "power_guess",
        "data",
        "joint_MLE",
        "dmid_fun",
        "params_dmid",
        "shape_guess_emax",
        "emax_fun",
        "precision",
        "np",
        "loadtxt",
        "data",
        "run",
        "dmid_fun",
        "emax_fun",
        "np",
        "loadtxt",
        "data",
        "run",
        "dmid_fun",
        "emax_fun",
        "params_shape",
        "params_shape",
        "params_dmid",
        "gamma_opt",
        "delta_opt",
        "params_emax",
        "plt",
        "close",
        "data",
        "cumulative_dist",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "stat_dL",
        "pvalue_dL",
        "data",
        "cumulative_dist",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "stat_Mtot",
        "pvalue_Mtot",
        "data",
        "cumulative_dist",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "stat_Mc",
        "pvalue_Mc",
        "data",
        "cumulative_dist",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "stat_Mtot_det",
        "pvalue_Mtot_det",
        "data",
        "cumulative_dist",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "stat_Mc_det",
        "pvalue_Mc_det",
        "data",
        "cumulative_dist",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "stat_eta",
        "pvalue_eta",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "data",
        "binned_cumulative_dist",
        "nbins",
        "dmid_fun",
        "params_dmid",
        "params_shape",
        "emax_fun",
        "getattr",
        "data",
        "dmid_fun",
        "getattr",
        "data",
        "emax_fun",
        "data",
        "m1",
        "data",
        "z",
        "data",
        "m2",
        "data",
        "z",
        "plt",
        "figure",
        "figsize",
        "plt",
        "plot",
        "data",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "params_dmid",
        "data",
        "sigmoid",
        "data",
        "dL",
        "dmid",
        "m1_det",
        "m2_det",
        "params_dmid",
        "emax",
        "m1_det",
        "m2_det",
        "params_emax",
        "gamma_opt",
        "delta_opt",
        "plt",
        "xlabel",
        "plt",
        "ylabel",
        "plt",
        "show",
        "plt",
        "savefig",
        "data",
        "run",
        "dmid_fun",
        "emax_fun",
        "np",
        "argsort",
        "data",
        "dL",
        "data",
        "dL",
        "order",
        "data",
        "m1",
        "order",
        "data",
        "m2",
        "order",
        "data",
        "z",
        "order",
        "plt",
        "figure",
        "figsize",
        "plt",
        "scatter",
        "m1",
        "m2",
        "s",
        "c",
        "dmid",
        "m1",
        "z",
        "m2",
        "z",
        "params_dmid",
        "plt",
        "xlabel",
        "plt",
        "ylabel",
        "plt",
        "colorbar",
        "label",
        "plt",
        "show",
        "plt",
        "savefig",
        "data",
        "run",
        "dmid_fun",
        "emax_fun",
        "plt",
        "figure",
        "figsize",
        "plt",
        "scatter",
        "m1",
        "z",
        "m2",
        "z",
        "s",
        "c",
        "dmid",
        "m1",
        "z",
        "m2",
        "z",
        "params_dmid",
        "plt",
        "xlabel",
        "plt",
        "ylabel",
        "plt",
        "colorbar",
        "label",
        "plt",
        "show",
        "plt",
        "savefig",
        "data",
        "run",
        "dmid_fun",
        "emax_fun",
        "np",
        "linspace",
        "min",
        "m1",
        "z",
        "m2",
        "z",
        "max",
        "m1",
        "z",
        "m2",
        "z",
        "np",
        "exp",
        "params_emax",
        "params_emax",
        "x",
        "params_emax",
        "x",
        "plt",
        "figure",
        "plt",
        "plot",
        "x",
        "y",
        "plt",
        "ylim",
        "plt",
        "grid",
        "plt",
        "xlabel",
        "plt",
        "ylabel",
        "plt",
        "savefig",
        "data",
        "run",
        "dmid_fun",
        "emax_fun",
        "np",
        "linspace",
        "min",
        "m1",
        "z",
        "m2",
        "z",
        "max",
        "m1",
        "z",
        "m2",
        "z",
        "eta_choice",
        "np",
        "ones",
        "len",
        "M",
        "params_dmid",
        "np",
        "ones",
        "len",
        "M",
        "params_dmid",
        "M",
        "params_dmid",
        "eta",
        "params_dmid",
        "M",
        "eta",
        "params_dmid",
        "M",
        "params_dmid",
        "M",
        "eta",
        "a20",
        "a01",
        "a21",
        "a10",
        "a11",
        "plt",
        "figure",
        "plt",
        "plot",
        "M",
        "a10",
        "label",
        "plt",
        "plot",
        "M",
        "a20",
        "label",
        "plt",
        "plot",
        "M",
        "a21",
        "label",
        "plt",
        "plot",
        "M",
        "a01",
        "label",
        "plt",
        "plot",
        "M",
        "a11",
        "label",
        "plt",
        "plot",
        "M",
        "tot",
        "label",
        "plt",
        "semilogx",
        "plt",
        "ylim",
        "plt",
        "grid",
        "plt",
        "title",
        "eta_choice",
        "plt",
        "legend",
        "plt",
        "xlabel",
        "plt",
        "ylabel",
        "plt",
        "savefig",
        "data",
        "run",
        "dmid_fun",
        "emax_fun",
        "eta_choice"
    ],
    "literals": [
        "\"Argument (file) must be an h5py file.\"",
        "'o1'",
        "'o2'",
        "\"Argument (run) must be 'o1' or 'o2'. \"",
        "\"Argument (thr) must be a float or an integrer.\"",
        "'total_generated'",
        "\"events\"",
        "\"mass1_source\"",
        "\"events\"",
        "\"mass2_source\"",
        "\"events\"",
        "\"z\"",
        "\"events\"",
        "\"distance\"",
        "\"events\"",
        "\"logpdraw_mass1_source_GIVEN_z\"",
        "\"events\"",
        "\"logpdraw_mass2_source_GIVEN_mass1_source\"",
        "\"events\"",
        "\"logpdraw_z\"",
        "\"events\"",
        "\"snr_net\"",
        "'Dmid_mchirp'",
        "'cte'",
        "'Dmid_mchirp_expansion'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a30'",
        "'a10'",
        "'Dmid_mchirp_expansion_noa30'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a10'",
        "'a11'",
        "'Dmid_mchirp_expansion_a11'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a30'",
        "'a10'",
        "'a11'",
        "'Dmid_mchirp_expansion_exp'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a30'",
        "'a10'",
        "'a11'",
        "'Mstar'",
        "'Dmid_mchirp_expansion_asqrt'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a30'",
        "'asqrt'",
        "'Dmid_mchirp_power'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a30'",
        "'power_param'",
        "'emax_exp'",
        "'gamma_opt, delta_opt, b_0, b_1, b_2'",
        "'emax_sigmoid'",
        "'gamma_opt, delta_opt, b_0, k, M_0'",
        "'finished initializing'",
        "'\\n'",
        "'\\nNumber of needed iterations with precision <= %s : %s (+1 since it starts on 0)'",
        "'gamma_opt, delta_opt, emax_opt, maxL'",
        "f'{self.run}/{dmid_fun}/joint_fit_dmid.dat'",
        "f'{self.run}/{dmid_fun}/joint_fit_shape.dat'",
        "'%s'",
        "f'{self.emax_params_names[emax_fun]} , maxL'",
        "f'{self.run}/{dmid_fun}/{emax_fun}/joint_fit_dmid_emaxfun.dat'",
        "f'{self.run}/{dmid_fun}/{emax_fun}/joint_fit_shape_emaxfun.dat'",
        "'%s'",
        "f'{self.dmid_params_names[dmid_fun]} , maxL'",
        "'%s'",
        "'cmds'",
        "'emax_exp'",
        "'emax_exp_cmds'",
        "'emax_sigmoid'",
        "'emax_sigmoid_cmds'",
        "'dL'",
        "'Mc'",
        "'Mtot'",
        "'eta'",
        "'Mc_det'",
        "'Mtot_det'",
        "f'{self.run}/{dmid_fun}/{emax_dic[emax_fun]}'",
        "'.'",
        "'model'",
        "'.'",
        "'found injections'",
        "f'{var}$^*$'",
        "'Cumulative found injections'",
        "'best'",
        "f'{self.run}/{dmid_fun}/{emax_dic[emax_fun]}/{var}_cumulative.png'",
        "'png'",
        "'cmds'",
        "'emax_exp'",
        "'emax_exp_cmds'",
        "'emax_sigmoid'",
        "'emax_sigmoid_cmds'",
        "f'{self.run}/{dmid_fun}/{emax_dic[emax_fun]}'",
        "f'{self.run}/{dmid_fun}/{emax_dic[emax_fun]}/{var_binned}_bins'",
        "f'{self.run}/{dmid_fun}/{emax_dic[emax_fun]}/{var_binned}_bins/{var_cmd}_cmd'",
        "'dL'",
        "'Mc'",
        "'Mtot'",
        "'eta'",
        "'Mc_det'",
        "'Mtot_det'",
        "f'\\n{var_binned} bins:\\n'",
        "'dL'",
        "'Mc'",
        "'Mtot'",
        "'eta'",
        "'Mc_det'",
        "'Mtot_det'",
        "'.'",
        "'model'",
        "'.'",
        "'found injections'",
        "f'{var_cmd}$^*$'",
        "'Cumulative found injections'",
        "'best'",
        "f'{var_binned} bin {i} : {data_inbin[0]:.6} - {data_inbin[-1]:.6}'",
        "f'{self.run}/{dmid_fun}/{emax_dic[emax_fun]}/{var_binned}_bins/{var_cmd}_cmd/{i}.png'",
        "'png'",
        "f'{var_cmd} KStest in {i} bin: statistic = %s , pvalue = %s'",
        "''",
        "'all'",
        "'o2'",
        "f'{run}-bbh-IMRPhenomXPHMpseudoFourPN.hdf5'",
        "'r'",
        "'Dmid_mchirp_expansion_noa30'",
        "'emax_exp'",
        "f'{run}'",
        "f'{run}/{dmid_fun}'",
        "f'{run}/{dmid_fun}/{emax_fun}'",
        "'Dmid_mchirp'",
        "'Dmid_mchirp_expansion'",
        "'Dmid_mchirp_expansion_a11'",
        "'Dmid_mchirp_expansion_asqrt'",
        "'Dmid_mchirp_power'",
        "'Dmid_mchirp'",
        "'cte'",
        "'Dmid_mchirp_expansion'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a30'",
        "'a10'",
        "'Dmid_mchirp_expansion_a11'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a30'",
        "'a10'",
        "'a11'",
        "'Dmid_mchirp_expansion_asqrt'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a30'",
        "'asqrt'",
        "'Dmid_mchirp_power'",
        "'cte'",
        "'a20'",
        "'a01'",
        "'a21'",
        "'a30'",
        "'power_param'",
        "'Nelder-Mead'",
        "f'{data.run}/{dmid_fun}/{emax_fun}/joint_fit_dmid_emaxfun.dat'",
        "f'{data.run}/{dmid_fun}/{emax_fun}/joint_fit_shape_emaxfun.dat'",
        "'\\nparams_dmid:\\n'",
        "'\\ngamma, delta, b0, b1, b2:\\n'",
        "'\\n'",
        "'all'",
        "'dL'",
        "'\\ndL KStest: statistic = %s , pvalue = %s'",
        "'Mtot'",
        "'Mtot KStest: statistic = %s , pvalue = %s'",
        "'Mc'",
        "'Mc KStest: statistic = %s , pvalue = %s'",
        "'Mtot_det'",
        "'Mtot_det KStest: statistic = %s , pvalue = %s'",
        "'Mc_det'",
        "'Mc_det KStest: statistic = %s , pvalue = %s'",
        "'eta'",
        "'eta KStest: statistic = %s , pvalue = %s'",
        "'dL'",
        "'dL'",
        "'Mtot'",
        "'dL'",
        "'Mc'",
        "'dL'",
        "'Mtot_det'",
        "'dL'",
        "'Mc_det'",
        "'dL'",
        "'eta'",
        "'dL'",
        "'dL'",
        "'Mtot'",
        "'Mtot'",
        "'Mtot'",
        "'Mc'",
        "'Mtot'",
        "'eta'",
        "'Mtot'",
        "'dL'",
        "'Mtot_det'",
        "'Mtot_det'",
        "'Mtot_det'",
        "'Mc_det'",
        "'Mtot_det'",
        "'eta'",
        "'Mtot_det'",
        "'dL'",
        "'Mc'",
        "'Mtot'",
        "'Mc'",
        "'Mc'",
        "'Mc'",
        "'eta'",
        "'Mc'",
        "'dL'",
        "'Mc_det'",
        "'Mtot_det'",
        "'Mc_det'",
        "'Mc_det'",
        "'Mc_det'",
        "'eta'",
        "'Mc_det'",
        "'dL'",
        "'eta'",
        "'Mtot'",
        "'eta'",
        "'Mc'",
        "'eta'",
        "'Mtot_det'",
        "'eta'",
        "'Mc_det'",
        "'eta'",
        "'eta'",
        "'eta'",
        "'.'",
        "'D/D_mid'",
        "'Pdet'",
        "f'{data.run}/{dmid_fun}/{emax_fun}/opt_epsilon_plot_emaxfun.png'",
        "'m1'",
        "'m2'",
        "'dL_mid'",
        "f'{data.run}/{dmid_fun}/{emax_fun}/m1m2_dmid.png'",
        "'m1_det'",
        "'m2_det'",
        "'dL_mid'",
        "f'{data.run}/{dmid_fun}/{emax_fun}/m1m2det_dmid.png'",
        "'.'",
        "'Mtot_det'",
        "'emax(m)'",
        "f'{data.run}/{dmid_fun}/{emax_fun}/emax(m).png'",
        "'-'",
        "r'$a_{10} M$'",
        "'-'",
        "r'$a_{20} M^2$'",
        "'-'",
        "r'$a_{21} M^2 (1 - 4\\eta)$'",
        "'-'",
        "r'$a_{01} (1 - 4\\eta)$'",
        "'-'",
        "r'$a_{11} M (1 - 4\\eta)$'",
        "'-'",
        "'tot'",
        "f'eta = {eta_choice}'",
        "'Mtot_det'",
        "'contributions to dmid (abs value)*exp(-M/Mstar)'",
        "f'{data.run}/{dmid_fun}/{emax_fun}/dmid_params_{eta_choice}.png'"
    ],
    "variables": [
        "data",
        "run",
        "atr",
        "Ntotal",
        "m1",
        "m2",
        "z",
        "dL",
        "m1_pdf",
        "m2_pdf",
        "m_pdf",
        "z_pdf",
        "H0",
        "c",
        "omega_m",
        "A",
        "dL_dif",
        "dL_pdf",
        "Mc",
        "Mc_det",
        "Mtot",
        "Mtot_det",
        "mu",
        "eta",
        "snr",
        "found_snr",
        "found_any",
        "gamma_opt",
        "delta_opt",
        "emax_opt",
        "dmid_params_names",
        "emax_params_names",
        "frac",
        "denom",
        "Mc",
        "cte",
        "a_20",
        "a_01",
        "a_21",
        "a_30",
        "a_10",
        "M",
        "eta",
        "Mc",
        "pol",
        "cte",
        "a_20",
        "a_01",
        "a_21",
        "a_30",
        "a_sqrt",
        "M",
        "eta",
        "Mc",
        "pol",
        "cte",
        "a_20",
        "a_01",
        "a_21",
        "a_30",
        "a_10",
        "a_11",
        "M",
        "eta",
        "Mc",
        "pol",
        "cte",
        "a_20",
        "a_01",
        "a_21",
        "a_30",
        "power_param",
        "M",
        "eta",
        "Mc",
        "pol",
        "cte",
        "a_20",
        "a_01",
        "a_21",
        "a_30",
        "a_10",
        "a_11",
        "Mstar",
        "M",
        "eta",
        "Mc",
        "pol",
        "cte",
        "a_20",
        "a_01",
        "a_21",
        "a_10",
        "a_11",
        "M",
        "eta",
        "Mc",
        "pol",
        "Mtot",
        "b_0",
        "b_1",
        "b_2",
        "Mtot",
        "b_0",
        "k",
        "M_0",
        "L",
        "dmid",
        "m1_det",
        "m2_det",
        "gamma",
        "delta",
        "emax",
        "Nexp",
        "emax",
        "gamma",
        "delta",
        "emax_params",
        "Nexp",
        "dL",
        "dL_pdf",
        "m_pdf",
        "z",
        "m1",
        "m2",
        "m1_det",
        "m2_det",
        "dmid",
        "gamma",
        "delta",
        "emax",
        "lamda",
        "emax",
        "gamma",
        "delta",
        "emax_params",
        "lamda",
        "lnL",
        "res",
        "params_res",
        "min_likelihood",
        "res",
        "gamma",
        "delta",
        "emax",
        "min_likelihood",
        "res",
        "opt_params",
        "min_likelihood",
        "total_lnL",
        "all_gamma",
        "all_delta",
        "all_emax",
        "all_dmid_params",
        "all_emax_params",
        "params_emax",
        "dmid_params",
        "maxL_1",
        "all_dmid_params",
        "gamma_opt",
        "delta_opt",
        "emax_opt",
        "maxL_2",
        "total_lnL",
        "shape_params",
        "shape_params",
        "maxL_2",
        "gamma_opt",
        "delta_opt",
        "params_emax",
        "all_emax_params",
        "total_lnL",
        "total_lnL",
        "shape_results",
        "shape_header",
        "name_dmid",
        "shape_results",
        "shape_header",
        "name_dmid",
        "all_dmid_params",
        "dmid_results",
        "dmid_header",
        "emax_dic",
        "dmid",
        "dic",
        "emax",
        "emax_params",
        "gamma",
        "delta",
        "gamma",
        "delta",
        "emax",
        "indexo",
        "varo",
        "dLo",
        "m1o",
        "m2o",
        "zo",
        "m1o_det",
        "m2o_det",
        "cmd",
        "cmd",
        "var_found",
        "indexo_found",
        "var_foundo",
        "real_found_inj",
        "name",
        "m1_det",
        "m2_det",
        "pdet",
        "pdet",
        "values",
        "stat",
        "pvalue",
        "emax_dic",
        "emax",
        "emax_params",
        "gamma",
        "delta",
        "gamma",
        "delta",
        "emax",
        "dmid",
        "bin_dic",
        "data_not_sorted",
        "index",
        "data",
        "dLo",
        "m1o",
        "m2o",
        "zo",
        "m1o_det",
        "m2o_det",
        "Mco",
        "Mtoto",
        "etao",
        "Mco_det",
        "Mtoto_det",
        "found_any_o",
        "sep",
        "idx",
        "index_bins",
        "data_inbin",
        "dL_inbin",
        "m1_inbin",
        "m2_inbin",
        "z_inbin",
        "m1_det_inbin",
        "m2_det_inbin",
        "Mc_inbin",
        "Mtot_inbin",
        "eta_inbin",
        "Mc_det_inbin",
        "Mtot_det_inbin",
        "cmd_dic",
        "indexo",
        "varo",
        "dL",
        "m1",
        "m2",
        "z",
        "m1_det",
        "m2_det",
        "cmd",
        "cmd",
        "found_inj_index_inbin",
        "found_inj_inbin",
        "indexo_found",
        "found_inj_inbin_sorted",
        "real_found_inj",
        "name",
        "pdet",
        "pdet",
        "values",
        "stat",
        "pvalue",
        "run",
        "file",
        "data",
        "dmid_fun",
        "emax_fun",
        "cte_guess",
        "a20_guess",
        "a01_guess",
        "a21_guess",
        "a30_guess",
        "a10_guess",
        "a11_guess",
        "asqrt_guess",
        "power_guess",
        "b0_guess",
        "b1_guess",
        "b2_guess",
        "gamma_guess",
        "delta_guess",
        "emax_guess",
        "shape_guess",
        "params_guess",
        "params_names",
        "params_dmid",
        "shape_guess_emax",
        "params_dmid",
        "params_shape",
        "gamma_opt",
        "delta_opt",
        "params_emax",
        "stat_dL",
        "pvalue_dL",
        "stat_Mtot",
        "pvalue_Mtot",
        "stat_Mc",
        "pvalue_Mc",
        "stat_Mtot_det",
        "pvalue_Mtot_det",
        "stat_Mc_det",
        "pvalue_Mc_det",
        "stat_eta",
        "pvalue_eta",
        "nbins",
        "dmid",
        "emax",
        "m1_det",
        "m2_det",
        "order",
        "dL",
        "m1",
        "m2",
        "z",
        "x",
        "y",
        "eta_choice",
        "M",
        "eta",
        "cte",
        "a20",
        "a01",
        "a21",
        "a10",
        "a11",
        "tot"
    ],
    "comments": [
        "-*- coding: utf-8 -*-",
        "Total number of generated injections",
        "Mass 1 and mass 2 values in the source frame in solar units",
        "Redshift and luminosity distance [Mpc] values",
        "Joint mass sampling pdf (probability density function) values, p(m1,m2)",
        "Redshift sampling pdf values, p(z), corresponding to a redshift defined by a flat Lambda-Cold Dark Matter cosmology",
        "km/sMpc",
        "km/s",
        "Luminosity distance sampling pdf values, p(dL), computed for a flat Lambda-Cold Dark Matter cosmology from the z_pdf values",
        "mass chirp",
        "total mass (m1+m2)",
        "eta aka symmetric mass ratio",
        "False alarm rate statistics from each pipeline",
        "self.far_pbbh = file[\"injections/far_pycbc_bbh\"][:]",
        "self.far_gstlal = file[\"injections/far_gstlal\"][:]",
        "self.far_mbta = file[\"injections/far_mbta\"][:]",
        "self.far_pfull = file[\"injections/far_pycbc_hyperbank\"][:]",
        "SNR",
        "found_pbbh = self.far_pbbh <= thr",
        "found_gstlal = self.far_gstlal <= thr",
        "found_mbta = self.far_mbta <= thr",
        "found_pfull = self.far_pfull <= thr",
        "indexes of the found injections",
        "self.found_any = found_pbbh | found_gstlal | found_mbta | found_pfull",
        "self.pow_m1 = file.attrs['pow_mass1']",
        "self.pow_m2 = file.attrs['pow_mass2']",
        "self.mmax = file.attrs['max_mass1']",
        "self.mmin = file.attrs['min_mass1']",
        "self.zmax = file.attrs['max_redshift']",
        "self.max_index = np.argmax(self.dL)",
        "self.dLmax = self.dL[self.max_index]",
        "def fun_m_pdf(self, m1, m2):",
        "\"\"\"",
        "Function for the mass pdf aka p(m1,m2)",
        "Parameters",
        "----------",
        "m1 : source frame mass1, float or 1D array",
        "m2 : source frame mass2, float or 1D array",
        "Returns",
        "-------",
        "float or array",
        "\"\"\"",
        "# if m2 > m1:",
        "#   return 0",
        "mmin = self.mmin ; mmax = self.mmax",
        "alpha = self.pow_m1 ; beta = self.pow_m2",
        "m1_norm = (1. + alpha) / (mmax ** (1. + alpha) - mmin ** (1. + alpha))",
        "m2_norm = (1. + beta) / (m1 ** (1. + beta) - mmin ** (1. + beta))",
        "return m1**alpha * m2**beta * m1_norm * m2_norm",
        "print(lnL)",
        "def MLE_difev(self, dmid_fun, emax_fun, bounds, maxiter=50, popsize=100):",
        "def lnL(x):",
        "lnL = -self.Nexp(dmid_fun, emax_fun, x) + np.sum(np.log(self.lamda(dmid_fun, emax_fun, x)))",
        "print(lnL)",
        "return lnL",
        "result = opt.differential_evolution(lnL, bounds, maxiter=maxiter, popsize=popsize)",
        "params_opt = result.x",
        "maxL = result.fun",
        "return params_opt, maxL",
        "cumulative distribution over the desired variable",
        "found injections",
        "KS test",
        "sort data",
        "create bins with equally amount of data",
        "get data in each bin",
        "cumulative distribution over the desired variable",
        "found injections",
        "KS test",
        "function for dmid and emax we wanna use",
        "dmid_fun = 'Dmid_mchirp_expansion_exp'",
        "dmid_fun = 'Dmid_mchirp_expansion_a11'",
        "dmid_fun = 'Dmid_mchirp_expansion_asqrt'",
        "dmid_fun = 'Dmid_mchirp_expansion'",
        "emax_fun = 'emax_sigmoid'",
        "a22_guess = -0.0002",
        "MLE DMID ##########",
        "params_opt, maxL = data.MLE_dmid('Nelder-Mead', dmid_fun, params_guess[dmid_fun])",
        "print(params_opt)",
        "results = np.hstack((params_opt, maxL))",
        "header = f'{params_names[dmid_fun]} , maxL'",
        "np.savetxt(f'{dmid_fun}/dmid(m)_results_2method.dat', [results], header = header, fmt='%s')",
        "params_dmid = np.loadtxt(f'{dmid_fun}/dmid(m)_results_2method.dat')[:-1]",
        "MLE SHAPE ##########",
        "gamma_opt, delta_opt, emax_opt, maxL = data.MLE_shape('Nelder-Mead', dmid_fun, params_dmid, shape_guess, update = True)",
        "print(gamma_opt, delta_opt, emax_opt)",
        "results = np.column_stack((gamma_opt, delta_opt, emax_opt, maxL))",
        "header = 'gamma_opt, delta_opt, emax_opt, maxL'",
        "np.savetxt(f'{dmid_fun}/shape/opt_shape_params.dat', results, header = header, fmt='%s')",
        "gamma_opt, delta_opt, emax_opt = np.loadtxt(f'{dmid_fun}/shape/opt_shape_params.dat')[:-1]",
        "JOINT FIT #########",
        "data.joint_MLE('Nelder-Mead', dmid_fun, params_guess[dmid_fun], shape_guess, emax_fun = None, precision = 1e-2)",
        "# ~~~~~~~~~ THESE LINES ARE NECESSARY TO DO THE JOINT FIT WITH EMAX FUN ~~~~~~~~~",
        "params_dmid = np.loadtxt(f'{dmid_fun}/joint_fit_dmid.dat')[-1, :-1]",
        "gamma_opt, delta_opt, emax_opt = np.loadtxt(f'{dmid_fun}/joint_fit_shape.dat')[-1, :-1]",
        "params_shape = [gamma_opt, delta_opt, emax_opt]",
        "shape_guess_emax = [gamma_opt, delta_opt, b0_guess, b1_guess, b2_guess]",
        "# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~",
        "print('\\nparams_dmid:\\n', params_dmid)",
        "print('\\ngamma, delta, emax:\\n', gamma_opt, delta_opt, emax_opt, '\\n')",
        "JOINT FIT WITH EMAX FUNCTION ###########",
        "initial values from joint fit with emax fun and 'cte', 'a20', 'a01', 'a21', 'a30'",
        "params_dmid = [91.72267028049346, -1.2569702940809277e-05/2, -0.5671077334172103, 9.99097583380413e-06/2, 6.5686541980284065e-09, 0]",
        "shape_guess_emax  = [-0.5403600227437229, 0.21498422370452497, -2.2413634572753316, -0.014261526887000078, 0.00010764305058111201]",
        "initial values from joint fit with emax fun and 'cte', 'a20', 'a01', 'a21', 'a30'",
        "params_dmid = [83.6359221338493, -1.7720389246237178e-05, -0.6202851605751052, 5.799384584576895e-06, 2.2901587693040153e-08, 0.0020739921788790177, 0]",
        "shape_guess_emax  = [-0.5852595282336299, 0.22144333868817984, -3.4645779484229804, 0.01073830230180733, 1.9110955783665044e-06 ]",
        "initial values FOR EXP IN DMID from joint fit with emax fun and 'cte', 'a20', 'a01', 'a21', 'a10', 'a11'",
        "KS TEST ##########",
        "binned cumulative dist analysis",
        "bounds = [ (50, 150), (-1,1), (-1, 1), (-1, 1), (-1,1) ]",
        "ddmid = np.loadtxt(f'{dmid_fun}/joint_fit_dmid_emaxfun.dat')",
        "ddmid[:, 1] = ddmid[:, 1] / 2",
        "ddmid[:, 3] = ddmid[:, 3] / 2",
        "name_dmid = f'{dmid_fun}/joint_fit_dmid_emaxfun.dat'",
        "np.savetxt(name_dmid, ddmid, header = f'{params_names[dmid_fun]}', fmt='%s')",
        "params_dmid = np.loadtxt(f'{dmid_fun}/joint_fit_dmid_emaxfun.dat')",
        "PLOT TO CHECK EPSILON(DL) WITH OPT PARAMETERS #######",
        "gamma_opt, delta_opt, emax_opt = np.loadtxt(f'{dmid_fun}/joint_fit_shape.dat')[-1, :-1]",
        "plt.figure(figsize=(7,6))",
        "plt.plot(data.dL, data.sigmoid(data.dL, data.Dmid_mchirp_expansion(data.m1, data.m2, data.z, params_dmid), emax_opt, gamma_opt, delta_opt), '.')",
        "t = ('gamma = %.3f , delta = %.3f , emax = %.3f' %(gamma_opt, delta_opt, emax_opt) )",
        "plt.title(t)",
        "plt.xlabel('dL')",
        "plt.ylabel(r'$\\epsilon (dL, dmid(m), \\gamma_{opt}, \\delta_{opt}, emax_{opt})$')",
        "plt.show()",
        "plt.savefig(f'{dmid_fun}/opt_epsilon_plot.png')",
        "PLOT TO CHECK EPSILON(DL) WITH OPT PARAMETERS and emax fun #######",
        "gamma_opt, delta_opt, emax_opt = np.loadtxt(f'{dmid_fun}/joint_fit_shape.dat')[-1, :-1]",
        "%%",
        "y = (1 - np.exp(params_emax[0])) / (1 + np.exp(params_emax[1]*(x-params_emax[2])))",
        "a30 = params_dmid[4] * M**3",
        "asqrt = params_dmid[5] * M**(1/2)",
        "Mstar = np.exp(-M/params_dmid[7])",
        "plt.plot(M, np.abs(cte), '-', label='cte')",
        "plt.plot(M, np.abs(asqrt), '-', label='a_sqrt * M^(1/2)')",
        "plt.plot(M, a30, '-', label=r'$a_{30} M^3$')",
        "plt.semilogy()"
    ],
    "docstrings": [
        "\"\"\"\nCreated on Mon Jan 30 11:14:27 2023\n\n@author: Ana\n\"\"\"",
        "\"\"\"\n    Class for an algorithm of GW detected found injections from signal templates \n    of binary black hole mergers\n    \n    Input: an h5py file with the parameters of every sample and the threshold for \n    the false alarm rate (FAR). The default value is thr = 1, which means we are \n    considering a signal as detected when FAR <= 1.\n\n    \"\"\"",
        "\"\"\"\n        Sigmoid function used to estime the probability of detection of bbh events\n\n        Parameters\n        ----------\n        dL : 1D array of the luminosity distance.\n        dLmid : parameter or function standing for the dL at which Pdet = 0.5\n        gamma : parameter controling the shape of the curve. \n        delta : parameter controling the shape of the curve.\n        alpha : parameter controling the shape of the curve. The default is 2.05\n        emax : parameter or function controling the maximun search sensitivity\n\n        Returns\n        -------\n        array of detection probability.\n\n        \"\"\"",
        "\"\"\"\n        Dmid values (distance where Pdet = 0.5) as a function of the masses \n        in the detector frame (our first guess)\n\n        Parameters\n        ----------\n        m1_det : detector frame mass1, float or 1D array\n        m2_det: detector frame mass2, float or 1D array\n        cte : parameter that we will be optimizing, float\n        \n        Returns\n        -------\n        Dmid(m1,m2) in the detector's frame\n\n        \"\"\"",
        "\"\"\"\n        Dmid values (distance where Pdet = 0.5) as a function of the masses \n        in the detector frame \n\n        Parameters\n        ----------\n        m1_det : detector frame mass1, float or 1D array\n        m2_det: detector frame mass2, float or 1D array\n        params : parameters that we will be optimizing, 1D array\n        \n        Returns\n        -------\n        Dmid(m1,m2) in the detector's frame\n\n        \"\"\"",
        "\"\"\"\n        Dmid values (distance where Pdet = 0.5) as a function of the masses \n        in the detector frame \n\n        Parameters\n        ----------\n        m1_det : detector frame mass1, float or 1D array\n        m2_det: detector frame mass2, float or 1D array\n        params : parameters that we will be optimizing, 1D array\n        \n        Returns\n        -------\n        Dmid(m1,m2) in the detector's frame\n\n        \"\"\"",
        "\"\"\"\n        Dmid values (distance where Pdet = 0.5) as a function of the masses \n        in the detector frame \n\n        Parameters\n        ----------\n        m1_det : detector frame mass1, float or 1D array\n        m2_det: detector frame mass2, float or 1D array\n        params : parameters that we will be optimizing, 1D array\n        \n        Returns\n        -------\n        Dmid(m1,m2) in the detector's frame\n\n        \"\"\"",
        "\"\"\"\n        Dmid values (distance where Pdet = 0.5) as a function of the masses \n        in the detector frame \n        Parameters\n        ----------\n        m1_det : detector frame mass1, float or 1D array\n        m2_det: detector frame mass2, float or 1D array\n        params : parameters that we will be optimizing, 1D array\n        \n        Returns\n        -------\n        Dmid(m1,m2) in the detector's frame\n\n        \"\"\"",
        "\"\"\"\n        Dmid values (distance where Pdet = 0.5) as a function of the masses \n        in the detector frame \n\n        Parameters\n        ----------\n        m1_det : detector frame mass1, float or 1D array\n        m2_det: detector frame mass2, float or 1D array\n        params : parameters that we will be optimizing, 1D array\n        \n        Returns\n        -------\n        Dmid(m1,m2) in the detector's frame\n\n        \"\"\"",
        "\"\"\"\n        Dmid values (distance where Pdet = 0.5) as a function of the masses \n        in the detector frame \n\n        Parameters\n        ----------\n        m1_det : detector frame mass1, float or 1D array\n        m2_det: detector frame mass2, float or 1D array\n        params : parameters that we will be optimizing, 1D array\n        \n        Returns\n        -------\n        Dmid(m1,m2) in the detector's frame\n\n        \"\"\"",
        "\"\"\"\n        maximun search sensitivity (emax) as a function of the masses\n        in the detector frame\n\n        Parameters\n        ----------\n        m1_det : detector frame mass1, float or 1D array\n        m2_det: detector frame mass2, float or 1D array\n        params : parameters that we will be optimizing, 1D array\n\n        Returns\n        -------\n        emax(m1, m2) in the detector frame\n\n        \"\"\"",
        "\"\"\"\n        maximun search sensitivity (emax) as a function of the masses\n        in the detector frame\n\n        Parameters\n        ----------\n        m1_det : detector frame mass1, float or 1D array\n        m2_det: detector frame mass2, float or 1D array\n        params : parameters that we will be optimizing, 1D array\n\n        Returns\n        -------\n        emax(m1, m2) in the detector frame\n\n        \"\"\"",
        "\"\"\"\n        Expected number of found injections, computed as a sum over the \n        probability of detection of every injection\n\n        Parameters\n        ----------\n        dmid_fun : str, name of the method used for the dmid function\n        dmid_params : parameters of the Dmid function, 1D array\n        shape_params : gamma, delta and emax params, 1D array\n        emax_fun : str, name of the method used for the emax function\n                   if given None, shape_params should be only 3 numbers\n                   if given a method, shape_params should be [gamma, delta, emax_params]\n\n        Returns\n        -------\n        float\n\n        \"\"\"",
        "\"\"\"\n        Number density at found injectionsaka lambda(D,m1,m2)\n\n        Parameters\n        ----------\n        dmid_fun : str, name of the method used for the dmid function\n        dmid_params : parameters of the Dmid function, 1D array\n        shape_params : gamma, delta and emax params, 1D array\n        emax_fun : str, name of the method used for the emax function\n                   if given None, shape_params should be only 3 numbers\n                   if given a method, shape_params should be [gamma, delta, emax_params]\n\n        Returns\n        -------\n        float\n\n        \"\"\"",
        "\"\"\"\n        log likelihood of the expected density of found injections\n\n        Parameters\n        ----------\n        dmid_fun : str, name of the method used for the dmid function\n        dmid_params : parameters of the Dmid function, 1D array\n        shape_params : gamma, delta and emax params, 1D array\n        emax_fun : str, name of the method used for the emax function\n                   if given None, shape_params should be only 3 numbers\n                   if given a method, shape_params should be [gamma, delta, emax_params]\n\n        Returns\n        -------\n        float \n\n        \"\"\"",
        "\"\"\"\n        minimization of -logL on dmid\n\n        Parameters\n        ----------\n        methods : str, scipy method used to minimize -logL\n        dmid_fun : str, name of the method used for the dmid function\n        dmid_params_guess : initial guess for dmid params, 1D array\n        shape_params : gamma, delta and emax params, 1D array\n        emax_fun : str, name of the method used for the emax function\n                   if given None, shape_params should be only 3 numbers\n                   if given a method, shape_params should be [gamma, delta, emax_params]\n\n\n        Returns\n        -------\n        params_res : optimized value for Dmid params, 1D array\n        -min_likelihood : maximum log likelihood, float\n\n        \"\"\"",
        "\"\"\"\n        minimization of -logL on shape params (with emax as a cte)\n\n        Parameters\n        ----------\n        methods : scipy method used to minimize -logL\n        dmid_fun : str, name of the method used for the dmid function\n        dmid_params : parameters of the Dmid function, 1D array\n        shape_params_guess : initial guess for gamma, delta and emax, 1D array\n\n        Returns\n        -------\n        gamma: optimized value for gamma, float\n        delta: optimized value for delta, float\n        emax: optimized value for emax, float\n        -min_likelihood : maximum log likelihood, float\n\n        \"\"\"",
        "\"\"\"\n        minimization of -logL on shape params (with emax as a function of masses)\n\n        Parameters\n        ----------\n        methods : scipy method used to minimize -logL\n        dmid_fun : str, name of the method used for the dmid function\n        dmid_params : parameters of the Dmid function, 1D array\n        shape_params_guess : initial guess for [gamma, delta, emax_params], 1D array\n        emax_fun : str, name of the method used for the emax function\n\n        Returns\n        -------\n        opt_params: optimized values for [gamma, delta, emax_params], 1D array\n        -min_likelihood : maximum log likelihood, float\n\n        \"\"\"",
        "'''\n        joint optimization of log likelihood, alternating between optimizing dmid params and shape params\n        until the difference in the log L is <= precision . Saves the results of each iteration in txt files.\n\n        Parameters\n        ----------\n        methods : str, scipy method used to minimize -logL\n        dmid_fun : str, name of the method used for the dmid function\n        dmid_params : 1D array, initial guess for dmid params\n        shape_params : 1D array, initial guess for shape params\n        emax_fun : str, optional. Name of the method used for the emax function. The default is None.\n                   if given None, shape_params should be only 3 numbers\n                   if given a method, shape_params should be [gamma, delta, emax_params]\n        precision : float (positive), optional. Tolerance for termination . The default is 1e-2.\n\n        Returns\n        -------\n        None.\n\n        '''",
        "'''\n        Saves cumulative distributions plots and prints KS tests for the specified variables  \n\n        Parameters\n        ----------\n        dmid_fun : str, name of the method used for the dmid function\n        dmid_params : 1D array, parameters of Dmid function\n        shape_params : 1D array, [gamma, delta, emax] or [gamma, delta, emax_params]\n        var : str, variable for the CDFs and KS tests. Options:\n            'dL' - luminosity distance\n            'Mc' - chirp mass\n            'Mtot' - total mass \n            'eta' - symmetric mass ratio\n            'Mc_det' - chirp mass in the detector frame\n            'Mtot_det' - total mass in the detector frame\n        emax_fun : str, optional. Name of the method used for the emax function. The default is None.\n                   if given None, shape_params should be only 3 numbers\n                   if given a method, shape_params should be [gamma, delta, emax_params]\n\n        Returns\n        -------\n        stat : float, statistic from the KStest \n        pvalue : float, pvalue from the KStest \n\n        '''",
        "'''\n        Saves binned cumulative distributions and prints binned KS tests for the specified variables \n\n        Parameters\n        ----------\n        nbins : int, number of bins\n        dmid_fun : str, name of the method used for the dmid function\n        dmid_params : 1D array, parameters of Dmid function\n        shape_params : 1D array, [gamma, delta, emax] or [gamma, delta, emax_params]\n        var_cmd : str, variable for the CDFs and KS tests. Options:\n            'dL' - luminosity distance\n            'Mc' - chirp mass\n            'Mtot' - total mass \n            'eta' - symmetric mass ratio\n            'Mc_det' - chirp mass in the detector frame\n            'Mtot_det' - total mass in the detector frame\n        var_binned : str, variable in which we are taking bins. Same options as var_cmd\n        emax_fun : str, optional. Name of the method used for the emax function. The default is None.\n                   if given None, shape_params should be only 3 numbers\n                   if given a method, shape_params should be [gamma, delta, emax_params]\n\n        Returns\n        -------\n        None.\n\n        '''"
    ],
    "functions": [
        "sigmoid",
        "Dmid_mchirp",
        "Dmid_mchirp_expansion",
        "Dmid_mchirp_expansion_asqrt",
        "Dmid_mchirp_expansion_a11",
        "Dmid_mchirp_power",
        "Dmid_mchirp_expansion_exp",
        "Dmid_mchirp_expansion_noa30",
        "emax_exp",
        "emax_sigmoid",
        "Nexp",
        "lamda",
        "logL",
        "MLE_dmid",
        "MLE_shape",
        "MLE_emax",
        "joint_MLE",
        "cumulative_dist",
        "cdf",
        "binned_cumulative_dist",
        "equal_bin",
        "cdf"
    ],
    "classes": [
        "Found_injections"
    ]
}