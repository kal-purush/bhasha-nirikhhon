{
    "identifiers": [
        "org",
        "apache",
        "pulsar",
        "compaction",
        "org",
        "testng",
        "Assert",
        "assertEquals",
        "org",
        "testng",
        "Assert",
        "assertFalse",
        "java",
        "util",
        "java",
        "util",
        "java",
        "util",
        "Optional",
        "java",
        "util",
        "concurrent",
        "CompletableFuture",
        "java",
        "util",
        "concurrent",
        "TimeUnit",
        "org",
        "apache",
        "bookkeeper",
        "mledger",
        "impl",
        "ManagedLedgerImpl",
        "org",
        "apache",
        "bookkeeper",
        "mledger",
        "impl",
        "PositionImpl",
        "org",
        "apache",
        "pulsar",
        "broker",
        "BrokerTestUtil",
        "org",
        "apache",
        "pulsar",
        "broker",
        "service",
        "Topic",
        "org",
        "apache",
        "pulsar",
        "broker",
        "service",
        "persistent",
        "PersistentTopic",
        "org",
        "apache",
        "pulsar",
        "client",
        "api",
        "Consumer",
        "org",
        "apache",
        "pulsar",
        "client",
        "api",
        "MessageId",
        "org",
        "apache",
        "pulsar",
        "client",
        "api",
        "Producer",
        "org",
        "apache",
        "pulsar",
        "client",
        "api",
        "ProducerBuilder",
        "org",
        "apache",
        "pulsar",
        "client",
        "api",
        "ProducerConsumerBase",
        "org",
        "apache",
        "pulsar",
        "client",
        "api",
        "Schema",
        "org",
        "apache",
        "pulsar",
        "client",
        "impl",
        "BatchMessageIdImpl",
        "org",
        "apache",
        "pulsar",
        "client",
        "impl",
        "MessageIdImpl",
        "org",
        "apache",
        "pulsar",
        "client",
        "impl",
        "ReaderImpl",
        "org",
        "apache",
        "pulsar",
        "common",
        "util",
        "FutureUtil",
        "org",
        "awaitility",
        "Awaitility",
        "org",
        "testng",
        "annotations",
        "AfterClass",
        "org",
        "testng",
        "annotations",
        "BeforeClass",
        "org",
        "testng",
        "annotations",
        "DataProvider",
        "org",
        "testng",
        "annotations",
        "Test",
        "Test",
        "groups",
        "BeforeClass",
        "Override",
        "internalSetup",
        "producerBaseSetup",
        "AfterClass",
        "Override",
        "internalCleanup",
        "Override",
        "doInitConf",
        "conf",
        "setBrokerServiceCompactionMonitorIntervalInSeconds",
        "MAX_VALUE",
        "conf",
        "setRetentionCheckIntervalInSeconds",
        "MAX_VALUE",
        "topicName",
        "pulsar",
        "getBrokerService",
        "getTopic",
        "topicName",
        "get",
        "get",
        "getLastMessageId",
        "get",
        "topicName",
        "persistentTopic",
        "pulsar",
        "getBrokerService",
        "getTopic",
        "topicName",
        "get",
        "get",
        "persistentTopic",
        "triggerCompaction",
        "Awaitility",
        "await",
        "untilAsserted",
        "lastConfirmPos",
        "persistentTopic",
        "getManagedLedger",
        "getLastConfirmedEntry",
        "markDeletePos",
        "persistentTopic",
        "getSubscription",
        "Compactor",
        "COMPACTION_SUBSCRIPTION",
        "getCursor",
        "getMarkDeletedPosition",
        "assertEquals",
        "markDeletePos",
        "getLedgerId",
        "lastConfirmPos",
        "getLedgerId",
        "assertEquals",
        "markDeletePos",
        "getEntryId",
        "lastConfirmPos",
        "getEntryId",
        "topicName",
        "admin",
        "topics",
        "unload",
        "topicName",
        "Awaitility",
        "await",
        "until",
        "topicFuture",
        "pulsar",
        "getBrokerService",
        "getTopic",
        "topicName",
        "topicFuture",
        "isDone",
        "topicFuture",
        "isCompletedExceptionally",
        "topicOptional",
        "topicFuture",
        "join",
        "topicOptional",
        "isPresent",
        "persistentTopic",
        "topicOptional",
        "get",
        "managedLedger",
        "persistentTopic",
        "getManagedLedger",
        "managedLedger",
        "getState",
        "ManagedLedgerImpl",
        "State",
        "LedgerOpened",
        "topicName",
        "persistentTopic",
        "pulsar",
        "getBrokerService",
        "getTopic",
        "topicName",
        "get",
        "get",
        "managedLedger",
        "persistentTopic",
        "getManagedLedger",
        "Awaitility",
        "await",
        "atMost",
        "TimeUnit",
        "SECONDS",
        "until",
        "future",
        "managedLedger",
        "trimConsumedLedgersInBackground",
        "future",
        "future",
        "join",
        "managedLedger",
        "getLedgersInfo",
        "size",
        "Test",
        "topicName",
        "BrokerTestUtil",
        "newUniqueName",
        "subName",
        "consumer",
        "createConsumer",
        "topicName",
        "subName",
        "messageId",
        "consumer",
        "getLastMessageId",
        "assertEquals",
        "messageId",
        "getLedgerId",
        "assertEquals",
        "messageId",
        "getEntryId",
        "consumer",
        "close",
        "admin",
        "topics",
        "topicName",
        "enabledBatch",
        "topicName",
        "producerBuilder",
        "pulsarClient",
        "newProducer",
        "Schema",
        "STRING",
        "topic",
        "topicName",
        "enableBatching",
        "enabledBatch",
        "enabledBatch",
        "producerBuilder",
        "batchingMaxBytes",
        "MAX_VALUE",
        "batchingMaxPublishDelay",
        "TimeUnit",
        "HOURS",
        "batchingMaxBytes",
        "MAX_VALUE",
        "producerBuilder",
        "create",
        "topicName",
        "subName",
        "pulsarClient",
        "newConsumer",
        "Schema",
        "STRING",
        "topic",
        "topicName",
        "subscriptionName",
        "subName",
        "receiverQueueSize",
        "readCompacted",
        "subscribe",
        "Test",
        "topicName",
        "BrokerTestUtil",
        "newUniqueName",
        "subName",
        "reader",
        "pulsarClient",
        "newReader",
        "Schema",
        "STRING",
        "topic",
        "topicName",
        "subscriptionName",
        "subName",
        "receiverQueueSize",
        "startMessageId",
        "MessageId",
        "earliest",
        "readCompacted",
        "create",
        "producer",
        "createProducer",
        "topicName",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "get",
        "reader",
        "readNext",
        "triggerLedgerSwitch",
        "topicName",
        "clearAllTheLedgersOutdated",
        "topicName",
        "messageId",
        "reader",
        "getConsumer",
        "getLastMessageId",
        "assertEquals",
        "messageId",
        "getLedgerId",
        "assertEquals",
        "messageId",
        "getEntryId",
        "reader",
        "close",
        "producer",
        "close",
        "admin",
        "topics",
        "topicName",
        "DataProvider",
        "name",
        "Test",
        "dataProvider",
        "enabledBatch",
        "topicName",
        "BrokerTestUtil",
        "newUniqueName",
        "subName",
        "consumer",
        "createConsumer",
        "topicName",
        "subName",
        "producer",
        "createProducer",
        "enabledBatch",
        "topicName",
        "sendFutures",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "FutureUtil",
        "waitForAll",
        "sendFutures",
        "join",
        "lastMessageIdExpected",
        "getLastMessageIdByTopic",
        "topicName",
        "lastMessageId",
        "consumer",
        "getLastMessageId",
        "assertEquals",
        "lastMessageId",
        "getLedgerId",
        "lastMessageIdExpected",
        "getLedgerId",
        "assertEquals",
        "lastMessageId",
        "getEntryId",
        "lastMessageIdExpected",
        "getEntryId",
        "enabledBatch",
        "lastBatchMessageIdByTopic",
        "lastMessageIdExpected",
        "batchMessageId",
        "lastMessageId",
        "assertEquals",
        "batchMessageId",
        "getBatchSize",
        "lastBatchMessageIdByTopic",
        "getBatchSize",
        "assertEquals",
        "batchMessageId",
        "getBatchIndex",
        "lastBatchMessageIdByTopic",
        "getBatchIndex",
        "consumer",
        "close",
        "producer",
        "close",
        "admin",
        "topics",
        "topicName",
        "Test",
        "dataProvider",
        "enabledBatch",
        "topicName",
        "BrokerTestUtil",
        "newUniqueName",
        "subName",
        "consumer",
        "createConsumer",
        "topicName",
        "subName",
        "producer",
        "createProducer",
        "enabledBatch",
        "topicName",
        "sendFutures",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "FutureUtil",
        "waitForAll",
        "sendFutures",
        "join",
        "triggerCompactionAndWait",
        "topicName",
        "lastMessageIdByTopic",
        "getLastMessageIdByTopic",
        "topicName",
        "messageId",
        "consumer",
        "getLastMessageId",
        "assertEquals",
        "messageId",
        "getLedgerId",
        "lastMessageIdByTopic",
        "getLedgerId",
        "assertEquals",
        "messageId",
        "getEntryId",
        "lastMessageIdByTopic",
        "getEntryId",
        "enabledBatch",
        "lastBatchMessageIdByTopic",
        "lastMessageIdByTopic",
        "batchMessageId",
        "messageId",
        "assertEquals",
        "batchMessageId",
        "getBatchSize",
        "lastBatchMessageIdByTopic",
        "getBatchSize",
        "assertEquals",
        "batchMessageId",
        "getBatchIndex",
        "lastBatchMessageIdByTopic",
        "getBatchIndex",
        "consumer",
        "close",
        "producer",
        "close",
        "admin",
        "topics",
        "topicName",
        "Test",
        "dataProvider",
        "enabledBatch",
        "topicName",
        "BrokerTestUtil",
        "newUniqueName",
        "subName",
        "consumer",
        "createConsumer",
        "topicName",
        "subName",
        "producer",
        "createProducer",
        "enabledBatch",
        "topicName",
        "sendFutures",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "FutureUtil",
        "waitForAll",
        "sendFutures",
        "join",
        "triggerCompactionAndWait",
        "topicName",
        "lastMessageIdExpected",
        "sendFutures",
        "get",
        "get",
        "lastMessageId",
        "consumer",
        "getLastMessageId",
        "assertEquals",
        "lastMessageId",
        "getLedgerId",
        "lastMessageIdExpected",
        "getLedgerId",
        "assertEquals",
        "lastMessageId",
        "getEntryId",
        "lastMessageIdExpected",
        "getEntryId",
        "enabledBatch",
        "lastBatchMessageIdExpected",
        "lastMessageIdExpected",
        "batchMessageId",
        "lastMessageId",
        "assertEquals",
        "batchMessageId",
        "getBatchSize",
        "lastBatchMessageIdExpected",
        "getBatchSize",
        "assertEquals",
        "batchMessageId",
        "getBatchIndex",
        "lastBatchMessageIdExpected",
        "getBatchIndex",
        "consumer",
        "close",
        "producer",
        "close",
        "admin",
        "topics",
        "topicName",
        "Test",
        "dataProvider",
        "enabledBatch",
        "topicName",
        "BrokerTestUtil",
        "newUniqueName",
        "subName",
        "consumer",
        "createConsumer",
        "topicName",
        "subName",
        "producer",
        "createProducer",
        "enabledBatch",
        "topicName",
        "sendFutures",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "FutureUtil",
        "waitForAll",
        "sendFutures",
        "join",
        "triggerCompactionAndWait",
        "topicName",
        "lastMessageIdExpected",
        "sendFutures",
        "get",
        "get",
        "lastMessageId",
        "consumer",
        "getLastMessageId",
        "assertEquals",
        "lastMessageId",
        "getLedgerId",
        "lastMessageIdExpected",
        "getLedgerId",
        "assertEquals",
        "lastMessageId",
        "getEntryId",
        "lastMessageIdExpected",
        "getEntryId",
        "enabledBatch",
        "lastBatchMessageIdExpected",
        "lastMessageIdExpected",
        "batchMessageId",
        "lastMessageId",
        "assertEquals",
        "batchMessageId",
        "getBatchSize",
        "lastBatchMessageIdExpected",
        "getBatchSize",
        "assertEquals",
        "batchMessageId",
        "getBatchIndex",
        "lastBatchMessageIdExpected",
        "getBatchIndex",
        "consumer",
        "close",
        "producer",
        "close",
        "admin",
        "topics",
        "topicName",
        "Test",
        "dataProvider",
        "enabledBatch",
        "topicName",
        "BrokerTestUtil",
        "newUniqueName",
        "subName",
        "consumer",
        "createConsumer",
        "topicName",
        "subName",
        "producer",
        "createProducer",
        "enabledBatch",
        "topicName",
        "sendFutures",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "sendFutures",
        "add",
        "producer",
        "newMessage",
        "key",
        "value",
        "sendAsync",
        "producer",
        "flush",
        "FutureUtil",
        "waitForAll",
        "sendFutures",
        "join",
        "triggerCompactionAndWait",
        "topicName",
        "lastMessageId",
        "consumer",
        "getLastMessageId",
        "assertFalse",
        "lastMessageId",
        "assertEquals",
        "lastMessageId",
        "getLedgerId",
        "assertEquals",
        "lastMessageId",
        "getEntryId",
        "consumer",
        "close",
        "producer",
        "close",
        "admin",
        "topics",
        "topicName"
    ],
    "literals": [
        "\"broker-impl\"",
        "\"persistent://public/default/\"",
        "\"tp\"",
        "\"sub\"",
        "\"persistent://public/default/\"",
        "\"tp\"",
        "\"sub\"",
        "\"k0\"",
        "\"v0\"",
        "\"enabledBatch\"",
        "\"enabledBatch\"",
        "\"persistent://public/default/\"",
        "\"tp\"",
        "\"sub\"",
        "\"k0\"",
        "\"v0\"",
        "\"k0\"",
        "\"v1\"",
        "\"k0\"",
        "\"v2\"",
        "\"k1\"",
        "\"v0\"",
        "\"k1\"",
        "\"v1\"",
        "\"k1\"",
        "\"v2\"",
        "\"enabledBatch\"",
        "\"persistent://public/default/\"",
        "\"tp\"",
        "\"sub\"",
        "\"k0\"",
        "\"v0\"",
        "\"k0\"",
        "\"v1\"",
        "\"k0\"",
        "\"v2\"",
        "\"k1\"",
        "\"v0\"",
        "\"k1\"",
        "\"v1\"",
        "\"k1\"",
        "\"v2\"",
        "\"enabledBatch\"",
        "\"persistent://public/default/\"",
        "\"tp\"",
        "\"sub\"",
        "\"k0\"",
        "\"v0\"",
        "\"k0\"",
        "\"v1\"",
        "\"k0\"",
        "\"v2\"",
        "\"k1\"",
        "\"v0\"",
        "\"k1\"",
        "\"v1\"",
        "\"k1\"",
        "\"k2\"",
        "\"v0\"",
        "\"k2\"",
        "\"v1\"",
        "\"k2\"",
        "\"enabledBatch\"",
        "\"persistent://public/default/\"",
        "\"tp\"",
        "\"sub\"",
        "\"k0\"",
        "\"v0\"",
        "\"k0\"",
        "\"v1\"",
        "\"k1\"",
        "\"v0\"",
        "\"k1\"",
        "\"v1\"",
        "\"k1\"",
        "\"v2\"",
        "\"k2\"",
        "\"v0\"",
        "\"k2\"",
        "\"v1\"",
        "\"k2\"",
        "\"enabledBatch\"",
        "\"persistent://public/default/\"",
        "\"tp\"",
        "\"sub\"",
        "\"k0\"",
        "\"v0\"",
        "\"k0\"",
        "\"k1\"",
        "\"v0\"",
        "\"k1\"",
        "\"k2\"",
        "\"v0\"",
        "\"k2\""
    ],
    "variables": [],
    "comments": [
        "Disable the scheduled task: compaction.",
        "Disable the scheduled task: retention.",
        "cleanup.",
        "cleanup.",
        "cleanup.",
        "cleanup.",
        "cleanup.",
        "cleanup.",
        "cleanup."
    ],
    "docstrings": [
        "* Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License."
    ],
    "functions": [
        "setup",
        "cleanup",
        "doInitConf",
        "MessageIdImpl",
        "getLastMessageIdByTopic",
        "triggerCompactionAndWait",
        "triggerLedgerSwitch",
        "clearAllTheLedgersOutdated",
        "testGetLastMessageIdWhenLedgerEmpty",
        "createProducer",
        "createConsumer",
        "testGetLastMessageIdWhenNoNonEmptyLedgerExists",
        "enabledBatch",
        "testGetLastMessageIdBeforeCompaction",
        "testGetLastMessageIdAfterCompaction",
        "testGetLastMessageIdAfterCompactionEndWithNullMsg",
        "testGetLastMessageIdAfterCompactionEndWithNullMsg2",
        "testGetLastMessageIdAfterCompactionAllNullMsg"
    ],
    "classes": [
        "GetLastMessageIdCompactedTest"
    ]
}