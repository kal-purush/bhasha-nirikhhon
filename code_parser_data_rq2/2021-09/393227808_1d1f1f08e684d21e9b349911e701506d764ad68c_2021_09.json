{
    "identifiers": [
        "time",
        "torch",
        "torch",
        "optim",
        "optim",
        "torch",
        "nn",
        "functional",
        "F",
        "torch",
        "distributed",
        "dist",
        "torch",
        "nn",
        "argparse",
        "tutel",
        "moe",
        "tutel_moe",
        "argparse",
        "ArgumentParser",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "parser",
        "add_argument",
        "action",
        "parser",
        "add_argument",
        "parser",
        "parse_args",
        "torch",
        "cuda",
        "set_device",
        "args",
        "local_rank",
        "dist",
        "is_available",
        "dist",
        "init_process_group",
        "dist",
        "get_rank",
        "dist",
        "get_world_size",
        "args",
        "dist_rank",
        "args",
        "args",
        "batch_size",
        "args",
        "num_tokens",
        "args",
        "model_dim",
        "args",
        "hidden_size",
        "args",
        "num_local_experts",
        "args",
        "top",
        "args",
        "local_rank",
        "torch",
        "device",
        "args",
        "local_rank",
        "args",
        "dtype",
        "torch",
        "set_default_dtype",
        "torch",
        "float32",
        "args",
        "dtype",
        "torch",
        "set_default_dtype",
        "torch",
        "float16",
        "args",
        "dtype",
        "torch",
        "nn",
        "Module",
        "tutel_moe",
        "moe_layer",
        "gate_type",
        "top_value",
        "model_dim",
        "model_dim",
        "experts",
        "num_local_experts",
        "hidden_size",
        "fp32_gate",
        "args",
        "fp32_gate",
        "scan_expert_func",
        "name",
        "param",
        "setattr",
        "param",
        "seeds",
        "dist_rank",
        "to",
        "device",
        "sum",
        "torch",
        "numel",
        "param",
        "name",
        "param",
        "_moe_layer",
        "get_parameter_iterator",
        "param_type",
        "sum",
        "torch",
        "numel",
        "param",
        "name",
        "param",
        "_moe_layer",
        "get_parameter_iterator",
        "param_type",
        "dist_print",
        "local_count",
        "shared_count",
        "input",
        "_moe_layer",
        "input",
        "F",
        "log_softmax",
        "torch",
        "sum",
        "result",
        "dim",
        "dim",
        "result",
        "param_name",
        "_ddp_params_and_buffers_to_ignore",
        "append",
        "param_name",
        "ExampleModel",
        "name",
        "param",
        "model",
        "named_parameters",
        "hasattr",
        "param",
        "model",
        "add_param_to_skip_allreduce",
        "name",
        "torch",
        "distributed",
        "is_initialized",
        "torch",
        "nn",
        "parallel",
        "DistributedDataParallel",
        "model",
        "device_ids",
        "args",
        "local_rank",
        "dist_print",
        "model",
        "torch",
        "optim",
        "SGD",
        "model",
        "parameters",
        "lr",
        "torch",
        "randn",
        "batch_size",
        "num_tokens",
        "model_dim",
        "device",
        "device",
        "requires_grad",
        "torch",
        "LongTensor",
        "batch_size",
        "random_",
        "to",
        "device",
        "dist_world_size",
        "args",
        "dtype",
        "model_dim",
        "hidden_size",
        "batch_size",
        "num_tokens",
        "num_local_experts",
        "top_value",
        "device",
        "dist_print",
        "tuples",
        "i",
        "num_steps",
        "torch",
        "cuda",
        "synchronize",
        "time",
        "time",
        "optimizer",
        "zero_grad",
        "model",
        "x",
        "F",
        "nll_loss",
        "output",
        "y",
        "loss",
        "backward",
        "optimizer",
        "step",
        "torch",
        "cuda",
        "synchronize",
        "time",
        "time",
        "dist_print",
        "i",
        "loss",
        "data",
        "t_stop",
        "t_start",
        "i",
        "num_steps",
        "average_time",
        "t_stop",
        "t_start",
        "average_time",
        "dist_print",
        "average_time"
    ],
    "literals": [
        "'--local_rank'",
        "'--batch_size'",
        "'--num_tokens'",
        "'--model_dim'",
        "'--hidden_size'",
        "'--num_local_experts'",
        "'--dtype'",
        "'float32'",
        "'--fp32_gate'",
        "'store_true'",
        "'--top'",
        "'nccl'",
        "'cuda'",
        "'float32'",
        "'float16'",
        "'Unrecognized data type specified: %s'",
        "'Top%dGate'",
        "'type'",
        "'ffn'",
        "'count_per_node'",
        "'hidden_size_per_expert'",
        "'skip_allreduce'",
        "'local_experts'",
        "'gate'",
        "'[Statistics] param count for MoE local_experts = %s, param count for MoE gate = %s.\\n'",
        "'skip_allreduce'",
        "'[Benchmark] world_size = %s, dtype = %s, model_dim = %s, hidden_size = %s, samples = %s, num_local_experts = %s, topK = %s, device = `%s`'",
        "'STEP-%s: DONE, loss = %s, step_time = %s sec.'",
        "'\\n[Summary] Average synchronized step_time = %s sec.'"
    ],
    "variables": [
        "parser",
        "args",
        "dist_rank",
        "dist_world_size",
        "dist_rank",
        "dist_world_size",
        "dist_print",
        "batch_size",
        "num_tokens",
        "model_dim",
        "hidden_size",
        "num_local_experts",
        "top_value",
        "local_rank",
        "device",
        "_ddp_params_and_buffers_to_ignore",
        "_moe_layer",
        "local_count",
        "shared_count",
        "result",
        "result",
        "model",
        "model",
        "optimizer",
        "x",
        "y",
        "tuples",
        "average_time",
        "num_steps",
        "t_start",
        "output",
        "loss",
        "t_stop"
    ],
    "comments": [
        "!/usr/bin/env python3",
        "Copyright (c) Microsoft Corporation.",
        "Licensed under the MIT license.",
        "Distinguish different parameter types: gate, local_experts"
    ],
    "docstrings": [],
    "functions": [
        "dist_print",
        "forward",
        "add_param_to_skip_allreduce"
    ],
    "classes": [
        "ExampleModel"
    ]
}