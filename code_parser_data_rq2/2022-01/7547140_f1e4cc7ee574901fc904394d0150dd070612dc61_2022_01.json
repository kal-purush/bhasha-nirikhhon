{
    "identifiers": [
        "sys",
        "codecs",
        "aid",
        "aid",
        "aid",
        "fci",
        "status",
        "body",
        "fci",
        "status",
        "body",
        "hex",
        "fileId",
        "fileId",
        "hex",
        "status",
        "body",
        "status",
        "body",
        "hex",
        "body",
        "body",
        "hex",
        "status",
        "body",
        "body",
        "hex",
        "body",
        "body",
        "hex",
        "status",
        "body",
        "body",
        "hex",
        "aid",
        "aid",
        "aid",
        "selectT",
        "status",
        "body",
        "body",
        "body",
        "body",
        "appLen",
        "len",
        "body",
        "body",
        "body",
        "selectT",
        "tag",
        "ret",
        "body",
        "tagLen",
        "hex",
        "tag",
        "body",
        "tagLen",
        "subBody",
        "subBody",
        "subBody",
        "hex",
        "subTag",
        "content",
        "v",
        "startswith",
        "ret",
        "content",
        "tag",
        "ret",
        "tag",
        "ret",
        "rety",
        "tag",
        "ret",
        "selectT",
        "body",
        "tagLen",
        "ret",
        "fileId",
        "FIDs",
        "get",
        "fileId",
        "fileId",
        "lc",
        "ret",
        "lc",
        "i",
        "i",
        "i",
        "tag",
        "tagLen",
        "keyRef",
        "i",
        "tagLen",
        "i",
        "i",
        "keyStr",
        "lc",
        "tag",
        "hex",
        "ret",
        "tagStr",
        "PIV_OIDs",
        "get",
        "tagStr",
        "tagStr",
        "ret",
        "ret",
        "status",
        "body",
        "len",
        "body",
        "body",
        "body",
        "body",
        "appLen",
        "len",
        "body",
        "body",
        "body",
        "body",
        "tagLen",
        "lastGet",
        "tag",
        "ret",
        "tagBody",
        "hex",
        "tag",
        "ret",
        "tagBody",
        "hex",
        "tag",
        "ret",
        "tagBody",
        "decode",
        "tag",
        "ret",
        "tagBody",
        "hex",
        "ret",
        "tag",
        "tagLen",
        "tagBody",
        "hex",
        "ret",
        "lastGet",
        "tag",
        "tagLen",
        "tagBody",
        "hex",
        "body",
        "tagLen",
        "ret",
        "body",
        "body",
        "hex",
        "status",
        "body",
        "body",
        "hex",
        "body",
        "body",
        "hex",
        "status",
        "body",
        "body",
        "hex",
        "aid",
        "aid",
        "aid",
        "tagLen",
        "tag",
        "ret",
        "len",
        "body",
        "body",
        "body",
        "body",
        "tag2Len",
        "tag2",
        "ret",
        "tag2Body",
        "hex",
        "tag2",
        "ret",
        "tag2Body",
        "hex",
        "tag2",
        "ret",
        "tag2Body",
        "encode",
        "tag2",
        "ret",
        "tag2Body",
        "hex",
        "ret",
        "tag2",
        "tag2Body",
        "hex",
        "body",
        "tag2Len",
        "ret",
        "tagLen",
        "tag",
        "ret",
        "len",
        "body",
        "body",
        "body",
        "body",
        "tag2Len",
        "tag2",
        "ret",
        "tag2Body",
        "hex",
        "tag2",
        "ret",
        "tag2Body",
        "encode",
        "tag2",
        "tag2Body",
        "len",
        "body2",
        "body2",
        "body2",
        "tag3",
        "body2",
        "v",
        "tokens",
        "append",
        "v",
        "tokens",
        "append",
        "v",
        "tokens",
        "append",
        "body2",
        "tag3Len",
        "ret",
        "join",
        "tokens",
        "ret",
        "tag2",
        "tag2Body",
        "hex",
        "body",
        "tag2Len",
        "ret",
        "selectT",
        "status",
        "body",
        "len",
        "body",
        "selectT",
        "parseFcp",
        "body",
        "selectT",
        "parseFci",
        "body",
        "selectT",
        "status",
        "body",
        "hex",
        "fileId",
        "tag",
        "tagLen",
        "hex",
        "DOs",
        "get",
        "doStr",
        "doStr",
        "doStr",
        "tag",
        "tagLen",
        "tagLen",
        "hex",
        "ret",
        "status",
        "body",
        "ret",
        "body",
        "body",
        "hex",
        "status",
        "body",
        "body",
        "hex",
        "body",
        "body",
        "hex",
        "status",
        "body",
        "body",
        "hex",
        "aid",
        "aid",
        "ApplicationPIV",
        "aid",
        "aid",
        "ApplicationGids",
        "aid",
        "ApplicationDummy",
        "aid",
        "len",
        "sys",
        "argv",
        "open",
        "sys",
        "argv",
        "sys",
        "stdin",
        "l",
        "fin",
        "readlines",
        "lineno",
        "len",
        "l",
        "l",
        "find",
        "recvKey",
        "pos",
        "pos",
        "len",
        "recvKey",
        "l",
        "find",
        "pos",
        "pos2",
        "l",
        "find",
        "sendKey",
        "pos",
        "pos",
        "len",
        "sendKey",
        "l",
        "find",
        "pos",
        "pos2",
        "l",
        "pos",
        "pos2",
        "l",
        "codecs",
        "decode",
        "body",
        "toCard",
        "CMD_NAMES",
        "get",
        "ins",
        "ins",
        "cmdName",
        "cmdName",
        "p1",
        "i",
        "i",
        "i",
        "lc",
        "p1",
        "i",
        "i",
        "lc",
        "hex",
        "AIDs",
        "get",
        "aid",
        "aid",
        "lastSelect",
        "p2",
        "p2",
        "p2",
        "currentApp",
        "currentApp",
        "getAID",
        "aid",
        "createAppByAid",
        "aid",
        "cmdName",
        "lc",
        "lc",
        "decode",
        "P2_DATA_QUALIFIER",
        "get",
        "p2",
        "pin",
        "cmdName",
        "p1",
        "p2",
        "currentApp",
        "getData",
        "fileId",
        "ret",
        "cmdName",
        "currentApp",
        "mse",
        "lc",
        "ret",
        "cmdName",
        "currentApp",
        "pso",
        "lc",
        "ret",
        "cmdName",
        "cmdName",
        "status",
        "ERROR_CODES",
        "get",
        "status",
        "len",
        "body",
        "lastCmd",
        "currentApp",
        "selectResult",
        "lastSelectT",
        "status",
        "body",
        "lastCmd",
        "currentApp",
        "getDataResult",
        "status",
        "body",
        "lastCmd",
        "currentApp",
        "mseResult",
        "status",
        "body",
        "lastCmd",
        "currentApp",
        "psoResult",
        "status",
        "body",
        "ret",
        "ret"
    ],
    "literals": [
        "\"DESACTIVATE FILE\"",
        "\"ERASE RECORD\"",
        "\"ERASE BINARY\"",
        "\"ERASE BINARY\"",
        "\"VERIFY\"",
        "\"VERIFY\"",
        "\"MSE\"",
        "\"CHANGE REFERENCE DATA\"",
        "\"MSE\"",
        "\"DISABLE VERIFICATION REQUIREMENT\"",
        "\"ENABLE VERIFICATION REQUIREMENT\"",
        "\"PSO\"",
        "\"RESET RETRY COUNTER\"",
        "\"RESET RETRY COUNTER\"",
        "\"ACTIVATE FILE\"",
        "\"GENERATE ASYMMETRIC KEY PAIR\"",
        "\"GENERATE ASYMMETRIC KEY PAIR\"",
        "\"GET CHALLENGE\"",
        "\"GENERAL AUTHENTICATE\"",
        "\"GENERAL AUTHENTICATE\"",
        "\"INTERNAL AUTHENTICATE\"",
        "\"SEARCH BINARY\"",
        "\"SEARCH BINARY\"",
        "\"SEARCH RECORD\"",
        "\"SELECT\"",
        "\"READ BINARY\"",
        "\"READ BINARY\"",
        "\"READ RECORD\"",
        "\"READ RECORD\"",
        "\"GET RESPONSE\"",
        "\"ENVELOPPE\"",
        "\"ENVELOPPE\"",
        "\"GET DATA\"",
        "\"GET DATA\"",
        "\"WRITE BINARY\"",
        "\"WRITE BINARY\"",
        "\"WRITE RECORD\"",
        "\"UPDATE BINARY\"",
        "\"UPDATE BINARY\"",
        "\"PUT DATA\"",
        "\"PUT DATA\"",
        "\"UPDATE RECORD\"",
        "\"UPDATE RECORD\"",
        "\"CREATE FILE\"",
        "\"APPEND RECORD\"",
        "\"DELETE FILE\"",
        "\"TERMINATE DF\"",
        "\"TERMINATE EF\"",
        "\"TERMINATE CARD USAGE\"",
        "\"a00000039742544659\"",
        "\"MsGidsAID\"",
        "\"a000000308\"",
        "\"PIV\"",
        "\"a0000003974349445f0100\"",
        "\"SC PNP\"",
        "\"Current EF\"",
        "\"EF.DIR\"",
        "\"EF.ATR\"",
        "\"Current application(ADF)\"",
        "\"df1f\"",
        "\"DO_FILESYSTEMTABLE\"",
        "\"df20\"",
        "\"DO_CARDID\"",
        "\"df21\"",
        "\"DO_CARDAPPS\"",
        "\"df22\"",
        "\"DO_CARDCF\"",
        "\"df23\"",
        "\"DO_CMAPFILE\"",
        "\"df24\"",
        "\"DO_KXC00\"",
        "\"success\"",
        "\"end of file or record\"",
        "\"warning counter 0\"",
        "\"warning counter 1\"",
        "\"warning counter 2\"",
        "\"warning counter 3\"",
        "\"warning counter 4\"",
        "\"warning counter 5\"",
        "\"warning counter 6\"",
        "\"warning counter 7\"",
        "\"warning counter 8\"",
        "\"warning counter 9\"",
        "\"security status not satisfied\"",
        "\"condition of use not satisfied\"",
        "\"incorrect parameter cmd data field\"",
        "\"function not suppported\"",
        "\"file or application not found\"",
        "\"record not found\"",
        "\"REFERENCE DATA NOT FOUND\"",
        "\"unsupported\"",
        "\"5fc101\"",
        "\"X.509 Certificate for Card Authentication\"",
        "\"5fc102\"",
        "\"Card Holder Unique Identifier\"",
        "\"5fc103\"",
        "\"Cardholder Fingerprints\"",
        "\"5fc105\"",
        "\"X.509 Certificate for PIV Authentication\"",
        "\"5fc106\"",
        "\"Security Object\"",
        "\"5fc107\"",
        "\"Card Capability Container\"",
        "\"5fc108\"",
        "\"Cardholder Facial Image\"",
        "\"5fc10a\"",
        "\"X.509 Certificate for Digital Signature\"",
        "\"5fc10b\"",
        "\"X.509 Certificate for Key Management\"",
        "\"5fc10d\"",
        "\"Retired X.509 Certificate for Key Management 1\"",
        "\"5fc10e\"",
        "\"Retired X.509 Certificate for Key Management 2\"",
        "\"5fc10f\"",
        "\"Retired X.509 Certificate for Key Management 3\"",
        "'selectResult(%s, %s, %s)\\n'",
        "'getData(0x%x, %s)\\n'",
        "'getDataResult(0x%x, %s)\\n'",
        "''",
        "\"FCI\"",
        "\"\\tpiv version: %s\\n\"",
        "'a000000308'",
        "'NIST RID'",
        "'\\tCoexistent tag allocation authority: %s\\n'",
        "'\\tapplication label\\n'",
        "'\\tCryptographic algorithms supported\\n'",
        "'\\tunknown tag 0x%x\\n'",
        "\"\\tTODO: selectType %s\\n\"",
        "\"\\tfileId=%s\\n\"",
        "\"%0.4x\"",
        "\"\\tdoId=%0.4x\\n\"",
        "''",
        "\"key(tag=0x%x len=%d ref=0x%x)=\"",
        "\"value(tag=0x%x len=%d)\"",
        "'\\ttag: %s(%s)\\n'",
        "'<unknown>'",
        "\"\\tunknown key access\\n\"",
        "''",
        "''",
        "'5fc102'",
        "'\\tFASC-N: %s\\n'",
        "'\\tGUID: %s\\n'",
        "'\\texpirationDate: %s\\n'",
        "'utf8'",
        "'\\tIssuer Asymmetric Signature: %s\\n'",
        "\"\\tunknown tag=0x%x len=%d content=%s\\n\"",
        "\"\\t%s: unknown tag=0x%x len=%d content=%s\\n\"",
        "''",
        "'\\tFCP\\n'",
        "'\\t\\tFileDescriptor: %s\\n'",
        "'\\t\\tLifeCycleByte: %s\\n'",
        "'\\t\\tDF name: %s\\n'",
        "'utf8'",
        "'\\t\\tSecurityAttributes: %s\\n'",
        "'\\t\\tunhandled tag=0x%x body=%s\\n'",
        "''",
        "'\\tFCI\\n'",
        "'\\t\\tApplication AID: %s\\n'",
        "'\\t\\tApplication label: %s\\n'",
        "'utf8'",
        "'mutualAuthSymAlgo'",
        "'extAuthSymAlgo'",
        "'keyEstabIntAuthECC'",
        "'\\t\\tDiscretionary data objects: %s\\n'",
        "\",\"",
        "'\\t\\tunhandled tag=0x%x body=%s\\n'",
        "''",
        "'FCP'",
        "'FCI'",
        "'\\tselectResult(%s, %s, %s)\\n'",
        "'\\tDO=%s\\n'",
        "\"<%s>\"",
        "'\\tunknown tag=0%x len=%d v=%s'",
        "''",
        "\"a000000308\"",
        "'a00000039742544659'",
        "'__main__'",
        "\"r\"",
        "''",
        "'pbRecvBuffer: { '",
        "' }'",
        "\"line %d: invalid recvBuffer\"",
        "'pbSendBuffer: { '",
        "' }'",
        "\"line %d: invalid sendBuffer\"",
        "'hex'",
        "\"<COMMAND 0x%x>\"",
        "\":\"",
        "\"SELECT\"",
        "\"\\tselectByFID: %0.2x%0.2x\"",
        "''",
        "\"\\tselectByAID: %s(%s)\"",
        "\"FCI\"",
        "'\\tFCI'",
        "'\\tFCP'",
        "\"FCP\"",
        "'\\tFMD'",
        "\"FMD\"",
        "\"VERIFY\"",
        "\"Card global password\"",
        "\"RFU\"",
        "\"Application password\"",
        "\"Application resetting password\"",
        "\"Application security status resetting code\"",
        "''",
        "\", pin='\"",
        "'utf8)'",
        "\"'\"",
        "\"\\t%s%s\"",
        "\"<unknown>\"",
        "\"GET DATA\"",
        "\"%s\"",
        "\"MSE\"",
        "\"%s\"",
        "\"PSO\"",
        "\"%s\"",
        "'handle %s'",
        "\"status=0x%0.4x(%s)\"",
        "\"<unknown>\"",
        "''",
        "\"SELECT\"",
        "\"GET DATA\"",
        "\"MSE\"",
        "\"PSO\"",
        "\"%s\""
    ],
    "variables": [
        "CMD_NAMES",
        "AIDs",
        "FIDs",
        "DOs",
        "ERROR_CODES",
        "PIV_OIDs",
        "aid",
        "lastGet",
        "aid",
        "ret",
        "appTag",
        "appLen",
        "body",
        "tag",
        "tagLen",
        "subBody",
        "subTag",
        "subLen",
        "content",
        "v",
        "content",
        "body",
        "ret",
        "lc",
        "tag",
        "tagLen",
        "keyStr",
        "i",
        "tag",
        "tagLen",
        "keyRef",
        "keyStr",
        "i",
        "tag",
        "tagLen",
        "tagStr",
        "lastGet",
        "ret",
        "appTag",
        "appLen",
        "body",
        "tag",
        "tagLen",
        "tagBody",
        "body",
        "aid",
        "lastDo",
        "ret",
        "tag",
        "tagLen",
        "body",
        "tag2",
        "tag2Len",
        "tag2Body",
        "body",
        "ret",
        "tag",
        "tagLen",
        "body",
        "tag2",
        "tag2Len",
        "tag2Body",
        "body2",
        "tokens",
        "tag3",
        "tag3Len",
        "v",
        "body2",
        "body",
        "lc",
        "tag",
        "tagLen",
        "doStr",
        "ret",
        "lastDo",
        "ret",
        "ret",
        "fin",
        "fin",
        "lineno",
        "lastCmd",
        "lastSelect",
        "lastSelectFCI",
        "lastGetItem",
        "currentApp",
        "body",
        "recvKey",
        "pos",
        "toCard",
        "pos2",
        "toCard",
        "sendKey",
        "pos",
        "pos2",
        "body",
        "cla",
        "ins",
        "p1",
        "p2",
        "cmdName",
        "lc",
        "i",
        "i",
        "aid",
        "lastSelect",
        "lastSelectT",
        "lastSelectT",
        "lastSelectT",
        "currentApp",
        "lc",
        "P2_DATA_QUALIFIER",
        "pin",
        "pin",
        "lc",
        "fileId",
        "ret",
        "ret",
        "ret",
        "lastCmd",
        "status",
        "body",
        "ret",
        "ret",
        "ret",
        "ret",
        "ret"
    ],
    "comments": [
        "!/usr/bin/env python3",
        "",
        "Copyright 2022 David Fort <contact@hardening-consulting.com>",
        "",
        "This script is meant to parse some FreeRDP logs in DEBUG mode (WLOG_LEVEL=DEBUG) and interpret the",
        "smartcard traffic, dissecting the PIV or GIDS commands",
        "",
        "usage:",
        "",
        "TLV",
        "Card holder Unique Identifier",
        "smartcard loggers have changed",
        "if l.find(\"[DEBUG][com.freerdp.channels.smartcard.client]\") == -1:",
        "continue",
        "Responses"
    ],
    "docstrings": [
        "* live: WLOG_LEVEL=DEBUG xfreerdp <args with smartcard> | python3 smartcard-interpreter.py",
        "* on an existing log file: python3 smartcard-interpreter.py <log file>",
        "'''\n        while len(body) > 2:\n            tag = body[0]\n            tagLen = body[1]\n            \n            ret += '\\ttag=0x%x len=%d content=%s\\n' % (tag, tagLen, body[2:2+tagLen].hex())\n            \n            body = body[2+tagLen:]\n        '''"
    ],
    "functions": [
        "getAID",
        "selectResult",
        "getData",
        "getDataResult",
        "mse",
        "mseResult",
        "pso",
        "psoResult",
        "getAID",
        "selectResult",
        "getData",
        "getDataResult",
        "mse",
        "mseResult",
        "pso",
        "psoResult",
        "getAID",
        "parseFcp",
        "parseFci",
        "selectResult",
        "getData",
        "getDataResult",
        "mse",
        "mseResult",
        "pso",
        "psoResult",
        "createAppByAid"
    ],
    "classes": [
        "ApplicationDummy",
        "ApplicationPIV",
        "ApplicationGids"
    ]
}