{
    "identifiers": [
        "Microsoft",
        "Win32",
        "Newtonsoft",
        "Json",
        "Configuration",
        "Drawing",
        "IO",
        "Net",
        "Runtime",
        "InteropServices",
        "Text",
        "RegularExpressions",
        "Windows",
        "Forms",
        "DynamicBackground",
        "GetBackgroundUrlBase",
        "DownloadBackground",
        "urlBase",
        "GetResolutionExtension",
        "urlBase",
        "SaveBackground",
        "background",
        "WebClient",
        "WriteLine",
        "webClient",
        "DownloadString",
        "JsonConvert",
        "DeserializeObject",
        "dynamic",
        "jsonString",
        "ex",
        "ex",
        "DownloadJson",
        "jsonObject",
        "images",
        "urlbase",
        "DownloadJson",
        "jsonObject",
        "images",
        "copyright",
        "copyrightText",
        "Substring",
        "copyrightText",
        "IndexOf",
        "url",
        "WebRequest",
        "Create",
        "url",
        "request",
        "Method",
        "HttpWebResponse",
        "request",
        "GetResponse",
        "response",
        "StatusCode",
        "HttpStatusCode",
        "OK",
        "url",
        "Screen",
        "PrimaryScreen",
        "Bounds",
        "resolution",
        "Width",
        "resolution",
        "Height",
        "widthByHeight",
        "WebsiteExists",
        "url",
        "potentialExtension",
        "WriteLine",
        "widthByHeight",
        "potentialExtension",
        "WriteLine",
        "widthByHeight",
        "WriteLine",
        "url",
        "WriteLine",
        "WebRequest",
        "Create",
        "url",
        "request",
        "GetResponse",
        "reponse",
        "GetResponseStream",
        "Image",
        "FromStream",
        "stream",
        "directoryPath",
        "GetSetting",
        "IsNullOrEmpty",
        "directoryPath",
        "directoryPath",
        "Path",
        "Combine",
        "Environment",
        "GetFolderPath",
        "Environment",
        "SpecialFolder",
        "MyPictures",
        "Now",
        "Year",
        "ToString",
        "Directory",
        "Exists",
        "directoryPath",
        "Directory",
        "CreateDirectory",
        "directoryPath",
        "GetBackgroundTitle",
        "IsNullOrEmpty",
        "filename",
        "filename",
        "Now",
        "ToString",
        "filename",
        "Regex",
        "Replace",
        "filename",
        "filename",
        "Path",
        "Combine",
        "directoryPath",
        "filename",
        "Image",
        "background",
        "WriteLine",
        "GetBackgroundImagePath",
        "background",
        "Save",
        "imagepath",
        "Drawing",
        "Imaging",
        "ImageFormat",
        "Bmp",
        "imagepath",
        "key",
        "ConfigurationManager",
        "AppSettings",
        "key",
        "key",
        "value",
        "ConfigurationManager",
        "OpenExeConfiguration",
        "ConfigurationUserLevel",
        "configuration",
        "AppSettings",
        "Settings",
        "key",
        "Value",
        "value",
        "configuration",
        "Save",
        "ConfigurationSaveMode",
        "Full",
        "ConfigurationManager",
        "RefreshSection"
    ],
    "literals": [
        "\"Downloading JSON...\"",
        "\"https://www.bing.com/HPImageArchive.aspx?format=js&idx=0&n=1&mkt=en-US\"",
        "\"https://www.bing.com\"",
        "\" (\"",
        "\"HEAD\"",
        "\"x\"",
        "\"_\"",
        "\".jpg\"",
        "\"Background for \"",
        "\" found.\"",
        "\"No background for \"",
        "\" was found.\"",
        "\"Using 1920x1080 instead.\"",
        "\"_1920x1080.jpg\"",
        "\"Downloading background...\"",
        "\"ImgSaveLoc\"",
        "\"Bing Backgrounds\"",
        "\"M-d-yyyy\"",
        "\"_\"",
        "\".jpg\"",
        "\"Saving background...\"",
        "\"appSettings\""
    ],
    "variables": [
        "urlBase",
        "Image",
        "background",
        "WebClient",
        "webClient",
        "jsonString",
        "dynamic",
        "jsonObject",
        "dynamic",
        "jsonObject",
        "copyrightText",
        "WebRequest",
        "request",
        "HttpWebResponse",
        "response",
        "Rectangle",
        "resolution",
        "widthByHeight",
        "potentialExtension",
        "WebRequest",
        "request",
        "WebResponse",
        "reponse",
        "Stream",
        "stream",
        "directoryPath",
        "filename",
        "imagepath",
        "Configuration",
        "configuration"
    ],
    "comments": [
        "https://github.com/josueespinosa/BingBackground/blob/master/BingBackground/BingBackground/App.config",
        "SetBackground(GetPosition());",
        "SetProxy();",
        "private static void SetProxy()",
        "{",
        "string proxyUrl = Properties.Settings.Default.Proxy;",
        "if (proxyUrl.Length > 0)",
        "{",
        "var webProxy = new WebProxy(proxyUrl, true);",
        "webProxy.Credentials = CredentialCache.DefaultCredentials;",
        "WebRequest.DefaultWebProxy = webProxy;",
        "}",
        "}",
        "private enum PicturePosition",
        "{",
        "Tile,",
        "Center,",
        "Stretch,",
        "Fit,",
        "Fill",
        "}",
        "private static PicturePosition GetPosition()",
        "{",
        "PicturePosition position = PicturePosition.Fit;",
        "switch (Properties.Settings.Default.Position)",
        "{",
        "case \"Tile\":",
        "position = PicturePosition.Tile;",
        "break;",
        "case \"Center\":",
        "position = PicturePosition.Center;",
        "break;",
        "case \"Stretch\":",
        "position = PicturePosition.Stretch;",
        "break;",
        "case \"Fit\":",
        "position = PicturePosition.Fit;",
        "break;",
        "case \"Fill\":",
        "position = PicturePosition.Fill;",
        "break;",
        "}",
        "return position;",
        "}",
        "internal sealed class NativeMethods",
        "{",
        "[DllImport(\"user32.dll\", CharSet = CharSet.Auto)]",
        "internal static extern int SystemParametersInfo(int uAction, int uParam, string lpvParam, int fuWinIni);",
        "}",
        "private static void SetBackground(PicturePosition style)",
        "{",
        "Console.WriteLine(\"Setting background...\");",
        "using (RegistryKey key = Registry.CurrentUser.OpenSubKey(Path.Combine(\"Control Panel\", \"Desktop\"), true))",
        "{",
        "switch (style)",
        "{",
        "case PicturePosition.Tile:",
        "key.SetValue(\"PicturePosition\", \"0\");",
        "key.SetValue(\"TileWallpaper\", \"1\");",
        "break;",
        "case PicturePosition.Center:",
        "key.SetValue(\"PicturePosition\", \"0\");",
        "key.SetValue(\"TileWallpaper\", \"0\");",
        "break;",
        "case PicturePosition.Stretch:",
        "key.SetValue(\"PicturePosition\", \"2\");",
        "key.SetValue(\"TileWallpaper\", \"0\");",
        "break;",
        "case PicturePosition.Fit:",
        "key.SetValue(\"PicturePosition\", \"6\");",
        "key.SetValue(\"TileWallpaper\", \"0\");",
        "break;",
        "case PicturePosition.Fill:",
        "key.SetValue(\"PicturePosition\", \"10\");",
        "key.SetValue(\"TileWallpaper\", \"0\");",
        "break;",
        "}",
        "}",
        "const int SetDesktopBackground = 20;",
        "const int UpdateIniFile = 1;",
        "const int SendWindowsIniChange = 2;",
        "NativeMethods.SystemParametersInfo(SetDesktopBackground, 0, GetBackgroundImagePath(), UpdateIniFile | SendWindowsIniChange);",
        "}"
    ],
    "docstrings": [],
    "functions": [
        "GetDownloadedImagePath",
        "dynamic",
        "DownloadJson",
        "GetBackgroundUrlBase",
        "GetBackgroundTitle",
        "WebsiteExists",
        "GetResolutionExtension",
        "Image",
        "DownloadBackground",
        "GetBackgroundImagePath",
        "SaveBackground",
        "GetSetting",
        "SetSetting"
    ],
    "classes": [
        "BingBackground"
    ]
}