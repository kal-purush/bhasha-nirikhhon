{
    "identifiers": [
        "geopy",
        "distance",
        "geodesic",
        "pandas",
        "pd",
        "sqlalchemy",
        "create_engine",
        "MetaData",
        "Table",
        "select",
        "and_",
        "geopandas",
        "gpd",
        "shapely",
        "geometry",
        "Point",
        "math",
        "numpy",
        "np",
        "lat1",
        "lon1",
        "lat2",
        "lon2",
        "lon2",
        "lon1",
        "math",
        "sin",
        "dLon",
        "math",
        "cos",
        "lat2",
        "math",
        "cos",
        "lat1",
        "math",
        "sin",
        "lat2",
        "math",
        "sin",
        "lat1",
        "math",
        "cos",
        "lat2",
        "math",
        "cos",
        "dLon",
        "np",
        "rad2deg",
        "math",
        "atan2",
        "y",
        "x",
        "brng",
        "brng",
        "brng",
        "fname",
        "tab",
        "tab",
        "pd",
        "read_csv",
        "fname",
        "sep",
        "sep_char",
        "df",
        "engine",
        "metadata",
        "connection",
        "Table",
        "metadata",
        "autoload",
        "autoload_with",
        "engine",
        "Table",
        "metadata",
        "autoload",
        "autoload_with",
        "engine",
        "t_locality_point",
        "columns",
        "keys",
        "t_locality",
        "columns",
        "keys",
        "select",
        "t_locality",
        "columns",
        "locality_pid",
        "t_locality",
        "columns",
        "locality_name",
        "t_locality",
        "columns",
        "state_pid",
        "t_locality_point",
        "columns",
        "latitude",
        "t_locality_point",
        "columns",
        "longitude",
        "t_locality",
        "columns",
        "locality_class_code",
        "ilocs_stmt",
        "where",
        "and_",
        "t_locality",
        "columns",
        "locality_pid",
        "t_locality_point",
        "columns",
        "locality_pid",
        "t_locality",
        "columns",
        "locality_class_code",
        "ilocs_stmt",
        "order_by",
        "t_locality",
        "columns",
        "locality_pid",
        "connection",
        "execute",
        "ilocs_stmt",
        "fetchall",
        "pd",
        "DataFrame",
        "results",
        "results",
        "keys",
        "gpd",
        "GeoDataFrame",
        "df",
        "geometry",
        "gpd",
        "points_from_xy",
        "df",
        "longitude",
        "df",
        "latitude",
        "gdf",
        "v_stmt",
        "row",
        "tolerance",
        "v_stmt",
        "where",
        "and_",
        "v_address_view",
        "columns",
        "Longitude",
        "between",
        "row",
        "LONGITUDE",
        "tolerance",
        "row",
        "LONGITUDE",
        "tolerance",
        "v_address_view",
        "columns",
        "Latitude",
        "between",
        "row",
        "LATITUDE",
        "tolerance",
        "row",
        "LATITUDE",
        "tolerance",
        "result",
        "connection",
        "execute",
        "v_stmt_loop",
        "geodesic",
        "result",
        "Latitude",
        "result",
        "Longitude",
        "row",
        "LATITUDE",
        "row",
        "LONGITUDE",
        "km",
        "data",
        "append",
        "result",
        "Address_Detail_PID",
        "result",
        "AddressText",
        "strip",
        "result",
        "Latitude",
        "result",
        "Longitude",
        "row",
        "LCODE",
        "row",
        "NAME",
        "row",
        "LATITUDE",
        "row",
        "LONGITUDE",
        "distance_km",
        "pd",
        "DataFrame",
        "data",
        "columns",
        "data_df",
        "found",
        "v_stmt",
        "row",
        "tolerance",
        "v_stmt",
        "where",
        "and_",
        "v_address_view",
        "columns",
        "Longitude",
        "between",
        "row",
        "LONGITUDE",
        "tolerance",
        "row",
        "LONGITUDE",
        "tolerance",
        "v_address_view",
        "columns",
        "Latitude",
        "between",
        "row",
        "LATITUDE",
        "tolerance",
        "row",
        "LATITUDE",
        "tolerance",
        "row",
        "LCODE",
        "row",
        "LCODE",
        "row",
        "LATITUDE",
        "row",
        "LONGITUDE",
        "result",
        "connection",
        "execute",
        "v_stmt_loop",
        "geodesic",
        "result",
        "Latitude",
        "result",
        "Longitude",
        "row",
        "LATITUDE",
        "row",
        "LONGITUDE",
        "km",
        "distance_km",
        "smallest",
        "distance_km",
        "result",
        "Address_Detail_PID",
        "result",
        "AddressText",
        "strip",
        "result",
        "Latitude",
        "result",
        "Longitude",
        "row",
        "LCODE",
        "row",
        "LCODE",
        "row",
        "LATITUDE",
        "row",
        "LATITUDE",
        "distance_km",
        "small_data",
        "found",
        "pd",
        "read_csv",
        "agil_names_url",
        "pd",
        "read_csv",
        "agil_locations_url",
        "pd",
        "merge",
        "agil_locations",
        "agil_names",
        "on",
        "Point",
        "xy",
        "xy",
        "agil_joined",
        "LONGITUDE",
        "agil_joined",
        "LATITUDE",
        "gpd",
        "GeoDataFrame",
        "agil_joined",
        "geometry",
        "geom",
        "crs",
        "agil_joined_gdf",
        "df",
        "id_col",
        "id_name",
        "gpd",
        "read_file",
        "rafile",
        "replace",
        "gpd",
        "GeoDataFrame",
        "df",
        "geometry",
        "gpd",
        "points_from_xy",
        "df",
        "locality_longitude",
        "df",
        "locality_latitude",
        "crs",
        "gpd",
        "sjoin",
        "df_poi_gdf",
        "rafile",
        "rafile",
        "geometry",
        "how",
        "op",
        "df_poi_ra_gdf",
        "drop",
        "columns",
        "gpd",
        "GeoDataFrame",
        "df",
        "geometry",
        "gpd",
        "points_from_xy",
        "df",
        "address_longitude",
        "df",
        "address_latitude",
        "crs",
        "gpd",
        "sjoin",
        "df_address_gdf",
        "rafile",
        "rafile",
        "geometry",
        "how",
        "op",
        "df_address_ra_gdf",
        "rename",
        "columns",
        "inplace",
        "pd",
        "merge",
        "df_address_ra_gdf",
        "id_col",
        "id_name",
        "df_poi_ra",
        "on",
        "df_out",
        "df_out",
        "df_out",
        "RA16_Diff_Flag",
        "apply",
        "x",
        "x",
        "df_out",
        "drop_duplicates",
        "id_col",
        "df_out",
        "pd",
        "read_csv",
        "pd",
        "read_csv",
        "agil_names_url",
        "pd",
        "read_csv",
        "agil_locations_url",
        "pd",
        "merge",
        "agil_locations",
        "agil_names",
        "on",
        "Point",
        "xy",
        "xy",
        "agil_joined",
        "LONGITUDE",
        "agil_joined",
        "LATITUDE",
        "gpd",
        "GeoDataFrame",
        "agil_joined",
        "geometry",
        "geom",
        "crs",
        "gpd",
        "read_file",
        "gpd",
        "sjoin",
        "agil_joined_gdf",
        "rafile",
        "rafile",
        "geometry",
        "how",
        "op",
        "agil_remote_gdf",
        "loc",
        "agil_remote_gdf",
        "pd",
        "merge",
        "df_closest",
        "p_agil",
        "left_on",
        "right_on",
        "how",
        "ref_agil",
        "RA_NAME16",
        "replace",
        "ref_agil",
        "Point",
        "xy",
        "xy",
        "process_dataset_1",
        "address_longitude",
        "process_dataset_1",
        "address_latitude",
        "gpd",
        "GeoDataFrame",
        "process_dataset_1",
        "geometry",
        "geom",
        "crs",
        "gpd",
        "sjoin",
        "process_dataset_1_gdf",
        "rafile",
        "rafile",
        "geometry",
        "how",
        "op",
        "process_dataset_2_gdf",
        "AddressText",
        "strip",
        "process_dataset_2_gdf",
        "RA_NAME16",
        "replace",
        "process_dataset_2_gdf",
        "process_dataset_2_gdf",
        "process_dataset_2_gdf",
        "RA16_Diff_Flag",
        "apply",
        "x",
        "x",
        "process_dataset_2_gdf",
        "drop",
        "axis",
        "process_dataset_3",
        "to_csv",
        "agil_joined",
        "pd",
        "merge",
        "process_dataset_3",
        "agil_joined_ref",
        "on",
        "how",
        "process_dataset_4",
        "NAME_y",
        "process_dataset_4",
        "drop",
        "axis",
        "process_dataset_5",
        "to_csv",
        "index",
        "gpd",
        "read_file",
        "gpd",
        "read_file",
        "gpd",
        "read_file",
        "gpd",
        "read_file",
        "gpd",
        "read_file",
        "gpd",
        "read_file",
        "gpd",
        "read_file",
        "gpd",
        "read_file",
        "gpd",
        "read_file",
        "pd",
        "concat",
        "mbact",
        "mbnsw",
        "mbnt",
        "mbnt",
        "mbot",
        "mbqld",
        "mbsa",
        "mbtas",
        "mbvic",
        "mbwa",
        "gdf",
        "STE_NAME16",
        "astype",
        "unique",
        "gdf",
        "dbase",
        "create_engine",
        "dbase",
        "engine",
        "connect",
        "MetaData",
        "engine",
        "metadata",
        "connection",
        "connection",
        "connection",
        "close",
        "read_poi",
        "add_cols",
        "df_closest"
    ],
    "literals": [
        "','",
        "'\\t'",
        "'LOCALITY'",
        "'LOCALITY_POINT'",
        "'locality_point'",
        "'locality'",
        "'I'",
        "'* query to dataframe *'",
        "'Address_Detail_PID'",
        "'AddressText'",
        "'address_latitude'",
        "'address_longitude'",
        "'LCODE'",
        "'NAME'",
        "'locality_latitude'",
        "'locality_longitude'",
        "'distance_km'",
        "'0'",
        "\"https://data.gov.au/data/dataset/34b1c164-fbe8-44a0-84fd-467dba645aa7/resource/6947c036-6383-44f3-a867-0fa0c2a48d6b/download/agil_names20190208.csv\"",
        "\"https://data.gov.au/data/dataset/34b1c164-fbe8-44a0-84fd-467dba645aa7/resource/625e0a41-6a30-4c11-9a20-ac64ba5a1d1f/download/agil_locations20190208.csv\"",
        "'LCODE'",
        "\"EPSG:4283\"",
        "'shape/RA_2016_AUST.shp'",
        "'RA_NAME16'",
        "'RA_NAME16'",
        "'.\\(.*\\)'",
        "''",
        "'Address_Detail_PID'",
        "'locality_latitude'",
        "'locality_longitude'",
        "\"EPSG:4283\"",
        "'RA_NAME16'",
        "'geometry'",
        "'left'",
        "'within'",
        "'geometry'",
        "'index_right'",
        "'locality_latitude'",
        "'locality_longitude'",
        "'Address_Detail_PID'",
        "'locality_longlat_RA16'",
        "\"EPSG:4283\"",
        "'RA_NAME16'",
        "'geometry'",
        "'left'",
        "'within'",
        "'RA_NAME16'",
        "'address_longlat_RA16'",
        "'Address_Detail_PID'",
        "'AddressText'",
        "'address_latitude'",
        "'address_longitude'",
        "'locality_latitude'",
        "'locality_longitude'",
        "'distance_km'",
        "'address_longlat_RA16'",
        "'Address_Detail_PID'",
        "'RA16_Diff_Flag'",
        "'address_longlat_RA16'",
        "'locality_longlat_RA16'",
        "'RA16_Diff_Flag'",
        "'closest_agil_3.csv'",
        "\"https://data.gov.au/data/dataset/34b1c164-fbe8-44a0-84fd-467dba645aa7/resource/6947c036-6383-44f3-a867-0fa0c2a48d6b/download/agil_names20190208.csv\"",
        "\"https://data.gov.au/data/dataset/34b1c164-fbe8-44a0-84fd-467dba645aa7/resource/625e0a41-6a30-4c11-9a20-ac64ba5a1d1f/download/agil_locations20190208.csv\"",
        "'LCODE'",
        "\"EPSG:4283\"",
        "'shape/RA_2016_AUST.shp'",
        "'RA_NAME16'",
        "'geometry'",
        "'left'",
        "'within'",
        "'NFLAG'",
        "'P'",
        "'LCODE'",
        "'NAME'",
        "'STATE'",
        "'LONGITUDE'",
        "'LATITUDE'",
        "'RA_NAME16'",
        "'LCODE'",
        "'LCODE'",
        "'left'",
        "'locality_longlat_RA16'",
        "'.\\(.*\\)'",
        "''",
        "'LCODE'",
        "'NAME_y'",
        "'locality_latitude'",
        "'locality_longitude'",
        "'locality_longlat_RA16'",
        "'distance_km'",
        "'Address_Detail_PID'",
        "'AddressText'",
        "'address_latitude'",
        "'address_longitude'",
        "'hello'",
        "\"EPSG:4283\"",
        "'RA_NAME16'",
        "'geometry'",
        "'left'",
        "'within'",
        "'AddressText'",
        "'address_longlat_RA16'",
        "'.\\(.*\\)'",
        "''",
        "'RA16_Diff_Flag'",
        "'address_longlat_RA16'",
        "'locality_longlat_RA16'",
        "'RA16_Diff_Flag'",
        "'geometry'",
        "'index_right'",
        "'RA_NAME16'",
        "'csv/new_closest_wout_alts.csv'",
        "'LCODE'",
        "'NCODE'",
        "'NAME'",
        "'NFLAG'",
        "'LCODE'",
        "'left'",
        "'NAME'",
        "'NCODE'",
        "'NAME_y'",
        "'LCODE'",
        "'NAME'",
        "'NFLAG'",
        "'locality_latitude'",
        "'locality_longitude'",
        "'locality_longlat_RA16'",
        "'distance_km'",
        "'Address_Detail_PID'",
        "'AddressText'",
        "'address_latitude'",
        "'address_longitude'",
        "'address_longlat_RA16'",
        "'RA16_Diff_Flag'",
        "'csv/new_closest_agil_w_alts.csv'",
        "'shape/MB_2016_ACT.shp'",
        "'shape/MB_2016_NSW.shp'",
        "'shape/MB_2016_NT.shp'",
        "'shape/MB_2016_OT.shp'",
        "'shape/MB_2016_QLD.shp'",
        "'shape/MB_2016_SA.shp'",
        "'shape/MB_2016_TAS.shp'",
        "'shape/MB_2016_VIC.shp'",
        "'shape/MB_2016_WA.shp'",
        "'category'",
        "'sqlite:///spatialite_db/'",
        "'.sqlite'",
        "'closest_agil_3.csv'",
        "'LCODE'",
        "'NAME'"
    ],
    "variables": [
        "dLon",
        "y",
        "x",
        "brng",
        "sep_char",
        "sep_char",
        "df",
        "t_locality",
        "t_locality_point",
        "ilocs_stmt",
        "ilocs_stmt",
        "ilocs_stmt",
        "results",
        "df",
        "df",
        "columns",
        "gdf",
        "v_stmt_loop",
        "found",
        "data",
        "distance_km",
        "data_df",
        "v_stmt_loop",
        "found",
        "small_data",
        "smallest",
        "distance_km",
        "smallest",
        "small_data",
        "found",
        "agil_names_url",
        "agil_locations_url",
        "agil_names",
        "agil_locations",
        "agil_joined",
        "geom",
        "agil_joined_gdf",
        "rafile",
        "rafile",
        "df_poi_gdf",
        "df_poi_ra_gdf",
        "df_poi_ra",
        "df_poi_ra",
        "columns",
        "df_address_gdf",
        "df_address_ra_gdf",
        "df_out",
        "df_out",
        "df_out",
        "df_out",
        "df_closest",
        "agil_names_url",
        "agil_locations_url",
        "agil_names",
        "agil_locations",
        "agil_joined",
        "geom",
        "agil_joined_gdf",
        "rafile",
        "agil_remote_gdf",
        "p_agil",
        "ref_agil",
        "ref_agil",
        "process_dataset_1",
        "geom",
        "process_dataset_1_gdf",
        "process_dataset_2_gdf",
        "process_dataset_2_gdf",
        "process_dataset_2_gdf",
        "process_dataset_2_gdf",
        "process_dataset_2_gdf",
        "process_dataset_3",
        "agil_joined_ref",
        "process_dataset_4",
        "process_dataset_4",
        "process_dataset_5",
        "mbact",
        "mbnsw",
        "mbnt",
        "mbot",
        "mbqld",
        "mbsa",
        "mbtas",
        "mbvic",
        "mbwa",
        "gdf",
        "engine",
        "connection",
        "metadata",
        "df_closest",
        "df_out"
    ],
    "comments": [
        "!/usr/bin/env python3",
        "-*- coding: utf-8 -*-",
        "import geopandas as gpd",
        "from shapely.geometry import Point",
        "Set Column names",
        "if distance_km < 60:",
        "geom=[Point(xy) for xy in zip(df.locality_longitude, df.locality_latitude)]",
        "geom=[Point(xy) for xy in zip(df.address_longitude, df.address_latitude)]",
        "a_agil = agil_remote_gdf[agil_remote_gdf.NFLAG=='A']",
        "stages 1 and 2 - convert to inputs to geospatial and base process",
        "stage 3 - drop working columns and output primary list",
        "stage 4 and 5 - replace with alternate name references and output complete list",
        "print(engine.table_names())",
        "tables",
        "ADDRESS_DETAIL ->  ADDRESS_DETAIL_PID (in v_address_view)",
        "ADDRESS_MESH_BLOCK_2016 -> ADDRESS_MESH_BLOCK_2016_PID,ADDRESS_DETAIL_PID,MB_2016_PID",
        "MB_2016 -> MB_2016_PID,MB_2016_CODE",
        "print('address view')",
        "engine,metadata,connection = start_engine('gnaf_may_2020_new')",
        "v_address_view= Table('ADDRESS_TBL2',metadata, autoload=True,",
        "autoload_with=engine)",
        "print(v_address_view.columns.keys())",
        "",
        "",
        "closest=[]",
        "df = get_agil_datagovau()",
        "df = df[df['NFLAG']=='P']",
        "v_stmt = select([v_address_view.columns.Address_Detail_PID,",
        "v_address_view.columns.Latitude, v_address_view.columns.Longitude,",
        "v_address_view.columns.AddressText])",
        "",
        "for index,row in df.iterrows():",
        "#limit by bounding box",
        "tolerance = 1",
        "",
        "while True:",
        "print('trying tolerance', tolerance,' degree and row \\n',row)",
        "small_data, found = closest_address(v_stmt,row,tolerance)",
        "print(index,small_data)",
        "if found == True:",
        "break",
        "else:",
        "tolerance += 1",
        "",
        "",
        "closest.append(small_data)",
        "",
        "",
        "",
        "close_connection(connection)",
        "print(closest)",
        "",
        "df_closest=pd.DataFrame(closest,columns=['Address_Detail_PID','AddressText',",
        "'address_latitude','address_longitude',",
        "'LCODE','NAME',",
        "'locality_latitude',",
        "'locality_longitude','distance_km'])",
        "df_closest.to_csv('closest_agil_3.csv')"
    ],
    "docstrings": [
        "\"\"\"\nCreated on Wed Jul  8 13:56:51 2020\n@author: pi\n\"\"\""
    ],
    "functions": [
        "get_bearing",
        "read_poi",
        "gnaf_agil_db",
        "closest_addresses",
        "closest_address",
        "get_agil_datagovau",
        "add_cols",
        "post_agil",
        "mb_aust",
        "start_engine",
        "close_connection"
    ],
    "classes": []
}