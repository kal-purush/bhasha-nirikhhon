{
    "identifiers": [
        "yaml",
        "os",
        "shodan",
        "datetime",
        "datetime",
        "pycti",
        "OpenCTIConnectorHelper",
        "get_config_variable",
        "os",
        "path",
        "dirname",
        "os",
        "path",
        "abspath",
        "yaml",
        "load",
        "open",
        "config_file_path",
        "Loader",
        "yaml",
        "FullLoader",
        "os",
        "path",
        "isfile",
        "config_file_path",
        "OpenCTIConnectorHelper",
        "config",
        "get_config_variable",
        "config",
        "get_config_variable",
        "config",
        "shodan",
        "Shodan",
        "token",
        "shodanHostResponse",
        "host",
        "shodanHostResponse",
        "Hostnames",
        "host",
        "domain",
        "shodanHostResponse",
        "Domains",
        "domain",
        "service",
        "shodanHostResponse",
        "service",
        "strip",
        "Services",
        "service",
        "serviceData",
        "service",
        "service",
        "service",
        "Services",
        "service",
        "Services",
        "shodanHostResponse",
        "shodanHostResponse",
        "shodanHostResponse",
        "Hostnames",
        "Domains",
        "Services",
        "Observable_Description",
        "shodanHostResponse",
        "service",
        "shodanHostResponse",
        "service",
        "service",
        "datetime",
        "datetime",
        "strptime",
        "sslObject",
        "datetime",
        "datetime",
        "strptime",
        "sslObject",
        "helper",
        "api",
        "stix_cyber_observable",
        "create",
        "observableData",
        "join",
        "k",
        "v",
        "k",
        "v",
        "sslObject",
        "items",
        "issued",
        "isoformat",
        "split",
        "expires",
        "isoformat",
        "split",
        "join",
        "k",
        "v",
        "k",
        "v",
        "sslObject",
        "items",
        "join",
        "sslObject",
        "i",
        "i",
        "i",
        "len",
        "sslObject",
        "sslObject",
        "sslObject",
        "sslObject",
        "sslObject",
        "update",
        "x509s",
        "append",
        "x509",
        "x509s",
        "shodanHostResponse",
        "domain",
        "shodanHostResponse",
        "helper",
        "api",
        "stix_cyber_observable",
        "create",
        "observableData",
        "domain",
        "update",
        "domains",
        "append",
        "domainX",
        "domains",
        "shodanHostResponse",
        "observable",
        "datetime",
        "now",
        "strftime",
        "shodanHostResponse",
        "tag",
        "shodanHostResponse",
        "helper",
        "api",
        "label",
        "create",
        "value",
        "tag",
        "helper",
        "api",
        "stix_cyber_observable",
        "add_label",
        "id",
        "observable",
        "label_id",
        "tag_shodan",
        "_generate_host_description",
        "shodanHostResponse",
        "_generate_x509",
        "shodanHostResponse",
        "_generate_domains",
        "shodanHostResponse",
        "shodanHostResponse",
        "replace",
        "helper",
        "api",
        "stix_cyber_observable",
        "create",
        "observableData",
        "ASNumber",
        "shodanHostResponse",
        "update",
        "objectLabel",
        "tags",
        "helper",
        "api",
        "indicator",
        "create",
        "name",
        "shodanHostResponse",
        "description",
        "Description",
        "pattern_type",
        "pattern",
        "shodanHostResponse",
        "x_opencti_main_observable_type",
        "valid_from",
        "now",
        "update",
        "objectLabel",
        "tags",
        "confidence",
        "helper",
        "connect_confidence_level",
        "x_opencti_detection",
        "helper",
        "api",
        "stix_cyber_observable",
        "update_field",
        "id",
        "observable",
        "key",
        "value",
        "Description",
        "tag",
        "tags",
        "helper",
        "api",
        "stix_cyber_observable",
        "add_label",
        "id",
        "observable",
        "label_name",
        "tag",
        "helper",
        "api",
        "stix_core_relationship",
        "create",
        "fromId",
        "final_indicator",
        "toId",
        "observable",
        "relationship_type",
        "update",
        "confidence",
        "helper",
        "connect_confidence_level",
        "helper",
        "api",
        "stix_cyber_observable_relationship",
        "create",
        "fromId",
        "final_observable",
        "toId",
        "asn",
        "relationship_type",
        "update",
        "confidence",
        "helper",
        "connect_confidence_level",
        "x509",
        "x509s",
        "helper",
        "api",
        "stix_core_relationship",
        "create",
        "fromId",
        "observable",
        "toId",
        "x509",
        "relationship_type",
        "update",
        "confidence",
        "helper",
        "connect_confidence_level",
        "domain",
        "domains",
        "helper",
        "api",
        "stix_cyber_observable_relationship",
        "create",
        "fromId",
        "domain",
        "toId",
        "observable",
        "relationship_type",
        "update",
        "confidence",
        "helper",
        "connect_confidence_level",
        "helper",
        "api",
        "external_reference",
        "create",
        "source_name",
        "url",
        "shodanHostResponse",
        "description",
        "shodanHostResponse",
        "shodanHostResponse",
        "shodanHostResponse",
        "join",
        "shodanHostResponse",
        "helper",
        "api",
        "stix_cyber_observable",
        "add_external_reference",
        "id",
        "final_observable",
        "external_reference_id",
        "external_reference",
        "data",
        "data",
        "helper",
        "api",
        "stix_cyber_observable",
        "read",
        "id",
        "entity_id",
        "marking_definition",
        "observable",
        "marking_definition",
        "marking_definition",
        "OpenCTIConnectorHelper",
        "check_max_tlp",
        "tlp",
        "max_tlp",
        "ValueError",
        "observable",
        "shodanAPI",
        "host",
        "observable_value",
        "e",
        "e",
        "_convert_shodan_to_stix",
        "response",
        "observable",
        "helper",
        "listen",
        "_process_message",
        "ShodanConnector",
        "ShodanInstance",
        "start"
    ],
    "literals": [
        "\"/config.yml\"",
        "\"SHODAN_TOKEN\"",
        "\"shodan\"",
        "\"token\"",
        "\"SHODAN_MAX_TLP\"",
        "\"shodan\"",
        "\"max_tlp\"",
        "\"Hostnames:\"",
        "\"hostnames\"",
        "f\"\\n  - {host}\"",
        "\"Domains:\"",
        "\"domains\"",
        "f\"\\n  - {domain}\"",
        "\"Services:\\n\"",
        "\"data\"",
        "\"data\"",
        "f'\\n**{str(service[\"port\"])}:**\\n```\\n{serviceData}\\n```'",
        "\"port\"",
        "\"opts\"",
        "\"opts\"",
        "\"heartbleed\"",
        "\"opts\"",
        "f'\\nHEARTBLEED: {service[\"opts\"][\"heartbleed\"]}'",
        "\"opts\"",
        "\"heartbleed\"",
        "\"\\n------------------\"",
        "f\"\"\"\n**ORG:** {shodanHostResponse[\"org\"]}\n\n**ISP:** {shodanHostResponse[\"isp\"]}\n\n**OS:** {str(shodanHostResponse[\"os\"])}\n\n--------------------------\n{Hostnames}\n\n--------------------------\n{Domains}\n\n--------------------------\n{Services}\n        \"\"\"",
        "\"org\"",
        "\"isp\"",
        "\"os\"",
        "\"data\"",
        "\"ssl\"",
        "\"ssl\"",
        "\"cert\"",
        "\"issued\"",
        "\"%Y%m%d%H%M%SZ\"",
        "\"cert\"",
        "\"expires\"",
        "\"%Y%m%d%H%M%SZ\"",
        "\"type\"",
        "\"x509-certificate\"",
        "\"issuer\"",
        "\", \"",
        "f\"{k}={v}\"",
        "\"cert\"",
        "\"subject\"",
        "\"validity_not_before\"",
        "\".\"",
        "\"Z\"",
        "\"validity_not_after\"",
        "\".\"",
        "\"Z\"",
        "\"subject\"",
        "\", \"",
        "f\"{k}={v}\"",
        "\"cert\"",
        "\"issuer\"",
        "\"serial_number\"",
        "\":\"",
        "\"cert\"",
        "\"serial\"",
        "\"cert\"",
        "\"serial\"",
        "\"hashes\"",
        "\"sha256\"",
        "\"cert\"",
        "\"fingerprint\"",
        "\"sha256\"",
        "\"sha1\"",
        "\"cert\"",
        "\"fingerprint\"",
        "\"sha1\"",
        "\"signature_algorithm\"",
        "\"cert\"",
        "\"sig_alg\"",
        "\"subject_public_key_algorithm\"",
        "\"cert\"",
        "\"pubkey\"",
        "\"type\"",
        "\"domains\"",
        "\"type\"",
        "\"domain-name\"",
        "\"value\"",
        "\"%Y-%m-%dT%H:%M:%SZ\"",
        "\"tags\"",
        "\"tags\"",
        "\"id\"",
        "\"id\"",
        "\"asn\"",
        "\"AS\"",
        "\"\"",
        "\"type\"",
        "\"autonomous-system\"",
        "\"number\"",
        "\"name\"",
        "\"asn\"",
        "\"ip_str\"",
        "\"stix\"",
        "f\"[ipv4-addr:value = '{shodanHostResponse['ip_str']}']\"",
        "'ip_str'",
        "\"IPv4-Addr\"",
        "\"id\"",
        "\"x_opencti_description\"",
        "\"id\"",
        "\"id\"",
        "\"id\"",
        "\"based-on\"",
        "\"id\"",
        "\"id\"",
        "\"obs_belongs-to\"",
        "\"id\"",
        "\"id\"",
        "\"related-to\"",
        "\"id\"",
        "\"id\"",
        "\"resolves-to\"",
        "\"Shodan\"",
        "\"https://shodan.io/host/\"",
        "\"ip_str\"",
        "f'[{shodanHostResponse[\"country_code\"]}] [{shodanHostResponse[\"region_code\"]} - {shodanHostResponse[\"city\"]}] - {\" \".join(shodanHostResponse[\"hostnames\"])}'",
        "\"country_code\"",
        "\"region_code\"",
        "\"city\"",
        "\" \"",
        "\"hostnames\"",
        "\"id\"",
        "\"id\"",
        "\"entity_id\"",
        "\"TLP:WHITE\"",
        "\"objectMarking\"",
        "\"definition_type\"",
        "\"TLP\"",
        "\"definition\"",
        "\"Do not send any data, TLP of the observable is greater than MAX TLP\"",
        "\"value\"",
        "\"[SUCCESS] Shodan IP Found, data sent in\"",
        "\"__main__\""
    ],
    "variables": [
        "config_file_path",
        "config",
        "helper",
        "token",
        "max_tlp",
        "shodanAPI",
        "Hostnames",
        "Hostnames",
        "Domains",
        "Domains",
        "Services",
        "serviceData",
        "Services",
        "Services",
        "Services",
        "Observable_Description",
        "x509s",
        "sslObject",
        "issued",
        "expires",
        "x509",
        "domains",
        "domainX",
        "now",
        "tags",
        "tag_shodan",
        "Description",
        "x509s",
        "domains",
        "ASNumber",
        "asn",
        "final_indicator",
        "final_observable",
        "external_reference",
        "entity_id",
        "observable",
        "tlp",
        "tlp",
        "observable_value",
        "response",
        "ShodanInstance"
    ],
    "comments": [
        "Instantiate the connector helper from config",
        "Generate Hostname Desc Block",
        "Generate Domain Desc Block",
        "Generate Services Desc Block",
        "Create the description for the Observable",
        "\"version\": str(sslObject[\"cert\"][\"version\"]),",
        "--------------------------------------------------------------------",
        "Helpers",
        "--------------------------------------------------------------------",
        "Now",
        "Pull Tags via API",
        "Create tags",
        "Create description",
        "Create ASN Helper Object",
        "--------------------------------------------------------------------",
        "STIX Objects",
        "--------------------------------------------------------------------",
        "Create Indicator",
        "Update the current observable",
        "--------------------------------------------------------------------",
        "Relationships",
        "--------------------------------------------------------------------",
        "Link Indicator to Observable",
        "Link ASN to Observable",
        "Link x509 to Observable",
        "Link Domains to Observable",
        "--------------------------------------------------------------------",
        "References",
        "--------------------------------------------------------------------",
        "Create external reference to shodan",
        "Extract TLP",
        "Extract IP from entity data",
        "Get Shodan API Response",
        "Process and send Shodan Data to OpenCTI",
        "Start the main loop"
    ],
    "docstrings": [],
    "functions": [
        "_generate_host_description",
        "_generate_x509",
        "_generate_domains",
        "_convert_shodan_to_stix",
        "_process_message",
        "start"
    ],
    "classes": [
        "ShodanConnector"
    ]
}