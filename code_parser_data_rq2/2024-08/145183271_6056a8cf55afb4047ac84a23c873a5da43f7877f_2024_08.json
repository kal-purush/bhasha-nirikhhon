{
    "identifiers": [
        "requests",
        "yaml",
        "re",
        "os",
        "subprocess",
        "csv",
        "json",
        "azure",
        "monitor",
        "ingestion",
        "LogsIngestionClient",
        "azure",
        "identity",
        "DefaultAzureCredential",
        "azure",
        "core",
        "exceptions",
        "HttpResponseError",
        "time",
        "sys",
        "current_directory",
        "subprocess",
        "run",
        "git_remote_command",
        "shell",
        "text",
        "capture_output",
        "check",
        "remote_result",
        "stdout",
        "split",
        "SentinelRepoUrl",
        "subprocess",
        "run",
        "git_add_upstream_command",
        "shell",
        "text",
        "capture_output",
        "check",
        "subprocess",
        "run",
        "git_fetch_upstream_command",
        "shell",
        "text",
        "capture_output",
        "check",
        "current_directory",
        "subprocess",
        "check_output",
        "cmd",
        "shell",
        "decode",
        "split",
        "subprocess",
        "CalledProcessError",
        "e",
        "e",
        "subprocess",
        "check_output",
        "cmd",
        "shell",
        "text",
        "strip",
        "subprocess",
        "CalledProcessError",
        "e",
        "e",
        "url",
        "requests",
        "get",
        "url",
        "e",
        "url",
        "e",
        "yaml",
        "safe_load",
        "response",
        "text",
        "response",
        "status_code",
        "modified_files",
        "line",
        "line",
        "modified_files",
        "line",
        "endswith",
        "csv_file",
        "open",
        "csv_file",
        "encoding",
        "file",
        "csv",
        "DictReader",
        "file",
        "row",
        "reader",
        "row",
        "reserved_columns",
        "row",
        "data",
        "append",
        "row",
        "rsplit",
        "data",
        "append",
        "row",
        "rsplit",
        "row",
        "item",
        "data",
        "key",
        "key",
        "endswith",
        "suffix",
        "suffix",
        "suffixes",
        "key",
        "value",
        "key",
        "value",
        "item",
        "items",
        "main_data",
        "append",
        "output_dict",
        "main_data",
        "csv_file",
        "open",
        "csv_file",
        "encoding",
        "file",
        "csv",
        "DictReader",
        "file",
        "row",
        "reader",
        "row",
        "key",
        "key",
        "endswith",
        "suffix",
        "suffix",
        "suffixes",
        "key",
        "value",
        "key",
        "value",
        "row",
        "items",
        "data",
        "append",
        "output_dict",
        "item",
        "data",
        "key",
        "item",
        "keys",
        "key",
        "item",
        "pop",
        "key",
        "data",
        "table_name",
        "table_name",
        "table_name",
        "lia_supported_builtin_table",
        "table_name",
        "lia_supported_builtin_table",
        "table_name",
        "endswith",
        "table_name",
        "endswith",
        "log_ingestion_supported",
        "table_type",
        "schema",
        "table",
        "table",
        "json",
        "loads",
        "schema",
        "subscriptionId",
        "resourceGroupName",
        "workspaceName",
        "table",
        "request_object",
        "url",
        "method",
        "query_table",
        "DefaultAzureCredential",
        "credential",
        "get_token",
        "token",
        "workspace_id",
        "json",
        "dumps",
        "query_table",
        "token",
        "requests",
        "post",
        "url",
        "headers",
        "headers",
        "data",
        "payload",
        "each",
        "json",
        "loads",
        "query_response",
        "text",
        "get",
        "get",
        "each",
        "reserved_columns",
        "each",
        "schema",
        "append",
        "each",
        "schema",
        "append",
        "each",
        "each",
        "schema",
        "schema",
        "table",
        "table_type",
        "table",
        "prnumber",
        "prnumber",
        "json",
        "loads",
        "schema",
        "subscriptionId",
        "resourceGroupName",
        "dataCollectionEndpointname",
        "subscriptionId",
        "resourceGroupName",
        "workspaceName",
        "workspace_id",
        "prnumber",
        "prnumber",
        "prnumber",
        "table_type",
        "table",
        "subscriptionId",
        "resourceGroupName",
        "dcrname",
        "request_object",
        "url",
        "method",
        "prnumber",
        "DefaultAzureCredential",
        "credential",
        "get_token",
        "token",
        "token",
        "url",
        "request",
        "method",
        "get_access_token",
        "access_token",
        "requests",
        "request",
        "method",
        "url",
        "headers",
        "headers",
        "json",
        "request",
        "response",
        "immutable_id",
        "data_result",
        "stream_name",
        "flag_status",
        "flag_status",
        "time",
        "sleep",
        "DefaultAzureCredential",
        "LogsIngestionClient",
        "endpoint",
        "endpoint_uri",
        "credential",
        "credential",
        "logging_enable",
        "client",
        "upload",
        "rule_id",
        "immutable_id",
        "stream_name",
        "stream_name",
        "logs",
        "data_result",
        "HttpResponseError",
        "e",
        "e",
        "parser_query",
        "parser_file",
        "re",
        "search",
        "parser_file",
        "match",
        "match",
        "group",
        "parser_file",
        "re",
        "search",
        "parser_query",
        "match",
        "match",
        "group",
        "replace",
        "parser_file",
        "re",
        "search",
        "parser_query",
        "match",
        "match",
        "group",
        "replace",
        "parser_file",
        "event_vendor",
        "event_product",
        "schema_name",
        "os",
        "path",
        "dirname",
        "os",
        "path",
        "abspath",
        "get_modified_files",
        "current_directory",
        "filter_yaml_files",
        "modified_files",
        "get_current_commit_number",
        "sys",
        "argv",
        "file",
        "parser_yaml_files",
        "file",
        "SENTINEL_REPO_RAW_URL",
        "commit_number",
        "file",
        "read_github_yaml",
        "asim_parser_url",
        "asim_parser",
        "get",
        "extract_event_vendor_product",
        "parser_query",
        "file",
        "event_vendor",
        "event_product",
        "schema_name",
        "SENTINEL_REPO_RAW_URL",
        "commit_number",
        "SAMPLE_DATA_PATH",
        "sample_data_url",
        "SampleDataFile",
        "requests",
        "get",
        "SampleDataUrl",
        "response",
        "status_code",
        "open",
        "file",
        "file",
        "write",
        "response",
        "content",
        "SampleDataUrl",
        "response",
        "text",
        "convert_data_csv_to_json",
        "table_name",
        "check_for_custom_table",
        "table_name",
        "log_ingestion_supported",
        "table_type",
        "log_ingestion_supported",
        "table_type",
        "table_name",
        "sample_data_url",
        "schema_file_name",
        "requests",
        "get",
        "schemaUrl",
        "response",
        "status_code",
        "open",
        "file",
        "file",
        "write",
        "response",
        "content",
        "schemaUrl",
        "response",
        "text",
        "convert_schema_csv_to_json",
        "create_table",
        "json",
        "dumps",
        "schema_result",
        "indent",
        "table_name",
        "hit_api",
        "url_to_call",
        "request_body",
        "method_to_use",
        "response_body",
        "status_code",
        "time",
        "sleep",
        "create_dcr",
        "json",
        "dumps",
        "schema_result",
        "indent",
        "table_name",
        "hit_api",
        "url_to_call",
        "request_body",
        "method_to_use",
        "response_body",
        "text",
        "dcr_directory",
        "append",
        "table_name",
        "prnumber",
        "json",
        "loads",
        "response_body",
        "text",
        "get",
        "get",
        "stream_name",
        "dcr_directory",
        "dcr",
        "dcr_directory",
        "table_name",
        "dcr",
        "prnumber",
        "dcr",
        "dcr",
        "dcr",
        "table_name",
        "immutable_id",
        "stream_name",
        "table_name",
        "senddtosentinel",
        "immutable_id",
        "data_result",
        "stream_name",
        "flag",
        "log_ingestion_supported",
        "table_type",
        "get_schema_for_builtin",
        "table_name",
        "create_dcr",
        "json",
        "dumps",
        "schema",
        "indent",
        "table_name",
        "hit_api",
        "url_to_call",
        "request_body",
        "method_to_use",
        "response_body",
        "text",
        "dcr_directory",
        "append",
        "table_name",
        "prnumber",
        "json",
        "loads",
        "response_body",
        "text",
        "get",
        "get",
        "stream_name",
        "dcr_directory",
        "dcr",
        "dcr_directory",
        "table_name",
        "dcr",
        "prnumber",
        "dcr",
        "dcr",
        "dcr",
        "dcr_directory",
        "table_name",
        "senddtosentinel",
        "immutable_id",
        "data_result",
        "stream_name",
        "flag",
        "table_name"
    ],
    "literals": [
        "\"git remote\"",
        "'upstream'",
        "f\"git remote add upstream '{SentinelRepoUrl}'\"",
        "\"git fetch upstream\"",
        "f\"git diff --name-only upstream/master {current_directory}/../../../Parsers/\"",
        "\"\\n\"",
        "f\"::error::Error occurred while executing the command: {e}\"",
        "\"git rev-parse HEAD\"",
        "f\"::error::Error occurred while executing the command: {e}\"",
        "f\"::error::An error occurred while trying to get content of YAML file located at {url}: {e}\"",
        "'.yaml'",
        "'r'",
        "'utf-8-sig'",
        "'_s'",
        "'_d'",
        "'_b'",
        "'_g'",
        "'ColumnName'",
        "'ColumnType'",
        "\"bool\"",
        "'name'",
        "'ColumnName'",
        "\"_\"",
        "'type'",
        "\"boolean\"",
        "'name'",
        "'ColumnName'",
        "\"_\"",
        "'type'",
        "'ColumnType'",
        "'r'",
        "'utf-8-sig'",
        "'_s'",
        "'_d'",
        "'_b'",
        "'_g'",
        "'Type'",
        "'TimeGenerated [UTC]'",
        "'TimeGenerated'",
        "\"builtin\"",
        "'_CL'",
        "'_cl'",
        "\"custom_log\"",
        "\"unknown\"",
        "\"properties\"",
        "\"schema\"",
        "\"name\"",
        "\"columns\"",
        "\"retentionInDays\"",
        "\"totalRetentionInDays\"",
        "\"PUT\"",
        "f\"https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/tables/{table}?api-version=2022-10-01\"",
        "'https://api.loganalytics.io/.default'",
        "f'https://api.loganalytics.io/v1/workspaces/{workspace_id}/query'",
        "'query'",
        "'|getschema'",
        "'Authorization'",
        "f'Bearer {token}'",
        "'Content-Type'",
        "'application/json'",
        "'tables'",
        "'rows'",
        "\"bool\"",
        "'name'",
        "'type'",
        "\"boolean\"",
        "'name'",
        "'type'",
        "\"_DCR\"",
        "\"location\"",
        "\"eastus\"",
        "\"properties\"",
        "\"streamDeclarations\"",
        "\"Custom-dcringest\"",
        "\"columns\"",
        "\"dataCollectionEndpointId\"",
        "f\"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Insights/dataCollectionEndpoints/{dataCollectionEndpointname}\"",
        "\"dataSources\"",
        "\"destinations\"",
        "\"logAnalytics\"",
        "\"workspaceResourceId\"",
        "f\"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}\"",
        "\"workspaceId\"",
        "\"name\"",
        "\"DataCollectionEvent\"",
        "\"dataFlows\"",
        "\"streams\"",
        "\"Custom-dcringest\"",
        "\"destinations\"",
        "\"DataCollectionEvent\"",
        "\"transformKql\"",
        "\"source\"",
        "\"outputStream\"",
        "f\"{table_type}-{table}\"",
        "\"PUT\"",
        "f\"https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Insights/dataCollectionRules/{dcrname}?api-version=2022-06-01\"",
        "\"Custom-dcringest\"",
        "'https://management.azure.com/'",
        "\"Authorization\"",
        "f\"Bearer {access_token}\"",
        "\"Content-Type\"",
        "\"application/json\"",
        "\"DCR is not created for the table. Please create DCR first\"",
        "\"Waiting for data to be sent to sentinel (This will take atleast 20 seconds)\"",
        "f\"Upload failed: {e}\"",
        "r'(ASim\\w+)/'",
        "f'EventVendor field not mapped in parser. Please map it in parser query.{parser_file}'",
        "r'EventVendor\\s*=\\s*[\\'\"]([^\\'\"]+)[\\'\"]'",
        "\" \"",
        "\"\"",
        "f'EventVendor field not mapped in parser. Please map it in parser query.{parser_file}'",
        "r'EventProduct\\s*=\\s*[\\'\"]([^\\'\"]+)[\\'\"]'",
        "\" \"",
        "\"\"",
        "f'Event Product field not mapped in parser. Please map it in parser query.{parser_file}'",
        "\"e9beceee-7d61-429f-a177-ee5e2b7f481a\"",
        "\"ASIM-SchemaDataTester-GithubShared\"",
        "\"asim-schemadatatester-githubshared\"",
        "\"4383ac89-7cd1-48c1-8061-b0b3c5ccfd97\"",
        "\"asim-schemadatatester-githubshared\"",
        "\"https://asim-schemadatatester-githubshared-uetl.eastus-1.ingest.monitor.azure.com\"",
        "f'https://raw.githubusercontent.com/Azure/Azure-Sentinel'",
        "'/Sample%20Data/ASIM/'",
        "'ADAssessmentRecommendation'",
        "'ADSecurityAssessmentRecommendation'",
        "'Anomalies'",
        "'ASimAuditEventLogs'",
        "'ASimAuthenticationEventLogs'",
        "'ASimDhcpEventLogs'",
        "'ASimDnsActivityLogs'",
        "'ASimDnsAuditLogs'",
        "'ASimFileEventLogs'",
        "'ASimNetworkSessionLogs'",
        "'ASimProcessEventLogs'",
        "'ASimRegistryEventLogs'",
        "'ASimUserManagementActivityLogs'",
        "'ASimWebSessionLogs'",
        "'AWSCloudTrail'",
        "'AWSCloudWatch'",
        "'AWSGuardDuty'",
        "'AWSVPCFlow'",
        "'AzureAssessmentRecommendation'",
        "'CommonSecurityLog'",
        "'DeviceTvmSecureConfigurationAssessmentKB'",
        "'DeviceTvmSoftwareVulnerabilitiesKB'",
        "'ExchangeAssessmentRecommendation'",
        "'ExchangeOnlineAssessmentRecommendation'",
        "'GCPAuditLogs'",
        "'GoogleCloudSCC'",
        "'SCCMAssessmentRecommendation'",
        "'SCOMAssessmentRecommendation'",
        "'SecurityEvent'",
        "'SfBAssessmentRecommendation'",
        "'SharePointOnlineAssessmentRecommendation'",
        "'SQLAssessmentRecommendation'",
        "'StorageInsightsAccountPropertiesDaily'",
        "'StorageInsightsDailyMetrics'",
        "'StorageInsightsHourlyMetrics'",
        "'StorageInsightsMonthlyMetrics'",
        "'StorageInsightsWeeklyMetrics'",
        "'Syslog'",
        "'UCClient'",
        "'UCClientReadinessStatus'",
        "'UCClientUpdateStatus'",
        "'UCDeviceAlert'",
        "'UCDOAggregatedStatus'",
        "'UCServiceUpdateStatus'",
        "'UCUpdateAlert'",
        "'WindowsEvent'",
        "'WindowsServerAssessmentRecommendation'",
        "\"_ResourceId\"",
        "\"id\"",
        "\"_SubscriptionId\"",
        "\"TenantId\"",
        "\"Type\"",
        "\"UniqueId\"",
        "\"Title\"",
        "\"_ItemId\"",
        "\"verbose_b\"",
        "\"verbose\"",
        "\"MG\"",
        "\"https://github.com/Azure/Azure-Sentinel\"",
        "f\"Starting ingestion for sample data present in {file}\"",
        "f'{SENTINEL_REPO_RAW_URL}/{commit_number}/{file}'",
        "'ParserQuery'",
        "''",
        "f'{event_vendor}_{event_product}_{schema_name}_IngestedLogs.csv'",
        "f'{SENTINEL_REPO_RAW_URL}/{commit_number}/{SAMPLE_DATA_PATH}'",
        "'tempfile.csv'",
        "'wb'",
        "f\"::error::An error occurred while trying to get content of Sample Data file located at {SampleDataUrl}: {response.text}\"",
        "'tempfile.csv'",
        "f\"Table Name : {table_name}\"",
        "f\"Log ingestion supported: {log_ingestion_supported}\\n Table type: {table_type}\"",
        "\"custom_log\"",
        "f\"{table_name}_Schema.csv\"",
        "'tempfile.csv'",
        "'wb'",
        "f\"::error::An error occurred while trying to get content of Schema file located at {schemaUrl}: {response.text}\"",
        "'tempfile.csv'",
        "f\"Response of table creation: {response_body.status_code}\"",
        "\"Custom\"",
        "f\"Response of DCR creation: {response_body.text}\"",
        "'DCRname'",
        "'_DCR'",
        "'imutableid'",
        "'properties'",
        "'immutableId'",
        "'stream_name'",
        "'DCRname'",
        "'DCRname'",
        "'imutableid'",
        "'stream_name'",
        "f\"Ingestion started for {table_name}\"",
        "f\"{immutable_id},{stream_name},{table_name}\"",
        "\"builtin\"",
        "\"Microsoft\"",
        "f\"Response of DCR creation: {response_body.text}\"",
        "'DCRname'",
        "'_DCR'",
        "'imutableid'",
        "'properties'",
        "'immutableId'",
        "'stream_name'",
        "'DCRname'",
        "'DCRname'",
        "'imutableid'",
        "'stream_name'",
        "f\"Ingestion started for {table_name}\"",
        "f\"Table {table_name} is not supported for log ingestion\""
    ],
    "variables": [
        "git_remote_command",
        "remote_result",
        "git_add_upstream_command",
        "git_fetch_upstream_command",
        "cmd",
        "cmd",
        "response",
        "data",
        "main_data",
        "output_dict",
        "suffixes",
        "reader",
        "output_dict",
        "data",
        "output_dict",
        "suffixes",
        "reader",
        "table_name",
        "output_dict",
        "item",
        "log_ingestion_supported",
        "table_type",
        "log_ingestion_supported",
        "table_type",
        "log_ingestion_supported",
        "table_type",
        "request_object",
        "method",
        "url",
        "credential",
        "token",
        "url",
        "payload",
        "headers",
        "query_response",
        "schema",
        "dcrname",
        "request_object",
        "method",
        "url",
        "credential",
        "token",
        "access_token",
        "headers",
        "response",
        "credential",
        "client",
        "match",
        "schema_name",
        "match",
        "event_vendor",
        "match",
        "event_product",
        "workspace_id",
        "workspaceName",
        "resourceGroupName",
        "subscriptionId",
        "dataCollectionEndpointname",
        "endpoint_uri",
        "SENTINEL_REPO_RAW_URL",
        "SAMPLE_DATA_PATH",
        "dcr_directory",
        "lia_supported_builtin_table",
        "reserved_columns",
        "SentinelRepoUrl",
        "current_directory",
        "modified_files",
        "parser_yaml_files",
        "commit_number",
        "prnumber",
        "asim_parser_url",
        "asim_parser",
        "parser_query",
        "event_vendor",
        "event_product",
        "schema_name",
        "SampleDataFile",
        "sample_data_url",
        "SampleDataUrl",
        "response",
        "data_result",
        "table_name",
        "log_ingestion_supported",
        "table_type",
        "flag",
        "schema_file_name",
        "schemaUrl",
        "response",
        "schema_result",
        "request_body",
        "url_to_call",
        "method_to_use",
        "response_body",
        "request_body",
        "url_to_call",
        "method_to_use",
        "stream_name",
        "response_body",
        "immutable_id",
        "stream_name",
        "flag",
        "flag",
        "schema",
        "request_body",
        "url_to_call",
        "method_to_use",
        "stream_name",
        "response_body",
        "immutable_id",
        "stream_name",
        "flag"
    ],
    "comments": [
        "Add upstream remote if not already present",
        "Fetch from upstream",
        "Take only the YAML files",
        "If the key matches 'TimeGenerated [UTC]', rename it",
        "Obtain the access token",
        "Set the API endpoint",
        "Create the payload",
        "Set the headers",
        "Make the request",
        "suffic_num = str(random.randint(100,999))",
        "main starting point of script",
        "logs ingestion endpoint of the DCR",
        "flag value is used to check if DCR is created for the table or not",
        "create table",
        "Once table is created now creating DCR",
        "ingestion start for sending data via DCR",
        "flag value is used to check if DCR is created for the table or not",
        "create dcr for ingestion"
    ],
    "docstrings": [],
    "functions": [
        "get_modified_files",
        "get_current_commit_number",
        "read_github_yaml",
        "filter_yaml_files",
        "convert_schema_csv_to_json",
        "convert_data_csv_to_json",
        "check_for_custom_table",
        "create_table",
        "get_schema_for_builtin",
        "create_dcr",
        "get_access_token",
        "hit_api",
        "senddtosentinel",
        "extract_event_vendor_product"
    ],
    "classes": []
}