{
    "identifiers": [
        "canvas",
        "src",
        "resolve",
        "reject",
        "Image",
        "img",
        "resolve",
        "img",
        "img",
        "err",
        "reject",
        "src",
        "img",
        "src",
        "index",
        "imageTransforms",
        "index",
        "previewBgs",
        "index",
        "transform",
        "previewBg",
        "transform",
        "previewBg",
        "transform",
        "previewBg",
        "transform",
        "transform",
        "previewBg",
        "previewBg",
        "previewBg",
        "index",
        "imageTransforms",
        "index",
        "photoFiles",
        "index",
        "photoImageObjects",
        "index",
        "index",
        "index",
        "index",
        "updatePreviewBackground",
        "index",
        "updateGenerateButtonState",
        "photoInputs",
        "input",
        "input",
        "parseInt",
        "file",
        "photoFiles",
        "index",
        "file",
        "statusElem",
        "index",
        "FileReader",
        "reader",
        "e",
        "imageTransforms",
        "index",
        "e",
        "imageTransforms",
        "index",
        "imageTransforms",
        "index",
        "imageTransforms",
        "index",
        "index",
        "index",
        "index",
        "updatePreviewBackground",
        "index",
        "updateGenerateButtonState",
        "loadImage",
        "e",
        "img",
        "photoImageObjects",
        "index",
        "img",
        "statusElem",
        "index",
        "updateGenerateButtonState",
        "error",
        "error",
        "statusElem",
        "index",
        "resetImageState",
        "index",
        "reader",
        "file",
        "error",
        "error",
        "statusElem",
        "index",
        "resetImageState",
        "index",
        "resetImageState",
        "index",
        "templateInput",
        "file",
        "templateFile",
        "file",
        "FileReader",
        "reader",
        "e",
        "previewTemplate",
        "e",
        "previewTemplate",
        "statusElem",
        "templateImageObject",
        "loadImage",
        "e",
        "statusElem",
        "error",
        "error",
        "statusElem",
        "templateFile",
        "templateImageObject",
        "previewTemplate",
        "previewTemplate",
        "updateGenerateButtonState",
        "reader",
        "file",
        "templateFile",
        "templateImageObject",
        "previewTemplate",
        "previewTemplate",
        "updateGenerateButtonState",
        "parseInt",
        "imageTransforms",
        "index",
        "imageTransforms",
        "index",
        "transformType",
        "parseFloat",
        "updatePreviewBackground",
        "index",
        "scaleSliders",
        "slider",
        "slider",
        "handleSliderChange",
        "offsetXSliders",
        "slider",
        "slider",
        "handleSliderChange",
        "offsetYSliders",
        "slider",
        "slider",
        "handleSliderChange",
        "updateGenerateButtonState",
        "photoImageObjects",
        "img",
        "img",
        "templateImageObject",
        "generateBtn",
        "allPhotosReady",
        "templateReady",
        "generateBtn",
        "statusElem",
        "statusElem",
        "generateBtn",
        "allPhotosReady",
        "templateReady",
        "photoImageObjects",
        "img",
        "i",
        "img",
        "photoFiles",
        "i",
        "missing",
        "i",
        "img",
        "photoFiles",
        "i",
        "missing",
        "i",
        "templateReady",
        "templateFile",
        "missing",
        "templateReady",
        "templateFile",
        "missing",
        "missing",
        "statusElem",
        "missing",
        "generateBtn",
        "statusElem",
        "generateBtn",
        "resultImage",
        "downloadLink",
        "photoImageObjects",
        "img",
        "img",
        "templateImageObject",
        "statusElem",
        "updateGenerateButtonState",
        "setTimeout",
        "templateImageObject",
        "templateImageObject",
        "parseInt",
        "gridMarginTopInput",
        "parseInt",
        "gridMarginBottomInput",
        "parseInt",
        "gridMarginLeftInput",
        "parseInt",
        "gridMarginRightInput",
        "templateW",
        "marginLeft",
        "marginRight",
        "templateH",
        "marginTop",
        "marginBottom",
        "gridAreaWidth",
        "gridAreaHeight",
        "gridAreaWidth",
        "gridAreaHeight",
        "canvas",
        "templateW",
        "canvas",
        "templateH",
        "gridAreaWidth",
        "gridAreaHeight",
        "gridAreaX",
        "gridAreaY",
        "gridAreaX",
        "quadWidth",
        "gridAreaY",
        "gridAreaX",
        "gridAreaY",
        "quadHeight",
        "gridAreaX",
        "quadWidth",
        "gridAreaY",
        "quadHeight",
        "ctx",
        "canvas",
        "canvas",
        "photoImageObjects",
        "img",
        "index",
        "img",
        "imageTransforms",
        "index",
        "drawPositions",
        "index",
        "drawImageWithTransform",
        "ctx",
        "img",
        "transform",
        "pos",
        "pos",
        "quadWidth",
        "quadHeight",
        "ctx",
        "templateImageObject",
        "canvas",
        "canvas",
        "canvas",
        "resultImage",
        "finalImageDataUrl",
        "resultImage",
        "downloadLink",
        "finalImageDataUrl",
        "downloadLink",
        "statusElem",
        "error",
        "error",
        "statusElem",
        "error",
        "updateGenerateButtonState",
        "ctx",
        "img",
        "transform",
        "targetX",
        "targetY",
        "targetW",
        "targetH",
        "img",
        "img",
        "transform",
        "transform",
        "transform",
        "imgWidth",
        "scale",
        "imgHeight",
        "scale",
        "imgWidth",
        "sourceW",
        "offsetXRatio",
        "imgHeight",
        "sourceH",
        "offsetYRatio",
        "targetW",
        "targetH",
        "sourceW",
        "sourceH",
        "sourceAspect",
        "targetAspect",
        "sourceH",
        "targetAspect",
        "sourceX",
        "sourceW",
        "newSourceW",
        "offsetXRatio",
        "sourceW",
        "newSourceW",
        "sourceAspect",
        "targetAspect",
        "sourceW",
        "targetAspect",
        "sourceY",
        "sourceH",
        "newSourceH",
        "offsetYRatio",
        "sourceH",
        "newSourceH",
        "sourceX",
        "imgWidth",
        "sourceW",
        "sourceX",
        "sourceY",
        "imgHeight",
        "sourceH",
        "sourceY",
        "ctx",
        "img",
        "sourceX",
        "sourceY",
        "sourceW",
        "sourceH",
        "targetX",
        "targetY",
        "targetW",
        "targetH",
        "updateGenerateButtonState"
    ],
    "literals": [
        "'DOMContentLoaded'",
        "'.photo-input'",
        "'template'",
        "'previewTemplate'",
        "'generateBtn'",
        "'canvas'",
        "'2d'",
        "'resultImage'",
        "'downloadLink'",
        "'status'",
        "'.scale-slider'",
        "'.offset-slider-x'",
        "'.offset-slider-y'",
        "'previewBg0'",
        "'previewBg1'",
        "'previewBg2'",
        "'previewBg3'",
        "'gridMarginTop'",
        "'gridMarginBottom'",
        "'gridMarginLeft'",
        "'gridMarginRight'",
        "Failed to load image: ${src.substring(0, 50)}...",
        "url(${transform.dataUrl})",
        "${transform.scale * 100}%",
        "${transform.offsetX}% ${transform.offsetY}%",
        "''",
        "'cover'",
        "'center center'",
        "scale${index}",
        "offsetX${index}",
        "offsetY${index}",
        "'change'",
        "Loading photo ${index + 1}...",
        "scale${index}",
        "offsetX${index}",
        "offsetY${index}",
        "Photo ${index + 1} loaded.",
        "Error loading photo ${index + 1}. Please try another file.",
        "\"Error reading file:\"",
        "Error reading photo ${index + 1}.",
        "'change'",
        "'block'",
        "'Loading template...'",
        "'Template loaded.'",
        "'Error loading template. Please try another PNG.'",
        "'#'",
        "'none'",
        "'#'",
        "'none'",
        "''",
        "'input'",
        "'input'",
        "'input'",
        "'loaded'",
        "'Ready to generate.'",
        "Photo ${i+1} (processing)",
        "Photo ${i+1}",
        "'Template (processing)'",
        "'Template'",
        "Missing: ${missing.join(', ')}",
        "', '",
        "'click'",
        "'Generating... Please wait.'",
        "'none'",
        "'none'",
        "'Error: Not all images/template are loaded correctly.'",
        "Invalid grid dimensions calculated. Check margins. Grid Area: ${gridAreaWidth}x${gridAreaHeight}",
        "'image/png'",
        "'block'",
        "'inline-block'",
        "'Image generated successfully!'",
        "\"Error during canvas generation:\"",
        "Error: ${error.message || 'Could not generate image.'}",
        "'Could not generate image.'"
    ],
    "variables": [
        "photoInputs",
        "templateInput",
        "previewTemplate",
        "generateBtn",
        "canvas",
        "ctx",
        "resultImage",
        "downloadLink",
        "statusElem",
        "scaleSliders",
        "offsetXSliders",
        "offsetYSliders",
        "previewBgs",
        "gridMarginTopInput",
        "gridMarginBottomInput",
        "gridMarginLeftInput",
        "gridMarginRightInput",
        "photoFiles",
        "templateFile",
        "photoImageObjects",
        "templateImageObject",
        "imageTransforms",
        "img",
        "transform",
        "previewBg",
        "index",
        "file",
        "reader",
        "file",
        "reader",
        "index",
        "transformType",
        "updateGenerateButtonState",
        "allPhotosReady",
        "templateReady",
        "missing",
        "templateW",
        "templateH",
        "marginTop",
        "marginBottom",
        "marginLeft",
        "marginRight",
        "gridAreaX",
        "marginLeft",
        "gridAreaY",
        "marginTop",
        "gridAreaWidth",
        "gridAreaHeight",
        "quadWidth",
        "quadHeight",
        "drawPositions",
        "transform",
        "pos",
        "finalImageDataUrl",
        "imgWidth",
        "imgHeight",
        "scale",
        "offsetXRatio",
        "offsetYRatio",
        "sourceW",
        "sourceH",
        "sourceX",
        "sourceY",
        "targetAspect",
        "sourceAspect",
        "newSourceW",
        "newSourceH"
    ],
    "comments": [
        "--- Get references (Add new margin inputs) ---",
        "NEW: Margin Inputs",
        "--- State Management (No major changes needed here) ---",
        "--- Helper Functions (loadImage, updatePreviewBackground, resetImageState - Keep as before) ---",
        "... (same as before)",
        "... (same as before)",
        "... (same as before)",
        "--- Event Handlers (Photo Input, Template Input, Slider Changes - Keep as before) ---",
        "... (same as before)",
        "... (same as before)",
        "Optional: Automatically set max values for margins based on template size?",
        "gridMarginTopInput.max = templateImageObject.naturalHeight;",
        "gridMarginBottomInput.max = templateImageObject.naturalHeight;",
        "... etc. (Might be slightly annoying if user already typed)",
        "... (same as before)",
        "--- updateGenerateButtonState (No changes needed) ---",
        "... (same as before)",
        "--- Main Image Generation Function (MODIFIED) ---",
        "Use setTimeout to allow the UI to update",
        "--- NEW: Read and Validate Grid Margins ---",
        "Calculate the actual area for the 2x2 grid",
        "Validate grid area dimensions",
        "Set canvas size based on the template",
        "Calculate dimensions for each quadrant *within the grid area*",
        "--- Calculate positions for each quadrant RELATIVE TO CANVAS (0,0) ---",
        "Top-Left Quad",
        "Top-Right Quad",
        "Bottom-Left Quad",
        "Bottom-Right Quad",
        "Clear canvas",
        "--- Draw photos onto the canvas using transforms AND calculated positions/sizes ---",
        "Get the calculated top-left corner",
        "Draw the image into the calculated quadrant space",
        "Draw the template overlay on top (covers everything, including margins)",
        "Generate the final image URL",
        "Display the result",
        "Set up download link",
        "--- drawImageWithTransform (Keep as before - it works with target rect) ---",
        "... (same as before)",
        "--- Initial state check ---"
    ],
    "docstrings": [],
    "functions": [
        "loadImage",
        "updatePreviewBackground",
        "resetImageState",
        "handleSliderChange",
        "drawImageWithTransform"
    ],
    "classes": []
}